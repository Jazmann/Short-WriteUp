<html>
<head>
<meta http-equiv='content-type' content='text/html; charset=utf8'>
<style>
<!--
body {width:auto;padding:5;margin:5;}
.error {font-weight:bold;color:#f00;font-style:italic; border: solid 1px red;}
.word,.hword,.oword,.altwd {border-left: 1px solid #CDF; border-bottom: 1px solid #CDF;}
.word {color: #009}
.hword {color: #009; font-weight: 700;}
.oword {color: #009; font-style: italic;}
.altwd {color: #00c; font-style: oblique;}
.cmd {color: #c00;}
.exclcmd {color: #f99;}
.option {color: #cc0;}
.optparm {color: #c90;}
.envir, .document {color: #900; font-weight:bold;}
.math {color: #6c0;}
.mathgroup {color: #090;}
.exclmath {color: #9f6;}
.mathcmd {color: #6c0;}
.ignore {color: #999;}
.exclenv {color:#c66;}
.special {color:#c66; font-weight: bold;}
.specarg {color:#c66; font-weight: bold; font-style: italic;}
.tc {color: #999; font-weight:bold;}
.comment {color: #999; font-style: italic;}
.state {color: #990; font-size: 70%;}
.cumsum {color: #999; font-size: 80%;}
.fileinc {color: #696; font-weight:bold;}
.warning {color: #c00; font-weight: 700;}
.note {color: #c90; font-weight: bold;}

div.filegroup, div.parse, div.stylehelp, div.count, div.sumcount, div.error {
   border: solid 1px #999; margin: 4pt 0pt; padding: 4pt;
}
div.stylehelp {font-size: 80%; background: #fffff0; margin-bottom: 16pt;}
div.filegroup {background: #dfd; margin-bottom: 16pt;}
div.count {background: #ffe;}
div.sumcount {background: #cec;}
div.error {background: #fcc;}
.parse {font-size: 80%; background: #f8fff8; border-bottom:none;}

ul.count {list-style-type: none; margin: 4pt 0pt; padding: 0pt;}
.count li.header {font-weight: bold; font-style: italic;}
.subcount li.header {font-weight: normal; font-style: italic;}
.subcount li {margin-left: 16pt; font-size: 80%;}
.fielddesc {font-style: italic;}
.nb {color: #900;}

table.stat {border:2px solid #339; margin:0 0 8pt 0; background:#666; border-collapse:collapse;}
table.stat tr {border:1px solid #CCC;}
table.stat th, table.stat td {padding:1pt 4pt;}
table.stat col {padding:4pt;}
table.stat thead {background: #CCF;}
table.stat tbody {border:1px solid #333;}
table.stat tbody.sumstat {background:#FFC;}
table.stat tbody.langstat {background:#FEE;}
table.stat tbody.wordstat {background:#EEF;}
table.stat tbody.macrostat {background:#EFE;}
table.stat .sum {font-weight:bold; font-style:italic;}
-->
</style>
</head>

<body>

<h1>LaTeX word count</h1>
<div class="stylehelp"><p><h2>Format/colour codes of verbose output:</h2>

<span class='error'>ERROR</span>&nbsp;&nbsp;....&nbsp;&nbsp;TeXcount error message<br>
<span class='word'>Text which is counted</span>&nbsp;&nbsp;....&nbsp;&nbsp;counted as text words<br>
<span class='hword'>Header and title text</span>&nbsp;&nbsp;....&nbsp;&nbsp;counted as header words<br>
<span class='oword'>Caption text and footnotes</span>&nbsp;&nbsp;....&nbsp;&nbsp;counted as caption words<br>
<span class='altwd'>Words in user specified counters</span>&nbsp;&nbsp;....&nbsp;&nbsp;counted in separate counters<br>
<span class='ignore'>Ignored text or code</span>&nbsp;&nbsp;....&nbsp;&nbsp;excluded or ignored<br>
<span class='document'>\documentclass</span>&nbsp;&nbsp;....&nbsp;&nbsp;document start, beginning of preamble<br>
<span class='special'>Special macros, eg require special handling or have side-effects</span>&nbsp;&nbsp;....&nbsp;&nbsp;<br>
<span class='cmd'>\macro</span>&nbsp;&nbsp;....&nbsp;&nbsp;macro not counted, but parameters may be<br>
<span class='exclcmd'>\macro</span>&nbsp;&nbsp;....&nbsp;&nbsp;macro in excluded region<br>
<span class='option'>[Macro options]</span>&nbsp;&nbsp;....&nbsp;&nbsp;not counted<br>
<span class='optparm'>[Optional parameter]</span>&nbsp;&nbsp;....&nbsp;&nbsp;content parsed and styled as counted<br>
<span class='envir'>\begin{name}&nbsp; \end{name}</span>&nbsp;&nbsp;....&nbsp;&nbsp;environment<br>
<span class='exclenv'>\begin{name}&nbsp; \end{name}</span>&nbsp;&nbsp;....&nbsp;&nbsp;environment in excluded region<br>
<span class='specarg'>Special argument, eg with side-effects</span>&nbsp;&nbsp;....&nbsp;&nbsp;<br>
<span class='mathgroup'>$&nbsp; $</span>&nbsp;&nbsp;....&nbsp;&nbsp;counted as one equation<br>
<span class='exclmath'>$&nbsp; $</span>&nbsp;&nbsp;....&nbsp;&nbsp;equation in excluded region<br>
<span class='math'>2+2=4</span>&nbsp;&nbsp;....&nbsp;&nbsp;maths (inside $...$ etc.)<br>
<span class='mathcmd'>$\macro$</span>&nbsp;&nbsp;....&nbsp;&nbsp;macros inside maths<br>
<span class='comment'>% Comments</span>&nbsp;&nbsp;....&nbsp;&nbsp;not counted<br>
<span class='tc'>%TC:TeXcount instructions</span>&nbsp;&nbsp;....&nbsp;&nbsp;not counted<br>
<span class='fileinc'>File to include</span>&nbsp;&nbsp;....&nbsp;&nbsp;not counted but file may be counted later<br>
</p></div>


<div class='filegroup'>
<h2>File: thesis.tex</h2>
<div class='parse'><p>
<span class='comment'>% !TeX document-id = {e3a7ff19-e925-4f85-9d15-87fd720805e2}</span><br>
<span class='comment'>% !TeX TXS-program:compile = txs:///pdflatex --shell-escape --enable-write18 </span><br>
<span class='comment'>% ******************************* PhD Thesis Template **************************</span><br>
<span class='comment'>% Please have a look at the README.md file for info on how to use the template</span><br>
<br>
<span class='document'>\documentclass</span><span class='option'>[a4paper,12pt,times,numbered,print,index,square, sort, numbers, authoryear]</span><span class='document'>{Classes/PhDThesisPSnPDF}</span><br>
<br>
<span class='comment'>% ******************************************************************************</span><br>
<span class='comment'>% ******************************* Class Options ********************************</span><br>
<span class='comment'>% *********************** See README for more details **************************</span><br>
<span class='comment'>% ******************************************************************************</span><br>
<br>
<span class='comment'>% `a4paper'(The University of Cambridge PhD thesis guidelines recommends a page</span><br>
<span class='comment'>% size a4 - default option) or `a5paper': A5 Paper size is also allowed as per</span><br>
<span class='comment'>% the Cambridge University Engineering Deparment guidelines for PhD thesis</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `11pt' or `12pt'(default): Font Size 10pt is NOT recommended by the University</span><br>
<span class='comment'>% guidelines</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `oneside' or `twoside'(default): Printing double side (twoside) or single</span><br>
<span class='comment'>% side.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `print': Use `print' for print version with appropriate margins and page</span><br>
<span class='comment'>% layout. Leaving the options field blank will activate Online version.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `index': For index at the end of the thesis</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `draft': For draft mode without loading any images (same as draft in book)</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `abstract': To generate only the title page and abstract page with</span><br>
<span class='comment'>% dissertation title and name, to submit to the Student Registry</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% ************************* Custom Page Margins ********************************</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `custommargin`: Use `custommargin' in options to activate custom page margins,</span><br>
<span class='comment'>% which can be defined in the preamble.tex. Custom margin will override</span><br>
<span class='comment'>% print/online margin setup.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% *********************** Choosing the Fonts in Class Options ******************</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `times' : Times font with math support. ( The Cambridge University guidelines</span><br>
<span class='comment'>% recommend using times)</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `fourier': Utopia Font with Fourier Math font</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `customfont': Use `customfont' option in the document class and load the</span><br>
<span class='comment'>% package in the preamble.tex</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% default or leave empty: `Latin Modern' font will be loaded.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% ********************** Choosing the Bibliography style ***********************</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `authoryear': For author-year citation eg., Krishna (2013)</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `numbered': (Default Option) For numbered and sorted citation e.g., [1,5,2]</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `custombib': Define your own bibliography style in the `preamble.tex' file.</span><br>
<span class='comment'>% `\RequirePackage[square, sort, numbers, authoryear]{natbib}'</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% **************************** Choosing the Page Style *************************</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `default (leave empty)': For Page Numbers in Header (Left Even, Right Odd) and</span><br>
<span class='comment'>% Chapter Name in Header (Right Even) and Section Name (Left Odd). Blank Footer.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `PageStyleI': Chapter Name next &amp; Page Number on Even Side (Left Even).</span><br>
<span class='comment'>% Section Name &amp; Page Number in Header on Odd Side (Right Odd). Footer is empty.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% `PageStyleII': Chapter Name on Even Side (Left Even) in Header. Section Number</span><br>
<span class='comment'>% and Section Name in Header on Odd Side (Right Odd). Page numbering in footer</span><br>
<br>
<br>
<span class='comment'>% ********************************** Preamble **********************************</span><br>
<span class='comment'>% Preamble: Contains packages and user-defined commands and settings</span><br>
<span class='cmd'>\input</span><span class='fileinc'>{Preamble/preamble}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>notation-private</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>animate</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>media9</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>subfig</span><span class='document'>}</span><br>
<br>
<span class='exclcmd'>\epstopdfsetup</span><span class='ignore'>{</span><span class='ignore'>outdir</span><span class='ignore'>=</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\ifpdf</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Raster</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\else</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Vector</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\fi</span><br>
<br>
<br>
<span class='comment'>% ************************ Thesis Information &amp; Meta-data **********************</span><br>
<span class='comment'>%% The title of the thesis</span><br>
<span class='cmd'>\title</span><span class='ignore'>{</span><span class='hword'>A</span> <span class='hword'>Fingertip</span> <span class='hword'>Mechanical-Stress</span> <span class='hword'>Detector</span> <span class='hword'>using</span> <span class='hword'>Chromatic</span> <span class='hword'>Skin</span> <span class='hword'>Information</span><span class='ignore'>}</span><br>
<span class='comment'>%\texorpdfstring is used for PDF metadata. Usage:</span><br>
<span class='comment'>%\texorpdfstring{LaTeX_Version}{PDF Version (non-latex)} eg.,</span><br>
<span class='comment'>%\texorpdfstring{$sigma$}{sigma}</span><br>
<br>
<span class='comment'>%% The full name of the author</span><br>
<span class='exclcmd'>\author</span><span class='ignore'>{</span><span class='ignore'>Nayef</span> <span class='ignore'>Al-Saud</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>%% Department (eg. Department of Engineering, Maths, Physics)</span><br>
<span class='exclcmd'>\dept</span><span class='ignore'>{</span><span class='ignore'>Department</span> <span class='ignore'>of</span> <span class='ignore'>Engineering</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>%% University and Crest</span><br>
<span class='exclcmd'>\university</span><span class='ignore'>{</span><span class='ignore'>University</span> <span class='ignore'>of</span> <span class='ignore'>Cambridge</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\crest</span><span class='ignore'>{</span><span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.25\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>University</span><span class='ignore'>_</span><span class='ignore'>Crest.pdf</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>%% You can redefine the submission text:</span><br>
<span class='comment'>% Default as per the University guidelines: This dissertation is submitted for</span><br>
<span class='comment'>% the degree of Doctor of Philosophy</span><br>
<span class='comment'>%\renewcommand{\submissiontext}{change the default text here if needed}</span><br>
<br>
<span class='comment'>%% Full title of the Degree</span><br>
<span class='exclcmd'>\degree</span><span class='ignore'>{</span><span class='ignore'>Master</span> <span class='ignore'>of</span> <span class='ignore'>Philosophy</span> <span class='ignore'>in</span> <span class='ignore'>Engineering</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>%% College affiliation (optional)</span><br>
<span class='exclcmd'>\college</span><span class='ignore'>{</span><span class='ignore'>Hughes</span> <span class='ignore'>Hall</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>%% Submission date</span><br>
<span class='exclcmd'>\degreedate</span><span class='ignore'>{</span><span class='ignore'>15</span> <span class='ignore'>August</span> <span class='ignore'>2018</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>%% Meta information</span><br>
<span class='exclcmd'>\subject</span><span class='ignore'>{</span><span class='ignore'>LaTeX</span><span class='ignore'>}</span> <span class='exclcmd'>\keywords</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>LaTeX</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>MPhil</span> <span class='ignore'>Thesis</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>Engineering</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>University</span> <span class='ignore'>of</span><br>
<span class='ignore'>Cambridge</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<br>
<br>
<br>
<span class='comment'>% ***************************** Abstract Separate ******************************</span><br>
<span class='comment'>% To printout only the titlepage and the abstract with the PhD title and the</span><br>
<span class='comment'>% author name for submission to the Student Registry, use the abstract option in</span><br>
<span class='comment'>% the document class.</span><br>
<br>
<span class='exclcmd'>\ifdefineAbstract</span><br>
 <span class='exclcmd'>\includeonly</span><span class='ignore'>{</span><span class='ignore'>Abstract</span><span class='ignore'>/</span><span class='ignore'>abstract</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\else</span><br>
<span class='exclcmd'>\fi</span><br>
<br>
<br>
<span class='comment'>% ******************************** Front Matter ********************************</span><br>
<span class='envir'>\begin</span><span class='envir'>{document}</span><br>
<br>
<br>
<span class='cmd'>\frontmatter</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{titlepage}</span><br>
<br>
<span class='exclcmd'>\maketitle</span><br>
<br>
<span class='envir'>\end</span><span class='envir'>{titlepage}</span><br>
<br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Dedication/dedication</span><span class='ignore'>}</span><br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Declaration/declaration</span><span class='ignore'>}</span><br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Acknowledgement/acknowledgement</span><span class='ignore'>}</span><br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Abstract/abstract</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\wordcount</span><br>
<br>
<span class='comment'>% *********************** Adding TOC and List of Figures ***********************</span><br>
<br>
<span class='cmd'>\tableofcontents</span><br>
<br>
<span class='cmd'>\listoffigures</span><br>
<br>
<span class='comment'>%\listoftables</span><br>
<br>
<span class='comment'>% \printnomenclature[space] space can be set as 2.5cm between symbol and</span><br>
<span class='comment'>% description</span><br>
<span class='cmd'>\printnomencl</span><br>
<br>
<span class='comment'>% ******************************** Main Matter *********************************</span><br>
<span class='cmd'>\mainmatter</span><br>
<br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Chapter1/chapter1</span><span class='ignore'>}</span><br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Chapter2/chapter2</span><span class='ignore'>}</span><br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Chapter3/chapter3</span><span class='ignore'>}</span><br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Chapter4/chapter4</span><span class='ignore'>}</span><br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Chapter5/chapter5</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>% ********************************** Appendices ********************************</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{appendices}</span><span class='comment'>% Using appendices environment for more functunality</span><br>
<br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Chapter2/AppendixChapter2</span><span class='ignore'>}</span><br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Chapter3/AppendixChapter3</span><span class='ignore'>}</span><br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Chapter4/AppendixChapter4</span><span class='ignore'>}</span><br>
<span class='cmd'>\include</span><span class='ignore'>{</span><span class='fileinc'>Chapter5/AppendixChapter5</span><span class='ignore'>}</span><br>
<span class='comment'>%\include{Appendix1/appendix1}</span><br>
<span class='comment'>%\include{Appendix2/appendix2}</span><br>
<br>
<span class='envir'>\end</span><span class='envir'>{appendices}</span><br>
<br>
<span class='comment'>% ********************************** Back Matter *******************************</span><br>
<span class='comment'>% ********************************** Bibliography ******************************</span><br>
<span class='cmd'>\backmatter</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{spacing}</span><span class='ignore'>{</span><span class='word'>0.9</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>% Bibliography style previews: http://nodonn.tipido.net/bibstyle.php</span><br>
<br>
<span class='comment'>%\bibliographystyle{apalike}</span><br>
<span class='cmd'>\bibliographystyle</span><span class='ignore'>{</span><span class='ignore'>agsm</span><span class='ignore'>}</span> <span class='comment'>% use this to have URLs listed in References</span><br>
<br>
<span class='cmd'>\cleardoublepage</span><br>
<br>
<span class='cmd'>\bibliography</span><span class='ignore'>{</span><span class='ignore'>References</span><span class='ignore'>/</span><span class='ignore'>all</span><span class='ignore'>}</span> <span class='comment'>% Path to your References.bib file</span><br>
<span class='comment'>% \bibliography{References/Misc} % Path to your References.bib file</span><br>
<span class='comment'>% \bibliography{References/ColorSpace} % Path to your References.bib file</span><br>
<br>
<span class='envir'>\end</span><span class='envir'>{spacing}</span><br>
<br>
<span class='comment'>% *************************************** Index ********************************</span><br>
<span class='cmd'>\printthesisindex</span> <span class='comment'>% If index is present</span><br>
<br>
<span class='envir'>\end</span><span class='envir'>{document}</span><br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>File: thesis.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 1</li>
<li>Words in headers: 8</li>
<li>Words outside text (captions, etc.): 0</li>
<li>Number of headers: 1</li>
<li>Number of floats/tables/figures: 0</li>
<li>Number of math inlines: 0</li>
<li>Number of math displayed: 0</li>
</ul>
</div>
<h2>File: ./Preamble/preamble.tex</h2>
<div class='parse'><p>
<br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>etoolbox</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>rotating</span><span class='document'>}</span><br>
<br>
<br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>/</span><span class='specarg'>usr</span><span class='specarg'>/</span><span class='specarg'>local</span><span class='specarg'>/</span><span class='specarg'>texlive</span><span class='specarg'>/</span><span class='specarg'>texmf-local</span><span class='specarg'>/</span><span class='specarg'>picins</span><span class='specarg'>/</span><span class='specarg'>picins</span><span class='document'>}</span><br>
<br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>graphicx</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>algorithm</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>algpseudocode</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>needspace</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>multirow</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>afterpage</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>wrapfig</span><span class='document'>}</span><br>
<br>
<br>
<span class='comment'>% ******************************************************************************</span><br>
<span class='comment'>% ****************************** Custom Margin *********************************</span><br>
<span class='comment'>% Add `custommargin' in the document class options to use this section</span><br>
<span class='comment'>% Set {innerside margin / outerside margin / topmargin / bottom margin}&nbsp; and</span><br>
<span class='comment'>% other page dimensions</span><br>
<span class='cmd'>\ifsetMargin</span><br>
<span class='cmd'>\else</span><br>
&nbsp;&nbsp;<span class='document'>\RequirePackage</span><span class='optparm'>[</span><span class='ignore'>left</span><span class='ignore'>=</span><span class='ignore'>37mm</span><span class='ignore'>,</span><span class='ignore'>right</span><span class='ignore'>=</span><span class='ignore'>30mm</span><span class='ignore'>,</span><span class='ignore'>top</span><span class='ignore'>=</span><span class='ignore'>35mm</span><span class='ignore'>,</span><span class='ignore'>bottom</span><span class='ignore'>=</span><span class='ignore'>30mm</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='specarg'>geometry</span><span class='document'>}</span><br>
&nbsp;&nbsp;<span class='cmd'>\setFancyHdr</span> <span class='comment'>% To apply fancy header after geometry package is loaded</span><br>
<span class='cmd'>\fi</span><br>
<br>
<span class='comment'>% *****************************************************************************</span><br>
<span class='comment'>% ******************* Fonts (like different typewriter fonts etc.)*************</span><br>
<br>
<span class='comment'>% Add `customfont' in the document class option to use this section</span><br>
<span class='cmd'>\ifsetFont</span><br>
<span class='cmd'>\else</span><br>
&nbsp;&nbsp;<span class='comment'>% Set your custom font here and use `customfont' in options. Leave empty to</span><br>
&nbsp;&nbsp;<span class='comment'>% load computer modern font (default LaTeX font).&nbsp; </span><br>
&nbsp;&nbsp;<span class='document'>\RequirePackage</span><span class='ignore'>{</span><span class='specarg'>libertine</span><span class='document'>}</span> <br>
<span class='cmd'>\fi</span><br>
<br>
<span class='comment'>% *****************************************************************************</span><br>
<span class='comment'>% *************************** Bibliography&nbsp; and References ********************</span><br>
<br>
<span class='comment'>%\usepackage{cleveref} %Referencing without need to explicitly state fig /table</span><br>
<br>
<span class='comment'>% Add `custombib' in the document class option to use this section</span><br>
<span class='cmd'>\ifsetBib</span> <span class='comment'>% True, Bibliography option is chosen in class options</span><br>
<span class='cmd'>\else</span> <span class='comment'>% If custom bibliography style chosen then load bibstyle here</span><br>
&nbsp;&nbsp;<span class='document'>\RequirePackage</span><span class='optparm'>[</span><span class='ignore'>square</span><span class='ignore'>,</span> <span class='ignore'>sort</span><span class='ignore'>,</span> <span class='ignore'>numbers</span><span class='ignore'>,</span> <span class='ignore'>authoryear</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='specarg'>natbib</span><span class='document'>}</span> <span class='comment'>% CustomBib</span><br>
<span class='cmd'>\fi</span><br>
<br>
<span class='comment'>% changes the default name `Bibliography` -&gt; `References'</span><br>
<span class='cmd'>\renewcommand</span><span class='ignore'>{</span><span class='ignore'>\bibname</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>References</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>% *****************************************************************************</span><br>
<span class='comment'>% *************** Changing the Visual Style of Chapter Headings ***************</span><br>
<span class='comment'>% Uncomment the section below. Requires titlesec package.</span><br>
<br>
<span class='comment'>%\RequirePackage{titlesec}</span><br>
<span class='comment'>%\newcommand{\PreContentTitleFormat}{\titleformat{\chapter}[display]{\scshape\Large}</span><br>
<span class='comment'>%{\Large\filleft{\chaptertitlename} \Huge\thechapter}</span><br>
<span class='comment'>%{1ex}{}</span><br>
<span class='comment'>%[\vspace{1ex}\titlerule]}</span><br>
<span class='comment'>%\newcommand{\ContentTitleFormat}{\titleformat{\chapter}[display]{\scshape\huge}</span><br>
<span class='comment'>%{\Large\filleft{\chaptertitlename} \Huge\thechapter}{1ex}</span><br>
<span class='comment'>%{\titlerule\vspace{1ex}\filright}</span><br>
<span class='comment'>%[\vspace{1ex}\titlerule]}</span><br>
<span class='comment'>%\newcommand{\PostContentTitleFormat}{\PreContentTitleFormat}</span><br>
<span class='comment'>%\PreContentTitleFormat</span><br>
<br>
<br>
<span class='comment'>% *****************************************************************************</span><br>
<span class='comment'>% **************************** Custom Packages ********************************</span><br>
<span class='comment'>% *****************************************************************************</span><br>
<br>
<br>
<span class='comment'>% ************************* Algorithms and Pseudocode **************************</span><br>
<br>
<span class='comment'>%\usepackage{algpseudocode} </span><br>
<br>
<br>
<span class='comment'>% ********************Captions and Hyperreferencing / URL **********************</span><br>
<br>
<span class='comment'>% Captions: This makes captions of figures use a boldfaced small font. </span><br>
<span class='comment'>%\RequirePackage[small,bf]{caption}</span><br>
<br>
<span class='document'>\RequirePackage</span><span class='optparm'>[</span><span class='ignore'>labelsep</span><span class='ignore'>=</span><span class='ignore'>space</span><span class='ignore'>,</span><span class='ignore'>tableposition</span><span class='ignore'>=</span><span class='ignore'>top</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='specarg'>caption</span><span class='document'>}</span> <br>
<span class='cmd'>\renewcommand</span><span class='ignore'>{</span><span class='ignore'>\figurename</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Fig</span><span class='ignore'>.</span><span class='ignore'>}</span> <span class='comment'>%to support older versions of captions.sty</span><br>
<br>
<br>
<span class='comment'>% ************************ Formatting / Footnote *******************************</span><br>
<br>
<span class='comment'>%\usepackage[perpage]{footmisc} %Range of footnote options </span><br>
<br>
<br>
<span class='comment'>% ****************************** Line Numbers **********************************</span><br>
<br>
<span class='comment'>%\RequirePackage{lineno}</span><br>
<span class='comment'>%\linenumbers</span><br>
<br>
<span class='comment'>% ************************** Graphics and figures *****************************</span><br>
<span class='document'>\usepackage</span><span class='optparm'>[</span><span class='ignore'>help</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='specarg'>epspdfconversion</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>epstopdf</span><span class='document'>}</span><br>
<span class='comment'>%\usepackage{rotating}</span><br>
<span class='comment'>%\usepackage{wrapfig}</span><br>
<span class='comment'>%\usepackage{float}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>subfig</span><span class='document'>}</span> <span class='comment'>%note: subfig must be included after the `caption` package. </span><br>
<br>
<span class='comment'>% ********************************* Table **************************************</span><br>
<br>
<span class='comment'>%\usepackage{longtable}</span><br>
<span class='comment'>%\usepackage{multicol}</span><br>
<span class='comment'>%\usepackage{multirow}</span><br>
<span class='comment'>%\usepackage{tabularx}</span><br>
<br>
<br>
<span class='comment'>% ***************************** Math and SI Units ******************************</span><br>
<br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>amsfonts</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>amsmath</span><span class='document'>}</span><br>
<span class='document'>\usepackage</span><span class='ignore'>{</span><span class='specarg'>amssymb</span><span class='document'>}</span><br>
<span class='comment'>%\usepackage{siunitx} % use this package module for SI units</span><br>
<br>
<br>
<span class='comment'>% ******************************************************************************</span><br>
<span class='comment'>% ************************* User Defined Commands ******************************</span><br>
<span class='comment'>% ******************************************************************************</span><br>
<br>
<br>
<span class='comment'>% ********************** TOC depth and numbering depth *************************</span><br>
<span class='comment'>% ******** We need subsubsubsections *********</span><br>
<span class='cmd'>\setcounter</span><span class='ignore'>{</span><span class='ignore'>secnumdepth</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>4</span><span class='ignore'>}</span><br>
<span class='cmd'>\setcounter</span><span class='ignore'>{</span><span class='ignore'>tocdepth</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>% ******************************* Nomenclature *********************************</span><br>
<br>
<span class='comment'>% To change the name of the Nomenclature section, uncomment the following line</span><br>
<br>
<span class='comment'>%\renewcommand\nomname{Symbols}</span><br>
<br>
<br>
<span class='comment'>% ********************************* Appendix ***********************************</span><br>
<br>
<span class='comment'>% The default value of both \appendixtocname and \appendixpagename is `Appendices'. These names can all be changed via: </span><br>
<br>
<span class='comment'>%\renewcommand{\appendixtocname}{List of appendices}</span><br>
<br>
<span class='comment'>%\renewcommand{\appendixname}{Appndx}</span><br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Preamble/preamble.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 0</li>
<li>Words in headers: 0</li>
<li>Words outside text (captions, etc.): 0</li>
<li>Number of headers: 0</li>
<li>Number of floats/tables/figures: 0</li>
<li>Number of math inlines: 0</li>
<li>Number of math displayed: 0</li>
</ul>
</div>
<h2>File: ./Dedication/dedication.tex</h2>
<div class='parse'><p>
<span class='comment'>% ******************************* Thesis Dedidcation ********************************</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{dedication}</span><br>
<br>
<span class='word'>I</span> <span class='word'>would</span> <span class='word'>like</span> <span class='word'>to</span> <span class='word'>dedicate</span> <span class='word'>this</span> <span class='word'>thesis</span> <span class='word'>to</span> <span class='word'>my</span> <span class='word'>little</span> <span class='word'>one</span><span class='ignore'>.</span> <span class='word'>Let's</span> <span class='word'>never</span> <span class='word'>part</span> <span class='word'>again</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\end</span><span class='envir'>{dedication}</span><br>
<br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Dedication/dedication.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 15</li>
<li>Words in headers: 0</li>
<li>Words outside text (captions, etc.): 0</li>
<li>Number of headers: 0</li>
<li>Number of floats/tables/figures: 0</li>
<li>Number of math inlines: 0</li>
<li>Number of math displayed: 0</li>
</ul>
</div>
<h2>File: ./Declaration/declaration.tex</h2>
<div class='parse'><p>
<span class='comment'>% ******************************* Thesis Declaration ********************************</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{declaration}</span><br>
<br>
<span class='word'>I</span> <span class='word'>hereby</span> <span class='word'>declare</span> <span class='word'>that</span> <span class='word'>except</span> <span class='word'>where</span> <span class='word'>specific</span> <span class='word'>reference</span> <span class='word'>is</span> <span class='word'>made</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>work</span> <span class='word'>of</span> <span class='word'>others</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>contents</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>dissertation</span> <span class='word'>are</span> <span class='word'>original</span> <span class='word'>and</span> <span class='word'>have</span> <span class='word'>not</span> <span class='word'>been</span> <span class='word'>submitted</span> <span class='word'>in</span> <span class='word'>whole</span> <span class='word'>or</span> <span class='word'>in</span> <span class='word'>part</span> <span class='word'>for</span> <span class='word'>consideration</span> <span class='word'>for</span> <span class='word'>any</span> <span class='word'>other</span> <span class='word'>degree</span> <span class='word'>or</span> <span class='word'>qualification</span> <span class='word'>in</span> <span class='word'>this</span><span class='ignore'>,</span> <span class='word'>or</span> <span class='word'>any</span> <span class='word'>other</span> <span class='word'>University</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>dissertation</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>result</span> <span class='word'>of</span> <span class='word'>my</span> <span class='word'>own</span> <span class='word'>work</span> <span class='word'>and</span> <span class='word'>includes</span> <span class='word'>nothing</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>outcome</span> <span class='word'>of</span> <span class='word'>work</span> <span class='word'>done</span> <span class='word'>in</span> <span class='word'>collaboration</span><span class='ignore'>,</span> <span class='word'>except</span> <span class='word'>where</span> <span class='word'>specifically</span> <span class='word'>indicated</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>text</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>dissertation</span> <span class='word'>contains</span> <span class='word'>less</span> <span class='word'>than</span> <span class='word'>15</span><span class='ignore'>,</span><span class='word'>000</span> <span class='word'>words</span> <span class='word'>exclusive</span> <span class='word'>of</span> <span class='word'>footnotes</span><span class='ignore'>,</span> <span class='word'>appendices</span> <span class='word'>and</span> <span class='word'>bibliography</span><span class='ignore'>.</span><br>
<br>
<span class='comment'>% Author and date will be inserted automatically from thesis.tex \author \degreedate</span><br>
<br>
<span class='envir'>\end</span><span class='envir'>{declaration}</span><br>
<br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Declaration/declaration.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 88</li>
<li>Words in headers: 0</li>
<li>Words outside text (captions, etc.): 0</li>
<li>Number of headers: 0</li>
<li>Number of floats/tables/figures: 0</li>
<li>Number of math inlines: 0</li>
<li>Number of math displayed: 0</li>
</ul>
</div>
<h2>File: ./Acknowledgement/acknowledgement.tex</h2>
<div class='parse'><p>
<span class='comment'>% ************************** Thesis Acknowledgements *****************************</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{acknowledgements}</span><br>
<br>
<br>
<span class='word'>I</span> <span class='word'>would</span> <span class='word'>like</span> <span class='word'>to</span> <span class='word'>express</span> <span class='word'>my</span> <span class='word'>deepest</span> <span class='word'>gratitude</span> <span class='word'>to</span> <span class='word'>my</span> <span class='word'>supervisor</span><span class='ignore'>,</span> <span class='word'>Prof</span><span class='ignore'>.</span> <span class='word'>Roberto</span> <span class='word'>Cipolla</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>my</span> <span class='word'>advisor</span><span class='ignore'>,</span> <span class='word'>Dr</span><span class='ignore'>.</span> <span class='word'>Joan</span> <span class='word'>Lasenby</span><span class='ignore'>,</span> <span class='word'>for</span> <span class='word'>their</span> <span class='word'>guidance</span> <span class='word'>over</span> <span class='word'>the</span> <span class='word'>past</span> <span class='word'>two</span> <span class='word'>years</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>well</span> <span class='word'>as</span> <span class='word'>their</span> <span class='word'>patience</span> <span class='word'>and</span> <span class='word'>understanding</span> <span class='word'>as</span> <span class='word'>I</span> <span class='word'>was</span> <span class='word'>learning</span> <span class='word'>the</span> <span class='word'>metaphorical</span> <span class='word'>computer</span> <span class='word'>vision</span> <span class='word'>ropes</span><span class='ignore'>.</span><br>
<span class='word'>I</span> <span class='word'>would</span> <span class='word'>also</span> <span class='word'>like</span> <span class='word'>to</span> <span class='word'>acknowledge</span> <span class='word'>my</span> <span class='word'>colleague</span> <span class='word'>and</span> <span class='word'>friend</span> <span class='word'>Dr</span><span class='ignore'>.</span> <span class='word'>Vijay</span> <span class='word'>Badrinarayanan</span><span class='ignore'>,</span> <span class='word'>who</span> <span class='word'>was</span> <span class='word'>always</span> <span class='word'>around</span> <span class='word'>to</span> <span class='word'>offer</span> <span class='word'>advice</span><span class='ignore'>,</span> <span class='word'>suggestions</span> <span class='word'>or</span> <span class='word'>simply</span> <span class='word'>a</span> <span class='word'>kind</span> <span class='word'>word</span> <span class='word'>whenever</span> <span class='word'>I</span> <span class='word'>was</span> <span class='word'>working</span> <span class='word'>too</span> <span class='word'>hard</span><span class='ignore'>.</span><br>
<span class='word'>Most</span> <span class='word'>importantly</span><span class='ignore'>,</span> <span class='word'>I</span> <span class='word'>would</span> <span class='word'>like</span> <span class='word'>to</span> <span class='word'>thank</span> <span class='word'>my</span> <span class='word'>wonderful</span> <span class='word'>family</span> <span class='word'>and</span> <span class='word'>friends</span> <span class='word'>in</span> <span class='word'>Saudi</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>states</span> <span class='word'>and</span> <span class='word'>elsewhere</span> <span class='word'>who</span> <span class='word'>supported</span> <span class='word'>me</span> <span class='word'>through</span> <span class='word'>the</span> <span class='word'>most</span> <span class='word'>difficult</span> <span class='word'>period</span> <span class='word'>of</span> <span class='word'>my</span> <span class='word'>life</span><span class='ignore'>.</span><br>
<br>
<br>
<br>
<span class='envir'>\end</span><span class='envir'>{acknowledgements}</span><br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Acknowledgement/acknowledgement.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 105</li>
<li>Words in headers: 0</li>
<li>Words outside text (captions, etc.): 0</li>
<li>Number of headers: 0</li>
<li>Number of floats/tables/figures: 0</li>
<li>Number of math inlines: 0</li>
<li>Number of math displayed: 0</li>
</ul>
</div>
<h2>File: ./Abstract/abstract.tex</h2>
<div class='parse'><p>
<span class='comment'>% ************************** Thesis Abstract *****************************</span><br>
<span class='comment'>% Use `abstract' as an option in the document class to print only the titlepage and the abstract.</span><br>
<span class='envir'>\begin</span><span class='envir'>{abstract}</span><br>
<span class='word'>Human</span> <span class='word'>skin</span> <span class='word'>and</span> <span class='word'>feature</span> <span class='word'>detection</span> <span class='word'>are</span> <span class='word'>common</span> <span class='word'>and</span> <span class='word'>widespread</span> <span class='word'>applications</span> <span class='word'>in</span> <span class='word'>computer</span> <span class='word'>vision</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>many</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithms</span> <span class='word'>used</span> <span class='word'>by</span> <span class='word'>such</span> <span class='word'>applications</span> <span class='word'>are</span> <span class='word'>very</span> <span class='word'>resource-intensive</span> <span class='word'>and</span> <span class='word'>require</span> <span class='word'>powerful</span> <span class='word'>machines</span> <span class='word'>to</span> <span class='word'>run</span> <span class='word'>them</span> <span class='word'>with</span> <span class='word'>any</span> <span class='word'>reasonable</span> <span class='word'>level</span> <span class='word'>of</span> <span class='word'>performance</span><span class='ignore'>,</span> <span class='word'>if</span> <span class='word'>at</span> <span class='word'>all</span><span class='ignore'>.</span> <span class='word'>Furthermore</span><span class='ignore'>,</span> <span class='word'>these</span> <span class='word'>algorithms</span> <span class='word'>tend</span> <span class='word'>to</span> <span class='word'>focus</span> <span class='word'>on</span> <span class='word'>detection</span> <span class='word'>as</span> <span class='word'>opposed</span> <span class='word'>to</span> <span class='word'>retention</span> <span class='word'>of</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>purpose</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>project</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>design</span> <span class='word'>and</span> <span class='word'>implement</span> <span class='word'>a</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>algorithm</span> <span class='word'>which</span> <span class='word'>not</span> <span class='word'>only</span> <span class='word'>quickly</span> <span class='word'>and</span> <span class='word'>accurately</span> <span class='word'>detects</span> <span class='word'>chromatic</span> <span class='word'>skin</span> <span class='word'>and</span> <span class='word'>related</span> <span class='word'>features</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>is</span> <span class='word'>also</span> <span class='word'>efficient</span> <span class='word'>enough</span> <span class='word'>to</span> <span class='word'>run</span> <span class='word'>on</span> <span class='word'>CCD</span> <span class='word'>camera-equipped</span> <span class='word'>mobile</span> <span class='word'>devices</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>chapter</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>examine</span> <span class='word'>techniques</span> <span class='word'>and</span> <span class='word'>color</span> <span class='word'>spaces</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>typical</span> <span class='word'>skin</span> <span class='word'>detection</span> <span class='word'>algorithms</span><span class='ignore'>,</span> <span class='word'>exploring</span> <span class='word'>the</span> <span class='word'>benefits</span> <span class='word'>and</span> <span class='word'>costs</span> <span class='word'>of</span> <span class='word'>each</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>well</span> <span class='word'>as</span> <span class='word'>physiological</span> <span class='word'>considerations</span> <span class='word'>and</span> <span class='word'>how</span> <span class='word'>CCD</span> <span class='word'>devices</span> <span class='word'>capture</span> <span class='word'>color</span> <span class='word'>information</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>make</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>bespoke</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>transform</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>second</span> <span class='word'>chapter</span> <span class='word'>describes</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>exhaustive</span> <span class='word'>detail</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>design</span> <span class='word'>and</span> <span class='word'>construction</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>bespoke</span> <span class='word'>color</span> <span class='word'>space</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>stores</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>and</span> <span class='word'>luminosity</span> <span class='word'>information</span> <span class='word'>separately</span><span class='ignore'>;</span> <span class='word'>retains</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>targeted</span> <span class='word'>way</span><span class='ignore'>,</span> <span class='word'>discarding</span> <span class='word'>irrelevant</span> <span class='word'>data</span> <span class='word'>based</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>statistical</span> <span class='word'>skin</span> <span class='word'>model</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='word'>performs</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>transform</span> <span class='word'>using</span> <span class='word'>integer</span> <span class='word'>types</span><span class='ignore'>,</span> <span class='word'>thereby</span> <span class='word'>eliminating</span> <span class='word'>the</span> <span class='word'>need</span> <span class='word'>for</span> <span class='word'>costly</span> <span class='word'>floating-point</span> <span class='word'>operations</span><span class='ignore'>.</span> <span class='word'>Chapter</span> <span class='word'>three</span> <span class='word'>outlines</span> <span class='word'>the</span> <span class='word'>method</span> <span class='word'>of</span> <span class='word'>gathering</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>skin</span> <span class='word'>statistics</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>build</span> <span class='word'>the</span> <span class='word'>bespoke</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>described</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>chapter</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>expressed</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>2D</span> <span class='word'>Gaussian</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>plane</span><span class='ignore'>,</span> <span class='word'>obtained</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>two</span> <span class='word'>1D</span> <span class='word'>Gaussians</span><span class='ignore'>,</span> <span class='word'>thereby</span> <span class='word'>further</span> <span class='word'>reducing</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>processing</span> <span class='word'>cost</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>fourth</span> <span class='word'>chapter</span> <span class='word'>describes</span> <span class='word'>the</span> <span class='word'>practical</span> <span class='word'>application</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>bespoke</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>based</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>theoretical</span> <span class='word'>designs</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>previous</span> <span class='word'>two</span> <span class='word'>chapters</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>project</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>mechanical</span> <span class='word'>fingertip-stress</span> <span class='word'>detector</span> <span class='word'>built</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>OpenCV</span> <span class='word'>computer</span> <span class='word'>vision</span> <span class='word'>library</span> <span class='word'>in</span> <span class='word'>C</span><span class='ignore'>+</span><span class='ignore'>+</span> <span class='word'>and</span> <span class='word'>running</span> <span class='word'>on</span> <span class='word'>an</span> <span class='word'>Apple</span> <span class='word'>iPhone</span> <span class='word'>6</span> <span class='word'>Plus</span> <span class='word'>with</span> <span class='word'>iOS</span> <span class='word'>version</span> <span class='word'>10.3.3</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>the</span> <span class='word'>fifth</span> <span class='word'>chapter</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>evaluate</span> <span class='word'>the</span> <span class='word'>results</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>application</span> <span class='word'>by</span> <span class='word'>comparing</span> <span class='word'>it</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>more</span> <span class='word'>typical</span> <span class='word'>floating-point</span> <span class='word'>implementation</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>shows</span> <span class='word'>a</span> <span class='word'>significant</span> <span class='word'>four-to-fivefold</span> <span class='word'>improvement</span> <span class='word'>over</span> <span class='word'>the</span> <span class='word'>standard</span> <span class='word'>approach</span><span class='ignore'>.</span><br>
<span class='envir'>\end</span><span class='envir'>{abstract}</span><br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Abstract/abstract.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 334</li>
<li>Words in headers: 1</li>
<li>Words outside text (captions, etc.): 0</li>
<li>Number of headers: 1</li>
<li>Number of floats/tables/figures: 0</li>
<li>Number of math inlines: 0</li>
<li>Number of math displayed: 0</li>
</ul>
</div>
<h2>File: ./Chapter1/chapter1.tex</h2>
<div class='parse'><p>
<span class='comment'>%*****************************************************************************************</span><br>
<span class='comment'>%*********************************** First Chapter ***************************************</span><br>
<span class='comment'>%*****************************************************************************************</span><br>
<br>
<span class='cmd'>\chapter</span><span class='ignore'>{</span><span class='hword'>Motivation</span><span class='ignore'>}</span>  <span class='comment'>%Title of the First Chapter</span><br>
<br>
<span class='cmd'>\epstopdfsetup</span><span class='ignore'>{</span><span class='word'>outdir</span><span class='ignore'>=</span><span class='word'>Chapter1</span><span class='ignore'>/</span><span class='word'>Figs</span><span class='ignore'>/</span><span class='word'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><br>
<span class='cmd'>\ifpdf</span><br>
&nbsp;&nbsp;<span class='cmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Raster</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\else</span><br>
&nbsp;&nbsp;<span class='cmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Vector</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\fi</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Introduction</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>Introduction</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>purpose</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>project</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>create</span> <span class='word'>a</span> <span class='word'>chromatic</span> <span class='word'>skin</span> <span class='word'>and</span> <span class='word'>feature</span> <span class='word'>detector</span> <span class='word'>for</span> <span class='word'>application</span> <span class='word'>in</span> <span class='word'>mobile</span> <span class='word'>devices</span><span class='ignore'>.</span> <span class='word'>Using</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>device's</span> <span class='word'>built-in</span> <span class='word'>CCD</span> <span class='word'>camera</span><span class='ignore'>,</span> <span class='word'>objects</span> <span class='word'>with</span> <span class='word'>characteristics</span> <span class='word'>matching</span> <span class='word'>those</span> <span class='word'>of</span> <span class='word'>human</span> <span class='word'>skin</span> <span class='word'>are</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>identified</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>presents</span> <span class='word'>a</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>challenges</span><span class='ignore'>.</span> <span class='word'>Since</span> <span class='word'>we</span> <span class='word'>are</span> <span class='word'>trying</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span> <span class='word'>of</span> <span class='word'>human</span> <span class='word'>skin</span> <span class='word'>to</span> <span class='word'>distinguish</span> <span class='word'>objects</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>scene</span><span class='ignore'>,</span> <span class='word'>working</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>chromatic-space</span> <span class='word'>helps</span> <span class='word'>to</span> <span class='word'>simplify</span> <span class='word'>this</span> <span class='word'>problem</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='word'>chromatic-space</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>color-space</span> <span class='word'>wherein</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>laid</span> <span class='word'>out</span> <span class='word'>in</span> <span class='word'>as</span> <span class='word'>few</span> <span class='word'>dimensions</span> <span class='word'>as</span> <span class='word'>possible</span><span class='ignore'>,</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>separate</span> <span class='word'>dimension</span> <span class='word'>for</span> <span class='word'>luminosity</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>the</span> <span class='word'>brightness</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>Fundamentally</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>issue</span> <span class='word'>with</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>CCD</span> <span class='word'>cameras</span> <span class='word'>capture</span> <span class='word'>information</span> <span class='word'>using</span> <span class='word'>RGB</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>mixes</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>luminosity</span><span class='ignore'>.</span> <span class='word'>Before</span> <span class='word'>us</span> <span class='word'>are</span> <span class='word'>three</span> <span class='word'>challenges</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{itemize}</span><br>
<span class='cmd'>\item</span> <span class='word'>Separate</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>luminosity</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>Develop</span> <span class='word'>a</span> <span class='word'>statistical</span> <span class='word'>chromatic</span> <span class='word'>model</span> <span class='word'>for</span> <span class='word'>skin</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>Develop</span> <span class='word'>an</span> <span class='word'>efficient</span> <span class='word'>algorithm</span> <span class='word'>to</span> <span class='word'>perform</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>space</span> <span class='word'>transformation</span> <span class='word'>applying</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>model</span><span class='ignore'>,</span> <span class='word'>preserving</span> <span class='word'>all</span> <span class='word'>relevant</span> <span class='word'>information</span><span class='ignore'>.</span><br>
<span class='envir'>\end</span><span class='envir'>{itemize}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%Separating this information is the first part of the challenge.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%The second part of the challenge is, because we are searching for objects which exhibit certain chromatic characteristics, a statistical model must be developed and applied in order to characterize the objects as such.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%The third and final challenge is developing efficient, discrete maths to perform the chromatic-space rotation and to apply the statistical model efficiently enough such that all the chromatic information about the target object is retained, whilst all irrelevant information is discarded.</span><br>
<br>
<span class='word'>While</span> <span class='word'>several</span> <span class='word'>people</span> <span class='word'>have</span> <span class='word'>developed</span> <span class='word'>algorithms</span> <span class='word'>for</span> <span class='word'>skin</span> <span class='word'>detection</span><span class='ignore'>,</span> <span class='word'>their</span> <span class='word'>focus</span> <span class='word'>has</span> <span class='word'>been</span> <span class='word'>squarely</span> <span class='word'>on</span> <span class='word'>detection</span> <span class='word'>rather</span> <span class='word'>than</span> <span class='word'>retention</span> <span class='word'>of</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>color-spaces</span><span class='ignore'>,</span> <span class='word'>Hue-based</span> <span class='word'>spaces</span><span class='ignore'>,</span> <span class='word'>such</span> <span class='word'>as</span> <span class='word'>HSV</span><span class='ignore'>,</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>used</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>clear</span> <span class='word'>separation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span> <span class='word'>and</span> <span class='word'>luminosity</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Zarit1999a</span><span class='ignore'>,</span><span class='ignore'>Sigal2000a</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>Simpler</span> <span class='word'>color-spaces</span><span class='ignore'>,</span> <span class='word'>such</span> <span class='word'>as</span> <span class='word'>Normalized</span> <span class='word'>RGB</span><span class='ignore'>,</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>video</span> <span class='word'>applications</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>demand</span> <span class='word'>of</span> <span class='word'>continuously</span> <span class='word'>processing</span> <span class='word'>image</span> <span class='word'>frames</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Soriano2000a</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>As</span> <span class='word'>for</span> <span class='word'>gathering</span> <span class='word'>statistics</span><span class='ignore'>,</span> <span class='word'>histogram</span> <span class='word'>thresholding</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Soriano2000a</span><span class='ignore'>,</span><span class='ignore'>Sigal2000a</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>and</span> <span class='word'>Gaussian</span> <span class='word'>models</span> <span class='word'>using</span> <span class='word'>2D</span> <span class='word'>Gaussians</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Terrillon1999a</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>3D</span> <span class='word'>Gaussians</span> <span class='word'>or</span> <span class='word'>multiple</span> <span class='word'>Gaussian</span> <span class='word'>clusters</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Vezhnevets2003</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>are</span> <span class='word'>among</span> <span class='word'>the</span> <span class='word'>most</span> <span class='word'>common</span> <span class='word'>models</span> <span class='word'>in</span> <span class='word'>practice</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Shin2002a</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>though</span> <span class='word'>other</span> <span class='word'>models</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>similar</span> <span class='word'>effect</span><span class='ignore'>,</span> <span class='word'>such</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>Self-Organizing</span> <span class='word'>Map</span> <span class='ignore'>(</span><span class='word'>SOM</span><span class='ignore'>)</span> <span class='word'>in</span> <span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Brown2001a</span><span class='ignore'>}</span><span class='ignore'>'</span><span class='word'>s</span> <span class='word'>application</span><span class='ignore'>.</span> <span class='word'>Additionally</span><span class='ignore'>,</span> <span class='word'>practically</span> <span class='word'>every</span> <span class='word'>application</span> <span class='word'>uses</span> <span class='word'>double</span> <span class='word'>precision</span> <span class='word'>numbers</span> <span class='word'>in</span> <span class='word'>their</span> <span class='word'>transformations</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Shin2002a</span><span class='ignore'>,</span><span class='ignore'>Vezhnevets2003</span><span class='ignore'>,</span><span class='ignore'>Terrillon1999a</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Regardless</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>color-spaces</span> <span class='word'>and</span> <span class='word'>statistical</span> <span class='word'>models</span> <span class='word'>used</span><span class='ignore'>,</span> <span class='word'>all</span> <span class='word'>of</span> <span class='word'>these</span> <span class='word'>algorithms</span> <span class='word'>have</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>fundamental</span> <span class='word'>approach</span><span class='ignore'>:</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>is</span> <span class='word'>transformed</span> <span class='word'>into</span> <span class='word'>some</span> <span class='word'>color-space</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>statistical</span> <span class='word'>model</span> <span class='word'>is</span> <span class='word'>applied</span><span class='ignore'>,</span> <span class='word'>resulting</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>binary</span> <span class='word'>image</span> <span class='word'>which</span> <span class='word'>classifies</span> <span class='word'>whether</span> <span class='word'>any</span> <span class='word'>given</span> <span class='word'>pixel</span> <span class='word'>is</span> <span class='word'>skin</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>then</span> <span class='word'>used</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>mask</span> <span class='word'>and</span> <span class='word'>applied</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>original</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>algorithms</span> <span class='word'>are</span> <span class='word'>fundamentally</span> <span class='word'>different</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>one</span> <span class='word'>used</span> <span class='word'>for</span> <span class='word'>this</span> <span class='word'>project</span> <span class='word'>in</span> <span class='word'>that</span> <span class='word'>preservation</span> <span class='word'>information</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>primary</span> <span class='word'>goal</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>process</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>into</span> <span class='word'>a</span> <span class='word'>new</span> <span class='word'>chromatic-space</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>apply</span> <span class='word'>the</span> <span class='word'>statistical</span> <span class='word'>model</span><span class='ignore'>,</span> <span class='word'>resulting</span> <span class='word'>in</span> <span class='word'>an</span> <span class='word'>image</span> <span class='word'>which</span> <span class='word'>contains</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>and</span> <span class='word'>luminosity</span> <span class='word'>information</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='word'>losing</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>about</span> <span class='word'>non-skin</span> <span class='word'>areas</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>We</span> <span class='word'>are</span> <span class='word'>preserving</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>targeted</span> <span class='word'>way</span><span class='ignore'>,</span> <span class='word'>reducing</span> <span class='word'>the</span> <span class='word'>overall</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>whilst</span> <span class='word'>preserving</span> <span class='word'>the</span> <span class='word'>relevant</span> <span class='word'>information</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>object</span> <span class='word'>we're</span> <span class='word'>interested</span> <span class='word'>in</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>clear</span> <span class='word'>difference</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>more</span> <span class='word'>common</span> <span class='word'>binary</span> <span class='word'>categorization</span> <span class='word'>approach</span><span class='ignore'>,</span> <span class='word'>though</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>possible</span> <span class='word'>to</span> <span class='word'>adapt</span> <span class='word'>our</span> <span class='word'>approach</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>process</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>it</span> <span class='word'>stands</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>entire</span> <span class='word'>process</span> <span class='word'>is</span> <span class='word'>more</span> <span class='word'>efficient</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>step</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>binary</span> <span class='word'>classifier</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>faster</span> <span class='word'>than</span> <span class='word'>moving</span> <span class='word'>to</span> <span class='word'>an</span> <span class='word'>HSV</span> <span class='ignore'>(</span><span class='word'>Hue</span><span class='ignore'>,</span> <span class='word'>Saturation</span> <span class='word'>and</span> <span class='word'>Value</span><span class='ignore'>)</span> <span class='word'>image</span> <span class='word'>using</span> <span class='word'>standard</span> <span class='word'>library</span> <span class='word'>routines</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Choosing</span> <span class='hword'>a</span> <span class='hword'>Color</span> <span class='hword'>Space</span><span class='ignore'>}</span><br>
<br>
<span class='word'>One</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>challenges</span> <span class='word'>facing</span> <span class='word'>this</span> <span class='word'>project</span> <span class='word'>is</span> <span class='word'>identifying</span> <span class='word'>a</span> <span class='word'>color-space</span> <span class='word'>in</span> <span class='word'>which</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>information</span> <span class='word'>and</span> <span class='word'>luminosity</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>separated</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>most</span> <span class='word'>widely-used</span> <span class='word'>color-spaces</span> <span class='word'>in</span> <span class='word'>practical</span> <span class='word'>applications</span> <span class='word'>of</span> <span class='word'>skin</span> <span class='word'>color</span> <span class='word'>classification</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>evaluated</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>HSV</span><span class='ignore'>,</span> <span class='word'>LAB</span> <span class='word'>and</span> <span class='word'>YCbCr</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>all</span> <span class='word'>of</span> <span class='word'>which</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>readily-available</span> <span class='word'>implementations</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Vezhnevets2003</span><span class='ignore'>,</span><span class='ignore'>Zarit1999a</span><span class='ignore'>,</span><span class='ignore'>Yang1997a</span><span class='ignore'>,</span><span class='ignore'>Brand2000a</span><span class='ignore'>,</span><span class='ignore'>Sigal2000a</span><span class='ignore'>,</span><span class='ignore'>Chai2000a</span><span class='ignore'>,</span><span class='ignore'>Phung2002a</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Unlike</span> <span class='word'>RGB</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>HSV</span> <span class='word'>color-space</span> <span class='word'>makes</span> <span class='word'>a</span> <span class='word'>clear</span> <span class='word'>distinction</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>chrominance</span> <span class='ignore'>(</span><span class='word'>the</span> <span class='ignore'>"</span><span class='word'>Hue</span><span class='ignore'>"</span> <span class='word'>and</span> <span class='ignore'>"</span><span class='word'>Saturation</span><span class='ignore'>"</span> <span class='word'>channels</span><span class='ignore'>)</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>luminance</span> <span class='ignore'>(</span><span class='word'>the</span> <span class='ignore'>"</span><span class='word'>Value</span><span class='ignore'>"</span> <span class='word'>channel</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>storing</span> <span class='word'>them</span> <span class='word'>separately</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Vezhnevets2003</span><span class='ignore'>,</span><span class='ignore'>Sigal2000a</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>Hue</span> <span class='word'>channel</span> <span class='word'>is</span> <span class='word'>expressed</span> <span class='word'>in</span> <span class='word'>polar</span> <span class='word'>coordinates</span><span class='ignore'>,</span> <span class='word'>thereby</span> <span class='word'>necessitating</span> <span class='word'>a</span> <span class='word'>coordinate</span> <span class='word'>transform</span> <span class='word'>when</span> <span class='word'>converting</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>raw</span> <span class='word'>image</span> <span class='word'>data</span><span class='ignore'>.</span> <span class='word'>Given</span> <span class='word'>the</span> <span class='word'>nature</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>outlined</span> <span class='word'>herein</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>computational</span> <span class='word'>cost</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>transformation</span> <span class='word'>is</span> <span class='word'>undesirable</span><span class='ignore'>.</span><br>
<br>
<span class='word'>LAB</span> <span class='word'>and</span> <span class='word'>YCbCr</span><span class='ignore'>,</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>other</span> <span class='word'>hand</span><span class='ignore'>,</span> <span class='word'>explicitly</span> <span class='word'>separate</span> <span class='word'>the</span> <span class='word'>chrominance</span> <span class='word'>and</span> <span class='word'>luminance</span> <span class='word'>without</span> <span class='word'>an</span> <span class='word'>accompanying</span> <span class='word'>polar</span> <span class='word'>coordinate</span> <span class='word'>transform</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Vezhnevets2003</span><span class='ignore'>,</span><span class='ignore'>Poynton1997</span><span class='ignore'>,</span><span class='ignore'>Phung2002a</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>LAB</span> <span class='word'>and</span> <span class='word'>YCbCr</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>matrix</span> <span class='word'>transform</span> <span class='word'>to</span> <span class='word'>convert</span> <span class='word'>from</span> <span class='word'>RGB</span><span class='ignore'>,</span> <span class='word'>allowing</span> <span class='word'>for</span> <span class='word'>simple</span> <span class='word'>and</span> <span class='word'>quick</span> <span class='word'>conversion</span> <span class='word'>exploiting</span> <span class='word'>optimized</span> <span class='word'>matrix</span> <span class='word'>multiplication</span> <span class='word'>routines</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>while</span> <span class='word'>they</span> <span class='word'>appear</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>perfectly</span> <span class='word'>suited</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>purposes</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>project</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>issues</span> <span class='word'>arise</span> <span class='word'>when</span> <span class='word'>represented</span> <span class='word'>discretely</span><span class='ignore'>.</span> <span class='word'>LAB</span><span class='ignore'>,</span> <span class='word'>YCbCr</span> <span class='word'>and</span> <span class='word'>other</span> <span class='word'>such</span> <span class='word'>luminosity-chrominance</span> <span class='word'>spaces</span> <span class='word'>all</span> <span class='word'>include</span> <span class='word'>implicit</span> <span class='word'>white-point</span> <span class='word'>correction</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>readily-available</span> <span class='word'>implementations</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>distorts</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>raw</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>Also</span><span class='ignore'>,</span> <span class='word'>while</span> <span class='word'>the</span> <span class='word'>transform</span> <span class='word'>is</span> <span class='word'>reversible</span> <span class='word'>mathematically</span><span class='ignore'>,</span> <span class='word'>discrete</span> <span class='word'>data</span> <span class='word'>types</span> <span class='word'>are</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>practical</span> <span class='word'>computer</span> <span class='word'>science</span> <span class='word'>applications</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>in</span> <span class='word'>most</span> <span class='word'>implementations</span> <span class='word'>the</span> <span class='word'>output</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>input</span><span class='ignore'>,</span> <span class='word'>resulting</span> <span class='word'>in</span> <span class='word'>some</span> <span class='word'>loss</span> <span class='word'>of</span> <span class='word'>information</span> <span class='word'>when</span> <span class='word'>the</span> <span class='word'>transform</span> <span class='word'>is</span> <span class='word'>applied</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>entire</span> <span class='word'>region</span> <span class='word'>of</span> <span class='word'>skin</span> <span class='word'>color</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>expressed</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>2D</span> <span class='word'>Gaussian</span> <span class='ignore'>(</span><span class='word'>see</span> <span class='word'>Chapter</span> <span class='word'>3</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>Typically</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>complex</span> <span class='word'>operation</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>by</span> <span class='word'>aligning</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>axes</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>luminosity-chrominance</span> <span class='word'>space</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>major</span> <span class='word'>and</span> <span class='word'>minor</span> <span class='word'>axes</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>2D</span> <span class='word'>Gaussian</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>expressed</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>two</span> <span class='word'>1D</span> <span class='word'>Gaussians</span> <span class='word'>in</span> <span class='word'>each</span> <span class='word'>chromatic</span> <span class='word'>channel</span><span class='ignore'>,</span> <span class='word'>thereby</span> <span class='word'>facilitating</span> <span class='word'>the</span> <span class='word'>application</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>statistics</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>It</span> <span class='word'>was</span> <span class='word'>decided</span> <span class='word'>that</span> <span class='word'>a</span> <span class='word'>bespoke</span> <span class='word'>color-space</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>best</span> <span class='word'>suited</span> <span class='word'>for</span> <span class='word'>this</span> <span class='word'>project</span> <span class='word'>fulfilling</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>design</span> <span class='word'>criteria</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{itemize}</span><br>
<span class='cmd'>\item</span> <span class='word'>Be</span> <span class='word'>expressible</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>matrix</span> <span class='word'>transformation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>values</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>Allow</span> <span class='word'>an</span> <span class='word'>arbitrary</span> <span class='word'>orientation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>axis</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>Be</span> <span class='word'>expressed</span> <span class='word'>as</span> <span class='word'>an</span> <span class='word'>integer</span> <span class='word'>type</span> <span class='word'>at</span> <span class='word'>every</span> <span class='word'>step</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>transformation</span><span class='ignore'>,</span> <span class='word'>eliminating</span> <span class='word'>floating</span> <span class='word'>point</span> <span class='word'>operations</span> <span class='word'>and</span> <span class='word'>allowing</span> <span class='word'>for</span> <span class='word'>efficient</span> <span class='word'>optimization</span> <span class='word'>on</span> <span class='word'>mobile</span> <span class='word'>processors</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>Allow</span> <span class='word'>for</span> <span class='word'>retention</span> <span class='word'>and</span> <span class='word'>elimination</span> <span class='word'>of</span> <span class='word'>color-space</span> <span class='word'>information</span><span class='ignore'>,</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>performed</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>non-linear</span> <span class='word'>fashion</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>2D</span> <span class='word'>Gaussian</span> <span class='word'>distribution</span><span class='ignore'>.</span><br>
<span class='envir'>\end</span><span class='envir'>{itemize}</span><br>
<br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Physiology</span> <span class='hword'>Study</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>PhysiologyStudy</span><span class='ignore'>}</span><br>
<br>
<span class='word'>Now</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>chosen</span> <span class='word'>our</span> <span class='word'>color-space</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>will</span> <span class='word'>look</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>necessary</span> <span class='word'>biological</span> <span class='word'>considerations</span><span class='ignore'>.</span> <span class='word'>Specifically</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>chromophores</span> <span class='word'>in</span> <span class='word'>human</span> <span class='word'>skin</span> <span class='word'>and</span> <span class='word'>how</span> <span class='word'>they</span> <span class='word'>affect</span> <span class='word'>how</span> <span class='word'>skin</span> <span class='word'>appears</span> <span class='word'>to</span> <span class='word'>different</span> <span class='word'>detection</span> <span class='word'>devices</span><span class='ignore'>.</span> <span class='word'>Chromophores</span> <span class='word'>are</span> <span class='word'>chemicals</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>which</span> <span class='word'>interact</span> <span class='word'>with</span> <span class='word'>light</span><span class='ignore'>,</span> <span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>chromophores</span> <span class='word'>are</span> <span class='word'>the</span> <span class='word'>chemicals</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>responsible</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>of</span> <span class='word'>skin</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Anderson1981</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>aim</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>physiology</span> <span class='word'>study</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>determine</span><span class='ignore'>,</span> <span class='word'>theoretically</span><span class='ignore'>,</span> <span class='word'>how</span> <span class='word'>various</span> <span class='word'>sensors</span> <span class='word'>perceive</span> <span class='word'>human</span> <span class='word'>skin</span><span class='ignore'>.</span> <span class='word'>Empirically</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>the</span> <span class='word'>absorption</span> <span class='word'>spectra</span> <span class='word'>for</span> <span class='word'>various</span> <span class='word'>key</span> <span class='word'>chromophores</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>response</span> <span class='word'>spectra</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>sensors</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>combine</span> <span class='word'>this</span> <span class='word'>empirical</span> <span class='word'>data</span> <span class='word'>to</span> <span class='word'>predict</span> <span class='word'>the</span> <span class='word'>output</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>sensor</span><span class='ignore'>.</span> <br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Chromophores</span> <span class='hword'>in</span> <span class='hword'>Human</span> <span class='hword'>Skin</span><span class='ignore'>}</span><br>
<br>
<span class='word'>In</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>of</span> <span class='word'>human</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>chemicals</span> <span class='word'>responsible</span> <span class='word'>for</span> <span class='word'>both</span> <span class='word'>scattering</span> <span class='word'>and</span> <span class='word'>absorption</span> <span class='word'>are</span> <span class='word'>different</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>absorption</span> <span class='word'>chemicals</span> <span class='word'>affect</span> <span class='word'>the</span> <span class='word'>hue</span><span class='ignore'>,</span> <span class='word'>while</span> <span class='word'>the</span> <span class='word'>scattering</span> <span class='word'>chemicals</span> <span class='word'>determine</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>path</span> <span class='word'>length</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>light</span> <span class='word'>through</span> <span class='word'>the</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='word'>thereby</span> <span class='word'>determining</span> <span class='word'>the</span> <span class='word'>saturation</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>the</span> <span class='word'>amount</span> <span class='word'>of</span> <span class='word'>light</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>absorbed</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>longer</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>length</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>more</span> <span class='word'>light</span> <span class='word'>is</span> <span class='word'>absorbed</span> <span class='word'>for</span> <span class='word'>any</span> <span class='word'>given</span> <span class='word'>concentration</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>chromophore</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>While</span> <span class='word'>there</span> <span class='word'>are</span> <span class='word'>a</span> <span class='word'>variety</span> <span class='word'>of</span> <span class='word'>chromophores</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>focusing</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>four</span> <span class='word'>which</span> <span class='word'>most</span> <span class='word'>significantly</span> <span class='word'>affect</span> <span class='word'>skin</span> <span class='word'>color</span><span class='ignore'>:</span> <span class='word'>oxy-hemoglobin</span><span class='ignore'>,</span> <span class='word'>deoxy-hemoglobin</span><span class='ignore'>,</span> <span class='word'>eumelanin</span> <span class='word'>and</span> <span class='word'>pheomelanin</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>absorption</span> <span class='word'>spectra</span> <span class='word'>for</span> <span class='word'>these</span> <span class='word'>chromophores</span> <span class='word'>are</span> <span class='word'>known</span> <span class='word'>quantities</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>use</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>absorbance</span> <span class='word'>of</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='ignore'>"</span><span class='word'>absorbance</span><span class='ignore'>"</span> <span class='word'>being</span> <span class='word'>the</span> <span class='word'>ratio</span> <span class='word'>of</span> <span class='word'>remitted</span> <span class='word'>light</span> <span class='word'>to</span> <span class='word'>absorbed</span> <span class='word'>light</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>absorbance</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>applying</span> <span class='word'>the</span> <span class='word'>Beer-Lambert</span> <span class='word'>Law</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Clark2007</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>BeerLambert</span><span class='ignore'>}</span><br>
<span class='math'>A</span> <span class='math'>=</span> <span class='mathcmd'>\log</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>I</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>0</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>I</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>\epsilon l</span>&nbsp; <span class='math'>c</span> <br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>Where</span> <span class='mathgroup'>$</span><span class='math'>A</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>absorbance</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>I</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>0</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>intensity</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>light</span> <span class='word'>passing</span> <span class='word'>through</span> <span class='word'>the</span> <span class='word'>reference</span> <span class='word'>cell</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>I</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>intensity</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>light</span> <span class='word'>passing</span> <span class='word'>through</span> <span class='word'>the</span> <span class='word'>sample</span> <span class='word'>cell</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>l</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>length</span> <span class='word'>of</span> <span class='word'>light</span> <span class='word'>through</span> <span class='word'>the</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>c</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>concentration</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromophore</span><span class='ignore'>.</span> <span class='mathgroup'>$</span><span class='math'>\epsilon</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>variously</span> <span class='word'>called</span> <span class='ignore'>"</span><span class='word'>molar</span> <span class='word'>absorptivity</span><span class='ignore'>,</span><span class='ignore'>"</span> <span class='word'>the</span> <span class='ignore'>"</span><span class='word'>molar</span> <span class='word'>extinction</span> <span class='word'>coefficient</span><span class='ignore'>,</span><span class='ignore'>"</span> <span class='word'>and</span> <span class='word'>the</span> <span class='ignore'>"</span><span class='word'>molar</span> <span class='word'>absorption</span> <span class='word'>coefficient</span><span class='ignore'>;</span><span class='ignore'>"</span> <span class='word'>all</span> <span class='word'>equivalent</span> <span class='word'>terms</span> <span class='word'>for</span> <span class='word'>how</span> <span class='word'>strongly</span> <span class='word'>a</span> <span class='word'>chemical</span> <span class='word'>species</span> <span class='word'>absorbs</span> <span class='word'>light</span> <span class='word'>at</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>wavelength</span><span class='ignore'>.</span><br>
<br>
<span class='word'>In</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>apply</span> <span class='word'>the</span> <span class='word'>molar</span> <span class='word'>absorptivity</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>path</span> <span class='word'>length</span> <span class='word'>of</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>concentration</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromophore</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>their</span> <span class='word'>Beer-Lambert</span> <span class='word'>Law</span> <span class='word'>relation</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>in</span> <span class='word'>this</span> <span class='word'>case</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>them</span> <span class='word'>all</span><span class='ignore'>.</span> <span class='word'>Unfortunately</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>units</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>consistent</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Clark2007</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>they</span> <span class='word'>can</span> <span class='word'>each</span> <span class='word'>be</span> <span class='word'>converted</span> <span class='word'>into</span> <span class='word'>the</span> <span class='word'>SI</span> <span class='word'>units</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>m</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>/</span><span class='math'>mol</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>data</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>chromophores</span> <span class='word'>were</span> <span class='word'>obtained</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>OMLC</span> <span class='word'>website</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>contains</span> <span class='word'>information</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>absorption</span> <span class='word'>spectra</span> <span class='word'>for</span> <span class='word'>many</span> <span class='word'>different</span> <span class='word'>chemicals</span><span class='ignore'>,</span> <span class='word'>including</span> <span class='word'>the</span> <span class='word'>aforementioned</span> <span class='word'>four</span> <span class='word'>skin</span> <span class='word'>chromophores</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>OMLC2001</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>Our</span> <span class='word'>first</span> <span class='word'>task</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>convert</span> <span class='word'>everything</span> <span class='word'>into</span> <span class='word'>consistent</span> <span class='word'>SI</span> <span class='word'>units</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>absorbance</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>Beer-Lambert</span> <span class='word'>Law</span> <span class='word'>relation</span><span class='ignore'>.</span> <span class='word'>As</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>path</span> <span class='word'>length</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>property</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>useful</span> <span class='word'>to</span> <span class='word'>calculate</span> <span class='word'>an</span> <span class='word'>absorption</span> <span class='word'>coefficient</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>chromophore</span><span class='ignore'>;</span> <span class='word'>this</span> <span class='word'>differs</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>molar</span> <span class='word'>absorptivity</span> <span class='word'>only</span> <span class='word'>in</span> <span class='word'>that</span> <span class='word'>it</span> <span class='word'>contains</span> <span class='word'>the</span> <span class='word'>concentration</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>chromophore</span><span class='ignore'>.</span> <span class='word'>We're</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>average</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>actual</span> <span class='word'>concentrations</span> <span class='word'>vary</span> <span class='word'>markedly</span> <span class='word'>between</span> <span class='word'>individuals</span><span class='ignore'>.</span> <span class='word'>So</span> <span class='word'>we</span> <span class='word'>chose</span> <span class='word'>a</span> <span class='word'>molar</span> <span class='word'>concentration</span> <span class='word'>equivalent</span> <span class='word'>to</span> <span class='word'>that</span> <span class='word'>of</span> <span class='word'>hemoglobin</span> <span class='word'>in</span> <span class='word'>blood</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromophores</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>used</span> <span class='word'>their</span> <span class='word'>individual</span> <span class='word'>molar</span> <span class='word'>masses</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>absorption</span> <span class='word'>coefficient</span> <span class='mathgroup'>$</span><span class='math'>\mu </span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\epsilon \rho</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>M</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>chem</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='math'>\rho</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>mass</span> <span class='word'>concentration</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>M</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>chem</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>molar</span> <span class='word'>mass</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromophore</span><span class='ignore'>.</span><br>
<br>
<span class='word'>We</span> <span class='word'>can</span> <span class='word'>convert</span> <span class='word'>the</span> <span class='word'>molar</span> <span class='word'>absorptivity</span> <span class='word'>into</span> <span class='word'>an</span> <span class='word'>absorption</span> <span class='word'>spectrum</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>chromophore</span> <span class='word'>if</span> <span class='word'>we</span> <span class='word'>know</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>path</span> <span class='word'>length</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>skin</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>scattering</span> <span class='word'>properties</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>will</span> <span class='word'>determine</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>length</span><span class='ignore'>.</span> <span class='word'>Since</span> <span class='word'>we</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>trying</span> <span class='word'>to</span> <span class='word'>simulate</span> <span class='word'>any</span> <span class='word'>skin</span> <span class='word'>in</span> <span class='word'>particular</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>simply</span> <span class='word'>use</span> <span class='word'>average</span> <span class='word'>values</span> <span class='word'>taken</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>OMLC</span> <span class='word'>site</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>OMLC2001</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>At</span> <span class='word'>this</span> <span class='word'>point</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>aren't</span> <span class='word'>so</span> <span class='word'>much</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>saturation</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>the</span> <span class='word'>concentration</span> <span class='word'>and</span> <span class='word'>path</span> <span class='word'>length</span> <span class='word'>both</span> <span class='word'>affect</span> <span class='word'>the</span> <span class='word'>saturation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>rather</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>hue</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>as</span> <span class='word'>we</span> <span class='word'>are</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>relative</span> <span class='word'>position</span> <span class='word'>around</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>axis</span><span class='ignore'>.</span><br>
<br>
<span class='word'>So</span> <span class='word'>now</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>an</span> <span class='word'>absorption</span> <span class='word'>spectrum</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>perceive</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>light</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>remitted</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>that</span> <span class='word'>is</span> <span class='word'>what</span> <span class='word'>we</span> <span class='word'>are</span> <span class='word'>really</span> <span class='word'>interested</span> <span class='word'>in</span><span class='ignore'>:</span> <span class='word'>the</span> <span class='word'>remitted</span> <span class='word'>light</span><span class='ignore'>,</span> <span class='word'>or</span> <span class='mathgroup'>$</span><span class='math'>R</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>While</span> <span class='word'>the</span> <span class='word'>optics</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>complicated</span> <span class='word'>study</span><span class='ignore'>,</span> <span class='word'>there</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>relatively</span> <span class='word'>simple</span> <span class='word'>theory</span> <span class='word'>called</span> <span class='word'>Kubelka-Munk</span> <span class='word'>Theory</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Kubelka1931</span><span class='ignore'>,</span><span class='ignore'>Kubelka</span><span class='ignore'>:</span><span class='ignore'>48</span><span class='ignore'>,</span><span class='ignore'>Kubelka</span><span class='ignore'>:</span><span class='ignore'>54</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>turn</span> <span class='word'>an</span> <span class='word'>absorption</span> <span class='word'>spectra</span> <span class='word'>into</span> <span class='word'>a</span> <span class='word'>remission</span> <span class='word'>spectra</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>KubelkaMunk</span><span class='ignore'>}</span><br>
<span class='math'>r</span> <span class='math'>&amp;</span><span class='math'>=</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>A</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='math'>r</span> <span class='math'>&amp;</span> <span class='math'>=</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>R-1</span><span class='math'>)</span><span class='math'>^</span><span class='math'>2-T</span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>R</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='math'>S</span> <span class='math'>&amp;</span> <span class='math'>=</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\tanh</span> <span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>1</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>r</span> <span class='math'>(</span><span class='math'>r</span><span class='math'>+</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>R</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>1</span><span class='math'>-</span><span class='math'>(</span><span class='math'>r</span><span class='math'>+</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>R</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>d</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>r</span> <span class='math'>(</span><span class='math'>r</span><span class='math'>+</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>Where</span> <span class='mathgroup'>$</span><span class='math'>A</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>absorption</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>S</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>scattering</span> <span class='word'>of</span> <span class='word'>light</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>R</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>remission</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>T</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>transmittance</span><span class='ignore'>.</span> <span class='word'>As</span> <span class='word'>the</span> <span class='word'>transmittance</span> <span class='mathgroup'>$</span><span class='math'>T</span><span class='mathgroup'>$</span> <span class='word'>of</span> <span class='word'>human</span> <span class='word'>skin</span> <span class='word'>is</span> <span class='word'>approximately</span> <span class='word'>zero</span> <span class='word'>at</span> <span class='word'>visible</span> <span class='word'>wavelengths</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>A</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>expressed</span> <span class='word'>as</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>KubelkaMunk2</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>A</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span> <span class='math'>&amp;</span><span class='math'>=</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>R-1</span><span class='math'>)</span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>R</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\therefore</span><span class='mathcmd'>\\</span><br>
<span class='math'>R</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>r</span><span class='math'>+</span><span class='math'>1</span> <span class='mathcmd'>\pm</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>r</span><span class='math'>^</span><span class='math'>2</span><span class='math'>+</span><span class='math'>2</span> <span class='math'>r</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>As</span> <span class='mathgroup'>$</span><span class='math'>r</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>A</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>remission</span> <span class='mathgroup'>$</span><span class='math'>R</span><span class='mathgroup'>$</span> <span class='word'>must</span> <span class='word'>go</span> <span class='word'>down</span> <span class='word'>with</span> <span class='word'>increasing</span> <span class='word'>absorption</span> <span class='mathgroup'>$</span><span class='math'>A</span><span class='mathgroup'>$</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>KubelkaMunk3</span><span class='ignore'>}</span><br>
<span class='math'>R</span> <span class='math'>=</span> <span class='math'>r</span><span class='math'>+</span><span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>r</span><span class='math'>^</span><span class='math'>2</span><span class='math'>+</span><span class='math'>2</span> <span class='math'>r</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.02\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>ChemicalSpectralProperties.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>From</span> <span class='oword'>left</span> <span class='oword'>to</span> <span class='oword'>right</span><span class='ignore'>,</span> <span class='oword'>the</span> <span class='oword'>molar</span> <span class='oword'>absorptivity</span><span class='ignore'>,</span> <span class='oword'>the</span> <span class='oword'>absorption</span> <span class='oword'>coefficient</span><span class='ignore'>,</span> <span class='oword'>and</span> <span class='oword'>remittance</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>four</span> <span class='oword'>key</span> <span class='oword'>chromophores</span><span class='ignore'>.</span> <span class='oword'>We</span> <span class='oword'>assume</span> <span class='oword'>a</span> <span class='oword'>typical</span> <span class='oword'>hemoglobin</span> <span class='oword'>concentration</span> <span class='oword'>of</span> <span class='oword'>150</span> <span class='mathgroup'>$</span><span class='math'>g</span><span class='math'>/</span><span class='math'>L</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>remittance</span> <span class='oword'>was</span> <span class='oword'>found</span> <span class='oword'>using</span> <span class='oword'>Kubelka-Munk</span> <span class='oword'>Theory</span><span class='ignore'>,</span> <span class='oword'>outlined</span> <span class='oword'>in</span> <span class='oword'>section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>SkinColorSimulation</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ChemicalSpectralProperties</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>remittance</span> <span class='word'>spectra</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>four</span> <span class='word'>key</span> <span class='word'>chromophores</span> <span class='word'>is</span> <span class='word'>shown</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ChemicalSpectralProperties</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Response</span> <span class='hword'>Spectra</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>response</span> <span class='word'>spectrum</span> <span class='word'>is</span> <span class='word'>how</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>sensor</span> <span class='word'>responds</span> <span class='word'>to</span> <span class='word'>specific</span> <span class='word'>wavelengths</span> <span class='word'>of</span> <span class='word'>light</span><span class='ignore'>.</span> <span class='word'>Essentially</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>raw</span> <span class='word'>output</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>sensor</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>almost</span> <span class='word'>never</span> <span class='word'>used</span> <span class='word'>and</span> <span class='word'>is</span> <span class='word'>generally</span> <span class='word'>inaccessible</span> <span class='word'>even</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>hardware</span> <span class='word'>layer</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>circuitry</span> <span class='word'>very</span> <span class='word'>close</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>CCD</span> <span class='word'>does</span> <span class='word'>a</span> <span class='word'>basic</span> <span class='word'>level</span> <span class='word'>of</span> <span class='word'>color</span> <span class='word'>rebalancing</span><span class='ignore'>.</span> <span class='word'>As</span> <span class='word'>we</span> <span class='word'>don't</span> <span class='word'>know</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>rebalancing</span> <span class='word'>for</span> <span class='word'>every</span> <span class='word'>possible</span> <span class='word'>CCD</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>observed</span> <span class='word'>the</span> <span class='word'>raw</span> <span class='word'>output</span> <span class='word'>spectra</span> <span class='word'>of</span> <span class='word'>several</span> <span class='word'>different</span> <span class='word'>devices</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>tried</span> <span class='word'>two</span> <span class='word'>very</span> <span class='word'>simple</span> <span class='word'>methods</span> <span class='word'>of</span> <span class='word'>rebalancing</span> <span class='word'>the</span> <span class='word'>color</span><span class='ignore'>:</span><br>
<br>
<span class='word'>The</span> <span class='word'>first</span> <span class='word'>is</span> <span class='word'>peak</span> <span class='word'>normalization</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>simply</span> <span class='word'>levels</span> <span class='word'>out</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>output</span> <span class='word'>in</span> <span class='word'>each</span> <span class='word'>channel</span> <span class='word'>such</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>peak</span> <span class='word'>output</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>channels</span> <span class='word'>is</span> <span class='word'>equal</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>approach</span> <span class='word'>is</span> <span class='word'>very</span> <span class='word'>simple</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>is</span> <span class='word'>quite</span> <span class='word'>likely</span> <span class='word'>from</span> <span class='word'>an</span> <span class='word'>electrical</span> <span class='word'>engineering</span> <span class='word'>perspective</span> <span class='word'>as</span> <span class='word'>it</span> <span class='word'>facilitates</span> <span class='word'>the</span> <span class='word'>digitization</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>information</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>second</span> <span class='word'>method</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>approach</span> <span class='word'>the</span> <span class='word'>response</span> <span class='word'>spectra</span> <span class='word'>using</span> <span class='word'>basis</span> <span class='word'>functions</span> <span class='word'>to</span> <span class='word'>represent</span> <span class='word'>the</span> <span class='word'>spectrum</span><span class='ignore'>.</span> <span class='word'>Using</span> <span class='word'>this</span> <span class='word'>approach</span><span class='ignore'>,</span> <span class='word'>each</span> <span class='word'>basis</span> <span class='word'>function</span> <span class='word'>is</span> <span class='word'>normalized</span> <span class='word'>according</span> <span class='word'>to</span> <span class='word'>its</span> <span class='word'>integral</span> <span class='word'>over</span> <span class='word'>the</span> <span class='word'>visible</span> <span class='word'>wavelengths</span><span class='ignore'>,</span> <span class='word'>giving</span> <span class='word'>an</span> <span class='word'>equal</span> <span class='word'>weighting</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>response</span> <span class='word'>spectra</span> <span class='word'>functions</span> <span class='word'>over</span> <span class='word'>the</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>rather</span> <span class='word'>than</span> <span class='word'>focusing</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>peak</span> <span class='word'>value</span><span class='ignore'>.</span> <span class='word'>Mathematically</span> <span class='word'>speaking</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>approach</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>unusual</span> <span class='word'>when</span> <span class='word'>constructing</span> <span class='word'>a</span> <span class='word'>basis</span> <span class='word'>set</span> <span class='word'>as</span> <span class='word'>it</span> <span class='word'>facilitates</span> <span class='word'>the</span> <span class='word'>maths</span><span class='ignore'>.</span><br>
<br>
<span class='word'>It</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>noted</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>rebalancing</span> <span class='word'>methods</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>modern</span> <span class='word'>CCD</span> <span class='word'>devices</span> <span class='word'>are</span> <span class='word'>much</span> <span class='word'>more</span> <span class='word'>sophisticated</span> <span class='word'>than</span> <span class='word'>either</span> <span class='word'>of</span> <span class='word'>these</span> <span class='word'>approaches</span><span class='ignore'>.</span><br>
<br>
<span class='word'>However</span><span class='ignore'>,</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>methods</span> <span class='word'>chosen</span> <span class='word'>here</span> <span class='word'>are</span> <span class='word'>straightforward</span> <span class='word'>amplifications</span> <span class='word'>of</span> <span class='word'>each</span> <span class='word'>channel</span><span class='ignore'>,</span> <span class='word'>they're</span> <span class='word'>likely</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>first</span> <span class='word'>step</span> <span class='word'>in</span> <span class='word'>color</span> <span class='word'>rebalancing</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>hardware</span> <span class='word'>level</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>device</span><span class='ignore'>.</span> <span class='word'>While</span> <span class='word'>we</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>concerned</span> <span class='word'>with</span> <span class='word'>device</span> <span class='word'>constructions</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>useful</span> <span class='word'>to</span> <span class='word'>know</span> <span class='word'>how</span> <span class='word'>these</span> <span class='word'>devices</span> <span class='word'>capture</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>information</span> <span class='word'>if</span> <span class='word'>this</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>diagnostically</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>color</span> <span class='word'>rebalancing</span> <span class='word'>may</span> <span class='word'>introduce</span> <span class='word'>artefacts</span> <span class='word'>and</span> <span class='word'>distortions</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>data</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Although</span> <span class='word'>we</span> <span class='word'>consider</span> <span class='word'>these</span> <span class='word'>sensors</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>capturing</span> <span class='word'>information</span> <span class='word'>throughout</span> <span class='word'>the</span> <span class='word'>entire</span> <span class='word'>visible</span> <span class='word'>spectrum</span><span class='ignore'>,</span> <span class='word'>what</span> <span class='word'>they</span> <span class='word'>are</span> <span class='word'>actually</span> <span class='word'>capturing</span> <span class='word'>varies</span> <span class='word'>quite</span> <span class='word'>significantly</span> <span class='word'>between</span> <span class='word'>devices</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>shown</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ResponseSpectraStripes</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>Even</span> <span class='word'>a</span> <span class='word'>very</span> <span class='word'>simple</span> <span class='word'>color</span> <span class='word'>rebalancing</span> <span class='word'>can</span> <span class='word'>restore</span> <span class='word'>some</span> <span class='word'>normality</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>spectrum</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>shown</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ResponseSpectraStripesNorm</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>these</span> <span class='word'>devices</span> <span class='word'>use</span> <span class='word'>the</span> <span class='word'>aforementioned</span> <span class='word'>color</span> <span class='word'>rebalancing</span> <span class='word'>algorithms</span> <span class='word'>to</span> <span class='word'>alter</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>to</span> <span class='word'>look</span> <span class='word'>more</span> <span class='word'>sensible</span> <span class='word'>to</span> <span class='word'>human</span> <span class='word'>eyes</span><span class='ignore'>,</span> <span class='word'>these</span> <span class='word'>differences</span> <span class='word'>aren't</span> <span class='word'>so</span> <span class='word'>apparent</span> <span class='word'>to</span> <span class='word'>us</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\clearpage</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.99\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>ResponseSpectrum</span><span class='ignore'>_</span><span class='ignore'>NokiaN900.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>response</span> <span class='oword'>spectrum</span> <span class='oword'>for</span> <span class='oword'>the</span> <span class='oword'>Nokia</span> <span class='oword'>N900</span><span class='ignore'>.</span> <span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ResponseSpectumNokia</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.99\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>ResponseSpectraStripes.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>light</span> <span class='oword'>spectrum</span> <span class='oword'>as</span> <span class='oword'>viewed</span> <span class='oword'>using</span> <span class='oword'>various</span> <span class='oword'>CCDs</span> <span class='oword'>with</span> <span class='oword'>a</span> <span class='oword'>physical</span> <span class='oword'>spectrum</span> <span class='oword'>for</span> <span class='oword'>comparison</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ResponseSpectraStripes</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='cmd'>\clearpage</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.99\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>ResponseSpectraStripesNorm.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>light</span> <span class='oword'>spectrum</span> <span class='oword'>as</span> <span class='oword'>viewed</span> <span class='oword'>using</span> <span class='oword'>various</span> <span class='oword'>CCDs</span> <span class='oword'>after</span> <span class='oword'>normalization</span> <span class='oword'>with</span> <span class='oword'>a</span> <span class='oword'>physical</span> <span class='oword'>spectrum</span> <span class='oword'>for</span> <span class='oword'>comparison</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ResponseSpectraStripesNorm</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>In</span> <span class='word'>addition</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>rebalancing</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>corrects</span> <span class='word'>the</span> <span class='word'>behavior</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>CCD</span> <span class='word'>devices</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>in</span> <span class='word'>later</span> <span class='word'>sections</span><span class='ignore'>,</span> <span class='word'>some</span> <span class='word'>devices</span><span class='ignore'>,</span> <span class='word'>like</span> <span class='word'>the</span> <span class='word'>iPhone</span><span class='ignore'>,</span> <span class='word'>also</span> <span class='word'>apply</span> <span class='word'>a</span> <span class='word'>dynamic</span> <span class='word'>color</span> <span class='word'>rebalancing</span> <span class='word'>which</span> <span class='word'>attempts</span> <span class='word'>to</span> <span class='word'>even</span> <span class='word'>out</span> <span class='word'>the</span> <span class='word'>colors</span> <span class='word'>based</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>captured</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>feature</span> <span class='word'>is</span> <span class='word'>intended</span> <span class='word'>to</span> <span class='word'>correct</span> <span class='word'>for</span> <span class='word'>strange</span> <span class='word'>lighting</span> <span class='word'>conditions</span> <span class='word'>and</span> <span class='word'>other</span> <span class='word'>such</span> <span class='word'>problems</span> <span class='word'>which</span> <span class='word'>could</span> <span class='word'>affect</span> <span class='word'>the</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>addressed</span> <span class='word'>in</span> <span class='word'>detail</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>Chap2</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='word'>Appendix</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>app</span><span class='ignore'>:</span><span class='ignore'>PreservationOfColorInformation</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\clearpage</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Skin</span> <span class='hword'>Color</span> <span class='hword'>Simulation</span><span class='ignore'>}</span> <span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>SkinColorSimulation</span><span class='ignore'>}</span><br>
<br>
<span class='word'>So</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>the</span> <span class='word'>molar</span> <span class='word'>absorptivity</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>four</span> <span class='word'>key</span> <span class='word'>chromophores</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>the</span> <span class='word'>response</span> <span class='word'>spectra</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>variety</span> <span class='word'>of</span> <span class='word'>devices</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>response</span> <span class='word'>spectra</span> <span class='word'>which</span> <span class='word'>serves</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>target</span> <span class='word'>color</span> <span class='word'>output</span> <span class='word'>for</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>devices</span> <span class='word'>after</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>rebalancing</span> <span class='word'>has</span> <span class='word'>been</span> <span class='word'>applied</span><span class='ignore'>.</span> <span class='word'>Additionally</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>are</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>CIE</span> <span class='word'>1931</span> <span class='word'>RGB</span> <span class='word'>color-space</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>absorption</span> <span class='word'>spectra</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>closer</span> <span class='word'>to</span> <span class='word'>how</span> <span class='word'>our</span> <span class='word'>eyes</span> <span class='word'>perceive</span> <span class='word'>color</span> <span class='word'>than</span> <span class='word'>any</span> <span class='word'>other</span> <span class='word'>color-space</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>RIDI2013</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>means</span> <span class='word'>that</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>principle</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>get</span> <span class='word'>appropriate</span> <span class='word'>RGB</span> <span class='word'>values</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>four</span> <span class='word'>key</span> <span class='word'>chromophores</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>hardware</span> <span class='word'>layer</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>device</span> <span class='word'>response</span> <span class='word'>spectra</span><span class='ignore'>,</span> <span class='word'>or</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>AP</span> <span class='word'>layer</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>CIE</span> <span class='word'>1931</span> <span class='word'>RGB</span> <span class='word'>color-space</span> <span class='word'>spectrum</span><span class='ignore'>,</span> <span class='word'>assuming</span> <span class='word'>the</span> <span class='word'>device's</span> <span class='word'>color-space</span> <span class='word'>rebalancing</span> <span class='word'>does</span> <span class='word'>its</span> <span class='word'>job</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>question</span> <span class='word'>now</span> <span class='word'>is</span> <span class='word'>how</span> <span class='word'>to</span> <span class='word'>actually</span> <span class='word'>simulate</span> <span class='word'>skin</span> <span class='word'>color</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Given</span> <span class='word'>a</span> <span class='word'>remittance</span> <span class='word'>spectrum</span> <span class='mathgroup'>$</span><span class='math'>R</span><span class='math'>(</span><span class='mathcmd'>\lambda</span><span class='math'>)</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>response</span> <span class='word'>function</span> <span class='mathgroup'>$</span><span class='math'>S</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>rgb</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\lambda</span><span class='math'>)</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>sensor</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>output</span> <span class='word'>values</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>calculated</span> <span class='word'>by</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>convolution</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='math'>R</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\int</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>0</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='mathcmd'>\infty</span><span class='ignore'>}</span> <span class='math'>R</span><span class='math'>(</span><span class='mathcmd'>\lambda</span><span class='math'>)</span> <span class='math'>S</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>R</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\lambda</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>d</span><span class='mathcmd'>\lambda</span><span class='ignore'>}</span><span class='mathcmd'>\\</span><br>
<span class='math'>G</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\int</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>0</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='mathcmd'>\infty</span><span class='ignore'>}</span> <span class='math'>R</span><span class='math'>(</span><span class='mathcmd'>\lambda</span><span class='math'>)</span> <span class='math'>S</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>G</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\lambda</span><span class='math'>)</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>d</span><span class='mathcmd'>\lambda</span><span class='ignore'>}</span><span class='mathcmd'>\\</span><br>
<span class='math'>B</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\int</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>0</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='mathcmd'>\infty</span><span class='ignore'>}</span> <span class='math'>R</span><span class='math'>(</span><span class='mathcmd'>\lambda</span><span class='math'>)</span> <span class='math'>S</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>B</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\lambda</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>d</span><span class='mathcmd'>\lambda</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>As</span> <span class='word'>for</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>bright</span> <span class='word'>color</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>response</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>CCD</span><span class='ignore'>.</span> <span class='word'>By</span> <span class='word'>integrating</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>functions</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>figure</span> <span class='word'>below</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>get</span> <span class='word'>the</span> <span class='word'>channel</span> <span class='word'>output</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span><span class='ignore'>~</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Chromophores</span><span class='ignore'>_</span><span class='ignore'>NokiaN900</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.99\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Chromophores</span><span class='ignore'>_</span><span class='ignore'>NokiaN900.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>functions</span> <span class='oword'>representing</span> <span class='oword'>the</span> <span class='oword'>channel</span> <span class='oword'>output</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>four</span> <span class='oword'>chromophores</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>color</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>remittance</span> <span class='oword'>curve</span> <span class='oword'>is</span> <span class='oword'>the</span> <span class='oword'>color</span> <span class='oword'>for</span> <span class='oword'>that</span> <span class='oword'>particular</span> <span class='oword'>chromophore</span> <span class='oword'>as</span> <span class='oword'>seen</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>NokiaN900</span> <span class='oword'>camera</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>solid-filled</span><span class='ignore'>,</span> <span class='oword'>bright</span> <span class='oword'>function</span> <span class='oword'>is</span> <span class='oword'>the</span> <span class='oword'>response</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>CCD</span> <span class='oword'>for</span> <span class='oword'>each</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>channels</span> <span class='oword'>to</span> <span class='oword'>that</span> <span class='oword'>limited</span> <span class='oword'>light</span><span class='ignore'>,</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>pale</span> <span class='oword'>function</span> <span class='oword'>is</span> <span class='oword'>the</span> <span class='oword'>response</span> <span class='oword'>function</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>CCD</span> <span class='oword'>for</span> <span class='oword'>each</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>channels</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Chromophores</span><span class='ignore'>_</span><span class='ignore'>NokiaN900</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<br>
<br>
<span class='word'>Thus</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>now</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>channel</span> <span class='word'>output</span> <span class='word'>of</span> <span class='word'>any</span> <span class='word'>device</span> <span class='word'>for</span> <span class='word'>which</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>response</span> <span class='word'>function</span> <span class='ignore'>(</span><span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>CameraComparison</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<span class='word'>At</span> <span class='word'>the</span> <span class='word'>time</span> <span class='word'>of</span> <span class='word'>development</span><span class='ignore'>,</span> <span class='word'>access</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>was</span> <span class='word'>limited</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>AP</span> <span class='word'>layer</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>work</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>CIE</span> <span class='word'>1931</span> <span class='word'>RGB</span> <span class='word'>color-space</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>relative</span> <span class='word'>position</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromophores</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>is</span> <span class='word'>shown</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ChromophoresYAB</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<br>
<br>
<span class='comment'>%********************************** %First Section&nbsp; **************************************</span><br>
<span class='comment'>%\section{Motivation} %Section - 1.1 </span><br>
<br>
<br>
<br>
<br>
<br>
<span class='comment'>%********************************** %Second Section&nbsp; *************************************</span><br>
<span class='comment'>%\section{Overview of Color Spaces} %Section - 1.2</span><br>
<br>
<br>
<span class='comment'>%********************************** % Third Section&nbsp; *************************************</span><br>
<span class='comment'>%\section{Where does it come from?}&nbsp; %Section - 1.3 </span><br>
<span class='comment'>%\label{section1.3}</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span> <span class='comment'>%hi-res</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.99\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>CameraComparison.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Chromophore</span> <span class='oword'>colors</span> <span class='oword'>as</span> <span class='oword'>perceived</span> <span class='oword'>by</span> <span class='oword'>a</span> <span class='oword'>range</span> <span class='oword'>of</span> <span class='oword'>devices</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>CameraComparison</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.99\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter1</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>ChromophoresYAB.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>four</span> <span class='oword'>main</span> <span class='oword'>chromophores</span> <span class='oword'>as</span> <span class='oword'>perceived</span> <span class='oword'>by</span> <span class='oword'>CIE</span> <span class='oword'>1931</span> <span class='oword'>RGB</span> <span class='oword'>color-space</span> <span class='oword'>after</span> <span class='oword'>rotation</span> <span class='oword'>into</span> <span class='oword'>the</span> <span class='oword'>LCaCb</span> <span class='mathgroup'>$</span><span class='math'>\theta </span><span class='math'>=</span> <span class='math'>0</span><span class='mathgroup'>$</span> <span class='oword'>color-space</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ChromophoresYAB</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span></p></div>
<br>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Chapter1/chapter1.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 2269</li>
<li>Words in headers: 17</li>
<li>Words outside text (captions, etc.): 162</li>
<li>Number of headers: 7</li>
<li>Number of floats/tables/figures: 7</li>
<li>Number of math inlines: 25</li>
<li>Number of math displayed: 5</li>
<li>Subcounts:</li>
<span class='subcount'>
<li class='fielddesc'>&nbsp; text+headers+captions (#headers/#floats/#inlines/#displayed)</li>
  <li>4+1+0 (1/0/0/0) Chapter: Motivation</li>
  <li>478+1+0 (1/0/0/0) Section: Introduction}\label{sec:Introduction</li>
  <li>396+4+0 (1/0/0/0) Section: Choosing a Color Space</li>
  <li>104+2+0 (1/0/0/0) Section: Physiology Study}\label{sec:PhysiologyStudy</li>
  <li>602+4+35 (1/1/22/4) Subsection: Chromophores in Human Skin</li>
  <li>444+2+37 (1/3/0/0) Subsection: Response Spectra</li>
  <li>241+3+90 (1/3/3/1) Subsection: Skin Color Simulation} \label{sec:SkinColorSimulation</li>
</span>
</ul>
</div>
<h2>File: ./Chapter2/chapter2.tex</h2>
<div class='parse'><p>
<span class='comment'>%*****************************************************************************************</span><br>
<span class='comment'>%*********************************** Second Chapter **************************************</span><br>
<span class='comment'>%*****************************************************************************************</span><br>
<br>
<br>
<span class='cmd'>\chapter</span><span class='ignore'>{</span><span class='hword'>Color</span> <span class='hword'>Spaces</span> <span class='hword'>and</span> <span class='hword'>Information</span> <span class='hword'>Storage</span> <span class='hword'>for</span> <span class='hword'>Computer</span> <span class='hword'>Vision</span> <span class='hword'>Processing</span><span class='ignore'>}</span> <span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>Chap2</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\epstopdfsetup</span><span class='ignore'>{</span><span class='word'>outdir</span><span class='ignore'>=</span><span class='word'>Chapter2</span><span class='ignore'>/</span><span class='word'>Figs</span><span class='ignore'>/</span><span class='word'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><br>
<span class='cmd'>\ifpdf</span><br>
&nbsp;&nbsp;<span class='cmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Raster</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\else</span><br>
&nbsp;&nbsp;<span class='cmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Vector</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\fi</span><br>
<br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Constructing</span> <span class='hword'>a</span> <span class='hword'>New</span> <span class='hword'>Color</span> <span class='hword'>Space</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ConstructingANewColorSpace</span><span class='ignore'>}</span><br>
<br>
<span class='word'>In</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>construct</span> <span class='word'>a</span> <span class='word'>new</span> <span class='word'>color-space</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>consider</span> <span class='word'>the</span> <span class='word'>coordinate</span> <span class='word'>system</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>orientation</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>fidelity</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>discrete</span> <span class='word'>representation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axes</span><span class='ignore'>.</span><br>
<br>
<span class='word'>A</span> <span class='word'>Cartesian</span> <span class='word'>coordinate</span> <span class='word'>system</span> <span class='word'>allows</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>straightforward</span> <span class='word'>transformation</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>source</span> <span class='word'>involving</span> <span class='word'>only</span> <span class='word'>rotation</span><span class='ignore'>,</span> <span class='word'>translation</span> <span class='word'>and</span> <span class='word'>scaling</span><span class='ignore'>.</span> <span class='word'>An</span> <span class='word'>orientation</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>luminosity</span> <span class='word'>axis</span> <span class='word'>is</span> <span class='word'>useful</span> <span class='word'>because</span> <span class='word'>we're</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>choice</span> <span class='word'>determines</span> <span class='word'>two</span> <span class='word'>of</span> <span class='word'>three</span> <span class='word'>rotational</span> <span class='word'>degrees</span> <span class='word'>of</span> <span class='word'>freedom</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>discussed</span> <span class='word'>below</span><span class='ignore'>.</span><br>
<br>
<span class='word'>As</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>discrete</span> <span class='word'>representation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axes</span><span class='ignore'>,</span> <span class='word'>it's</span> <span class='word'>desired</span> <span class='word'>that</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>captured</span> <span class='word'>pertaining</span> <span class='word'>to</span> <span class='word'>skin</span> <span class='word'>color</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>preserved</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Camera</span> <span class='hword'>RGB</span> <span class='hword'>and</span> <span class='hword'>Normalization</span> <span class='hword'>for</span> <span class='hword'>Discrete</span> <span class='hword'>Range</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>CameraRGB</span><span class='ignore'>}</span><br>
<br>
<span class='word'>Due</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>hardware</span> <span class='word'>being</span> <span class='word'>locked</span> <span class='word'>down</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>application</span> <span class='word'>level</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>do</span> <span class='word'>not</span> <span class='word'>have</span> <span class='word'>access</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>raw</span> <span class='word'>camera</span> <span class='word'>feed</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>do</span><span class='ignore'>,</span> <span class='word'>however</span><span class='ignore'>,</span> <span class='word'>have</span> <span class='word'>access</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>post-processing</span> <span class='ignore'>(</span><span class='word'>color-rebalanced</span> <span class='word'>and</span> <span class='word'>white-point-corrected</span><span class='ignore'>)</span> <span class='word'>8-bit</span> <span class='word'>RGB</span> <span class='word'>image</span> <span class='word'>data</span><span class='ignore'>.</span> <span class='word'>Investigating</span> <span class='word'>the</span> <span class='word'>difficulties</span> <span class='word'>introduced</span> <span class='word'>by</span> <span class='word'>these</span> <span class='word'>processing</span> <span class='word'>effects</span> <span class='word'>and</span> <span class='word'>accounting</span> <span class='word'>for</span> <span class='word'>them</span> <span class='word'>is</span> <span class='word'>looked</span> <span class='word'>at</span> <span class='word'>in</span> <span class='word'>Chapter</span>&nbsp; <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>iPhoneCameraCharacteristics</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Computer</span> <span class='word'>vision</span> <span class='word'>tasks</span> <span class='word'>are</span> <span class='word'>computationally</span> <span class='word'>intensive</span> <span class='word'>and</span> <span class='word'>often</span> <span class='word'>operate</span> <span class='word'>in</span> <span class='word'>real</span> <span class='word'>time</span><span class='ignore'>.</span> <span class='word'>Reduction</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>data</span> <span class='word'>set</span> <span class='word'>size</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>simple</span> <span class='word'>method</span> <span class='word'>for</span> <span class='word'>improving</span> <span class='word'>performance</span><span class='ignore'>.</span> <span class='word'>There</span> <span class='word'>is</span><span class='ignore'>,</span> <span class='word'>therefore</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>develop</span> <span class='word'>techniques</span> <span class='word'>which</span> <span class='word'>keep</span> <span class='word'>the</span> <span class='word'>relevant</span> <span class='word'>information</span> <span class='word'>while</span> <span class='word'>quickly</span> <span class='word'>and</span> <span class='word'>efficiently</span> <span class='word'>discarding</span> <span class='word'>the</span> <span class='word'>irrelevant</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>Achieving</span> <span class='word'>this</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>space</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>aim</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>chapter</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>Skin</span> <span class='hword'>Color</span> <span class='hword'>Space</span> <span class='hword'>Algorithm</span><span class='ignore'>}</span><br>
<br>
<span class='word'>Appendix</span> <span class='word'>A</span> <span class='word'>outlines</span> <span class='word'>how</span> <span class='word'>an</span> <span class='word'>integer</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>and</span> <span class='word'>Appendix</span> <span class='word'>B</span> <span class='word'>describes</span> <span class='word'>how</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>redistributed</span> <span class='word'>preserving</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>particular</span> <span class='word'>region</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>can</span> <span class='word'>use</span> <span class='word'>these</span> <span class='word'>methods</span> <span class='word'>to</span> <span class='word'>build</span> <span class='word'>a</span> <span class='word'>color-space</span> <span class='word'>transformation</span> <span class='word'>algorithm</span> <span class='word'>which</span> <span class='word'>can</span> <span class='word'>make</span> <span class='word'>intelligent</span> <span class='word'>decisions</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>numerical</span> <span class='word'>precision</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>intermediate</span> <span class='word'>and</span> <span class='word'>final</span> <span class='word'>variables</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>well</span> <span class='word'>as</span> <span class='word'>determining</span> <span class='word'>the</span> <span class='word'>most</span> <span class='word'>efficient</span> <span class='word'>transformation</span> <span class='word'>methods</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>described</span> <span class='word'>herein</span> <span class='word'>will</span> <span class='word'>take</span> <span class='word'>values</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>axis</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>standard</span> <span class='word'>deviations</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\uSTD</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span><span class='mathgroup'>$</span> <span class='mathcmd'>\uSTD</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>mean</span> <span class='word'>values</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\uMean</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span><span class='mathgroup'>$</span> <span class='mathcmd'>\uMean</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>chromatic</span> <span class='word'>axes</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>unit</span> <span class='word'>range</span>&nbsp; <span class='word'>and</span> <span class='word'>will</span> <span class='word'>automatically</span> <span class='word'>decide</span> <span class='word'>upon</span> <span class='word'>the</span> <span class='word'>necessary</span> <span class='word'>intermediate</span> <span class='word'>working</span> <span class='word'>data</span> <span class='word'>types</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>most</span> <span class='word'>efficient</span> <span class='word'>re-distribution</span> <span class='word'>methods</span><span class='ignore'>.</span><br>
<br>
<span class='word'>We</span> <span class='word'>found</span> <span class='word'>a</span> <span class='word'>rotational</span> <span class='word'>transformation</span> <span class='word'>which</span> <span class='word'>allows</span> <span class='word'>a</span> <span class='word'>working</span> <span class='word'>type</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>chosen</span> <span class='word'>such</span> <span class='word'>that</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span> <span class='mathcmd'>\le</span> <span class='math'>2</span> <span class='mathcmd'>\srcRange</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='word'>Appendices</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>app</span><span class='ignore'>:</span><span class='ignore'>AnIntegerRotationMatrix</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>app</span><span class='ignore'>:</span><span class='ignore'>PreservationOfColorInformation</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='mathcmd'>\srcRange</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>type</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>we</span> <span class='word'>were</span> <span class='word'>to</span> <span class='word'>keep</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>data</span> <span class='word'>type</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dstRange</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>destination</span> <span class='word'>type</span> <span class='word'>as</span> <span class='word'>is</span> <span class='word'>used</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>values</span><span class='ignore'>'</span> <span class='word'>source</span> <span class='word'>type</span> <span class='mathgroup'>$</span><span class='mathcmd'>\srcRange</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>axes</span> <span class='word'>would</span> <span class='word'>have</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>rescaled</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>accompanying</span> <span class='word'>loss</span> <span class='word'>of</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>Given</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>allow</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>assess</span> <span class='word'>where</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>relevant</span> <span class='word'>information</span> <span class='word'>lies</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>more</span> <span class='word'>sophisticated</span> <span class='word'>approach</span> <span class='word'>is</span> <span class='word'>possible</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>a</span> <span class='word'>chromatic</span> <span class='word'>axis</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>which</span><span class='ignore'>,</span> <span class='word'>after</span> <span class='word'>rotation</span><span class='ignore'>,</span> <span class='word'>has</span> <span class='word'>a</span> <span class='word'>length</span> <span class='mathgroup'>$</span><span class='math'>L</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span><span class='mathgroup'>$</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>determine</span> <span class='word'>the</span> <span class='word'>positions</span> <span class='word'>on</span> <span class='word'>that</span> <span class='word'>axis</span> <span class='word'>at</span> <span class='word'>which</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>considered</span> <span class='word'>irrelevant</span> <span class='word'>using</span> <span class='word'>Equation</span><span class='ignore'>~</span><span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>LowHigh</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>positions</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>all</span> <span class='word'>considered</span> <span class='word'>relevant</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>the</span> <span class='word'>gradient</span> <span class='mathgroup'>$</span> <span class='math'>\Delta</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>gradient</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>is</span> <span class='word'>less</span> <span class='word'>than</span> <span class='word'>1</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>loses</span> <span class='word'>information</span> <span class='word'>at</span> <span class='word'>all</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>shortened</span> <span class='word'>without</span> <span class='word'>loss</span> <span class='word'>of</span> <span class='word'>relevant</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>only</span> <span class='word'>further</span> <span class='word'>consideration</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>ensure</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>outside</span> <span class='word'>that</span> <span class='word'>range</span> <span class='word'>are</span> <span class='word'>prevented</span> <span class='word'>from</span> <span class='word'>causing</span> <span class='word'>errors</span> <span class='word'>associated</span> <span class='word'>with</span> <span class='word'>overflow</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>exclude</span> <span class='word'>this</span> <span class='word'>possibility</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>conditional</span> <span class='word'>statement</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>which</span> <span class='word'>checks</span> <span class='word'>the</span> <span class='word'>bounds</span> <span class='word'>as</span> <span class='word'>stated</span><span class='ignore'>,</span> <span class='word'>assigning</span> <span class='word'>an</span> <span class='word'>appropriate</span> <span class='word'>value</span> <span class='word'>as</span> <span class='word'>necessary</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>alternative</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>an</span> <span class='word'>intermediate</span> <span class='word'>value</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>higher</span> <span class='word'>bit</span> <span class='word'>depth</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>to</span> <span class='word'>recast</span> <span class='word'>into</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>in</span> <span class='word'>such</span> <span class='word'>a</span> <span class='word'>way</span> <span class='word'>that</span> <span class='word'>overflow</span> <span class='word'>and</span> <span class='word'>underflow</span> <span class='word'>are</span> <span class='word'>handled</span> <span class='word'>appropriately</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>OpenCV</span> <span class='word'>library</span> <span class='word'>provides</span> <span class='word'>a</span> <span class='word'>casting</span> <span class='word'>method</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='ignore'>"</span><span class='word'>saturateCast</span><span class='ignore'>"</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>which</span> <span class='word'>serves</span> <span class='word'>this</span> <span class='word'>purpose</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Setting</span> <span class='hword'>the</span> <span class='hword'>Value</span> <span class='hword'>for</span> <span class='hword'>the</span> <span class='hword'>Tolerance</span><span class='ignore'>}</span><br>
<span class='word'>Now</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>the</span> <span class='word'>working</span> <span class='word'>type</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>accounting</span> <span class='word'>for</span> <span class='word'>both</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>statistics</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>set</span> <span class='word'>a</span> <span class='word'>meaningful</span> <span class='word'>tolerance</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>error</span><span class='ignore'>.</span> <span class='word'>Previously</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>calculated</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>error</span> <span class='word'>would</span> <span class='word'>occur</span> <span class='word'>for</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>corners</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span><span class='ignore'>;</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>now</span> <span class='word'>seen</span> <span class='word'>that</span> <span class='word'>some</span> <span class='word'>values</span> <span class='word'>are</span> <span class='word'>more</span> <span class='word'>important</span> <span class='word'>than</span> <span class='word'>others</span> <span class='word'>and</span> <span class='word'>that</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>more</span> <span class='word'>meaningful</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>smaller</span> <span class='word'>RGB</span> <span class='word'>cube</span> <span class='word'>which</span> <span class='word'>encloses</span> <span class='word'>only</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>of</span> <span class='word'>interest</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>cube</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Discard</span><span class='mathgroup'>$</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>corners</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>space</span> <span class='word'>and</span> <span class='word'>rotating</span> <span class='word'>back</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>As</span> <span class='word'>this</span> <span class='word'>only</span> <span class='word'>needs</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>done</span> <span class='word'>once</span> <span class='word'>it</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>performed</span> <span class='word'>using</span> <span class='word'>floats</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>unit</span> <span class='word'>spaces</span><span class='ignore'>,</span> <span class='word'>however</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\discard</span><span class='mathgroup'>$</span> <span class='word'>account</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>discrete</span> <span class='word'>numerics</span> <span class='word'>in</span> <span class='word'>that</span> <span class='word'>they</span> <span class='word'>are</span> <span class='word'>calculated</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>discrete</span> <span class='word'>values</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Discard</span><span class='mathgroup'>$</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>values</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>\kappa</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='word'>Equations</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>DistributionConstants</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>newCompressionRatio</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='math'>\kappa</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>compression</span> <span class='word'>ratio</span> <span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>perform</span> <span class='word'>the</span> <span class='word'>inverse</span> <span class='word'>rotation</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>must</span> <span class='word'>be</span> <span class='word'>shifted</span> <span class='word'>to</span> <span class='word'>compensate</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>natural</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>which</span> <span class='word'>is</span><span class='ignore'>:</span> <span class='mathgroup'>$</span><span class='math'>\{</span><span class='math'>0</span><span class='math'>:</span><span class='math'>1</span><span class='math'>,</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='mathcmd'>\textonehalf</span><span class='ignore'>}</span><span class='math'>:</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='mathcmd'>\textonehalf</span><span class='ignore'>}</span><span class='math'>,</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='mathcmd'>\textonehalf</span><span class='ignore'>}</span><span class='math'>:</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='mathcmd'>\textonehalf</span><span class='ignore'>}</span><span class='math'>\}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\nR</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>1</span><span class='ignore'>}</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\Rc</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\Rc</span><span class='math'>=</span><span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span>&nbsp; &nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span>&nbsp; &nbsp;  <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='mathcmd'>\\</span><br>
<span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\R</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>T</span><span class='ignore'>}</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\nS</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\Rc</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>Because</span> <span class='word'>rotations</span> <span class='word'>of</span> <span class='word'>any</span> <span class='word'>angle</span> <span class='word'>are</span> <span class='word'>allowed</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>larger</span> <span class='word'>than</span> <span class='word'>those</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>values</span> <span class='word'>may</span> <span class='word'>also</span> <span class='word'>be</span> <span class='word'>outside</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span><span class='ignore'>,</span> <span class='word'>meaning</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>may</span> <span class='word'>have</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>truncated</span> <span class='word'>to</span> <span class='word'>fit</span> <span class='word'>inside</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span> <span class='word'>range</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>The</span> <span class='word'>perturbation</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>channel</span> <span class='word'>elements</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dW</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='word'>Equation</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>thePerturbationToTheRotatedChannelElements</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>for</span> <span class='word'>an</span> <span class='word'>input</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='mathgroup'>$</span><span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\dW</span>    <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\min</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>K</span> <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>.</span> <span class='math'>,</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>.</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>\}</span> <br>
 <span class='mathcmd'>\otimes</span> <br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span>   <span class='math'>2</span>&nbsp;  <span class='mathcmd'>\\</span>  <span class='math'>2</span>&nbsp; &nbsp; <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp; <span class='mathcmd'>\otimes</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\dqEO</span><span class='mathcmd'>\left</span><span class='math'>[</span>&nbsp;  <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>  <span class='mathcmd'>\\</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span>   <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='mathcmd'>\right</span><span class='math'>]</span><br>
 <span class='mathcmd'>\otimes</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span>  <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>We</span> <span class='word'>have</span> <span class='word'>previously</span> <span class='word'>solved</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>where</span> <span class='word'>both</span> <span class='word'>channels</span> <span class='word'>are</span> <span class='word'>of</span> <span class='word'>equal</span> <span class='word'>importance</span><span class='ignore'>;</span> <span class='word'>we</span> <span class='word'>now</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\alpha</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\beta</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>set</span> <span class='word'>the</span> <span class='word'>relative</span> <span class='word'>importance</span> <span class='word'>of</span> <span class='word'>each</span> <span class='word'>channel</span><span class='ignore'>.</span> <span class='word'>There</span> <span class='word'>are</span> <span class='word'>two</span> <span class='word'>factors</span> <span class='word'>here</span><span class='ignore'>:</span> <span class='word'>the</span> <span class='word'>channel</span> <span class='word'>scaling</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>new</span><span class='ignore'>,</span> <span class='word'>smaller</span> <span class='word'>RGB</span> <span class='word'>cube</span> <span class='word'>corners</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>values</span> <span class='word'>for</span> <span class='word'>these</span> <span class='word'>also</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>put</span> <span class='word'>in</span> <span class='word'>correct</span> <span class='word'>correspondence</span> <span class='word'>with</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='math'>a</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>b</span><span class='mathgroup'>$</span> <span class='word'>channel</span> <span class='word'>functions</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>the</span> <span class='word'>scaling</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>by</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span>   <span class='mathcmd'>\alpha</span><span class='math'>_</span><span class='math'>1</span>&nbsp;  <span class='mathcmd'>\\</span>  <span class='mathcmd'>\beta</span><span class='math'>_</span><span class='math'>1</span>&nbsp;  <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <br>
<span class='mathcmd'>\dqEO</span><span class='mathcmd'>\left</span><span class='math'>[</span>&nbsp; <span class='mathcmd'>\min</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>K</span> <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>.</span> <span class='math'>,</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>.</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>\}</span> <br>
 <span class='mathcmd'>\otimes</span> <br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span>   <span class='math'>2</span>&nbsp;  <span class='mathcmd'>\\</span>  <span class='math'>2</span>&nbsp; &nbsp; <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='mathcmd'>\right</span><span class='math'>]</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<span class='word'>For</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>RGB</span> <span class='word'>corners</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>largest</span> <span class='word'>element</span> <span class='word'>which</span> <span class='word'>can</span> <span class='word'>result</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>inner</span> <span class='word'>product</span> <span class='word'>with</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>As</span> <span class='word'>the</span> <span class='word'>elements</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span><span class='mathgroup'>$</span> <span class='word'>are</span> <span class='word'>in</span> <span class='mathgroup'>$</span><span class='math'>\{</span><span class='math'>-</span><span class='math'>1</span><span class='math'>,</span><span class='math'>0</span><span class='math'>,</span><span class='math'>1</span><span class='math'>\}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>with</span> <span class='word'>only</span> <span class='word'>one</span> <span class='word'>occurrence</span> <span class='word'>of</span> <span class='word'>each</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>and</span> <span class='word'>third</span> <span class='word'>rows</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>largest</span> <span class='word'>element</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>zero</span> <span class='word'>position</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>solves</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span>   <span class='mathcmd'>\alpha</span><span class='math'>_</span><span class='math'>2</span>&nbsp;  <span class='mathcmd'>\\</span>  <span class='mathcmd'>\beta</span><span class='math'>_</span><span class='math'>2</span>&nbsp;  <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <br>
<span class='mathcmd'>\dqEO</span><span class='mathcmd'>\left</span><span class='math'>[</span>&nbsp; <br>
<span class='mathcmd'>\max</span> <span class='mathcmd'>\left</span><span class='math'>\{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>abs</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span><span class='math'>)</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>^</span><span class='math'>T</span> <span class='mathcmd'>\right</span><span class='math'>\}</span><br>
<span class='mathcmd'>\right</span><span class='math'>]</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<span class='word'>where</span> <span class='mathgroup'>$</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>max</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>acts</span> <span class='word'>on</span> <span class='word'>each</span> <span class='word'>row</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>abs</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span><span class='math'>)</span>&nbsp; <span class='math'>=</span> <span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
<span class='word'>These</span> <span class='word'>then</span> <span class='word'>give</span> <span class='word'>a</span> <span class='word'>combined</span> <span class='word'>value</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>\alpha </span><span class='math'>=</span> <span class='mathcmd'>\alpha</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\alpha</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\beta </span><span class='math'>=</span> <span class='mathcmd'>\beta</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\beta</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>Because</span> <span class='word'>the</span> <span class='word'>axes</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>scaled</span> <span class='word'>so</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>kept</span><span class='ignore'>,</span> <span class='word'>at</span> <span class='word'>least</span><span class='ignore'>,</span> <span class='word'>near</span> <span class='word'>the</span> <span class='word'>mean</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>set</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='math'>\tau </span><span class='math'>=</span><span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>condition</span> <span class='word'>for</span> <span class='word'>accepting</span> <span class='word'>a</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='mathgroup'>$</span><span class='math'>1</span> <span class='math'>&gt;</span> <span class='math'>h</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>\iota</span><span class='math'>;</span> <span class='math'>\alpha</span><span class='math'>,</span><span class='math'>\beta</span><span class='math'>)</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>Complete</span> <span class='hword'>Algorithm</span><span class='ignore'>}</span><br>
<br>
<br>
<span class='word'>The</span> <span class='word'>programmer</span> <span class='word'>specifies</span> <span class='word'>a</span> <span class='word'>requested</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>values</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>means</span> <span class='mathgroup'>$</span><span class='mathcmd'>\uMean</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='math'>ab</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>standard</span> <span class='word'>deviations</span> <span class='mathgroup'>$</span><span class='mathcmd'>\uSTD</span><span class='ignore'>{</span> <span class='ignore'>{</span><span class='math'>ab</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>three</span> <span class='word'>axes</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>color-space</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>unit</span> <span class='word'>range</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>ranges</span> <span class='mathgroup'>$</span><span class='mathcmd'>\srcRange</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dstRange</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>then</span> <span class='word'>proceeds</span> <span class='word'>as</span> <span class='word'>follows</span><span class='ignore'>:</span><br>
<span class='cmd'>\newline</span><br>
<span class='cmd'>\algosection</span><span class='ignore'>{</span><span class='word'>Find</span> <span class='word'>the</span> <span class='word'>working</span> <span class='word'>type</span> <span class='word'>and</span> <span class='word'>range</span><span class='ignore'>.</span><span class='ignore'>}</span> <br>
<span class='word'>Using</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>constants</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>DistributionConstants</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>gradient</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>unit</span> <span class='word'>range</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>gradient</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>natural</span> <span class='word'>rotated</span> <span class='word'>axis</span> <span class='word'>lengths</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>L</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>:</span><br>
<br>
<span class='comment'>%\begin{tabular}{|c|c|c|c|}</span><br>
<span class='comment'>%\hline&nbsp; \LaTeX &amp; Mathematica &amp; MatLab &amp; C++ \\ </span><br>
<span class='comment'>%\hline&nbsp; &amp;&nbsp; &amp;&nbsp; &amp;&nbsp; \\ </span><br>
<span class='comment'>%\hline&nbsp; &amp;&nbsp; &amp;&nbsp; &amp;&nbsp; \\ </span><br>
<span class='comment'>%\hline&nbsp; &amp;&nbsp; &amp;&nbsp; &amp;&nbsp; \\ </span><br>
<span class='comment'>%\hline&nbsp; &amp;&nbsp; &amp;&nbsp; &amp;&nbsp; \\ </span><br>
<span class='comment'>%\hline&nbsp; &amp;&nbsp; &amp;&nbsp; &amp;&nbsp; \\ </span><br>
<span class='comment'>%\hline&nbsp; &amp;&nbsp; &amp;&nbsp; &amp;&nbsp; \\ </span><br>
<span class='comment'>%\hline&nbsp; &amp;&nbsp; &amp;&nbsp; &amp;&nbsp; \\ </span><br>
<span class='comment'>%\hline&nbsp; &amp;&nbsp; &amp;&nbsp; &amp;&nbsp; \\ </span><br>
<span class='comment'>%\hline </span><br>
<span class='comment'>%\end{tabular} </span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{gather*}</span><br>
 <span class='envir'>\begin</span><span class='envir'>{aligned}</span><br>
&nbsp;<span class='exclcmd'>\delta</span>  <span class='ignore'>&amp;</span><span class='ignore'>=</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span> <span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span> <span class='ignore'>\sigma </span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span>&nbsp; <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='ignore'>\Sigma</span><span class='ignore'>^</span><span class='ignore'>+</span><span class='ignore'>-</span><span class='ignore'>\Sigma</span><span class='ignore'>^</span><span class='ignore'>-</span><span class='exclcmd'>\right</span><span class='ignore'>)</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <br>
 <span class='ignore'>K</span> <span class='ignore'>&amp;</span> <span class='ignore'>=</span>&nbsp; <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='exclcmd'>\dstRange</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\srcRange</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>&amp;</span> <br>
 <span class='ignore'>\Sigma</span><span class='ignore'>^</span><span class='ignore'>-</span> <span class='ignore'>&amp;</span><span class='ignore'>=</span> <span class='exclcmd'>\text</span><span class='ignore'>{</span><span class='ignore'>erf</span><span class='ignore'>}</span><span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\mu -1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='ignore'>\sigma </span><span class='ignore'>}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span><br>
 <span class='ignore'>\Sigma</span><span class='ignore'>^</span><span class='ignore'>+</span> <span class='ignore'>&amp;</span><span class='ignore'>=</span> <span class='exclcmd'>\text</span><span class='ignore'>{</span><span class='ignore'>erf</span><span class='ignore'>}</span><span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='ignore'>\sigma </span><span class='ignore'>}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{aligned}</span><span class='cmd'>\\</span><br>
&nbsp;<span class='cmd'>\mathbf</span><span class='ignore'>{</span><span class='word'>L</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>\theta</span><span class='ignore'>)</span> <span class='ignore'>=</span><br>
&nbsp; <span class='envir'>\begin</span><span class='envir'>{pmatrix}</span><br>
&nbsp;<span class='cmd'>\sqrt</span><span class='ignore'>{</span><span class='word'>3</span><span class='ignore'>}</span> <span class='cmd'>\\</span><br>
&nbsp; <span class='cmd'>\sqrt</span><span class='ignore'>{</span><span class='cmd'>\frac</span><span class='ignore'>{</span><span class='word'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='word'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='cmd'>\sin</span> <span class='cmd'>\left</span><span class='ignore'>(</span><span class='cmd'>\widetilde</span><span class='ignore'>{</span><span class='cmd'>\vartheta</span><span class='ignore'>}</span><span class='cmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='cmd'>\sqrt</span><span class='ignore'>{</span><span class='word'>2</span><span class='ignore'>}</span> <span class='cmd'>\cos</span> <span class='cmd'>\left</span><span class='ignore'>(</span><span class='cmd'>\widetilde</span><span class='ignore'>{</span><span class='cmd'>\vartheta</span><span class='ignore'>}</span><span class='cmd'>\right</span><span class='ignore'>)</span> <span class='cmd'>\\</span>  <br>
&nbsp;<span class='cmd'>\sqrt</span><span class='ignore'>{</span><span class='cmd'>\frac</span><span class='ignore'>{</span><span class='word'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='word'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='cmd'>\sin</span> <span class='cmd'>\left</span><span class='ignore'>(</span><span class='cmd'>\widetilde</span><span class='ignore'>{</span><span class='word'>\theta</span><span class='ignore'>}</span><span class='cmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='cmd'>\sqrt</span><span class='ignore'>{</span><span class='word'>2</span><span class='ignore'>}</span> <span class='cmd'>\cos</span> <span class='cmd'>\left</span><span class='ignore'>(</span><span class='cmd'>\widetilde</span><span class='ignore'>{</span><span class='word'>\theta</span><span class='ignore'>}</span><span class='cmd'>\right</span><span class='ignore'>)</span> <br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{pmatrix}</span><br>
&nbsp; <span class='cmd'>\quad</span> <span class='cmd'>\text</span><span class='ignore'>{</span><span class='word'>where</span><span class='ignore'>}</span>&nbsp; <span class='cmd'>\quad</span> <br>
&nbsp;<span class='envir'>\begin</span><span class='envir'>{array}</span><span class='ignore'>{</span><span class='word'>c</span><span class='ignore'>}</span><br>
&nbsp; <span class='cmd'>\widetilde</span><span class='ignore'>{</span><span class='cmd'>\vartheta</span><span class='ignore'>}</span> <span class='ignore'>=</span> <span class='cmd'>\left</span><span class='ignore'>(</span><span class='word'>\theta </span><span class='ignore'>-</span> <span class='cmd'>\Pii</span><span class='ignore'>{</span><span class='word'>6</span><span class='ignore'>}</span><span class='cmd'>\right</span><span class='ignore'>)</span> <span class='cmd'>\bmod</span> <span class='cmd'>\frac</span><span class='ignore'>{</span><span class='word'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='word'>3</span><span class='ignore'>}</span> <span class='cmd'>\\</span><br>
&nbsp;<span class='cmd'>\widetilde</span><span class='ignore'>{</span><span class='word'>\theta</span><span class='ignore'>}</span> <span class='ignore'>=</span> <span class='word'>\theta&nbsp; </span><span class='cmd'>\bmod</span> <span class='cmd'>\frac</span><span class='ignore'>{</span><span class='word'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='word'>3</span><span class='ignore'>}</span> <br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{gather*}</span><br>
<span class='word'>The</span> <span class='word'>length</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='mathgroup'>$</span> <span class='word'>after</span> <span class='word'>rescaling</span> <span class='word'>is</span> <span class='word'>given</span> <span class='word'>by</span> <span class='word'>Equation</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>CombinedRotationRange</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>limits</span> <span class='word'>are</span> <span class='word'>easily</span> <span class='word'>found</span> <span class='word'>along</span> <span class='word'>with</span> <br>
<span class='word'>the</span> <span class='word'>compression</span> <span class='word'>ratio</span> <span class='mathgroup'>$</span><span class='math'>\kappa</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='word'>Equation</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>newCompressionRatio</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<span class='envir'>\begin</span><span class='envir'>{gather*}</span><br>
<span class='envir'>\begin</span><span class='envir'>{aligned}</span><br>
 <span class='exclcmd'>\tRange</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='ignore'>\mu</span><span class='ignore'>,</span><span class='ignore'>\sigma</span><span class='ignore'>)</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>=</span>&nbsp; <span class='exclcmd'>\min</span><span class='exclcmd'>\left</span><span class='ignore'>\{</span><span class='ignore'>K</span> <span class='ignore'>\delta</span><span class='ignore'>(</span><span class='ignore'>\mu</span><span class='ignore'>,</span><span class='ignore'>\sigma</span><span class='ignore'>)</span> <span class='exclcmd'>\right</span><span class='ignore'>.</span> <span class='ignore'>,</span>&nbsp; <span class='exclcmd'>\left</span><span class='ignore'>.</span> <span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>L</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>)</span> <span class='exclcmd'>\right</span><span class='ignore'>\}</span>&nbsp; <span class='exclcmd'>\srcRange</span> <span class='exclcmd'>\quad</span><span class='ignore'>&amp;</span><span class='exclcmd'>\quad</span><br>
 <span class='ignore'>\kappa</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='ignore'>=</span> <span class='exclcmd'>\max</span><span class='exclcmd'>\left</span><span class='ignore'>\{</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\delta</span><span class='ignore'>(</span><span class='ignore'>\mu</span><span class='ignore'>,</span><span class='ignore'>\sigma</span><span class='ignore'>)</span> <span class='ignore'>}</span>&nbsp;  <span class='ignore'>,</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>K</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>L</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>)</span><span class='ignore'>}</span> <span class='exclcmd'>\right</span><span class='ignore'>\}</span>&nbsp; <br>
 <span class='envir'>\end</span><span class='envir'>{aligned}</span><span class='cmd'>\\</span><br>
 <span class='envir'>\begin</span><span class='envir'>{aligned}</span><br>
&nbsp;<span class='exclcmd'>\tMin</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='ignore'>\mu</span><span class='ignore'>,</span><span class='ignore'>\sigma</span><span class='ignore'>)</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>=</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
 <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
&nbsp;<span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='exclcmd'>\tRange</span><span class='ignore'>_</span><span class='ignore'>2</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='exclcmd'>\mu</span><span class='ignore'>_</span><span class='ignore'>2</span><span class='ignore'>,</span><span class='exclcmd'>\sigma</span><span class='ignore'>_</span><span class='ignore'>2</span><span class='ignore'>)</span> <span class='exclcmd'>\\</span>  <br>
&nbsp;<span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='exclcmd'>\tRange</span><span class='ignore'>_</span><span class='ignore'>3</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='exclcmd'>\mu</span><span class='ignore'>_</span><span class='ignore'>3</span><span class='ignore'>,</span><span class='exclcmd'>\sigma</span><span class='ignore'>_</span><span class='ignore'>3</span><span class='ignore'>)</span> <span class='exclcmd'>\\</span>  <br>
 <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='exclcmd'>\quad</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\quad</span><br>
&nbsp;<span class='exclcmd'>\tMax</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='ignore'>\mu</span><span class='ignore'>,</span><span class='ignore'>\sigma</span><span class='ignore'>)</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>=</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp;<span class='exclcmd'>\tRange</span><span class='ignore'>_</span><span class='ignore'>1</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='exclcmd'>\mu</span><span class='ignore'>_</span><span class='ignore'>1</span><span class='ignore'>,</span><span class='exclcmd'>\sigma</span><span class='ignore'>_</span><span class='ignore'>1</span><span class='ignore'>)</span>&nbsp; <span class='exclcmd'>\\</span><br>
&nbsp;<span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>1</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='exclcmd'>\tRange</span><span class='ignore'>_</span><span class='ignore'>2</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='exclcmd'>\mu</span><span class='ignore'>_</span><span class='ignore'>2</span><span class='ignore'>,</span><span class='exclcmd'>\sigma</span><span class='ignore'>_</span><span class='ignore'>2</span><span class='ignore'>)</span>&nbsp; <span class='exclcmd'>\\</span>  <br>
&nbsp;<span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>1</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='exclcmd'>\tRange</span><span class='ignore'>_</span><span class='ignore'>3</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='exclcmd'>\mu</span><span class='ignore'>_</span><span class='ignore'>3</span><span class='ignore'>,</span><span class='exclcmd'>\sigma</span><span class='ignore'>_</span><span class='ignore'>3</span><span class='ignore'>)</span>&nbsp; <span class='exclcmd'>\\</span>  <br>
 <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
 <span class='envir'>\end</span><span class='envir'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{gather*}</span><br>
<br>
<br>
<span class='cmd'>\algosection</span><span class='ignore'>{</span><span class='word'>Set</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>region</span> <span class='word'>boundary</span> <span class='word'>constants</span><span class='ignore'>.</span><span class='ignore'>}</span> <br>
<span class='word'>Using</span> <span class='word'>the</span> <span class='word'>constants</span> <span class='word'>defined</span> <span class='word'>in</span> <span class='word'>Equations</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>PreservedRegionConsts</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>0to1</span><span class='ignore'>}</span><br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
&nbsp;<span class='math'>w</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>=</span>&nbsp; <span class='math'>\sigma&nbsp; </span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span> <span class='mathcmd'>\log</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>-</span><span class='math'>2</span> <span class='mathcmd'>\log</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\kappa \sigma&nbsp; </span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>+</span><span class='math'>-</span><span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>-</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='ignore'>}</span> <span class='math'>&amp;</span><br>
&nbsp; <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\dstRange</span><span class='ignore'>}</span> <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<span class='word'>We</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>boundaries</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>unit</span> <span class='word'>range</span> <br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
<span class='exclcmd'>\discard</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>\sigma </span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>1</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>(</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>+</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span> <span class='mathcmd'>\;</span> <span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>-</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>+</span><span class='math'>\mu&nbsp; </span><span class='math'>&amp;</span>&nbsp; &nbsp; &nbsp;  <br>
<span class='mathcmd'>\keep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>\mu </span><span class='math'>-</span> <span class='math'>w</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\\</span>     <br>
<span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>\sigma </span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>1</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>(</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>-</span> <span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span> <span class='mathcmd'>\;</span> <span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>+</span> <span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>+</span><span class='math'>\mu </span><span class='math'>&amp;</span><br>
<span class='mathcmd'>\keep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>\mu </span><span class='math'>+</span> <span class='math'>w</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<span class='word'>and</span> <span class='word'>the</span> <span class='word'>boundaries</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>working</span> <span class='word'>range</span><br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
<span class='exclcmd'>\Discard</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\tMin</span> <span class='math'>+</span> <span class='mathcmd'>\tRange</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\discard</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <br>
<span class='mathcmd'>\Keep</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\tMin</span> <span class='math'>+</span> <span class='mathcmd'>\tRange</span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\keep</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<span class='word'>The</span> <span class='word'>extended</span> <span class='word'>region</span> <span class='word'>in</span> <span class='word'>which</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>kept</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>numerically</span> <span class='word'>solving</span> <span class='word'>the</span> <span class='word'>defining</span> <span class='word'>equations</span> <span class='word'>for</span> <span class='word'>the</span>&nbsp; <span class='word'>extended</span> <span class='word'>boundaries</span> <span class='mathgroup'>$</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='word'>Equation</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>theExtendedBoundaries</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>practical</span> <span class='word'>introduction</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>parameter</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span> <span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>extends</span> <span class='word'>the</span> <span class='word'>acceptable</span> <span class='word'>deviation</span> <span class='word'>from</span> <span class='word'>linearity</span><span class='ignore'>.</span> <span class='word'>So</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span> <span class='math'>=</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>would</span> <span class='word'>allow</span> <span class='word'>1</span> <span class='word'>discarded</span> <span class='word'>piece</span> <span class='word'>of</span> <span class='word'>information</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>extended</span> <span class='word'>region</span><span class='ignore'>.</span><br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
<span class='exclcmd'>\left</span><span class='mathcmd'>\lceil</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>1</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='mathcmd'>\rceil</span><span class='math'>-</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>=</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span> <span class='math'>_</span><span class='math'>1</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span> <span class='mathcmd'>\eKeep</span> <span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span><br>
<span class='mathcmd'>\left</span><span class='mathcmd'>\lfloor</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>2</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='mathcmd'>\rfloor</span><span class='math'>-</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>=</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span> <span class='math'>_</span><span class='math'>2</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span> <span class='mathcmd'>\eKeep</span> <span class='math'>_</span><span class='math'>2</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<span class='word'>The</span> <span class='word'>C</span><span class='ignore'>+</span><span class='ignore'>+</span> <span class='word'>code</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>algorithm</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{algorithm}</span><span class='option'>[H]</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{algorithmic}</span><br>
 <span class='exclcmd'>\Require</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>2</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>starting</span> <span class='ignore'>point</span> <span class='ignore'>for</span> <span class='ignore'>the</span> <span class='ignore'>linear</span> <span class='ignore'>walk</span> <span class='ignore'>}</span> <br>
 <span class='exclcmd'>\linebreak</span> <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Require</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>acceptable</span> <span class='ignore'>divergence</span> <span class='ignore'>from</span> <span class='ignore'>linearity</span> <br>
 <span class='exclcmd'>\Ensure</span><span class='ignore'>{</span><span class='exclmath'>$</span> <span class='math'>\{</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>,</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>\}</span> <span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>extended</span> <span class='ignore'>boundaries</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\State</span> <span class='exclmath'>$</span><span class='math'>x</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\Keep</span><span class='math'>_</span><span class='math'>2</span><span class='exclmath'>$</span>&nbsp; <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>dis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span><span class='exclmath'>$</span> <span class='ignore'>is</span> <span class='ignore'>the</span> <span class='ignore'>distribution</span> <span class='ignore'>function</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\While</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>dis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='math'>&gt;</span> <span class='math'>x</span> <span class='math'>+</span> <span class='mathcmd'>\left</span><span class='mathcmd'>\lfloor</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>2</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='mathcmd'>\rfloor</span>  <span class='math'>-</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>}</span><br>
&nbsp; &nbsp;  <span class='exclcmd'>\State</span>  <span class='ignore'>x</span><span class='ignore'>+</span><span class='ignore'>+</span> <br>
 <span class='exclcmd'>\EndWhile</span><br>
 <span class='exclcmd'>\State</span> <span class='exclmath'>$</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\gets</span> <span class='math'>x</span><span class='exclmath'>$</span> <br>
 <span class='exclcmd'>\State</span> <span class='exclmath'>$</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>1</span> <span class='math'>-</span> <span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>2</span><span class='math'>)</span><span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Exploiting</span> <span class='ignore'>a</span> <span class='ignore'>symetry</span> <span class='ignore'>dis</span><span class='ignore'>(</span><span class='ignore'>x</span><span class='ignore'>)</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\State</span> <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>Return</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='exclmath'>$</span> <span class='ignore'>,</span><span class='exclmath'>$</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='exclmath'>$</span> <span class='ignore'>}</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;<span class='exclcmd'>\caption</span><span class='ignore'>{</span><span class='ignore'>Finding</span> <span class='ignore'>the</span> <span class='ignore'>extended</span> <span class='ignore'>region</span> <span class='ignore'>in</span> <span class='ignore'>which</span> <span class='ignore'>all</span> <span class='ignore'>the</span> <span class='ignore'>information</span> <span class='ignore'>is</span> <span class='ignore'>kept</span> <span class='ignore'>in</span> <span class='ignore'>C</span><span class='ignore'>+</span><span class='ignore'>+</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{algorithm}</span><br>
<br>
<span class='word'>The</span> <span class='word'>unit</span> <span class='word'>range</span> <span class='word'>boundaries</span> <span class='mathgroup'>$</span><span class='mathcmd'>\ekeep</span><span class='mathgroup'>$</span> <span class='word'>are</span> <span class='word'>found</span> <span class='word'>using</span>&nbsp; <span class='mathgroup'>$</span><span class='mathcmd'>\ekeep</span> <span class='math'>=</span>&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\eKeep</span> <span class='math'>-</span> <span class='mathcmd'>\tMin</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\tRange</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='cmd'>\algosection</span><span class='ignore'>{</span><span class='word'>Suggest</span> <span class='word'>a</span> <span class='word'>new</span> <span class='word'>value</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span><span class='ignore'>.</span><span class='ignore'>}</span> <br>
<span class='word'>First</span> <span class='word'>we</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>scaling</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>perturbationFunctionSigns</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>function</span> <span class='word'>ordering</span> <span class='word'>function</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>abPerturbationFunctionOrdering</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<span class='envir'>\begin</span><span class='envir'>{gather}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>abPerturbationFunctionOrdering</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\dqEO</span><span class='ignore'>[</span>&nbsp; <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>0</span>&nbsp;  <span class='exclcmd'>\\</span><br>
 <span class='ignore'>a</span>&nbsp;  <span class='exclcmd'>\\</span><br>
 <span class='ignore'>b</span>&nbsp; <span class='exclcmd'>\\</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span>&nbsp; <span class='ignore'>,</span><span class='ignore'>\theta </span><span class='ignore'>]</span> <span class='ignore'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>a</span>&nbsp; <span class='exclcmd'>\\</span><br>
 <span class='ignore'>b</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span><span class='exclcmd'>\leq</span> <span class='ignore'>(</span><span class='ignore'>\theta&nbsp; </span><span class='exclcmd'>\bmod</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='ignore'>)</span><span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>b</span>&nbsp; <span class='exclcmd'>\\</span><br>
 <span class='ignore'>a</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='exclcmd'>\leq</span> <span class='ignore'>(</span><span class='ignore'>\theta&nbsp; </span><span class='exclcmd'>\bmod</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='ignore'>)</span> <span class='ignore'>&lt;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\dqs</span><span class='option'>[\theta]</span> <span class='ignore'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span><span class='exclcmd'>\leq</span> <span class='ignore'>(</span><span class='ignore'>\theta&nbsp; </span><span class='exclcmd'>\bmod</span> <span class='ignore'>\pi </span><span class='ignore'>)</span><span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='exclcmd'>\leq</span> <span class='ignore'>(</span><span class='ignore'>\theta&nbsp; </span><span class='exclcmd'>\bmod</span> <span class='ignore'>\pi </span><span class='ignore'>)</span><span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span><span class='exclcmd'>\leq</span> <span class='ignore'>(</span><span class='ignore'>\theta&nbsp; </span><span class='exclcmd'>\bmod</span> <span class='ignore'>\pi </span><span class='ignore'>)</span><span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='exclcmd'>\leq</span> <span class='ignore'>(</span><span class='ignore'>\theta&nbsp; </span><span class='exclcmd'>\bmod</span> <span class='ignore'>\pi </span><span class='ignore'>)</span><span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>2</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>2</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span><span class='exclcmd'>\leq</span> <span class='ignore'>(</span><span class='ignore'>\theta&nbsp; </span><span class='exclcmd'>\bmod</span> <span class='ignore'>\pi </span><span class='ignore'>)</span><span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>5</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>5</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='exclcmd'>\leq</span> <span class='ignore'>(</span><span class='ignore'>\theta&nbsp; </span><span class='exclcmd'>\bmod</span> <span class='ignore'>\pi </span><span class='ignore'>)</span><span class='ignore'>&lt;</span><span class='ignore'>\pi 
</span><span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='envir'>\end</span><span class='envir'>{gather}</span><br>
<span class='word'>In</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>set</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>scaling</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='mathgroup'>$</span><span class='math'>\alpha</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\beta</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>absolute</span> <span class='word'>value</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>matrix</span> <span class='word'>sign</span> <span class='mathgroup'>$</span><span class='mathcmd'>\left</span><span class='mathcmd'>\lVert</span> <span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span> <span class='mathcmd'>\right</span><span class='mathcmd'>\rVert</span><span class='mathgroup'>$</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>written</span> <span class='word'>in</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>single</span> <span class='word'>row</span> <span class='word'>vector</span> <span class='word'>function</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqas</span><span class='option'>[\theta]</span><span class='mathgroup'>$</span> <br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\left</span><span class='mathcmd'>\lVert</span> <span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span> <span class='mathcmd'>\right</span><span class='mathcmd'>\rVert</span> <span class='math'>&amp;</span> <span class='math'>=</span> <br>
<span class='mathcmd'>\left</span><span class='math'>(</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>0</span><span class='math'>&amp;</span><span class='math'>0</span><span class='math'>&amp;</span><span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span>   <span class='mathcmd'>\cdots</span> <span class='math'>&amp;</span> <span class='mathcmd'>\dqas</span><span class='option'>[\theta + \frac{\pi}{2}]</span> <span class='math'>&amp;</span> <span class='mathcmd'>\cdots</span>   <span class='mathcmd'>\\</span>  <span class='mathcmd'>\cdots</span> <span class='math'>&amp;</span> <span class='mathcmd'>\dqas</span><span class='option'>[\theta]</span>   <span class='math'>&amp;</span> <span class='mathcmd'>\cdots</span>  <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='math'>&amp;</span><br>
<span class='mathcmd'>\dqas</span><span class='option'>[\theta]</span> <span class='math'>&amp;</span><span class='math'>=</span><span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
<span class='mathcmd'>\left</span><span class='math'>(</span><span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>&amp;</span>&nbsp; <span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\leq</span> <span class='mathcmd'>\scalebox</span><span class='ignore'>{</span><span class='math'>0.75</span><span class='ignore'>}</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='math'>(</span><span class='math'>\theta </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='exclmath'>$</span> <span class='ignore'>}</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span>&nbsp;  <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\left</span><span class='math'>(</span><span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span>&nbsp;  <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='mathcmd'>\scalebox</span><span class='ignore'>{</span><span class='math'>0.75</span><span class='ignore'>}</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='math'>(</span><span class='math'>\theta </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='exclmath'>$</span> <span class='ignore'>}</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\left</span><span class='math'>(</span><span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='mathcmd'>\scalebox</span><span class='ignore'>{</span><span class='math'>0.75</span><span class='ignore'>}</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='math'>(</span><span class='math'>\theta </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='exclmath'>$</span> <span class='ignore'>}</span><span class='math'>&lt;</span><span class='math'>\pi&nbsp; </span><span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<span class='word'>Then</span> <span class='word'>we</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>at</span> <span class='word'>which</span> <span class='word'>loss</span> <span class='word'>of</span> <span class='word'>information</span> <span class='word'>does</span> <span class='word'>not</span> <span class='word'>matter</span> <span class='word'>in</span> <span class='word'>RGB</span> <span class='word'>space</span> <span class='mathgroup'>$</span><span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\max</span> <span class='mathcmd'>\left</span><span class='math'>\{</span> <br>
&nbsp; <span class='mathcmd'>\R</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>T</span><span class='ignore'>}</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\nS</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\Rc</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>,</span> <br>
&nbsp; <span class='mathcmd'>\R</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>T</span><span class='ignore'>}</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\nS</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\Rc</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='math'>&amp;</span><br>
 <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\Rc</span><span class='math'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span>&nbsp; &nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span>&nbsp; &nbsp;  <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>Then</span> <span class='word'>we</span> <span class='word'>numerically</span> <span class='word'>find</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span>   <span class='math'>\alpha&nbsp;  </span><span class='mathcmd'>\\</span>  <span class='math'>\beta&nbsp;  </span><span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='comment'>% &amp;=&nbsp; </span><br>
<span class='comment'>%\dqEO\left[&nbsp; \min\left\{K \delta(\mu,\sigma) \right. ,&nbsp; \left. \mathbf{L}(\theta) \right\} </span><br>
<span class='comment'>% \otimes </span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; \begin{pmatrix}&nbsp; 0&nbsp;  \\&nbsp;  2&nbsp;  \\&nbsp; 2&nbsp; &nbsp; \\ \end{pmatrix} </span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp;  \otimes </span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; \max \left\{\text{abs}(\dqs[\theta]) \otimes \left(\discard^{RGB}_2 \right)^T \right\}</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; \right]\\</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>&amp;</span><span class='math'>=</span><span class='mathcmd'>\dqEO</span><span class='mathcmd'>\left</span><span class='math'>[</span> <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp; <span class='math'>0</span> <span class='mathcmd'>\\</span> <br>
&nbsp;&nbsp;&nbsp;&nbsp; <span class='math'>2</span> <span class='mathcmd'>\min</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>K</span> <span class='math'>\delta</span><span class='math'>(</span><span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>2</span><span class='math'>,</span><span class='mathcmd'>\sigma</span><span class='math'>_</span><span class='math'>2</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>.</span> <span class='math'>,</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>.</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='mathcmd'>\max</span> <span class='mathcmd'>\left</span><span class='math'>\{</span><span class='mathcmd'>\dqas</span><span class='option'>[\theta + \frac{\pi}{2}]</span>  <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>^</span><span class='math'>T</span> <span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp; <span class='math'>2</span> <span class='mathcmd'>\min</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>K</span> <span class='math'>\delta</span><span class='math'>(</span><span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>3</span><span class='math'>,</span><span class='mathcmd'>\sigma</span><span class='math'>_</span><span class='math'>3</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>.</span> <span class='math'>,</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>.</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>3</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='mathcmd'>\max</span> <span class='mathcmd'>\left</span><span class='math'>\{</span><span class='mathcmd'>\dqas</span><span class='option'>[\theta&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\discard</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>^</span><span class='math'>T</span> <span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp;  <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='mathcmd'>\right</span><span class='math'>]</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>then</span> <span class='word'>finds</span> <span class='word'>a</span> <span class='word'>starting</span> <span class='word'>value</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>index</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>indexFromTheta</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>and</span> <span class='word'>returns</span> <span class='word'>the</span> <span class='word'>closest</span> <span class='word'>value</span> <span class='word'>which</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>generalizedPerturbation</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>:</span><br>
<br>
<span class='comment'>%\setlength{\belowdisplayskip}{0pt} \setlength{\belowdisplayshortskip}{0pt}</span><br>
<span class='comment'>%\setlength{\abovedisplayskip}{0pt} \setlength{\abovedisplayshortskip}{0pt}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
 <span class='math'>i</span><span class='math'>(</span><span class='math'>\delta\theta</span><span class='math'>,</span> <span class='math'>n</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\meanIndx</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\delta \theta </span><span class='math'>)</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\delta \theta </span><span class='math'>)</span><span class='math'>+</span><span class='math'>7</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\delta \theta </span><span class='math'>)</span><span class='math'>+</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>&amp;</span><br>
&nbsp; <span class='math'>\delta\theta </span><span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>\theta </span><span class='mathcmd'>\mod</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='math'>&amp;</span><br>
&nbsp; <span class='mathcmd'>\meanIndx</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span> <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>region</span> <span class='mathgroup'>$</span><span class='math'>\iota</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>appropriate</span> <span class='word'>values</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>extremaBounds</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>extrema</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>ExtremaFunctions</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>are</span> <span class='word'>evaluated</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>function</span> <span class='word'>which</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>index</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>generalizedPerturbation</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>intercept</span> <span class='word'>position</span> <span class='mathgroup'>$</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>with</span> <span class='word'>algorithm</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>thetaX</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<span class='comment'>%\begin{gather*}</span><br>
<span class='comment'>%\begin{aligned}</span><br>
<span class='comment'>% \iota(i,n)&nbsp; &amp;= \left\lfloor 7\ \meanIndx-\sqrt{i^2 - 2 i \; \meanIndx + 49\ \meanIndx^2 }\right\rfloor &amp;</span><br>
<span class='comment'>%&nbsp; \extremaTheta{a} {l} = &amp; \arctan\left(\frac{l \sqrt{3} }{2^n - l}\right) &amp;</span><br>
<span class='comment'>%&nbsp; \extremaTheta{b} {l} = &amp; \arctan\left(\frac{l \; 2^{2-n}}{\sqrt{3}}&nbsp; &nbsp; &nbsp;  \right)</span><br>
<span class='comment'>%\end{aligned} \\</span><br>
<span class='comment'>%\begin{aligned}</span><br>
<span class='comment'>% \minimaTheta{a}&nbsp; &amp;= \extremaTheta{a}{i+\iota} &amp;</span><br>
<span class='comment'>% \maximaTheta{b} &amp;= \extremaTheta{b}{i-\iota-1} &amp; </span><br>
<span class='comment'>% \minimaTheta{b}&nbsp; &amp;= \extremaTheta{b}{i-\iota}&nbsp; &amp;</span><br>
<span class='comment'>% \maximaTheta{a} &amp;= \extremaTheta{a}{i+\iota+1}&nbsp; &amp;</span><br>
<span class='comment'>%&nbsp; \text{when} \quad </span><br>
<span class='comment'>%i + \iota &amp;\in \{2 \mathbb{N}&nbsp; &nbsp;  \} \\</span><br>
<span class='comment'>% \maximaTheta{a}&nbsp; &amp;= \extremaTheta{a}{i+\iota} &amp; </span><br>
<span class='comment'>% \minimaTheta{b}&nbsp; &amp;= \extremaTheta{b} {i-\iota-1} &amp;</span><br>
<span class='comment'>% \maximaTheta{b} &amp;= \extremaTheta{b}{i-\iota}&nbsp; &amp;</span><br>
<span class='comment'>% \minimaTheta{a}&nbsp; &amp;= \extremaTheta{a}{i+\iota+1}&nbsp; &amp; </span><br>
<span class='comment'>%\text{when} \quad </span><br>
<span class='comment'>%i + \iota &amp;\in \{2 \mathbb{N}&nbsp; + 1 \} </span><br>
<span class='comment'>%\end{aligned}\\</span><br>
<span class='comment'>%\thetaX{i} = \left\{\frac{</span><br>
<span class='comment'>%\beta \minimaTheta{b} (\minimaTheta{a}&nbsp; -\maximaTheta{a} )+\alpha&nbsp; \minimaTheta{a} (\maximaTheta{b}-\minimaTheta{b})&nbsp; }{</span><br>
<span class='comment'>%\beta&nbsp; (\minimaTheta{a} -\maximaTheta{a})+\alpha&nbsp; (\maximaTheta{b}-\minimaTheta{b})</span><br>
<span class='comment'>%},\frac{</span><br>
<span class='comment'>%\alpha&nbsp; \beta&nbsp; (\minimaTheta{a}-\minimaTheta{b})&nbsp; }{</span><br>
<span class='comment'>%\beta&nbsp; (\minimaTheta{a}-\maximaTheta{a})+\alpha&nbsp; (\maximaTheta{b}-\minimaTheta{b})</span><br>
<span class='comment'>%}\right\}</span><br>
<span class='comment'>%\end{gather*}</span><br>
<br>
 <span class='envir'>\begin</span><span class='envir'>{algorithm}</span><span class='option'>[h]</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\Function</span> <span class='ignore'>{</span> <span class='exclmath'>$</span><span class='mathcmd'>\overset</span><span class='ignore'>{</span><span class='mathcmd'>\times</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\phi</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span> <span class='math'>i</span><span class='math'>,</span> <span class='math'>\alpha</span><span class='math'>,</span> <span class='math'>\beta</span><span class='math'>,</span> <span class='math'>n</span> <span class='exclmath'>$</span><span class='ignore'>}</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>i</span><span class='exclmath'>$</span> <span class='ignore'>integer</span> <span class='ignore'>index</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>intercept</span> <span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span> <span class='exclmath'>$</span><span class='mathcmd'>\meanIndx</span> <span class='mathcmd'>\gets</span>  <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='exclmath'>$</span>&nbsp; <span class='ignore'>;</span> <span class='exclcmd'>\quad</span>  <span class='exclmath'>$</span><span class='math'>\iota</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>n</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\gets</span>  <span class='mathcmd'>\left</span><span class='mathcmd'>\lfloor</span> <span class='math'>7</span><span class='mathcmd'>\ </span><span class='mathcmd'>\meanIndx</span><span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>^</span><span class='math'>2</span> <span class='math'>-</span> <span class='math'>2</span> <span class='math'>i</span> <span class='mathcmd'>\meanIndx</span> <span class='math'>+</span> <span class='math'>49</span><span class='mathcmd'>\ </span><span class='mathcmd'>\meanIndx</span><span class='math'>^</span><span class='math'>2</span> <span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='mathcmd'>\rfloor</span> <span class='exclmath'>$</span>&nbsp; <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>n</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>source</span> <span class='ignore'>bit</span> <span class='ignore'>depth</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\State</span> <span class='exclmath'>$</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2-n</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\right</span><span class='math'>)</span><span class='exclmath'>$</span> <span class='ignore'>;</span> <span class='exclcmd'>\quad</span> <br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclmath'>$</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='math'>-</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\If</span><span class='ignore'>{</span><span class='exclmath'>$</span> <span class='math'>i</span> <span class='math'>+</span> <span class='math'>\iota </span><span class='mathcmd'>\bmod</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>0</span><span class='exclmath'>$</span><span class='ignore'>}</span>&nbsp; <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>i</span> <span class='math'>+</span> <span class='math'>\iota</span><span class='exclmath'>$</span> <span class='ignore'>is</span> <span class='ignore'>even</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span>   <span class='exclmath'>$</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='exclmath'>$</span> <span class='ignore'>;</span><span class='exclcmd'>\quad</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span>   <span class='exclmath'>$</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-\iota-1</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='ignore'>;</span><span class='exclcmd'>\quad</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-\iota</span><span class='ignore'>}</span>&nbsp; <span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\Else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='ignore'>;</span><span class='exclcmd'>\quad</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='exclmath'>$</span> <span class='exclcmd'>\;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-\iota</span><span class='ignore'>}</span>&nbsp; <span class='exclmath'>$</span> <span class='ignore'>;</span><span class='exclcmd'>\quad</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-\iota-1</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='exclcmd'>\;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclcmd'>\EndIf</span><br>
&nbsp;&nbsp;&nbsp; <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\left</span><span class='math'>\{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>\beta </span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span>&nbsp; <span class='math'>-</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>)</span><span class='math'>+</span><span class='math'>\alpha&nbsp; </span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='ignore'>}</span><span class='ignore'>{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>\beta&nbsp; </span><span class='math'>(</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>-</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>)</span><span class='math'>+</span><span class='math'>\alpha&nbsp; </span><span class='math'>(</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>}</span><span class='math'>,</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>\alpha&nbsp; \beta&nbsp; </span><span class='math'>(</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='ignore'>}</span><span class='ignore'>{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>\beta&nbsp; </span><span class='math'>(</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>)</span><span class='math'>+</span><span class='math'>\alpha&nbsp; </span><span class='math'>(</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='exclmath'>$</span> <span class='exclcmd'>\;</span><br>
&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\State</span> <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>Return</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>}</span><span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='ignore'>\{</span><span class='ignore'>angle</span><span class='ignore'>,</span>&nbsp; <span class='ignore'>maximum</span> <span class='ignore'>perturbation</span><span class='ignore'>\}</span> <span class='ignore'>}</span><br>
<span class='exclcmd'>\EndFunction</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\caption</span><span class='ignore'>{</span><span class='ignore'>A</span> <span class='ignore'>function</span> <span class='ignore'>which</span> <span class='ignore'>returns</span> <span class='ignore'>the</span> <span class='ignore'>angular</span> <span class='ignore'>position</span> <span class='ignore'>of</span> <span class='ignore'>compromise</span> <span class='ignore'>between</span> <span class='ignore'>the</span> <span class='ignore'>perturbations</span> <span class='ignore'>to</span> <span class='ignore'>the</span> <span class='ignore'>channels</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>thetaX</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{algorithm}</span><br>
<span class='comment'>%the angular position of the intercept and the maximum perturbation at that value</span><br>
<br>
<span class='word'>To</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>angular</span> <span class='word'>value</span> <span class='word'>closest</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>produces</span> <span class='word'>a</span> <span class='word'>perturbation</span> <span class='word'>less</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='mathgroup'>$</span><span class='math'>\tau</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>algorithm</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>newTheta</span><span class='ignore'>}</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>closest</span> <span class='word'>value</span> <span class='word'>which</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>positive</span> <span class='word'>and</span> <span class='word'>negative</span> <span class='word'>directions</span> <span class='word'>and</span> <span class='word'>returns</span> <span class='word'>the</span> <span class='word'>nearest</span> <span class='word'>one</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>requested</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>Algorithm</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>newTheta</span><span class='ignore'>}</span> <span class='word'>is</span> <span class='word'>guaranteed</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>a</span> <span class='word'>value</span> <span class='word'>which</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='word'>in</span> <span class='word'>each</span> <span class='word'>direction</span> <span class='word'>within</span> <span class='word'>a</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>region</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>is</span> <span class='word'>zero</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>ends</span> <span class='word'>of</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>region</span><span class='ignore'>.</span><br>
 <br>
<span class='envir'>\begin</span><span class='envir'>{algorithm}</span><span class='option'>[H]</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;<span class='exclcmd'>\Require</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='math'>\alpha</span><span class='exclmath'>$</span><span class='ignore'>,</span> <span class='exclmath'>$</span><span class='math'>\beta</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>relative</span> <span class='ignore'>importance</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>channels</span><span class='ignore'>}</span><br>
&nbsp; <span class='exclcmd'>\State</span> <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Require</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>{</span> <span class='exclmath'>$</span><span class='math'>\theta</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>requested</span> <span class='ignore'>angle</span><span class='ignore'>;</span> <span class='exclcmd'>\quad</span> <span class='exclcmd'>\quad</span> <span class='exclmath'>$</span><span class='math'>\tau</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>tolerance</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\Ensure</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='mathcmd'>\vartheta</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>suggested</span> <span class='ignore'>value</span> <span class='ignore'>for</span> <span class='exclmath'>$</span><span class='math'>\theta</span><span class='exclmath'>$</span> <span class='ignore'>and</span>&nbsp; <span class='exclmath'>$</span><span class='math'>h</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>predicted</span> <span class='ignore'>maximum</span> <span class='ignore'>perturbation</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\State</span>  <span class='exclenv'>\begin</span><span class='exclenv'>{tabular*}</span><span class='ignore'>{</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>c</span> <span class='ignore'>@</span><span class='ignore'>{</span><span class='ignore'>\extracolsep</span><span class='ignore'>{</span><span class='ignore'>\fill</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>lll</span><span class='ignore'>}</span><br>
 <span class='exclmath'>$</span><span class='math'>\delta\theta </span><span class='mathcmd'>\gets</span> <span class='math'>\theta </span><span class='mathcmd'>\bmod</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>;</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>\Theta </span><span class='mathcmd'>\gets</span> <span class='math'>\theta </span><span class='math'>-</span> <span class='math'>\delta\theta</span><span class='exclmath'>$</span><span class='ignore'>;</span>&nbsp; <span class='ignore'>&amp;</span>&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\meanIndx</span> <span class='mathcmd'>\gets</span>  <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>;</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{tabular*}</span><br>
&nbsp; <span class='exclcmd'>\State</span>  <span class='exclenv'>\begin</span><span class='exclenv'>{tabular*}</span><span class='ignore'>{</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>c</span> <span class='ignore'>@</span><span class='ignore'>{</span><span class='ignore'>\extracolsep</span><span class='ignore'>{</span><span class='ignore'>\fill</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>ll</span><span class='ignore'>}</span><br>
&nbsp;<span class='exclmath'>$</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\meanIndx</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\delta \theta </span><span class='math'>)</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\delta \theta </span><span class='math'>)</span><span class='math'>+</span><span class='math'>7</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\delta \theta </span><span class='math'>)</span><span class='math'>+</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>;</span> <span class='ignore'>&amp;</span> <br>
&nbsp; <span class='exclmath'>$</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>,</span> <span class='math'>\alpha</span><span class='math'>,</span> <span class='math'>\beta</span><span class='math'>,</span> <span class='math'>n</span><span class='ignore'>}</span><span class='exclmath'>$</span><br>
&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{tabular*}</span><br>
 <span class='exclcmd'>\While</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span> <span class='math'>&gt;</span> <span class='math'>\tau</span><span class='exclmath'>$</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='math'>+</span><span class='math'>+</span><span class='exclmath'>$</span> <span class='exclcmd'>\;</span><br>
 <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>\alpha</span><span class='math'>,</span> <span class='math'>\beta</span><span class='math'>,</span> <span class='math'>n</span><span class='ignore'>}</span><span class='exclmath'>$</span><br>
 <span class='exclcmd'>\EndWhile</span><br>
 <span class='exclcmd'>\While</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span> <span class='math'>&gt;</span> <span class='math'>\tau</span><span class='exclmath'>$</span><span class='ignore'>}</span><br>
&nbsp; <span class='exclcmd'>\State</span>   <span class='exclmath'>$</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>-</span><span class='exclmath'>$</span> <span class='exclcmd'>\;</span><br>
&nbsp;<span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>\alpha</span><span class='math'>,</span> <span class='math'>\beta</span><span class='math'>,</span> <span class='math'>n</span><span class='ignore'>}</span><span class='exclmath'>$</span><br>
 <span class='exclcmd'>\EndWhile</span><br>
&nbsp;<span class='exclcmd'>\If</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span> <span class='math'>-</span><span class='math'>\delta\theta </span><span class='math'>&lt;</span> <span class='math'>\delta\theta </span><span class='math'>-</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>}</span><br>
 <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>,</span> <span class='math'>h</span><span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>\Theta </span><span class='math'>+</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='exclmath'>$</span> <br>
 <span class='exclcmd'>\Else</span><br>
&nbsp;<span class='exclcmd'>\State</span> <span class='exclmath'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>,</span> <span class='math'>h</span><span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>\Theta </span><span class='math'>+</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='exclmath'>$</span><br>
&nbsp; <span class='exclcmd'>\EndIf</span><br>
 <span class='exclcmd'>\State</span> <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>Return</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>,</span> <span class='math'>h</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='exclmath'>$</span> <span class='ignore'>}</span><br>
&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\caption</span><span class='ignore'>{</span><span class='ignore'>Suggest</span> <span class='ignore'>a</span> <span class='ignore'>new</span> <span class='ignore'>value</span> <span class='ignore'>for</span> <span class='exclmath'>$</span><span class='math'>\theta</span><span class='exclmath'>$</span><span class='ignore'>}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>newTheta</span><span class='ignore'>}</span><br>
 <span class='envir'>\end</span><span class='envir'>{algorithm}</span><br>
 <br>
<br>
<span class='cmd'>\algosection</span><span class='ignore'>{</span><span class='word'>Set</span> <span class='word'>the</span> <span class='word'>integer</span> <span class='word'>rotation</span> <span class='word'>matrix</span><span class='ignore'>.</span><span class='ignore'>}</span> <br>
<br>
<span class='word'>Expanding</span> <span class='word'>the</span> <span class='word'>definition</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>quantized</span> <span class='word'>matrix</span> <span class='mathgroup'>$</span><span class='mathcmd'>\qR</span><span class='option'>[\theta, n]</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>quantizedMatrixDef</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>definitions</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>factored</span> <span class='word'>matrix</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fR</span><span class='option'>[\theta]</span> <span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>factoredMatrixDef</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>matrix</span> <span class='word'>ordering</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='option'>[ \cdots , \theta \right]</span> <span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='word'>Table</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>tab</span><span class='ignore'>:</span><span class='ignore'>factoredRotationMatrix</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>factored</span> <span class='word'>matrix</span> <span class='word'>function</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fRe</span><span class='option'>[\phi]</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>fReDef</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>allows</span> <span class='word'>a</span> <span class='word'>more</span> <span class='word'>algorithm-minded</span> <span class='word'>form</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>written</span><span class='ignore'>.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{align*}</span><br>
<span class='comment'>%\fRe[\phi] &amp;= \frac{\um 1}{2} \left(1+\sqrt{3} \tan (\phi )\right)&nbsp; \\</span><br>
<span class='comment'>% \qR[\theta, n] &amp;=</span><br>
<span class='comment'>%\round{&nbsp;  \left( \begin{array}{c} 1&nbsp; \\ 2^{n - 2} \\ 2^{n - 2}&nbsp; \\ \end{array} \right) \bigotimes \fR[\theta] }</span><br>
<span class='comment'>%\quad \text{and} \quad </span><br>
<span class='comment'>%\qS[n] = \left(\begin{array}{c} 1&nbsp; \\ 2^{2-n } \\ 2^{2-n }&nbsp; \\ \end{array} \right) \\</span><br>
<span class='comment'>% \qR[\theta, n] &amp;=</span><br>
<span class='comment'>%\round{&nbsp;  \left( \begin{array}{c} 1&nbsp; \\ 2^{n - 2} \\ 2^{n - 2}&nbsp; \\ \end{array} \right) \bigotimes \fRO \left[ \fRm{\thetaA} , \theta \right]&nbsp; } \\</span><br>
<span class='comment'>% \qR[\theta, n] &amp;=</span><br>
<span class='comment'>%\round{&nbsp;  \left( \begin{array}{c} 1&nbsp; \\ 2^{n - 2} \\ 2^{n - 2}&nbsp; \\ \end{array} \right) \bigotimes </span><br>
<span class='comment'>%\fRO \left[</span><br>
<span class='comment'>%\left(\begin{smallmatrix}</span><br>
<span class='comment'>% 1 &amp; 1 &amp; 1 \\</span><br>
<span class='comment'>% \text{fRe} (\thetaA)&nbsp; &amp; 1 &amp; -1-\text{fRe} (\thetaA ) \\</span><br>
<span class='comment'>% \text{fRe} \left(\frac{\pi }{6}-\thetaA \right) &amp; -1 - \text{fRe} \left(\frac{\pi }{6}-\thetaA \right) &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix}\right) , \theta \right] } </span><br>
<span class='comment'>%\end{align*}</span><br>
<br>
<span class='comment'>%\begin{align*}</span><br>
<span class='comment'>%\elemAp &amp; = \fReq{\thetaA } &amp;</span><br>
<span class='comment'>%\elemAm &amp; = -1-\fReq{\thetaA }&nbsp; &amp; </span><br>
<span class='comment'>%\elemBp &amp; = \fReq{\frac{\pi }{6}-\thetaA } &amp; </span><br>
<span class='comment'>%\elemBm &amp; =-1 - \fReq{\frac{\pi }{6}-\thetaA} \\</span><br>
<span class='comment'>%\elemAp &amp; = \frac{\um 1}{2} \left(1+\sqrt{3} \tan (\thetaA )\right) &amp;</span><br>
<span class='comment'>%\elemAm &amp; = -1-\frac{\um 1}{2} \left(1+\sqrt{3} \tan (\thetaA )\right)&nbsp; &amp; </span><br>
<span class='comment'>%\elemBp &amp; = \frac{\um 1}{2} \left(1+\sqrt{3} \tan (\frac{\pi }{6}-\thetaA )\right)&nbsp; &amp; </span><br>
<span class='comment'>%\elemBm &amp; =-1 - \frac{\um 1}{2} \left(1+\sqrt{3} \tan (\frac{\pi }{6}-\thetaA )\right)&nbsp; \\</span><br>
<span class='comment'>%\elemAp &amp; = \frac{\um 1}{2} \left(1+\sqrt{3} \tan (\thetaA )\right) &amp;</span><br>
<span class='comment'>%\elemAm &amp; = \frac{\um 1}{2} \left(1-\sqrt{3} \tan (\thetaA )\right)&nbsp; &amp; </span><br>
<span class='comment'>%\elemBp &amp; = \frac{\um 1}{2} \left(1+\sqrt{3} \tan (\frac{\pi }{6}-\thetaA )\right)&nbsp; &amp; </span><br>
<span class='comment'>%\elemBm &amp; =\frac{\um 1}{2} \left(1-\sqrt{3} \tan (\frac{\pi }{6}-\thetaA )\right)&nbsp;  \\</span><br>
<span class='comment'>%\elemAp&nbsp; &amp; = -2^{n-3 } \left(1+\sqrt{3} \tan (\thetaA )\right) &amp;</span><br>
<span class='comment'>%\elemAm &amp; = -2^{n-3 } \left(1-\sqrt{3} \tan (\thetaA )\right)&nbsp; &amp; </span><br>
<span class='comment'>%\elemBp&nbsp; &amp; = -2^{n-3 } \left(1+\sqrt{3} \tan (\frac{\pi }{6}-\thetaA )\right)&nbsp; &amp; </span><br>
<span class='comment'>%\elemBm &amp; =-2^{n-3 } \left(1-\sqrt{3} \tan (\frac{\pi }{6}-\thetaA )\right)&nbsp;  \\</span><br>
<span class='comment'>%\end{align*}</span><br>
<br>
<span class='comment'>%\begin{tabular}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{gather*}</span><br>
<span class='envir'>\begin</span><span class='envir'>{aligned}</span><br>
<span class='exclcmd'>\qRs</span> <span class='ignore'>&amp;</span><span class='ignore'>=</span> <span class='exclcmd'>\fSs</span> <span class='exclcmd'>\otimes</span> <span class='exclcmd'>\qR</span>   <span class='ignore'>&amp;</span>&nbsp;  <span class='exclcmd'>\elemU</span>  <span class='ignore'>&amp;</span><span class='ignore'>=</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-2</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span><br>
<span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span><span class='ignore'>=</span> <span class='ignore'>\theta&nbsp; </span><span class='exclcmd'>\bmod</span> <span class='ignore'>\pi&nbsp; </span><span class='ignore'>&amp;</span> <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>1</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span><span class='ignore'>=</span> <span class='ignore'>\theta&nbsp; </span><span class='exclcmd'>\bmod</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='exclcmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{aligned}</span><span class='cmd'>\\</span><br>
<span class='envir'>\begin</span><span class='envir'>{aligned}</span><br>
<span class='exclcmd'>\elemAp</span>  <span class='ignore'>&amp;</span> <span class='ignore'>=</span> <span class='ignore'>-</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span> <span class='ignore'>}</span><span class='ignore'>+</span><span class='exclcmd'>\round</span><span class='ignore'>{</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span> <span class='ignore'>}</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\tan</span> <span class='ignore'>(</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>)</span> <span class='ignore'>}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-2</span><span class='ignore'>}</span> <span class='exclcmd'>\le</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemAp</span> <span class='exclcmd'>\le</span> <span class='ignore'>-</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\elemAm</span> <span class='ignore'>&amp;</span> <span class='ignore'>=</span> <span class='ignore'>-</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span> <span class='ignore'>}</span> <span class='ignore'>-</span><span class='exclcmd'>\round</span><span class='ignore'>{</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span> <span class='ignore'>}</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\tan</span> <span class='ignore'>(</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>)</span><span class='ignore'>}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span><span class='ignore'>}</span> <span class='exclcmd'>\le</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemAm</span> <span class='exclcmd'>\le</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\elemBp</span>   <span class='ignore'>&amp;</span> <span class='ignore'>=</span> <span class='ignore'>-</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span> <span class='ignore'>}</span> <span class='ignore'>+</span><span class='exclcmd'>\round</span><span class='ignore'>{</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span> <span class='ignore'>}</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\tan</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-2</span><span class='ignore'>}</span> <span class='exclcmd'>\le</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemBp</span>  <span class='exclcmd'>\le</span> <span class='ignore'>-</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\elemBm</span>  <span class='ignore'>&amp;</span> <span class='ignore'>=</span> <span class='ignore'>-</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span> <span class='ignore'>}</span> <span class='ignore'>-</span><span class='exclcmd'>\round</span><span class='ignore'>{</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span> <span class='ignore'>}</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\tan</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span><span class='ignore'>}</span> <span class='exclcmd'>\le</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemBm</span> <span class='exclcmd'>\le</span> <span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{aligned}</span><span class='cmd'>\\</span><br>
<span class='envir'>\begin</span><span class='envir'>{aligned}</span><br>
 <span class='exclcmd'>\qR</span><span class='option'>[\theta, n]</span> <span class='comment'>% &amp;=</span><br>
<span class='comment'>% \round{ \left(\begin{array}{c} 1&nbsp; \\ 2^{n - 2} \\ 2^{n - 2}&nbsp; \\\end{array} \right) \bigotimes \fR[\theta] } \\</span><br>
&nbsp;<span class='ignore'>&amp;</span><span class='ignore'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
<span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemAp</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemU</span>    <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemAm</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemBp</span>   <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemBm</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemU</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span><span class='exclcmd'>\leq</span> <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemU</span>     <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemBp</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemBm</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemAm</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemAp</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemU</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='exclcmd'>\leq</span> <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemU</span>    <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemAm</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemAp</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemBm</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemU</span>   <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemBp</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span><span class='exclcmd'>\leq</span> <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemBp</span>   <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemBm</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemU</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemAp</span>   <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemU</span>   <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemAm</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='exclcmd'>\leq</span> <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>2</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemAm</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemAp</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemU</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemU</span>     <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemBp</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemBm</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span>&nbsp; <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>2</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span><span class='exclcmd'>\leq</span> <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='ignore'>&lt;</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>5</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemBm</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemU</span>   <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemBp</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\elemU</span>    <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemAm</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\elemAp</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span>&nbsp; <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>5</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='exclcmd'>\leq</span> <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='ignore'>&lt;</span><span class='ignore'>\pi 
</span><span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><span class='ignore'>&amp;</span><br>
 <span class='exclcmd'>\fSs</span><span class='option'>[\theta]</span>  <span class='ignore'>&amp;</span><span class='ignore'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
<span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span>    <span class='ignore'>1</span> <span class='exclcmd'>\\</span>   <span class='ignore'>1</span><span class='exclcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\leq</span>    <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>&lt;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span>&nbsp;  <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span>  <span class='ignore'>-</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span>   <span class='ignore'>1</span><span class='exclcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span>&nbsp; <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='exclcmd'>\leq</span>  <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>&lt;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span>&nbsp;  <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span>  <span class='ignore'>-</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span> <span class='ignore'>-</span><span class='ignore'>1</span><span class='exclcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span>&nbsp; <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\leq</span>  <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>&lt;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span>&nbsp;  <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span>    <span class='ignore'>1</span> <span class='exclcmd'>\\</span> <span class='ignore'>-</span><span class='ignore'>1</span><span class='exclcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span>&nbsp; <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='exclcmd'>\leq</span>  <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>&lt;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>2</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span>    <span class='ignore'>1</span> <span class='exclcmd'>\\</span>   <span class='ignore'>1</span><span class='exclcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>2\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\leq</span>  <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>&lt;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>5</span> <span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span>  <span class='ignore'>-</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span>   <span class='ignore'>1</span><span class='exclcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>5\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='exclcmd'>\leq</span>  <span class='exclcmd'>\mTheta</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>\pi&nbsp; </span><span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='envir'>\end</span><span class='envir'>{aligned}</span><span class='cmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{gather*}</span><br>
<span class='word'>This</span> <span class='mathgroup'>$</span><span class='mathcmd'>\qRs</span><span class='option'>[\theta, n]</span><span class='mathgroup'>$</span> <span class='word'>matrix</span> <span class='word'>is</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>perform</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span><span class='ignore'>.</span> <span class='word'>Taking</span> <span class='word'>the</span> <span class='word'>inner</span> <span class='word'>product</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\qRs</span><span class='mathgroup'>$</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>produces</span> <br>
<span class='word'>a</span> <span class='word'>rotated</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='mathgroup'>$</span><span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\qRs</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>rgb</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>with</span> <span class='word'>elements</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>0</span> <span class='mathcmd'>\cdots</span> <span class='math'>3</span> <span class='math'>(</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='math'>-</span> <span class='math'>1</span><span class='math'>)</span><span class='math'>\}</span><span class='mathgroup'>$</span><span class='ignore'>,</span>&nbsp; <span class='mathgroup'>$</span> <span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>n-2</span><span class='ignore'>}</span> <span class='mathcmd'>\cdots</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>n-2</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span>&nbsp; <span class='math'>\}</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>3</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>n-2</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\cdots</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>n-2</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span>&nbsp; <span class='math'>\}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\qRsMin</span>     <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\\</span>  <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>n-2</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\\</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>n-2</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <br>
<span class='mathcmd'>\qRsMax</span>    <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>3</span> <span class='math'>(</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='math'>-</span> <span class='math'>1</span><span class='math'>)</span> <span class='mathcmd'>\\</span>  <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>n-2</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\\</span>  <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>n-2</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <br>
<span class='mathcmd'>\qRsRange</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>3</span> <span class='math'>(</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='math'>-</span> <span class='math'>1</span><span class='math'>)</span> <span class='mathcmd'>\\</span>  <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-1</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n-1</span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; &nbsp; &nbsp; <span class='mathcmd'>\\</span>  <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-1</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n-1</span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<span class='cmd'>\algosection</span><span class='ignore'>{</span><span class='word'>Design</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>function</span><span class='ignore'>.</span><span class='ignore'>}</span> <br>
<span class='word'>First</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>overall</span> <span class='word'>scaling</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>quantized</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>combining</span> <span class='word'>the</span> <span class='word'>normalized</span> <span class='word'>scaling</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Scale</span><span class='option'>[\theta, n]</span><span class='mathgroup'>$</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>desired</span> <span class='word'>scaling</span> <span class='word'>defined</span> <span class='word'>in</span> <span class='word'>Equation</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>CombinedRotationRange</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
<span class='mathcmd'>\Scale</span> <span class='math'>=</span><br>
 <span class='mathcmd'>\min</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>K</span> <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>.</span> <span class='math'>,</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>.</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='mathcmd'>\otimes</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp;<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>1-n</span> <span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>1-n</span> <span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='mathcmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<br>
<span class='word'>Next</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>decide</span> <span class='word'>which</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>methods</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>used</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>by</span> <span class='word'>assessing</span> <span class='word'>the</span> <span class='word'>size</span> <span class='word'>of</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>regions</span> <span class='word'>relative</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>tolerance</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>avoids</span> <span class='word'>unnecessary</span> <span class='word'>operations</span> <span class='word'>by</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>directly</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>unscaled</span> <span class='word'>result</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>inner</span> <span class='word'>product</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>matrix</span> <span class='mathgroup'>$</span><span class='mathcmd'>\qRs</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>value</span><span class='ignore'>.</span><br>
<span class='comment'>%\begin{align*}</span><br>
<span class='comment'>%\mathbf{Q}_{discard}&nbsp; &nbsp;  &amp;\gets \tau_{discard}&nbsp; &nbsp;  \le&nbsp; &nbsp; 1-\discard_2 + \discard_1 \\</span><br>
<span class='comment'>%\mathbf{Q}_{distribute} &amp;\gets \tau_{distribute}&nbsp; \le&nbsp; &nbsp; \discard_2 - \ekeep_2 + \ekeep_1 - \discard_1 \\</span><br>
<span class='comment'>%\mathbf{Q}_{keep}&nbsp; &nbsp; &nbsp; &nbsp; &amp;\gets&nbsp; \tau_{keep}&nbsp; &nbsp; &nbsp; &nbsp;  \le&nbsp; &nbsp;  \ekeep_2 - \ekeep_1 </span><br>
<span class='comment'>%\end{align*}</span><br>
<span class='comment'>%If $\mathbf{Q}_{discard} = \text{True} $ then we find the boundaries in the $0 \cdots 2^{2n}$ range and add the discard function to the distribution function.</span><br>
<span class='comment'>%\begin{align*}</span><br>
<span class='comment'>%\Discard_1^{q} &amp;= \qRsRange \discard_1 +\qRsMin&amp;</span><br>
<span class='comment'>%\eKeep_1^{q} &amp;= \qRsRange \ekeep_1 +\qRsMin \\</span><br>
<span class='comment'>%\Discard_2^{q} &amp;= \qRsRange \discard_2 + \qRsMin&amp;</span><br>
<span class='comment'>%\eKeep_2^{q} &amp;= \qRsRange \ekeep_2 + \qRsMin&amp;</span><br>
<span class='comment'>%\end{align*}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% \begin{algorithm}[H]</span><br>
<span class='comment'>% \SetKwProg{Fn}{Function}{is}{end}</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; \Fn{discard{t, n}}{</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  \Require{$t$ the channel value&nbsp; \quad</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; $n$ the source bit depth }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  \KwResult{$d$ the redistributed channel value}</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  $\Discard_1^{q} \gets \qRsRange \discard_1 + \qRsMin $; \quad </span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  $\Discard_2^{q} \gets \qRsRange \discard_2 + \qRsMin $ \;</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  $\eKeep_1^{q}&nbsp; &nbsp; \gets \qRsRange \ekeep_1&nbsp;  + \qRsMin $; \quad </span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  $\eKeep_2^{q}&nbsp; &nbsp; \gets \qRsRange \ekeep_2&nbsp;  + \qRsMin $ \;</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  \SetAlgoLined</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  \uIf{$t &lt; \Discard_1^{q}$}{</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  \textbf{Return} {$\dstMin$ }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  \uElseIf{$t &gt; \Discard_2^{q}$}{</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; \textbf{Return} {$\dstMax$ }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  \Else{</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \uIf{$ \eKeep_1^{q} \le t \le \eKeep_2^{q} $}{</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do linear stuff \;</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \textbf{Return} {$val$ }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  \Else{</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  \uIf{$\Discard_1^{q} &lt; t &lt; \eKeep_1^{q}$}{</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \textbf{Return} {$val$ }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Else($ \eKeep_2^{q} &lt; t &lt; \Discard_2^{q}$){</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \textbf{Return} {$val$ }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do other distro stuff</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  }</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp;  </span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; }</span><br>
<span class='comment'>% \caption{A function which returns the angular position of compromise between the perturbations to the channels.}</span><br>
<span class='comment'>%\end{algorithm}</span><br>
<br>
 <span class='envir'>\begin</span><span class='envir'>{algorithm}</span><span class='option'>[H]</span><br>
&nbsp;<span class='exclenv'>\begin</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;&nbsp;&nbsp; <span class='exclcmd'>\Require</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>\{</span><span class='mathcmd'>\discard</span><span class='math'>,</span> <span class='mathcmd'>\Discard</span><span class='math'>,</span> <span class='mathcmd'>\ekeep</span><span class='math'>,</span><span class='mathcmd'>\eKeep</span><span class='math'>\}</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>boundaries</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>regions</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span> <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Require</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='math'>0</span><span class='math'>&lt;</span><span class='math'>\tau</span><span class='math'>&lt;</span><span class='math'>1</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>tolerances</span> <span class='ignore'>for</span> <span class='ignore'>counting</span> <span class='ignore'>a</span> <span class='ignore'>region</span> <span class='ignore'>as</span> <span class='ignore'>significant</span><span class='ignore'>.</span><br>
&nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\Ensure</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>pDis</span><span class='exclmath'>$</span> <span class='ignore'>a</span> <span class='ignore'>function</span> <span class='ignore'>which</span> <span class='ignore'>performs</span> <span class='ignore'>the</span> <span class='ignore'>re-distribution</span> <span class='ignore'>for</span> <span class='ignore'>a</span> <span class='ignore'>channel</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span> <span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>llcrl</span><span class='ignore'>}</span><br>
&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>discard</span><span class='ignore'>}</span> <span class='exclmath'>$</span>&nbsp; &nbsp; <span class='ignore'>&amp;</span>&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\gets</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>discard</span><span class='ignore'>}</span>&nbsp; &nbsp;  <span class='mathcmd'>\le</span>    <span class='math'>1</span><span class='math'>-</span><span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>+</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>1</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\quad</span><span class='exclcmd'>\quad</span><span class='ignore'>&amp;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>keep</span><span class='ignore'>}</span> <span class='exclmath'>$</span>&nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\gets</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>keep</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\le</span>     <span class='mathcmd'>\ekeep</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\ekeep</span><span class='math'>_</span><span class='math'>1</span><span class='exclmath'>$</span><span class='exclcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>distribute</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\multicolumn</span><span class='ignore'>{</span><span class='ignore'>4</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\gets</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>distribute</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\le</span>    <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\ekeep</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>+</span> <span class='mathcmd'>\ekeep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>1</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>q</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span><span class='exclmath'>$</span><span class='mathcmd'>\gets</span> <span class='mathcmd'>\qRsRange</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>+</span> <span class='mathcmd'>\qRsMin</span><span class='exclmath'>$</span><span class='ignore'>;</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\quad</span><span class='exclcmd'>\quad</span> <span class='ignore'>&amp;</span><br>
&nbsp; &nbsp; &nbsp;  <span class='exclmath'>$</span><span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>q</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span><span class='exclmath'>$</span><span class='mathcmd'>\gets</span> <span class='mathcmd'>\qRsRange</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>+</span> <span class='mathcmd'>\qRsMin</span><span class='exclmath'>$</span> <span class='exclcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>q</span><span class='ignore'>}</span><span class='exclmath'>$</span>&nbsp; &nbsp; <span class='ignore'>&amp;</span><span class='exclmath'>$</span><span class='mathcmd'>\gets</span> <span class='mathcmd'>\qRsRange</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\ekeep</span><span class='math'>_</span><span class='math'>1</span>&nbsp;  <span class='math'>+</span> <span class='mathcmd'>\qRsMin</span><span class='exclmath'>$</span><span class='ignore'>;</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\quad</span><span class='exclcmd'>\quad</span> <span class='ignore'>&amp;</span><br>
&nbsp; &nbsp; &nbsp;  <span class='exclmath'>$</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>q</span><span class='ignore'>}</span><span class='exclmath'>$</span>&nbsp; &nbsp; <span class='ignore'>&amp;</span><span class='exclmath'>$</span><span class='mathcmd'>\gets</span> <span class='mathcmd'>\qRsRange</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\ekeep</span><span class='math'>_</span><span class='math'>2</span>&nbsp;  <span class='math'>+</span> <span class='mathcmd'>\qRsMin</span><span class='exclmath'>$</span> <br>
&nbsp; &nbsp; &nbsp;  <span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><span class='exclcmd'>\;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\If</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>keep</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>discard</span><span class='ignore'>}</span> <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>distribute</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>}</span><span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Piecewise</span> <span class='ignore'>Erf</span> <span class='ignore'>Distribution</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span> <span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>pDis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='mathcmd'>\gets</span> <span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\dstMin</span> <span class='math'>&amp;</span> <span class='math'>x</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\Scale</span> <span class='math'>x</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\Scale</span> <span class='math'>x</span> <span class='math'>-</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>+</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\le</span> <span class='math'>x</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\Scale</span> <span class='math'>x</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\le</span> <span class='math'>x</span><span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\ElsIf</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>keep</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>discard</span><span class='ignore'>}</span> <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\lnot</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>distribute</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>}</span><span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Partitioning</span> <span class='ignore'>Distribution</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\State</span>  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclmath'>$</span> <span class='math'>pDis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='mathcmd'>\gets</span> <span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='mathcmd'>\dstMin</span> <span class='math'>&amp;</span> <span class='math'>x</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='mathcmd'>\Scale</span> <span class='mathcmd'>\;</span> <span class='math'>x</span>&nbsp; <span class='math'>+</span> <span class='mathcmd'>\dstMin</span>  <span class='math'>&amp;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\le</span> <span class='math'>x</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>+</span> <span class='mathcmd'>\dstMin</span>  <span class='math'>&amp;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\le</span> <span class='math'>x</span><span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\algstore</span><span class='ignore'>{</span><span class='ignore'>bkbreak</span><span class='ignore'>}</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>An</span> <span class='oword'>algorithm</span> <span class='oword'>which</span> <span class='oword'>returns</span> <span class='oword'>a</span> <span class='oword'>channel</span> <span class='oword'>appropriate</span> <span class='oword'>distribution</span> <span class='oword'>function</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{algorithm}</span><br>
<span class='cmd'>\addtocounter</span><span class='ignore'>{</span><span class='ignore'>algorithm</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='ignore'>1</span><span class='ignore'>}</span><br>
<span class='envir'>\begin</span><span class='envir'>{algorithm}</span><span class='option'>[h]</span><br>
<span class='exclcmd'>\caption</span><span class='ignore'>{</span><span class='ignore'>Part</span> <span class='ignore'>2</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{algorithmic}</span><span class='option'>[1]</span><br>
<span class='exclcmd'>\algrestore</span><span class='ignore'>{</span><span class='ignore'>bkbreak</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\ElsIf</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>keep</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\lnot</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>discard</span><span class='ignore'>}</span> <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>distribute</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>}</span><span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Little</span> <span class='ignore'>Loss</span> <span class='ignore'>Distribution</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\State</span> <span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='math'>pDis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='mathcmd'>\gets</span> <span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\Scale</span> <span class='math'>x</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\srcMin</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\Scale</span> <span class='math'>x</span> <span class='math'>-</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>+</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\le</span> <span class='math'>x</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\Scale</span> <span class='math'>x</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\ElsIf</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>keep</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\lnot</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>discard</span><span class='ignore'>}</span> <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\lnot</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>distribute</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>}</span><span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Linear</span> <span class='ignore'>Distribution</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\State</span>   <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclmath'>$</span>&nbsp; <span class='math'>pDis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\Scale</span> <span class='mathcmd'>\;</span> <span class='math'>x</span> <span class='math'>+</span> <span class='mathcmd'>\dstMin</span> <span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\ElsIf</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\lnot</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>keep</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>discard</span><span class='ignore'>}</span> <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>distribute</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>}</span><span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Truncated</span> <span class='ignore'>Erf</span> <span class='ignore'>Distribution</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span>  <br>
&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span> <span class='math'>pDis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='mathcmd'>\gets</span> <span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\dstMin</span> <span class='math'>&amp;</span> <span class='math'>x</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\Scale</span> <span class='math'>x</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='mathcmd'>\dstMax</span> <span class='math'>&amp;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span> <span class='mathcmd'>\le</span> <span class='math'>x</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\ElsIf</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\lnot</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>keep</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>discard</span><span class='ignore'>}</span> <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\lnot</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>distribute</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>}</span><span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Step</span> <span class='ignore'>Distribution</span><span class='ignore'>!</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span>   <br>
&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span>&nbsp; <span class='math'>pDis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='mathcmd'>\gets</span> <span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='mathcmd'>\dstMin</span> <span class='math'>&amp;</span> <span class='math'>x</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='math'>+</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='math'>1</span> <span class='math'>+</span> <span class='mathcmd'>\dstMin</span>  <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>q</span> <span class='math'>+</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>q</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>&lt;</span> <span class='math'>x</span><span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\Else</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\lnot</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>keep</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\lnot</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>discard</span><span class='ignore'>}</span> <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\lnot</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>Q</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>distribute</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\State</span> <span class='ignore'>Error</span><span class='ignore'>;</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>The</span> <span class='ignore'>tolerances</span> <span class='ignore'>or</span> <span class='ignore'>something</span> <span class='ignore'>else</span> <span class='ignore'>must</span> <span class='ignore'>be</span> <span class='ignore'>wrong</span><span class='ignore'>!</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\EndIf</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\State</span> <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>Return</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>pDis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span><span class='exclmath'>$</span><span class='ignore'>}</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{algorithmic}</span><br>
<span class='envir'>\end</span><span class='envir'>{algorithm}</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Conclusion</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>matrix</span> <span class='mathgroup'>$</span><span class='mathcmd'>\qRs</span><span class='mathgroup'>$</span> <span class='word'>achieves</span> <span class='word'>its</span> <span class='word'>stated</span> <span class='word'>aims</span> <span class='word'>of</span> <span class='word'>being</span> <span class='word'>of</span> <span class='word'>integer</span> <span class='word'>type</span> <span class='word'>and</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>when</span> <span class='word'>acting</span> <span class='word'>upon</span> <span class='word'>vectors</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>type</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>producing</span> <span class='word'>results</span> <span class='word'>which</span> <span class='word'>fit</span> <span class='word'>into</span> <span class='word'>a</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>of</span> <span class='word'>twice</span> <span class='word'>the</span> <span class='word'>bit</span> <span class='word'>depth</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>no</span> <span class='word'>more</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>common</span> <span class='word'>source</span> <span class='word'>types</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>suggested</span> <span class='word'>quantized</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>will</span> <span class='word'>likely</span> <span class='word'>be</span> <span class='word'>within</span> <span class='word'>1</span> <span class='word'>degree</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>requested</span> <span class='word'>value</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>so</span> <span class='word'>there</span> <span class='word'>are</span> <span class='word'>no</span> <span class='word'>unacceptable</span> <span class='word'>restrictions</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>color-space</span><span class='ignore'>.</span> <span class='word'>And</span> <span class='word'>the</span> <span class='word'>re-distribution</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>working</span> <span class='word'>type</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>type</span> <span class='word'>is</span> <span class='word'>performed</span> <span class='word'>efficiently</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>optimization</span> <span class='word'>decisions</span> <span class='word'>taken</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>itself</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>thus</span> <span class='word'>described</span> <span class='word'>therefore</span> <span class='word'>only</span> <span class='word'>requires</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>statistics</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>object</span> <span class='word'>of</span> <span class='word'>interest</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>orientation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>provided</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>user</span><span class='ignore'>,</span> <span class='word'>along</span> <span class='word'>with</span> <span class='word'>optional</span> <span class='word'>tolerances</span> <span class='word'>variously</span> <span class='word'>described</span> <span class='word'>above</span><span class='ignore'>.</span><br>
<br>
<span class='word'>During</span> <span class='word'>the</span> <span class='word'>development</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>algorithm</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>became</span> <span class='word'>apparent</span> <span class='word'>with</span> <span class='word'>certain</span> <span class='word'>coincidences</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>formulations</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>happened</span> <span class='word'>upon</span> <span class='word'>in</span> <span class='word'>pursuit</span> <span class='word'>of</span> <span class='word'>different</span> <span class='word'>goals</span><span class='ignore'>.</span> <span class='word'>Most</span> <span class='word'>notably</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>matrix</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fRe</span><span class='mathgroup'>$</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>as</span> <span class='word'>well</span> <span class='word'>as</span> <span class='word'>satisfying</span> <span class='word'>the</span> <span class='word'>optimization</span> <span class='word'>goals</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>also</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>smallest</span> <span class='word'>representation</span> <span class='word'>which</span> <span class='word'>provides</span> <span class='word'>a</span> <span class='word'>truly</span> <span class='word'>lossless</span> <span class='word'>rotation</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>surprising</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>matrix</span> <span class='mathgroup'>$</span><span class='mathcmd'>\R</span><span class='mathgroup'>$</span> <span class='word'>theoretically</span> <span class='word'>provides</span> <span class='word'>sufficient</span> <span class='word'>space</span> <span class='word'>for</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>retained</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>there</span> <span class='word'>are</span> <span class='word'>unavoidable</span> <span class='word'>discretization</span> <span class='word'>errors</span> <span class='word'>which</span> <span class='word'>make</span> <span class='word'>some</span> <span class='word'>values</span> <span class='word'>inside</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>space</span> <span class='word'>inaccessible</span> <span class='word'>and</span> <span class='word'>others</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='mathcmd'>\rightarrow</span> <span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>space</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>LCaCb</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>clear</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fRe</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>smallest</span> <span class='word'>representation</span> <span class='word'>which</span> <span class='word'>has</span> <span class='word'>no</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='mathcmd'>\rightarrow</span> <span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>loss</span> <span class='word'>of</span> <span class='word'>information</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>has</span> <span class='word'>inaccessible</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>whereas</span> <span class='word'>LCaCb</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>most</span> <span class='word'>compact</span> <span class='word'>representation</span> <span class='word'>which</span> <span class='word'>has</span><span class='ignore'>,</span> <span class='word'>at</span> <span class='word'>worst</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='mathcmd'>\rightarrow</span> <span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>errors</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>It</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>noted</span> <span class='word'>that</span> <span class='word'>neither</span> <span class='word'>the</span> <span class='word'>inaccessible</span> <span class='word'>value</span> <span class='word'>problem</span> <span class='word'>or</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='mathcmd'>\rightarrow</span> <span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>loss</span> <span class='word'>of</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>unique</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>factored</span> <span class='word'>or</span> <span class='word'>discretized</span> <span class='word'>representation</span> <span class='word'>and</span> <span class='word'>is</span> <span class='word'>as</span> <span class='word'>much</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>problem</span> <span class='word'>even</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>floating-point</span> <span class='word'>representation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>rotation</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>common</span> <span class='word'>implementation</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>take</span> <span class='word'>a</span> <span class='word'>source</span> <span class='word'>integer</span><span class='ignore'>,</span> <span class='word'>turn</span> <span class='word'>it</span> <span class='word'>into</span> <span class='word'>a</span> <span class='word'>floating-point</span> <span class='word'>number</span><span class='ignore'>,</span> <span class='word'>perform</span> <span class='word'>the</span> <span class='word'>conversion</span> <span class='word'>in</span> <span class='word'>floating</span> <span class='word'>points</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>turn</span> <span class='word'>it</span> <span class='word'>back</span> <span class='word'>into</span> <span class='word'>an</span> <span class='word'>integer</span><span class='ignore'>;</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>in</span> <span class='word'>OpenCV</span> <span class='word'>and</span> <span class='word'>other</span> <span class='word'>such</span> <span class='word'>computer</span> <span class='word'>vision</span> <span class='word'>libraries</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>implementations</span> <span class='word'>also</span> <span class='word'>suffer</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>problem</span><span class='ignore'>.</span> <span class='word'>Hereafter</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>problem</span> <span class='word'>of</span> <span class='word'>inaccessible</span> <span class='word'>values</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='mathcmd'>\rightarrow</span> <span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>allocation</span> <span class='word'>values</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>discretization</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>referred</span> <span class='word'>to</span> <span class='word'>as</span> <span class='ignore'>"</span><span class='word'>the</span> <span class='word'>speckling</span> <span class='word'>problem</span><span class='ignore'>"</span><span class='ignore'>.</span> <br>
<br>
<br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Chapter2/chapter2.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 1867</li>
<li>Words in headers: 36</li>
<li>Words outside text (captions, etc.): 9</li>
<li>Number of headers: 7</li>
<li>Number of floats/tables/figures: 0</li>
<li>Number of math inlines: 88</li>
<li>Number of math displayed: 14</li>
<li>Subcounts:</li>
<span class='subcount'>
<li class='fielddesc'>&nbsp; text+headers+captions (#headers/#floats/#inlines/#displayed)</li>
  <li>4+9+0 (1/0/0/0) Chapter: Color Spaces and Information Storage for Computer Vision Processing} \label{sec:Chap2</li>
  <li>100+5+0 (1/0/0/0) Section: Constructing a New Color Space}\label{sec:ConstructingANewColorSpace</li>
  <li>113+7+0 (1/0/0/0) Subsection: Camera RGB and Normalization for Discrete Range}\label{sec:CameraRGB</li>
  <li>348+5+0 (1/0/12/0) Section: The Skin Color Space Algorithm</li>
  <li>407+6+0 (1/0/27/4) Subsection: Setting the Value for the Tolerance</li>
  <li>543+3+9 (1/0/39/10) Subsection: The Complete Algorithm</li>
  <li>352+1+0 (1/0/10/0) Subsection: Conclusion</li>
</span>
</ul>
</div>
<h2>File: ./Chapter3/chapter3.tex</h2>
<div class='parse'><p>
<br>
<span class='cmd'>\chapter</span><span class='ignore'>{</span><span class='hword'>Skin</span> <span class='hword'>Statistics</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ChapSkin</span><span class='ignore'>}</span><br>
<span class='cmd'>\epstopdfsetup</span><span class='ignore'>{</span><span class='word'>outdir</span><span class='ignore'>=</span><span class='word'>Chapter3</span><span class='ignore'>/</span><span class='word'>Figs</span><span class='ignore'>/</span><span class='word'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><br>
<span class='cmd'>\ifpdf</span><br>
&nbsp;&nbsp;<span class='cmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Raster</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\else</span><br>
&nbsp;&nbsp;<span class='cmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Vector</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\fi</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Objective</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>Objective</span><span class='ignore'>}</span><br>
<span class='word'>We</span> <span class='word'>are</span> <span class='word'>trying</span> <span class='word'>to</span> <span class='word'>describe</span> <span class='word'>monochromatic</span> <span class='word'>objects</span> <span class='word'>which</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>small</span> <span class='word'>variation</span> <span class='word'>around</span> <span class='word'>an</span> <span class='word'>average</span> <span class='word'>color</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>the</span> <span class='word'>implicit</span> <span class='word'>assumption</span> <span class='word'>here</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>skin</span> <span class='word'>is</span><span class='ignore'>,</span> <span class='word'>essentially</span><span class='ignore'>,</span> <span class='word'>monochromatic</span><span class='ignore'>.</span> <span class='word'>Chromatic</span> <span class='word'>skin</span> <span class='word'>statistics</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>collected</span> <span class='word'>by</span> <span class='word'>several</span> <span class='word'>authors</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>yang1998a</span><span class='ignore'>,</span><span class='ignore'>kollias1995</span><span class='ignore'>,</span><span class='ignore'>jedynak2003a</span><span class='ignore'>,</span><span class='ignore'>gomez2002a</span><span class='ignore'>,</span><span class='ignore'>Lee2002</span><span class='ignore'>,</span><span class='ignore'>Sigal2000a</span><span class='ignore'>,</span><span class='ignore'>Terrillon1999a</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>variety</span> <span class='word'>of</span> <span class='word'>different</span> <span class='word'>approaches</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>most</span> <span class='word'>have</span> <span class='word'>found</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>statistics</span> <span class='word'>are</span> <span class='word'>well-described</span> <span class='word'>by</span> <span class='word'>2D</span> <span class='word'>Gaussians</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>plane</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>goal</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>chapter</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>a</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='word'>two</span> <span class='word'>standard</span> <span class='word'>deviations</span><span class='ignore'>)</span><span class='ignore'>;</span> <span class='mathgroup'>$</span><span class='math'>\mu</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>position</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>mean</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='math'>^</span><span class='mathcmd'>\prime</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>angle</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>major</span> <span class='word'>axis</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>2D</span> <span class='word'>Gaussian</span> <span class='word'>found</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>LCaCb</span> <span class='mathgroup'>$</span><span class='math'>\theta </span><span class='math'>=</span> <span class='math'>0</span><span class='mathgroup'>$</span> <span class='word'>color-space</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>will</span> <span class='word'>allow</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>the</span> <span class='word'>methods</span> <span class='word'>presented</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span> <span class='word'>to</span> <span class='word'>design</span> <span class='word'>a</span> <span class='word'>bespoke</span> <span class='word'>color-space</span> <span class='word'>which</span> <span class='word'>will</span> <span class='word'>preserve</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>model</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>iPhone</span> <span class='hword'>Camera</span> <span class='hword'>Characteristics</span><span class='ignore'>}</span> <span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>iPhoneCameraCharacteristics</span><span class='ignore'>}</span><br>
<span class='word'>There</span> <span class='word'>are</span> <span class='word'>two</span> <span class='word'>aspects</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>which</span> <span class='word'>affect</span> <span class='word'>the</span> <span class='word'>collection</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>statistics</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>CCD</span> <span class='word'>sensitivity</span> <span class='word'>as</span> <span class='word'>detailed</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>1</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>processing</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>detected</span> <span class='word'>raw</span> <span class='word'>channel</span> <span class='word'>values</span> <span class='word'>before</span> <span class='word'>the</span> <span class='word'>AP</span> <span class='word'>layer</span><span class='ignore'>.</span> <span class='word'>Unfortunately</span> <span class='word'>neither</span> <span class='word'>the</span> <span class='word'>details</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>CCD</span> <span class='word'>nor</span> <span class='word'>the</span> <span class='word'>action</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>preprocessing</span> <span class='word'>are</span> <span class='word'>publicly</span> <span class='word'>documented</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>relevant</span> <span class='word'>effects</span> <span class='word'>are</span> <span class='word'>discovered</span> <span class='word'>and</span> <span class='word'>described</span> <span class='word'>in</span> <span class='word'>this</span> <span class='word'>section</span> <br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>White</span> <span class='hword'>Point</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>WhitePoint</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>iPhone's</span> <span class='word'>camera</span> <span class='word'>pre-processes</span> <span class='word'>the</span> <span class='word'>raw</span> <span class='word'>image</span> <span class='word'>before</span> <span class='word'>it</span> <span class='word'>reaches</span> <span class='word'>the</span> <span class='word'>AP</span> <span class='word'>layer</span> <span class='word'>which</span> <span class='word'>causes</span> <span class='word'>difficulties</span> <span class='word'>in</span> <span class='word'>collecting</span> <span class='word'>reliable</span> <span class='word'>statistics</span><span class='ignore'>.</span> <span class='word'>Typically</span><span class='ignore'>,</span> <span class='word'>cameras</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>specific</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>value</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>value</span> <span class='word'>corresponding</span> <span class='word'>to</span> <span class='word'>white</span> <span class='word'>which</span> <span class='word'>isn't</span> <span class='word'>necessarily</span> <span class='word'>the</span> <span class='word'>corner</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span><span class='ignore'>;</span> <span class='word'>finding</span> <span class='word'>this</span> <span class='word'>value</span> <span class='word'>is</span> <span class='word'>part</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>calibration</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>also</span> <span class='word'>determines</span> <span class='word'>the</span> <span class='word'>orientation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>axis</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>passes</span> <span class='word'>through</span> <span class='word'>zero</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>white</span> <span class='word'>point</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>why</span> <span class='word'>pre-defined</span> <span class='word'>color-space</span> <span class='word'>functions</span> <span class='word'>have</span> <span class='word'>an</span> <span class='word'>implicit</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>correction</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.98\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Theory</span><span class='ignore'>_</span><span class='ignore'>And</span><span class='ignore'>_</span><span class='ignore'>Practice.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>Bins</span> <span class='oword'>for</span> <span class='oword'>6</span> <span class='oword'>randomly</span> <span class='oword'>colored</span> <span class='oword'>blobs</span> <span class='oword'>varying</span> <span class='oword'>only</span> <span class='oword'>in</span> <span class='oword'>luminosity</span> <span class='oword'>with</span> <span class='oword'>lines</span> <span class='oword'>indicating</span> <span class='oword'>the</span> <span class='oword'>source</span> <span class='oword'>image</span> <span class='oword'>colors</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>WhitePoint</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>camera</span> <span class='word'>was</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>a</span> <span class='word'>random</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>6</span> <span class='word'>colors</span> <span class='mathgroup'>$</span><span class='math'>X</span><span class='math'>=</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>X</span><span class='math'>^</span><span class='math'>1</span><span class='math'>_</span><span class='math'>R</span> <span class='math'>+</span><span class='mathcmd'>\lambda</span><span class='math'>,</span> <span class='math'>X</span><span class='math'>^</span><span class='math'>1</span><span class='math'>_</span><span class='math'>G</span>&nbsp; <span class='math'>+</span><span class='mathcmd'>\lambda</span><span class='math'>,</span> <span class='math'>X</span><span class='math'>^</span><span class='math'>1</span><span class='math'>_</span><span class='math'>B</span> <span class='math'>+</span><span class='mathcmd'>\lambda</span> <span class='mathcmd'>\right</span><span class='math'>\}</span><span class='math'>,</span> <span class='mathcmd'>\cdots</span> <span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>and</span> <span class='word'>varying</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>between</span>&nbsp; <span class='mathgroup'>$</span> <span class='mathcmd'>\lambda</span><span class='math'>(</span><span class='math'>X</span><span class='math'>)</span><span class='math'>_</span><span class='math'>B</span> <span class='math'>&lt;</span> <span class='mathcmd'>\lambda</span>  <span class='math'>&lt;</span> <span class='mathcmd'>\lambda</span><span class='math'>(</span><span class='math'>X</span><span class='math'>)</span><span class='math'>_</span><span class='math'>W</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>produces</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>6</span> <span class='word'>colors</span> <span class='word'>which</span> <span class='word'>vary</span> <span class='word'>only</span> <span class='word'>in</span> <span class='word'>luminosity</span> <span class='word'>and</span> <span class='word'>which</span> <span class='word'>do</span> <span class='word'>not</span> <span class='word'>suffer</span> <span class='word'>from</span> <span class='word'>white-out</span> <span class='word'>or</span> <span class='word'>black-out</span><span class='ignore'>.</span> <span class='word'>Panels</span> <span class='word'>of</span> <span class='word'>these</span> <span class='word'>6</span> <span class='word'>colors</span> <span class='word'>with</span> <span class='word'>randomly</span> <span class='word'>selected</span> <span class='word'>luminosity</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>were</span> <span class='word'>presented</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>camera</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>produced</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>images</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>statistics</span> <span class='word'>were</span> <span class='word'>collected</span> <span class='word'>for</span> <span class='word'>this</span> <span class='word'>set</span><span class='ignore'>.</span> <span class='word'>Theoretically</span> <span class='word'>we</span> <span class='word'>expect</span> <span class='word'>there</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>6</span> <span class='word'>distinct</span> <span class='word'>parallel</span> <span class='word'>lines</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>also</span> <span class='word'>parallel</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>line</span> <span class='word'>from</span> <span class='word'>black</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>camera</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>the</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>is</span> <span class='word'>not</span> <span class='mathgroup'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='math'>255</span><span class='math'>,</span><span class='math'>255</span><span class='math'>,</span><span class='math'>255</span><span class='mathcmd'>\right</span><span class='math'>\}</span><span class='mathgroup'>$</span> <span class='word'>then</span> <span class='word'>this</span> <span class='word'>test</span> <span class='word'>should</span> <span class='word'>allow</span> <span class='word'>the</span> <span class='word'>determination</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>real</span> <span class='word'>white</span> <span class='word'>point</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>The</span> <span class='word'>iPhone's</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>is</span> <span class='word'>always</span> <span class='word'>set</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>corner</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span> <span class='word'>before</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>reaches</span> <span class='word'>the</span> <span class='word'>AP</span> <span class='word'>layer</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>when</span> <span class='word'>developing</span> <span class='word'>an</span> <span class='word'>algorithm</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>iPhone</span><span class='ignore'>,</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>correction</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>necessary</span><span class='ignore'>,</span> <span class='word'>while</span> <span class='word'>on</span> <span class='word'>other</span> <span class='word'>devices</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>may</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>adapted</span> <span class='word'>accordingly</span><span class='ignore'>.</span><br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Color</span> <span class='hword'>Correction</span> <span class='hword'>Preprocessing</span><span class='ignore'>}</span><br>
<span class='word'>A</span> <span class='word'>second</span> <span class='word'>undocumented</span> <span class='word'>pre-processing</span> <span class='word'>stage</span> <span class='word'>became</span> <span class='word'>apparent</span> <span class='word'>while</span> <span class='word'>gathering</span> <span class='word'>skin</span> <span class='word'>statistics</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>original</span> <span class='word'>approach</span> <span class='word'>taken</span> <span class='word'>used</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>photos</span> <span class='word'>of</span> <span class='word'>an</span> <span class='word'>individual's</span> <span class='word'>skin</span>&nbsp; <span class='word'>under</span> <span class='word'>different</span> <span class='word'>lighting</span> <span class='word'>conditions</span> <span class='word'>against</span> <span class='word'>a</span> <span class='word'>constant</span> <span class='word'>monochromatic</span> <span class='word'>background</span> <span class='word'>captured</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>camera</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>background</span> <span class='word'>was</span> <span class='word'>included</span> <span class='word'>in</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>obtain</span> <span class='word'>data</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>skin</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='word'>background</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>photos</span> <span class='word'>captured</span> <span class='word'>under</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>conditions</span> <span class='word'>but</span> <span class='word'>without</span> <span class='word'>the</span> <span class='word'>presence</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>hand</span> <span class='word'>would</span> <span class='word'>then</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>produce</span> <span class='word'>a</span> <span class='word'>statistical</span> <span class='word'>model</span> <span class='word'>which</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>negate</span> <span class='word'>bin</span> <span class='word'>counts</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>individual's</span> <span class='word'>skin</span> <span class='word'>set</span> <span class='word'>which</span> <span class='word'>corresponded</span> <span class='word'>to</span> <span class='word'>background</span> <span class='word'>values</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Surprisingly</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>approached</span> <span class='word'>failed</span> <span class='word'>to</span> <span class='word'>work</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>background</span> <span class='word'>was</span> <span class='word'>not</span> <span class='word'>represented</span> <span class='word'>well</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>collected</span> <span class='word'>background</span> <span class='word'>statistics</span> <span class='ignore'>(</span><span class='word'>Figure</span><span class='ignore'>~</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>BGFailure</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>CaCb</span><span class='ignore'>_</span><span class='ignore'>bg</span><span class='ignore'>_</span><span class='ignore'>failed.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Initial</span> <span class='oword'>attempt</span> <span class='oword'>at</span> <span class='oword'>removing</span> <span class='oword'>background</span><span class='ignore'>;</span> <span class='oword'>unsuccessful</span><span class='ignore'>.</span><span class='ignore'>}</span> <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>BGFailure</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>background</span> <span class='word'>statistics</span> <span class='word'>changed</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>present</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>photo</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>adjusts</span> <span class='word'>to</span> <span class='word'>images</span> <span class='word'>with</span> <span class='word'>very</span> <span class='word'>strong</span> <span class='word'>color</span> <span class='word'>characteristics</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>color</span> <span class='word'>correction</span> <span class='word'>is</span> <span class='word'>an</span> <span class='word'>undocumented</span> <span class='word'>feature</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>processing</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>only</span> <span class='word'>way</span> <span class='word'>to</span> <span class='word'>compensate</span> <span class='word'>for</span> <span class='word'>this</span> <span class='word'>unwelcome</span> <span class='word'>pre-processing</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>photograph</span> <span class='word'>the</span> <span class='word'>background</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>strongly</span> <span class='word'>contrasting</span> <span class='word'>object</span> <span class='word'>present</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>one</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>easily</span> <span class='word'>cropped</span> <span class='word'>out</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>before</span> <span class='word'>the</span> <span class='word'>background</span> <span class='word'>statistics</span> <span class='word'>are</span> <span class='word'>collected</span><span class='ignore'>.</span> <span class='word'>After</span> <span class='word'>collecting</span> <span class='word'>the</span> <span class='word'>statistics</span> <span class='word'>again</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>result</span> <span class='word'>was</span> <span class='word'>much</span> <span class='word'>improved</span> <span class='ignore'>(</span><span class='word'>Figure</span><span class='ignore'>~</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>BGSuccess1</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.80\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>CaCb</span><span class='ignore'>_</span><span class='ignore'>bg</span><span class='ignore'>_</span><span class='ignore'>success.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Successful</span> <span class='oword'>background</span> <span class='oword'>removal</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>BGSuccess1</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>In</span> <span class='word'>a</span> <span class='word'>real</span> <span class='word'>world</span> <span class='word'>context</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>relatively</span> <span class='word'>safe</span> <span class='word'>to</span> <span class='word'>presume</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>scene</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>chromatically</span> <span class='word'>complex</span> <span class='word'>enough</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>correction</span> <span class='word'>won't</span> <span class='word'>be</span> <span class='word'>detrimental</span> <span class='word'>to</span> <span class='word'>detection</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>perhaps</span> <span class='word'>even</span> <span class='word'>beneficial</span> <span class='word'>under</span> <span class='word'>unusual</span> <span class='word'>lighting</span> <span class='word'>conditions</span><span class='ignore'>.</span> <span class='word'>But</span> <span class='word'>for</span> <span class='word'>gathering</span> <span class='word'>statistics</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>proved</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>a</span> <span class='word'>massive</span> <span class='word'>pain</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>White-Out</span> <span class='hword'>and</span> <span class='hword'>Black-Out</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>WhiteoutAndBlackout</span><span class='ignore'>}</span><br>
<span class='word'>A</span> <span class='word'>monochromatic</span> <span class='word'>object</span> <span class='word'>with</span> <span class='word'>average</span> <span class='word'>RGB</span> <span class='word'>color</span> <span class='mathgroup'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>\mu</span><span class='ignore'>}</span><span class='math'>=</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>R</span><span class='math'>,</span> <span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>G</span><span class='math'>,</span> <span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>B</span> <span class='mathcmd'>\right</span><span class='math'>\}</span><span class='mathgroup'>$</span> <span class='word'>under</span> <span class='word'>different</span> <span class='word'>lighting</span> <span class='word'>conditions</span> <span class='word'>produce</span> <span class='word'>an</span> <span class='word'>in-camera</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>R</span> <span class='math'>+</span><span class='mathcmd'>\lambda</span><span class='math'>,</span> <span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>G</span>&nbsp; <span class='math'>+</span><span class='mathcmd'>\lambda</span><span class='math'>,</span> <span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>B</span> <span class='math'>+</span><span class='mathcmd'>\lambda</span> <span class='mathcmd'>\right</span><span class='math'>\}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>Each</span> <span class='word'>channel</span> <span class='word'>has</span> <span class='word'>a</span> <span class='word'>numerical</span> <span class='word'>limit</span> <span class='word'>which</span> <span class='word'>means</span> <span class='word'>that</span> <span class='word'>when</span> <span class='word'>that</span> <span class='word'>limit</span> <span class='word'>is</span> <span class='word'>reached</span> <span class='word'>further</span> <span class='word'>change</span> <span class='word'>in</span> <span class='word'>luminosity</span> <span class='mathgroup'>$</span><span class='mathcmd'>\lambda</span><span class='mathgroup'>$</span> <span class='word'>will</span> <span class='word'>result</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>change</span> <span class='word'>in</span> <span class='word'>chromatic</span> <span class='word'>value</span><span class='ignore'>.</span> <span class='word'>At</span> <span class='word'>high</span> <span class='word'>luminosities</span> <span class='word'>the</span> <span class='word'>colors</span> <span class='word'>converge</span> <span class='word'>on</span> <span class='word'>white</span> <span class='word'>becoming</span> <span class='word'>washed</span> <span class='word'>out</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>referred</span> <span class='word'>to</span> <span class='word'>as</span> <span class='word'>white-out</span><span class='ignore'>.</span> <span class='word'>Similarly</span> <span class='word'>at</span> <span class='word'>low</span> <span class='word'>luminosities</span> <span class='word'>the</span> <span class='word'>colors</span> <span class='word'>converge</span> <span class='word'>on</span> <span class='word'>black</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>referred</span> <span class='word'>to</span> <span class='word'>as</span> <span class='word'>black-out</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span> <span class='comment'>%hi-res</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.80\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>WOBOFig.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>White-out</span> <span class='oword'>and</span> <span class='oword'>Black-out</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>WoBo1</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>It</span> <span class='word'>is</span> <span class='word'>reasonable</span> <span class='word'>to</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>contain</span> <span class='word'>fully</span> <span class='word'>saturated</span> <span class='word'>channel</span> <span class='word'>elements</span> <span class='word'>are</span> <span class='word'>unreliable</span> <span class='word'>as</span> <span class='word'>they</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>the</span> <span class='word'>result</span> <span class='word'>of</span> <span class='word'>white-out</span> <span class='word'>or</span> <span class='word'>black-out</span><span class='ignore'>.</span> <span class='word'>Unfortunately</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>also</span> <span class='word'>performs</span> <span class='word'>a</span> <span class='word'>auto</span> <span class='word'>brightness</span> <span class='word'>and</span> <span class='word'>contrast</span> <span class='word'>adjustment</span> <span class='word'>moving</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>away</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>sides</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>result</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>processing</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>luminosity</span> <span class='word'>above</span> <span class='mathgroup'>$</span><span class='mathcmd'>\lambda</span><span class='math'>_</span><span class='math'>w</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>below</span> <span class='mathgroup'>$</span><span class='mathcmd'>\lambda</span><span class='math'>_</span><span class='math'>b</span><span class='mathgroup'>$</span> <span class='word'>are</span> <span class='word'>unreliable</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Algorithm</span> <span class='hword'>for</span> <span class='hword'>Generating</span> <span class='hword'>the</span> <span class='hword'>Model</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>AlgorithmForGeneratingModel</span><span class='ignore'>}</span><br>
<span class='word'>Here</span> <span class='word'>we</span> <span class='word'>present</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>generate</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>model</span><span class='ignore'>.</span> <span class='word'>It's</span> <span class='word'>assumed</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>RGB</span> <span class='word'>image</span> <span class='word'>sets</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>with</span> <span class='word'>simple</span><span class='ignore'>,</span> <span class='word'>monochromatic</span> <span class='word'>backgrounds</span><span class='ignore'>.</span><br>
<br>
<span class='comment'>%\animategraphics[loop,autoplay,controls]{12}{Chapter3/Figs/FSkin/RGB_FSkin_Bin_Animation/frame}{0001}{0025}</span><br>
<span class='comment'>%\animategraphics[loop,autoplay,controls]{12}{Chapter3/Figs/FSkin/RGB_FSkin_Bin_Skinned_Animation/frame}{0001}{0025}</span><br>
<span class='comment'>%\animategraphics[loop,autoplay,controls]{12}{Chapter3/Figs/FSkin/RGB_FSkin_Bin_Skinned_Rot_Animation/frame}{0001}{0025}</span><br>
<span class='comment'>%\animategraphics[loop,autoplay,controls]{12}{Chapter3/Figs/FSkin/RGB_FSkin_Bin_Skinned_Rot_TopTail_Animation/frame}{0001}{0025}</span><br>
<br>
<br>
<span class='comment'>%\includemedia[</span><br>
<span class='comment'>%&nbsp; label=cube_test,</span><br>
<span class='comment'>%&nbsp; width=0.7\linewidth,height=0.7\linewidth,</span><br>
<span class='comment'>%&nbsp; addresource=Chapter3/Figs/Animation/RGB_FSkin_Hand_Bin.swf, %two video files</span><br>
<span class='comment'>%&nbsp; transparent,</span><br>
<span class='comment'>%&nbsp; activate=pageopen,</span><br>
<span class='comment'>%&nbsp; flashvars={</span><br>
<span class='comment'>%&nbsp; &nbsp; source=Chapter3/Figs/Animation/RGB_FSkin_Hand_Bin.swf</span><br>
<span class='comment'>%&nbsp;  &amp;loop=true</span><br>
<span class='comment'>%&nbsp;  &amp;scaleMode=letterbox</span><br>
<span class='comment'>%&nbsp; }</span><br>
<span class='comment'>%]{}{Chapter3/Figs/Animation/RGB_FSkin_Hand_Bin.swf}</span><br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>RGB</span> <span class='hword'>Bin</span> <span class='hword'>Allocation</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>RGBBinAllocation</span><span class='ignore'>}</span><br>
<br>
<br>
<span class='comment'>% Choose an individual for the plots</span><br>
<span class='comment'>%\def\individual{FJN}</span><br>
<span class='cmd'>\def</span><span class='ignore'>\individual</span><span class='ignore'>{</span><span class='ignore'>FSkin</span><span class='ignore'>}</span><br>
<span class='comment'>%\def\individual{JSkin}</span><br>
<span class='comment'>%\def\individual{NSkin}</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.9\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='exclcmd'>\individual</span><span class='ignore'>/</span><span class='ignore'>Fill</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>3D</span> <span class='oword'>RGB</span> <span class='oword'>histogram</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='oword'>Distinct</span> <span class='oword'>distributions</span> <span class='oword'>can</span> <span class='oword'>be</span> <span class='oword'>seen</span> <span class='oword'>for</span> <span class='oword'>the</span> <span class='oword'>Skin</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>background</span><span class='ignore'>.</span> <span class='oword'>Here</span> <span class='oword'>the</span> <span class='oword'>bin</span> <span class='oword'>color</span> <span class='oword'>corresponds</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>color</span> <span class='oword'>which</span> <span class='oword'>that</span> <span class='oword'>bin</span> <span class='oword'>represents</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>opacity</span> <span class='oword'>indicates</span> <span class='oword'>the</span> <span class='oword'>frequency</span> <span class='oword'>of</span> <span class='oword'>that</span> <span class='oword'>bin</span> <span class='oword'>value</span><span class='ignore'>.</span> <span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Fill</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>first</span> <span class='word'>problem</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>large</span> <span class='word'>image</span> <span class='word'>set</span> <span class='word'>with</span> <span class='word'>large</span> <span class='word'>images</span><span class='ignore'>.</span> <span class='word'>We're</span> <span class='word'>only</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>individual</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>produce</span> <span class='word'>a</span> <span class='word'>3D</span> <span class='word'>histogram</span> <span class='word'>with</span> <span class='word'>one</span> <span class='word'>bin</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>RGB</span> <span class='word'>combination</span> <span class='word'>giving</span> <span class='word'>256x256x256</span> <span class='word'>bins</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>very</span> <span class='word'>large</span> <span class='word'>data</span> <span class='word'>set</span> <span class='word'>but</span> <span class='word'>it's</span> <span class='word'>easier</span> <span class='word'>to</span> <span class='word'>work</span> <span class='word'>with</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>images</span> <span class='word'>and</span> <span class='word'>is</span> <span class='word'>guaranteed</span> <span class='word'>to</span> <span class='word'>contain</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>relevant</span> <span class='word'>information</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>statistics</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>written</span> <span class='word'>in</span> <span class='word'>MATLAB</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>it</span> <span class='word'>runs</span> <span class='word'>through</span> <span class='word'>each</span> <span class='word'>pixel</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>set</span><span class='ignore'>,</span> <span class='word'>incrementing</span> <span class='word'>the</span> <span class='word'>corresponding</span> <span class='word'>bin</span> <span class='word'>keeping</span> <span class='word'>a</span> <span class='word'>count</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>bin</span> <span class='word'>allocations</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>total</span> <span class='word'>pixel</span> <span class='word'>count</span><span class='ignore'>.</span> <span class='word'>After</span> <span class='word'>it's</span> <span class='word'>run</span> <span class='word'>through</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>images</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>finds</span> <span class='word'>and</span> <span class='word'>records</span> <span class='word'>largest</span> <span class='word'>bin</span> <span class='word'>count</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>normalized</span> <span class='word'>bin</span> <span class='word'>when</span> <span class='word'>requested</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Skinning</span> <span class='hword'>the</span> <span class='hword'>Bins</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>SkinningTheBins</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span> <span class='comment'>%hi-res</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='exclcmd'>\individual</span><span class='ignore'>/</span><span class='ignore'>Skin</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>3D</span> <span class='oword'>RGB</span> <span class='oword'>histogram</span> <span class='oword'>after</span> <span class='ignore'>'</span><span class='oword'>skinning</span><span class='ignore'>'</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='oword'>Distinct</span> <span class='oword'>distributions</span> <span class='oword'>can</span> <span class='oword'>be</span> <span class='oword'>seen</span> <span class='oword'>for</span> <span class='oword'>the</span> <span class='oword'>Skin</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>background</span><span class='ignore'>.</span> <span class='oword'>Here</span> <span class='oword'>the</span> <span class='oword'>bin</span> <span class='oword'>color</span> <span class='oword'>corresponds</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>color</span> <span class='oword'>which</span> <span class='oword'>that</span> <span class='oword'>bin</span> <span class='oword'>represents</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>opacity</span> <span class='oword'>indicates</span> <span class='oword'>the</span> <span class='oword'>frequency</span> <span class='oword'>of</span> <span class='oword'>that</span> <span class='oword'>bin</span> <span class='oword'>value</span><span class='ignore'>.</span> <span class='oword'>Bin</span> <span class='oword'>counts</span> <span class='oword'>outside</span> <span class='oword'>the</span> <span class='oword'>black</span> <span class='oword'>lines</span> <span class='oword'>are</span> <span class='oword'>set</span> <span class='oword'>to</span> <span class='oword'>zero</span><span class='ignore'>.</span> <span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Skin</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>Next</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>bins</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>extreme</span> <span class='word'>edges</span> <span class='ignore'>(</span><span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>the</span> <span class='word'>ones</span> <span class='word'>which</span> <span class='word'>correspond</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>outer</span> <span class='word'>faces</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span><span class='ignore'>)</span> <span class='word'>are</span> <span class='word'>set</span> <span class='word'>equal</span> <span class='word'>to</span> <span class='word'>0</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>specified</span> <span class='word'>depth</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>example</span><span class='ignore'>:</span> <span class='word'>if</span> <span class='word'>a</span> <span class='word'>depth</span> <span class='word'>of</span> <span class='word'>3</span> <span class='word'>is</span> <span class='word'>requested</span><span class='ignore'>,</span> <span class='word'>bins</span> <span class='word'>of</span> <span class='word'>positions</span> <span class='word'>0</span><span class='ignore'>,</span> <span class='word'>1</span> <span class='word'>and</span> <span class='word'>2</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>253</span><span class='ignore'>,</span> <span class='word'>254</span> <span class='word'>and</span> <span class='word'>255</span> <span class='word'>are</span> <span class='word'>set</span> <span class='word'>to</span> <span class='word'>0</span> <span class='word'>in</span> <span class='word'>all</span> <span class='word'>three</span> <span class='word'>dimensions</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>total</span> <span class='word'>pixel</span> <span class='word'>count</span> <span class='word'>is</span> <span class='word'>adjusted</span> <span class='word'>to</span> <span class='word'>compensate</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>nulled</span> <span class='word'>bin</span> <span class='word'>counts</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>to</span> <span class='word'>address</span> <span class='word'>problems</span> <span class='word'>of</span> <span class='word'>white-out</span> <span class='word'>and</span> <span class='word'>black-out</span> <span class='word'>as</span> <span class='word'>described</span> <span class='word'>in</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>WhiteoutAndBlackout</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<br>
<br>
<span class='word'>It</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>noted</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>reason</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span> <span class='word'>is</span> <span class='word'>skinned</span> <span class='word'>before</span> <span class='word'>rotation</span> <span class='word'>is</span> <span class='word'>because</span> <span class='word'>it's</span> <span class='word'>not</span> <span class='word'>as</span> <span class='word'>easy</span> <span class='word'>to</span> <span class='word'>do</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>color-space</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Rotating</span> <span class='hword'>the</span> <span class='hword'>Bins</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>RotatingTheBins</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span> <span class='comment'>%hi-res</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='exclcmd'>\individual</span><span class='ignore'>/</span><span class='ignore'>Rotate</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>3D</span> <span class='oword'>RGB</span> <span class='oword'>histogram</span> <span class='oword'>after</span> <span class='oword'>rotation</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>skin</span> <span class='oword'>and</span> <span class='oword'>background</span> <span class='oword'>distributions</span> <span class='oword'>can</span> <span class='oword'>be</span> <span class='oword'>seen</span> <span class='oword'>for</span> <span class='oword'>the</span> <span class='oword'>Skin</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>background</span><span class='ignore'>.</span> <span class='oword'>Here</span> <span class='oword'>the</span> <span class='oword'>bin</span> <span class='oword'>color</span> <span class='oword'>corresponds</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>color</span> <span class='oword'>which</span> <span class='oword'>that</span> <span class='oword'>bin</span> <span class='oword'>represents</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>opacity</span> <span class='oword'>indicates</span> <span class='oword'>the</span> <span class='oword'>frequency</span> <span class='oword'>of</span> <span class='oword'>that</span> <span class='oword'>bin</span> <span class='oword'>value</span><span class='ignore'>.</span> <span class='oword'>Bin</span> <span class='oword'>counts</span> <span class='oword'>outside</span> <span class='oword'>the</span> <span class='oword'>black</span> <span class='oword'>lines</span> <span class='oword'>are</span> <span class='oword'>set</span> <span class='oword'>to</span> <span class='oword'>zero</span><span class='ignore'>.</span> <span class='ignore'>}</span>   <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Rotate</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>Because</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>bins</span> <span class='word'>corresponds</span> <span class='word'>to</span> <span class='word'>just</span> <span class='word'>one</span> <span class='word'>RGB</span> <span class='word'>value</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>equivalent</span> <span class='word'>bin</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>LCaCb</span> <span class='word'>space</span> <span class='word'>simply</span> <span class='word'>by</span> <span class='word'>rotating</span> <span class='word'>the</span> <span class='word'>bin</span> <span class='word'>index</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>normalized</span> <span class='word'>rotation</span> <span class='word'>as</span> <span class='word'>described</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>normalised</span> <span class='word'>rotation</span> <span class='word'>is</span> <span class='word'>used</span> <span class='word'>as</span> <span class='word'>we</span> <span class='word'>desire</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='mathgroup'>$</span><span class='math'>\mu</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>standard</span> <span class='word'>deviation</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>specified</span> <span class='word'>in</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='math'>:</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>range</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>easier</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>where</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>axes</span> <span class='word'>are</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>length</span><span class='ignore'>.</span> <span class='word'>With</span> <span class='word'>this</span> <span class='word'>done</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>now</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>bins</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>LCaCb</span> <span class='word'>color-space</span> <span class='word'>equivalent</span> <span class='word'>to</span> <span class='word'>that</span> <span class='word'>which</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>if</span> <span class='word'>we</span> <span class='word'>had</span> <span class='word'>applied</span> <span class='word'>the</span> <span class='word'>transform</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>images</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>collected</span> <span class='word'>the</span> <span class='word'>statistics</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>transformed</span> <span class='word'>images</span><span class='ignore'>.</span><br>
<br>
<br>
<br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Top</span> <span class='hword'>and</span> <span class='hword'>Tail</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>TopAndTail</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span> <span class='comment'>%hi-res</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.9\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='exclcmd'>\individual</span><span class='ignore'>/</span><span class='ignore'>Top</span><span class='ignore'>_</span><span class='ignore'>and</span><span class='ignore'>_</span><span class='ignore'>Tail</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Filling</span> <span class='oword'>the</span> <span class='oword'>RGB</span> <span class='oword'>Bins</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Top</span><span class='ignore'>_</span><span class='ignore'>and</span><span class='ignore'>_</span><span class='ignore'>Tail</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<br>
<span class='word'>Naively</span> <span class='word'>collapsing</span> <span class='word'>the</span> <span class='word'>bins</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>axis</span> <span class='word'>artificially</span> <span class='word'>skews</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>distribution</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>which</span> <span class='word'>passed</span> <span class='word'>through</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>axis</span><span class='ignore'>;</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>easily</span> <span class='word'>explained</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>white-out</span> <span class='word'>and</span> <span class='word'>black-out</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>WhiteoutAndBlackout</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <br>
<span class='word'>Although</span> <span class='word'>we've</span> <span class='ignore'>"</span><span class='word'>skinned</span><span class='ignore'>"</span> <span class='word'>the</span> <span class='word'>bins</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>white</span> <span class='word'>and</span> <span class='word'>black</span> <span class='word'>tips</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>cube</span> <span class='word'>suffer</span> <span class='word'>from</span> <span class='word'>white-out</span> <span class='word'>and</span> <span class='word'>black-out</span> <span class='word'>more</span> <span class='word'>than</span> <span class='word'>any</span> <span class='word'>other</span> <span class='word'>regions</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>there's</span> <span class='word'>a</span> <span class='word'>tendency</span> <span class='word'>for</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>to</span> <span class='word'>converge</span> <span class='word'>under</span> <span class='word'>the</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>black</span> <span class='word'>point</span> <span class='word'>without</span> <span class='word'>necessarily</span> <span class='word'>hitting</span> <span class='word'>the</span> <span class='word'>side</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>cube</span> <span class='word'>first</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>contrast</span> <span class='word'>and</span> <span class='word'>brightness</span> <span class='word'>adjustment</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span>&nbsp;  <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Top</span><span class='ignore'>_</span><span class='ignore'>and</span><span class='ignore'>_</span><span class='ignore'>Tail</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>We</span> <span class='word'>collapse</span> <span class='word'>the</span> <span class='word'>bins</span> <span class='word'>excluding</span> <span class='word'>the</span> <span class='word'>bins</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>clearly</span> <span class='word'>suffering</span> <span class='word'>from</span> <span class='word'>white-out</span> <span class='word'>and</span> <span class='word'>black-out</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>could</span> <span class='word'>be</span> <span class='word'>done</span> <span class='word'>mathematically</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>bin</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>furthest</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>axis</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>intersection</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span> <span class='word'>when</span> <span class='word'>this</span> <span class='word'>chromatic</span> <span class='word'>value</span> <span class='word'>is</span> <span class='word'>at</span> <span class='word'>its</span> <span class='word'>limits</span><span class='ignore'>,</span> <span class='word'>just</span> <span class='word'>before</span> <span class='word'>it</span> <span class='word'>reaches</span> <span class='word'>the</span> <span class='word'>edge</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>cube</span> <span class='word'>where</span> <span class='word'>it</span> <span class='word'>suffers</span> <span class='word'>from</span> <span class='word'>white-out</span> <span class='word'>or</span> <span class='word'>black-out</span><span class='ignore'>.</span> <span class='word'>But</span> <span class='word'>it's</span> <span class='word'>a</span> <span class='word'>simple</span> <span class='word'>matter</span> <span class='word'>to</span> <span class='word'>look</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>three</span> <span class='word'>projections</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>3D</span> <span class='word'>LCaCb</span> <span class='word'>bins</span> <span class='word'>and</span> <span class='word'>manually</span> <span class='word'>determine</span> <span class='word'>the</span> <span class='word'>limits</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>valid</span> <span class='word'>region</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Collapsing</span> <span class='hword'>the</span> <span class='hword'>Bins</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>CollapsingTheBins</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.6\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='exclcmd'>\individual</span><span class='ignore'>/</span><span class='ignore'>Collapse</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>2D</span> <span class='oword'>histogram</span> <span class='oword'>after</span> <span class='oword'>summing</span> <span class='oword'>along</span> <span class='oword'>the</span> <span class='oword'>luminosity</span> <span class='oword'>axis</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>color</span> <span class='oword'>corresponds</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>chromatic</span> <span class='oword'>value</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>bin</span> <span class='oword'>at</span> <span class='oword'>average</span> <span class='oword'>luminosity</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>opacity</span> <span class='oword'>corresponds</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>frequency</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>chromatic</span> <span class='oword'>value</span><span class='ignore'>.</span> <span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Collapse</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='envir'>\end</span><span class='envir'>{figure}</span><br>
&nbsp; &nbsp; <br>
<span class='word'>Because</span> <span class='word'>we're</span> <span class='word'>modelling</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>space</span> <span class='word'>and</span> <span class='word'>not</span> <span class='word'>the</span> <span class='word'>luminosity</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>now</span> <span class='word'>collapse</span> <span class='word'>the</span> <span class='word'>3D</span> <span class='word'>histogram</span> <span class='word'>by</span> <span class='word'>summing</span> <span class='word'>the</span> <span class='word'>bin</span> <span class='word'>values</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>axis</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>now</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>2D</span> <span class='word'>histogram</span> <span class='word'>in</span> <span class='word'>CaCb</span> <span class='word'>chromatic</span> <span class='word'>space</span><span class='ignore'>.</span><br>
<br>
<br>
<br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>De-Speckling</span> <span class='hword'>the</span> <span class='hword'>Bin</span> <span class='hword'>Values</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>DeSpeckle</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='exclcmd'>\individual</span><span class='ignore'>/</span><span class='ignore'>Despeckle</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>De-speckled</span> <span class='oword'>Bins</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>action</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>de-speckling</span> <span class='oword'>algorithm</span> <span class='oword'>can</span> <span class='oword'>be</span> <span class='oword'>seen</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>right-hand</span> <span class='oword'>close-up</span> <span class='oword'>panels</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Despeckle</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='envir'>\end</span><span class='envir'>{figure}</span><br>
&nbsp; &nbsp; <br>
<span class='word'>The</span> <span class='word'>raw</span> <span class='word'>camera</span> <span class='word'>output</span> <span class='word'>has</span><span class='ignore'>,</span> <span class='word'>by</span> <span class='word'>this</span> <span class='word'>stage</span><span class='ignore'>,</span> <span class='word'>undergone</span> <span class='word'>two</span> <span class='word'>rounds</span> <span class='word'>of</span> <span class='word'>processing</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>first</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>device</span><span class='ignore'>,</span> <span class='word'>before</span> <span class='word'>the</span> <span class='word'>AP</span> <span class='word'>layer</span><span class='ignore'>,</span> <span class='word'>creating</span> <span class='word'>an</span> <span class='word'>8-bit</span> <span class='word'>RGB</span> <span class='word'>image</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>LCaCb</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>processes</span> <span class='word'>are</span><span class='ignore'>,</span> <span class='word'>unfortunately</span><span class='ignore'>,</span> <span class='word'>not</span> <span class='word'>1-to-1</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>results</span> <span class='word'>in</span> <span class='word'>some</span> <span class='word'>bins</span> <span class='word'>being</span> <span class='word'>artificially</span> <span class='word'>overpopulated</span> <span class='word'>and</span> <span class='word'>other</span> <span class='word'>bins</span> <span class='word'>becoming</span> <span class='word'>artificially</span> <span class='word'>empty</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>effect</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>LCaCb</span> <span class='word'>rotation</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>controlled</span> <span class='word'>by</span> <span class='word'>extending</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>lengths</span><span class='ignore'>;</span> <span class='word'>this</span> <span class='word'>process</span> <span class='word'>can</span> <span class='word'>make</span> <span class='word'>for</span> <span class='word'>at</span> <span class='word'>worst</span> <span class='word'>1-to-1</span> <span class='word'>correspondence</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>necessarily</span> <span class='word'>introduces</span> <span class='word'>a</span> <span class='word'>greater</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>inaccessible</span> <span class='word'>bins</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>collecting</span> <span class='word'>the</span> <span class='word'>statistics</span><span class='ignore'>,</span> <span class='word'>these</span> <span class='word'>effects</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>problematic</span> <span class='word'>aside</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>fact</span> <span class='word'>that</span> <span class='word'>it</span> <span class='word'>introduces</span> <span class='word'>empty</span> <span class='word'>bins</span> <span class='word'>inside</span> <span class='word'>the</span> <span class='word'>main</span> <span class='word'>region</span> <span class='word'>of</span> <span class='word'>interest</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>causes</span> <span class='word'>difficulties</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>further</span> <span class='word'>down</span> <span class='word'>the</span> <span class='word'>line</span><span class='ignore'>.</span> <span class='word'>Graphically</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>problem</span> <span class='word'>looks</span> <span class='word'>like</span> <span class='word'>speckling</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>speckling</span> <span class='word'>is</span> <span class='word'>also</span> <span class='word'>apparent</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>bins</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>assumed</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>result</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>pre-processing</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>device</span> <span class='word'>before</span> <span class='word'>the</span> <span class='word'>AP</span> <span class='word'>layer</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>is</span> <span class='word'>noteworthy</span> <span class='word'>that</span> <span class='word'>although</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>claims</span> <span class='word'>to</span> <span class='word'>capture</span> <span class='word'>full</span> <span class='word'>3-channel</span><span class='ignore'>,</span> <span class='word'>8-bit</span> <span class='word'>RGB</span> <span class='word'>information</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>quite</span> <span class='word'>true</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>In</span> <span class='word'>attempting</span> <span class='word'>to</span> <span class='word'>solve</span> <span class='word'>this</span> <span class='word'>problem</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>obvious</span> <span class='word'>idea</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>non-zero</span> <span class='word'>bins</span> <span class='word'>and</span> <span class='word'>fit</span> <span class='word'>an</span> <span class='word'>interpolating</span> <span class='word'>function</span> <span class='word'>between</span> <span class='word'>them</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>will</span> <span class='word'>effectively</span> <span class='word'>remove</span> <span class='word'>the</span> <span class='word'>empty</span> <span class='word'>bin</span> <span class='word'>artefacts</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>densely-packed</span> <span class='word'>region</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>we're</span> <span class='word'>interested</span> <span class='word'>in</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>empty</span> <span class='word'>bins</span> <span class='word'>outside</span> <span class='word'>the</span> <span class='word'>main</span> <span class='word'>distribution</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>artefacts</span> <span class='word'>and</span> <span class='word'>are</span> <span class='word'>genuinely</span> <span class='word'>empty</span> <span class='word'>bins</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>removing</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>empty</span> <span class='word'>bins</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>fitting</span> <span class='word'>the</span> <span class='word'>function</span> <span class='word'>joins</span> <span class='word'>together</span> <span class='word'>any</span> <span class='word'>outlying</span> <span class='word'>points</span> <span class='word'>or</span> <span class='word'>secondary</span> <span class='word'>distributions</span> <span class='word'>corresponding</span> <span class='word'>to</span> <span class='word'>regions</span> <span class='word'>such</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>background</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>therefore</span> <span class='word'>desire</span> <span class='word'>a</span> <span class='word'>method</span> <span class='word'>which</span> <span class='word'>will</span> <span class='word'>allow</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>keep</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>non-empty</span> <span class='word'>bins</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>empty</span> <span class='word'>bins</span> <span class='word'>outside</span> <span class='word'>the</span> <span class='word'>main</span> <span class='word'>distribution</span><span class='ignore'>,</span> <span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>genuinely</span> <span class='word'>empty</span> <span class='word'>bins</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>achieve</span> <span class='word'>this</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>designed</span> <span class='word'>a</span> <span class='word'>Matlab</span> <span class='word'>routine</span> <span class='word'>which</span> <span class='word'>essentially</span> <span class='word'>paints</span> <span class='word'>a</span> <span class='word'>region</span> <span class='word'>around</span> <span class='word'>each</span> <span class='word'>non-zero</span> <span class='word'>point</span><span class='ignore'>,</span> <span class='word'>marking</span> <span class='word'>it</span> <span class='word'>as</span> <span class='word'>part</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>main</span> <span class='word'>distribution</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>then</span> <span class='word'>takes</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>unmarked</span> <span class='word'>regions</span> <span class='word'>and</span> <span class='word'>includes</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>empty</span> <span class='word'>bins</span> <span class='word'>in</span> <span class='word'>those</span> <span class='word'>regions</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>non-empty</span> <span class='word'>bins</span> <span class='word'>and</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>empty</span> <span class='word'>bins</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>unmarked</span> <span class='word'>regions</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>requirement</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>simple</span> <span class='word'>interpolating</span> <span class='word'>function</span> <span class='word'>can</span> <span class='word'>easily</span> <span class='word'>be</span> <span class='word'>fitted</span> <span class='word'>to</span> <span class='word'>those</span> <span class='word'>points</span><span class='ignore'>.</span><br>
<br>
<br>
<br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Blob</span> <span class='hword'>Detection</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>BlobDetection</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='exclcmd'>\individual</span><span class='ignore'>/</span><span class='ignore'>Find</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Blobs.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>Blob</span> <span class='oword'>Detection</span><span class='ignore'>.</span><span class='ignore'>}</span> <span class='oword'>The</span> <span class='oword'>detected</span> <span class='oword'>blobs</span> <span class='oword'>can</span> <span class='oword'>be</span> <span class='oword'>seen</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>right-hand</span> <span class='oword'>panel</span> <span class='oword'>with</span> <span class='oword'>the</span> <span class='oword'>ellipse</span> <span class='oword'>fit</span> <span class='oword'>overlayed</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>split</span> <span class='oword'>does</span> <span class='oword'>not</span> <span class='oword'>depend</span> <span class='oword'>on</span> <span class='oword'>the</span> <span class='oword'>ellipse</span> <span class='oword'>but</span> <span class='oword'>on</span> <span class='oword'>the</span> <span class='oword'>extreme</span> <span class='oword'>edges</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>blob</span><span class='ignore'>.</span><span class='ignore'>}</span> <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Find</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Blobs</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='envir'>\end</span><span class='envir'>{figure}</span><br>
&nbsp; &nbsp; <br>
<span class='word'>Having</span> <span class='word'>removed</span> <span class='word'>the</span> <span class='word'>empty</span> <span class='word'>bin</span> <span class='word'>artefacts</span> <span class='word'>and</span> <span class='word'>compensated</span> <span class='word'>for</span> <span class='word'>white-out</span><span class='ignore'>/</span><span class='word'>black-out</span> <span class='word'>effects</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>final</span> <span class='word'>step</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>remove</span> <span class='word'>the</span> <span class='word'>bin</span> <span class='word'>counts</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>bins</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>associated</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>background</span><span class='ignore'>,</span> <span class='word'>thereby</span> <span class='word'>leaving</span> <span class='word'>a</span> <span class='word'>distribution</span> <span class='word'>which</span> <span class='word'>corresponds</span> <span class='word'>to</span> <span class='word'>chromatic</span> <span class='word'>skin</span> <span class='word'>values</span> <span class='word'>and</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>artefact</span> <span class='word'>and</span> <span class='word'>systematic-error-free</span><span class='ignore'>.</span> <span class='word'>With</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>bins</span> <span class='word'>processed</span> <span class='word'>as</span> <span class='word'>they</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>so</span> <span class='word'>far</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>clear</span> <span class='word'>that</span> <span class='word'>there</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>distinct</span> <span class='word'>distribution</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>distinct</span> <span class='word'>distribution</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>background</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>distribution</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>background</span> <span class='word'>was</span> <span class='word'>produced</span> <span class='word'>earlier</span><span class='ignore'>,</span> <span class='word'>compensating</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>iPhone's</span> <span class='word'>pre-AP-layer</span> <span class='word'>processing</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>Using</span> <span class='word'>MATLAB's</span> <span class='word'>blob</span> <span class='word'>detection</span> <span class='word'>algorithm</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>distinct</span> <span class='word'>patches</span> <span class='word'>of</span> <span class='word'>chromatic</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>expect</span> <span class='word'>there</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>two</span> <span class='word'>distinct</span> <span class='word'>blobs</span><span class='ignore'>:</span> <span class='word'>one</span> <span class='word'>corresponding</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>skin</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>one</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>monochromatic</span> <span class='word'>background</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>distribution</span> <span class='word'>is</span> <span class='word'>divided</span> <span class='word'>into</span> <span class='word'>two</span><span class='ignore'>,</span> <span class='word'>one</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>detected</span> <span class='word'>blobs</span> <span class='ignore'>(</span><span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Find</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Blobs</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>blob</span> <span class='word'>detection</span> <span class='word'>algorithm</span> <span class='word'>also</span> <span class='word'>returns</span> <span class='word'>the</span> <span class='word'>center</span> <span class='mathgroup'>$</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\mu</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>eccentricity</span> <span class='mathgroup'>$</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>major</span> <span class='word'>and</span> <span class='word'>minor</span> <span class='word'>axis</span> <span class='mathgroup'>$</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\sigma</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>an</span> <span class='word'>ellipse</span> <span class='word'>which</span> <span class='word'>most</span> <span class='word'>closely</span> <span class='word'>fits</span> <span class='word'>the</span> <span class='word'>blob</span> <span class='word'>shape</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>distribution</span> <span class='word'>which</span> <span class='word'>contains</span> <span class='word'>the</span> <span class='word'>blob</span> <span class='word'>center</span> <span class='word'>closest</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>reference</span> <span class='word'>skin</span> <span class='word'>value</span> <span class='word'>is</span> <span class='word'>chosen</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>distribution</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>ellipse</span> <span class='word'>values</span> <span class='word'>are</span> <span class='word'>passed</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>next</span> <span class='word'>step</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>Gaussian</span> <span class='word'>fit</span> <span class='word'>is</span> <span class='word'>obtained</span><span class='ignore'>.</span> <span class='word'>Only</span> <span class='word'>the</span> <span class='word'>bin</span> <span class='word'>values</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>extreme</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>blob</span> <span class='word'>are</span> <span class='word'>passed</span> <span class='word'>on</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>next</span> <span class='word'>stage</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>Gaussian</span> <span class='hword'>Fit</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>TheGaussianFit</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span> <span class='comment'>%hi-res</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='exclcmd'>\individual</span><span class='ignore'>/</span><span class='ignore'>Fit</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Gaussian0.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>Gaussian</span> <span class='oword'>fit</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>blob</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Fit</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Gaussian0</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<br>
<span class='word'>We</span> <span class='word'>now</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>histogram</span> <span class='word'>which</span> <span class='word'>has</span> <span class='word'>bin</span> <span class='word'>values</span> <span class='word'>relevant</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>and</span> <span class='word'>no</span> <span class='word'>others</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>now</span> <span class='word'>fit</span> <span class='word'>a</span> <span class='word'>2D</span> <span class='word'>Gaussian</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>normalized</span> <span class='word'>histogram</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>initializing</span> <span class='word'>the</span> <span class='word'>routine</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>blob</span> <span class='word'>center</span> <span class='mathgroup'>$</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\mu</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='mathgroup'>$</span><span class='math'>\mu</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>the</span>&nbsp; <span class='word'>elliptical</span> <span class='word'>axis</span> <span class='word'>lengths</span> <span class='mathgroup'>$</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\sigma</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>standard</span> <span class='word'>deviation</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>and</span> <span class='word'>the</span> <span class='word'>eccentricity</span> <span class='mathgroup'>$</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>for</span> <span class='word'>the</span> <span class='word'>orientation</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>provided</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>blob</span> <span class='word'>detection</span><span class='ignore'>.</span><br>
<br>
<span class='word'>A</span> <span class='word'>least</span> <span class='word'>squares</span> <span class='word'>fit</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>2D</span> <span class='word'>Histogram</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>2D</span> <span class='word'>gaussian</span> <span class='word'>function</span> <span class='ignore'>(</span><span class='word'>eq</span><span class='ignore'>.</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>2DGaussian</span><span class='ignore'>}</span><span class='ignore'>)</span>&nbsp; <span class='word'>is</span> <span class='word'>found</span> <span class='word'>using</span> <span class='word'>MatLab's</span> <span class='word'>lsqcurvefit</span><span class='ignore'>.</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\CaMu</span><span class='ignore'>}</span><span class='ignore'>{</span> <span class='ignore'>\overline</span><span class='ignore'>{</span><span class='ignore'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>Ca</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\CbMu</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\overline</span><span class='ignore'>{</span><span class='ignore'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>Cb</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>}</span><br>
<span class='envir'>\begin</span><span class='envir'>{gather}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>2DGaussian</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>Let</span><span class='ignore'>}</span> <span class='exclcmd'>\quad</span> <span class='exclcmd'>\CaMu</span> <span class='ignore'>=</span> <span class='exclcmd'>\text</span><span class='ignore'>{</span><span class='ignore'>Ca</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\mu</span><span class='ignore'>_</span><span class='ignore'>1</span> <span class='exclcmd'>\quad</span> <span class='exclcmd'>\text</span><span class='ignore'>{</span><span class='ignore'>and</span><span class='ignore'>}</span> <span class='exclcmd'>\quad</span> <span class='exclcmd'>\CbMu</span> <span class='ignore'>=</span> <span class='exclcmd'>\text</span><span class='ignore'>{</span><span class='ignore'>Cb</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\mu</span><span class='ignore'>_</span><span class='ignore'>2</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\exp</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><br>
<span class='ignore'>-</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='ignore'>-</span> <span class='exclcmd'>\CaMu</span> <span class='exclcmd'>\;</span> <span class='exclcmd'>\sine</span><span class='ignore'>{</span>&nbsp; &nbsp;  <span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='ignore'>+</span> <span class='exclcmd'>\CbMu</span> <span class='exclcmd'>\;</span> <span class='exclcmd'>\cosine</span><span class='ignore'>{</span> <span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\right</span><span class='ignore'>)</span><span class='ignore'>{</span><span class='ignore'>}</span><span class='ignore'>^</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span> <span class='exclcmd'>\sigma</span><span class='ignore'>_</span><span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='ignore'>-</span> <br>
<span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='exclcmd'>\left</span><span class='ignore'>(</span>&nbsp; &nbsp; &nbsp; <span class='exclcmd'>\CaMu</span> <span class='exclcmd'>\;</span> <span class='exclcmd'>\cosine</span><span class='ignore'>{</span> <span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='ignore'>+</span> <span class='exclcmd'>\CbMu</span> <span class='exclcmd'>\;</span> <span class='exclcmd'>\sine</span><span class='ignore'>{</span>&nbsp; &nbsp; &nbsp; <span class='ignore'>\theta</span><span class='ignore'>}</span> <span class='exclcmd'>\right</span><span class='ignore'>)</span><span class='ignore'>{</span><span class='ignore'>}</span><span class='ignore'>^</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span> <span class='exclcmd'>\sigma</span><span class='ignore'>_</span><span class='ignore'>1</span><span class='ignore'>^</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='exclcmd'>\right</span><span class='ignore'>)</span><br>
<span class='envir'>\end</span><span class='envir'>{gather}</span><br>
<br>
<br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Sample</span> <span class='hword'>Sets</span> <span class='hword'>and</span> <span class='hword'>Results</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>SampleSets</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='exclcmd'>\individual</span><span class='ignore'>/</span><span class='ignore'>Despeckle</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins</span><span class='ignore'>_</span><span class='ignore'>Surf.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>Ca</span> <span class='oword'>Cb</span> <span class='oword'>histogram</span> <span class='oword'>for</span> <span class='oword'>the</span> <span class='oword'>combined</span> <span class='oword'>F</span><span class='ignore'>,</span><span class='oword'>J</span><span class='cmd'>\&amp;</span><span class='oword'>N</span> <span class='oword'>sets</span> <span class='oword'>incliding</span> <span class='oword'>the</span> <span class='oword'>background</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>colors</span> <span class='oword'>indicate</span> <span class='oword'>the</span> <span class='oword'>pixel</span> <span class='oword'>color</span> <span class='oword'>corresponding</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>bin</span><span class='ignore'>.</span> <span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Despeckle</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins</span><span class='ignore'>_</span><span class='ignore'>Surf</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>All</span><span class='ignore'>_</span><span class='ignore'>Together</span><span class='ignore'>_</span><span class='ignore'>2D.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>four</span> <span class='oword'>sets</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>combined</span> <span class='oword'>set</span> <span class='oword'>of</span> <span class='oword'>individuals</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>ellipses</span> <span class='oword'>are</span> <span class='oword'>placed</span> <span class='oword'>at</span> <span class='mathgroup'>$</span><span class='math'>2\sigma</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>3\sigma</span><span class='mathgroup'>$</span> <span class='oword'>and</span> <span class='mathgroup'>$</span><span class='math'>4\sigma</span><span class='mathgroup'>$</span> <span class='oword'>positions</span><span class='ignore'>.</span> <span class='oword'>Values</span> <span class='oword'>inside</span> <span class='mathgroup'>$</span><span class='math'>2\sigma</span><span class='mathgroup'>$</span> <span class='oword'>would</span> <span class='oword'>be</span> <span class='oword'>kept</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>distribution</span> <span class='oword'>function</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>AllTogether2D</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>All</span><span class='ignore'>_</span><span class='ignore'>Together</span><span class='ignore'>_</span><span class='ignore'>3D.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>histograms</span> <span class='oword'>for</span> <span class='oword'>the</span> <span class='oword'>four</span> <span class='oword'>data</span> <span class='oword'>sets</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>combined</span> <span class='oword'>set</span> <span class='oword'>of</span> <span class='oword'>individuals</span> <span class='oword'>are</span> <span class='oword'>shown</span> <span class='oword'>alongwith</span> <span class='oword'>the</span> <span class='oword'>Gaussian</span> <span class='oword'>fits</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>histogram</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>color</span> <span class='oword'>indicates</span> <span class='oword'>the</span> <span class='oword'>data</span> <span class='oword'>set</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>AllTogether3D</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>Sample</span> <span class='word'>image</span> <span class='word'>sets</span> <span class='word'>were</span> <span class='word'>collected</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>for</span> <span class='word'>three</span> <span class='word'>individuals</span> <span class='word'>with</span> <span class='word'>varying</span> <span class='word'>skin</span> <span class='word'>tones</span><span class='ignore'>.</span> <span class='word'>Sets</span> <span class='word'>of</span> <span class='word'>images</span> <span class='word'>were</span> <span class='word'>taken</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>digit</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>hand</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>whole</span> <span class='word'>under</span> <span class='word'>different</span> <span class='word'>lighting</span> <span class='word'>conditions</span> <span class='word'>and</span> <span class='word'>orientations</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='word'>selection</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>images</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>SetSamples</span><span class='ignore'>}</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;<span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>|</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>|</span><span class='ignore'>}</span><br>
&nbsp;<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>FSkin</span> <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>JSkin</span> <span class='ignore'>&amp;</span> <span class='ignore'>NSkin</span> <span class='exclcmd'>\\</span> <br>
&nbsp;<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <br>
&nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.3 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>SampleCollages</span><span class='ignore'>/</span><span class='ignore'>FSkin</span><span class='ignore'>_</span><span class='ignore'>Sample.jpg</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <br>
&nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.3 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>SampleCollages</span><span class='ignore'>/</span><span class='ignore'>JSkin</span><span class='ignore'>_</span><span class='ignore'>Sample.jpg</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span>&nbsp; <br>
&nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.3 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>SampleCollages</span><span class='ignore'>/</span><span class='ignore'>NSkin</span><span class='ignore'>_</span><span class='ignore'>Sample.jpg</span><span class='ignore'>}</span><span class='exclcmd'>\\</span> <br>
&nbsp;<span class='exclcmd'>\hline</span> <br>
&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Samples</span> <span class='oword'>from</span> <span class='oword'>the</span> <span class='oword'>image</span> <span class='oword'>sets</span> <span class='oword'>for</span> <span class='oword'>each</span> <span class='oword'>individual</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>SetSamples</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>MATLAB</span> <span class='word'>bin</span> <span class='word'>class</span> <span class='word'>was</span> <span class='word'>written</span> <span class='word'>so</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>combined</span> <span class='word'>statistics</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>three</span> <span class='word'>individuals</span> <span class='word'>could</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>adding</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>bins</span> <span class='word'>together</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>following</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>steps</span> <span class='word'>1-8</span> <span class='word'>as</span> <span class='word'>described</span> <span class='word'>previously</span><span class='ignore'>.</span> <span class='word'>All</span> <span class='word'>three</span> <span class='word'>distributions</span> <span class='word'>along</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>combined</span> <span class='word'>distribution</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figures</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>AllTogether2D</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>AllTogether3D</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='word'>In</span> <span class='word'>an</span> <span class='word'>attempt</span> <span class='word'>to</span> <span class='word'>identify</span> <span class='word'>a</span> <span class='word'>larger</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>values</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>space</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>large</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>skin</span> <span class='word'>samples</span> <span class='word'>were</span> <span class='word'>taken</span> <span class='word'>from</span> <span class='word'>photographs</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>Humane</span> <span class='word'>project</span> <span class='word'>by</span> <span class='word'>Angelica</span> <span class='word'>Dass</span><span class='ignore'>,</span> <span class='word'>an</span> <span class='word'>ongoing</span> <span class='ignore'>"</span><span class='word'>chromatic</span> <span class='word'>inventory</span><span class='ignore'>"</span> <span class='word'>art</span> <span class='word'>project</span> <span class='word'>which</span> <span class='word'>aims</span> <span class='word'>to</span> <span class='word'>compile</span> <span class='word'>every</span> <span class='word'>possible</span> <span class='word'>human</span> <span class='word'>skin</span> <span class='word'>color</span><span class='ignore'>,</span> <span class='word'>categorized</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>PANTONE</span> <span class='word'>guide</span> <span class='word'>color</span> <span class='word'>classification</span> <span class='word'>system</span><span class='ignore'>~</span><span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Dass2012</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>skin</span> <span class='word'>colors</span> <span class='word'>catalogued</span> <span class='word'>thus</span> <span class='word'>far</span> <span class='word'>are</span> <span class='word'>independent</span> <span class='word'>of</span> <span class='word'>race</span> <span class='word'>or</span> <span class='word'>ethnicity</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>the</span> <span class='word'>samples</span> <span class='word'>are</span> <span class='word'>representative</span> <span class='word'>of</span> <span class='word'>human</span> <span class='word'>skin</span> <span class='word'>tones</span> <span class='word'>in</span> <span class='word'>general</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>image</span> <span class='word'>set</span> <span class='word'>consists</span> <span class='word'>of</span> <span class='word'>approximately</span> <span class='word'>200</span> <span class='word'>skin</span> <span class='word'>samples</span>&nbsp; <span class='word'>each</span> <span class='word'>showing</span> <span class='word'>only</span> <span class='word'>one</span> <span class='word'>individuals</span> <span class='word'>skin</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>result</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figures</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>AllTogether2D</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>AllTogether3D</span><span class='ignore'>}</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>GeneralSkin</span> <span class='word'>set</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>distribution</span> <span class='word'>stands</span> <span class='word'>apart</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>others</span> <span class='word'>and</span> <span class='word'>surprisingly</span> <span class='word'>has</span> <span class='word'>a</span> <span class='word'>smaller</span> <span class='word'>standard</span> <span class='word'>deviation</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>probably</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>camera</span> <span class='word'>differences</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>sampling</span> <span class='word'>techniques</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>Humane</span> <span class='word'>project</span> <span class='word'>which</span> <span class='word'>focus</span> <span class='word'>on</span> <span class='word'>finding</span> <span class='word'>an</span> <span class='word'>average</span> <span class='word'>color</span> <span class='word'>rather</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>channel</span> <span class='word'>values</span> <span class='word'>in</span> <span class='word'>camera</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>orientation</span> <span class='word'>and</span> <span class='word'>position</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>is</span> <span class='word'>more</span> <span class='word'>consistent</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>theoretical</span> <span class='word'>values</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>pigments</span> <span class='word'>than</span> <span class='word'>those</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>individual</span> <span class='word'>sets</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>likely</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>fact</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>theoretical</span> <span class='word'>values</span> <span class='word'>were</span> <span class='word'>calculated</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>different</span> <span class='word'>camera</span> <span class='word'>CCD</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>CCD</span> <span class='word'>characteristics</span> <span class='word'>not</span> <span class='word'>being</span> <span class='word'>available</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>this</span> <span class='word'>reason</span> <span class='word'>the</span> <span class='word'>general</span> <span class='word'>distribution</span> <span class='word'>is</span> <span class='word'>excluded</span> <span class='word'>from</span> <span class='word'>further</span> <span class='word'>consideration</span> <span class='word'>aside</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>recognition</span> <span class='word'>that</span> <span class='word'>different</span> <span class='word'>cameras</span> <span class='word'>will</span> <span class='word'>require</span> <span class='word'>bespoke</span> <span class='word'>statistics</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>gathered</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>In</span> <span class='word'>contrast</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>GeneralSkin</span> <span class='word'>set</span> <span class='word'>the</span> <span class='word'>individual</span> <span class='word'>sets</span> <span class='word'>are</span> <span class='word'>close</span> <span class='word'>together</span> <span class='word'>with</span> <span class='word'>similar</span> <span class='word'>standard</span> <span class='word'>deviations</span> <span class='word'>however</span> <span class='word'>the</span> <span class='word'>angle</span> <span class='word'>varies</span> <span class='word'>significantly</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>angle</span> <span class='word'>needs</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>fixed</span> <span class='word'>so</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>statistics</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>gathered</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>color-space</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>angles</span> <span class='word'>are</span> <span class='word'>summarised</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>table</span> <span class='word'>below</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\hline</span>   <span class='ignore'>Set</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>Decimal</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>Approx</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>Relative</span> <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span>   <span class='exclmath'>$</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>FJ</span><span class='exclmath'>$</span><span class='mathcmd'>\&amp;</span><span class='exclmath'>$</span><span class='math'>NSkin</span> <span class='ignore'>}</span><span class='math'>\theta </span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>FJN</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>0.9312</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>75</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>253</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>\theta </span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>FJN</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\hline</span>   <span class='exclmath'>$</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>FSkin</span> <span class='ignore'>}</span><span class='math'>\theta </span><span class='math'>_</span><span class='math'>F</span><span class='exclmath'>$</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>1.0940</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>39</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>112</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>\theta </span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>FJN</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>3</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>58</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\hline</span>   <span class='exclmath'>$</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>JSkin</span> <span class='ignore'>}</span><span class='math'>\theta </span><span class='math'>_</span><span class='math'>J</span><span class='exclmath'>$</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>0.8294</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>33</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>125</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>\theta </span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>FJN</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>31</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\hline</span>   <span class='exclmath'>$</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>NSkin</span> <span class='ignore'>}</span><span class='math'>\theta </span><span class='math'>_</span><span class='math'>N</span><span class='exclmath'>$</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>1.0060</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>49</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>153</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>\theta </span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>FJN</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>42</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\hline</span> <br>
<span class='envir'>\end</span><span class='envir'>{tabular}</span><br>
<br>
<span class='word'>This</span> <span class='word'>suggests</span> <span class='word'>that</span> <span class='word'>taking</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='math'>'</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='math'>\theta </span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>FJN</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>84</span><span class='ignore'>}</span> <span class='math'>&lt;</span> <span class='math'>\theta</span><span class='math'>'</span> <span class='math'>&lt;</span> <span class='math'>\theta </span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>FJN</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>84</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>safe</span> <span class='word'>as</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>at</span> <span class='word'>most</span> <span class='word'>half</span> <span class='word'>way</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>nearest</span> <span class='word'>individual</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>position</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>remains</span> <span class='word'>within</span> <span class='word'>2</span> <span class='word'>standard</span> <span class='word'>deviations</span> <br>
<span class='mathgroup'>$</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span> <span class='math'>84</span> <span class='mathcmd'>\\</span> <span class='math'>117</span> <span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&lt;</span> <span class='math'>\mu</span><span class='math'>'</span>&nbsp; <span class='math'>&lt;</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span> <span class='math'>83</span> <span class='mathcmd'>\\</span> <span class='math'>121</span> <span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>somewhat</span> <span class='word'>arbitrary</span> <span class='word'>and</span> <span class='word'>we</span> <span class='word'>could</span> <span class='word'>extend</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>if</span> <span class='word'>we</span> <span class='word'>had</span> <span class='word'>reason</span> <span class='word'>but</span> <span class='word'>this</span> <span class='word'>range</span> <span class='word'>is</span> <span class='word'>sufficient</span> <span class='word'>to</span> <span class='word'>ensure</span> <span class='word'>that</span> <span class='word'>a</span> <span class='word'>computationally</span> <span class='word'>advantageous</span> <span class='word'>value</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>range</span> <span class='word'>being</span> <span class='word'>1</span><span class='ignore'>/</span><span class='word'>7</span> <span class='word'>th</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>Pi</span><span class='ignore'>/</span><span class='word'>6</span> <span class='word'>region</span><span class='ignore'>.</span>&nbsp; <span class='word'>The</span> <span class='word'>perturbation</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>channels</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>possible</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='math'>'</span><span class='mathgroup'>$</span> <span class='word'>values</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figures</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PerturbationNearThetaAB</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PerturbationNearThetaT</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Channel</span><span class='ignore'>_</span><span class='ignore'>Perturbations</span><span class='ignore'>_</span><span class='ignore'>Angle</span><span class='ignore'>_</span><span class='ignore'>Decision</span><span class='ignore'>_</span><span class='ignore'>AB.jpg</span><span class='ignore'>}</span> <br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>channel</span> <span class='oword'>perturbations</span> <span class='oword'>within</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>84</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='oword'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='math'>'</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>channel</span> <span class='oword'>perturbations</span> <span class='oword'>are</span> <span class='oword'>scaled</span> <span class='oword'>by</span> <span class='mathgroup'>$</span><span class='math'>\alpha</span><span class='mathgroup'>$</span> <span class='oword'>and</span> <span class='mathgroup'>$</span><span class='math'>\beta</span><span class='mathgroup'>$</span> <span class='oword'>so</span> <span class='oword'>a</span> <span class='oword'>tolerance</span> <span class='mathgroup'>$</span><span class='math'>\tau</span><span class='math'>=</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='oword'>is</span> <span class='oword'>used</span><span class='ignore'>.</span> <span class='oword'>Three</span> <span class='oword'>angles</span> <span class='oword'>satisfy</span> <span class='oword'>the</span> <span class='oword'>requirements</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PerturbationNearThetaAB</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Channel</span><span class='ignore'>_</span><span class='ignore'>Perturbations</span><span class='ignore'>_</span><span class='ignore'>Angle</span><span class='ignore'>_</span><span class='ignore'>Decision</span><span class='ignore'>_</span><span class='ignore'>T.jpg</span><span class='ignore'>}</span> <br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>channel</span> <span class='oword'>perturbations</span> <span class='oword'>within</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>84</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='oword'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='math'>'</span><span class='mathgroup'>$</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PerturbationNearThetaT</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>We</span> <span class='word'>now</span> <span class='word'>follow</span> <span class='word'>the</span> <span class='word'>procedure</span> <span class='word'>outlined</span> <span class='word'>in</span> <span class='word'>chapter</span> <span class='word'>2</span> <span class='word'>and</span> <span class='word'>obtain</span> <span class='word'>an</span> <span class='word'>angle</span> <span class='word'>informed</span> <span class='word'>by</span> <span class='word'>computational</span> <span class='word'>considerations</span><span class='ignore'>.</span>&nbsp; <br>
<span class='word'>With</span> <span class='word'>the</span> <span class='word'>perturbations</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>channel</span> <span class='word'>scaled</span> <span class='word'>by</span> <span class='word'>their</span> <span class='word'>relative</span> <span class='word'>importance</span> <span class='ignore'>(</span><span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PerturbationNearThetaAB</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>there</span> <span class='word'>are</span> <span class='word'>three</span> <span class='word'>angles</span> <span class='word'>which</span> <span class='word'>satisfy</span> <span class='word'>the</span> <span class='word'>criteria</span><span class='ignore'>.</span><br>
 <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>returns</span> <span class='word'>the</span> <span class='word'>closest</span> <span class='word'>angle</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>requested</span> <span class='word'>angle</span> <span class='word'>which</span> <span class='word'>is</span> <span class='mathgroup'>$</span><span class='mathcmd'>\overset</span><span class='ignore'>{</span><span class='math'>x</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\phi </span><span class='ignore'>}</span> <span class='math'>(</span><span class='math'>48</span><span class='math'>)</span><span class='mathgroup'>$</span> <span class='word'>however</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>is</span> <span class='word'>close</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='word'>of</span> <span class='word'>1</span> <span class='word'>which</span> <span class='word'>suggests</span> <span class='word'>that</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>parameters</span> <span class='word'>were</span> <span class='word'>adjusted</span> <span class='word'>to</span> <span class='word'>fit</span> <span class='word'>a</span> <span class='word'>particular</span> <span class='word'>individual</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>may</span> <span class='word'>slip</span> <span class='word'>above</span> <span class='word'>the</span> <span class='word'>tolerance</span><span class='ignore'>.</span> <br>
 <span class='word'>The</span> <span class='word'>channel</span> <span class='word'>scaling</span> <span class='mathgroup'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='math'>\alpha</span><span class='math'>,</span> <span class='math'>\beta</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathgroup'>$</span> <span class='word'>are</span> <span class='word'>also</span> <span class='word'>fairly</span> <span class='word'>close</span> <span class='word'>in</span> <span class='word'>value</span> <span class='word'>so</span> <span class='word'>the</span> <span class='word'>unscaled</span> <span class='word'>perturbations</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>tolerance</span> <span class='mathgroup'>$</span><span class='math'>\tau </span><span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Max</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\alpha</span><span class='math'>,</span> <span class='math'>\beta</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathgroup'>$</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PerturbationNearThetaT</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
 <span class='word'>Accounting</span> <span class='word'>for</span> <span class='word'>both</span> <span class='word'>low</span> <span class='word'>perturbation</span> <span class='word'>and</span> <span class='word'>future</span> <span class='word'>adaptability</span> <span class='word'>a</span> <span class='word'>final</span> <span class='word'>angle</span> <span class='mathgroup'>$</span><span class='math'>\theta </span><span class='math'>=</span> <span class='mathcmd'>\overset</span><span class='ignore'>{</span><span class='math'>x</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\phi </span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>46</span><span class='math'>)</span> <span class='math'>=</span> <span class='math'>0.9025768293268257</span><span class='mathgroup'>$</span> <span class='word'>was</span> <span class='word'>chosen</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Fit</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Gaussian</span><span class='ignore'>_</span><span class='ignore'>Final.jpg</span><span class='ignore'>}</span> <br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>Product</span> <span class='oword'>of</span> <span class='oword'>Gaussians</span> <span class='oword'>fit</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>three</span> <span class='oword'>individuals</span> <span class='oword'>statistics</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>LCa'Cb</span><span class='ignore'>'</span> <span class='oword'>color-space</span><span class='ignore'>.</span>&nbsp; <span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FittheGaussianFinal</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Distribution</span><span class='ignore'>_</span><span class='ignore'>Results.jpg</span><span class='ignore'>}</span> <br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span> <span class='oword'>The</span> <span class='oword'>redistribution</span> <span class='oword'>functions</span> <span class='oword'>for</span> <span class='oword'>each</span> <span class='oword'>axis</span> <span class='oword'>alongside</span> <span class='oword'>summary</span> <span class='oword'>tables</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>key</span> <span class='oword'>parameters</span> <span class='oword'>and</span> <span class='oword'>a</span> <span class='oword'>selection</span> <span class='oword'>of</span> <span class='oword'>calculations</span> <span class='oword'>and</span> <span class='oword'>an</span> <span class='oword'>overview</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>distribution</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>new</span> <span class='oword'>color-space</span>&nbsp; <span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>DistributionResults</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>As</span> <span class='word'>a</span> <span class='word'>final</span> <span class='word'>step</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>MATLAB</span> <span class='word'>statistics</span> <span class='word'>gathering</span> <span class='word'>routine</span> <span class='word'>was</span> <span class='word'>run</span> <span class='word'>again</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>combined</span> <span class='word'>F</span><span class='ignore'>,</span><span class='word'>J</span><span class='cmd'>\&amp;</span><span class='word'>N</span> <span class='word'>RGB</span> <span class='word'>bins</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>starting</span> <span class='word'>point</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>rotating</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>LCa'Cb</span><span class='ignore'>'</span> <span class='word'>color-space</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>value</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>was</span> <span class='word'>done</span> <span class='word'>partly</span> <span class='word'>to</span> <span class='word'>check</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>works</span> <span class='word'>as</span> <span class='word'>expected</span> <span class='word'>and</span> <span class='word'>to</span> <span class='word'>see</span> <span class='word'>how</span> <span class='word'>well</span> <span class='word'>the</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>Gaussians</span> <span class='word'>function</span> <span class='word'>fits</span> <span class='word'>the</span> <span class='word'>distribution</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>only</span> <span class='word'>difference</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>MATLAB</span> <span class='word'>code</span> <span class='word'>was</span> <span class='word'>that</span> <span class='word'>for</span> <span class='word'>this</span> <span class='word'>run</span> <span class='word'>the</span> <span class='word'>Gaussian</span> <span class='word'>fit</span> <span class='word'>was</span> <span class='word'>found</span> <span class='word'>using</span> <span class='word'>equation</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>2DGaussianProd</span><span class='ignore'>}</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>two</span> <span class='word'>1D</span> <span class='word'>Gaussians</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>fixed</span> <span class='word'>amplitude</span> <span class='word'>of</span> <span class='word'>1</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>result</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FittheGaussianFinal</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>2DGaussianProd</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\exp</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='mathcmd'>\CaMu</span><span class='ignore'>}</span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='mathcmd'>\sigma</span><span class='math'>_</span><span class='math'>1</span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>-</span>&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span> <span class='ignore'>{</span> <span class='mathcmd'>\CbMu</span> <span class='ignore'>}</span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='mathcmd'>\sigma</span><span class='math'>_</span><span class='math'>2</span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\textbf</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\CaMu</span> <span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Ca</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>and</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\CbMu</span> <span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Cb</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>2</span> <br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Distribution</span><span class='ignore'>_</span><span class='ignore'>Results</span><span class='ignore'>_</span><span class='ignore'>Final.jpg</span><span class='ignore'>}</span> <br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span> <span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>Tight</span> <span class='oword'>MATLAB</span> <span class='oword'>fit</span> <span class='oword'>in</span> <span class='oword'>LCa'Cb</span><span class='ignore'>'</span><span class='ignore'>.</span><span class='ignore'>}</span> <span class='oword'>The</span> <span class='oword'>redistribution</span> <span class='oword'>functions</span> <span class='oword'>for</span> <span class='oword'>each</span> <span class='oword'>axis</span> <span class='oword'>alongside</span> <span class='oword'>summary</span> <span class='oword'>tables</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>key</span> <span class='oword'>parameters</span> <span class='oword'>and</span> <span class='oword'>a</span> <span class='oword'>selection</span> <span class='oword'>of</span> <span class='oword'>calculations</span> <span class='oword'>and</span> <span class='oword'>an</span> <span class='oword'>overview</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>distribution</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>new</span> <span class='oword'>color-space</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>DistributionResultsFinal</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>It</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>least</span> <span class='word'>square</span> <span class='word'>fit</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>good</span> <span class='word'>predictor</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>but</span> <span class='word'>the</span> <span class='word'>aim</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>capture</span> <span class='word'>all</span> <span class='word'>skin</span> <span class='word'>relevant</span> <span class='word'>chromatic</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>this</span> <span class='word'>reason</span><span class='ignore'>,</span>&nbsp; <span class='word'>as</span> <span class='word'>well</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>desire</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>inclusive</span> <span class='word'>of</span> <span class='word'>skin</span> <span class='word'>tones</span> <span class='word'>outside</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>sample</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>three</span> <span class='word'>individuals</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>region</span> <span class='word'>larger</span> <span class='word'>than</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='math'>2\sigma</span><span class='mathgroup'>$</span> <span class='word'>ellipse</span> <span class='word'>region</span> <span class='ignore'>(</span><span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>DistributionResultsFinal</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>kept</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>tight</span> <span class='word'>MATLAB</span> <span class='word'>fit</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>desirable</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>included</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='mathgroup'>$</span><span class='math'>3\sigma</span><span class='mathgroup'>$</span> <span class='word'>ellipse</span> <span class='word'>region</span> <span class='word'>would</span> <span class='word'>include</span> <span class='word'>everything</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>combined</span> <span class='word'>individual</span> <span class='word'>F</span><span class='ignore'>,</span><span class='word'>J</span><span class='cmd'>\&amp;</span><span class='word'>N</span> <span class='word'>histogram</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='mathgroup'>$</span><span class='math'>5\sigma</span><span class='mathgroup'>$</span> <span class='word'>ellipse</span> <span class='word'>region</span> <span class='word'>would</span>&nbsp; <span class='word'>likely</span> <span class='word'>account</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>wide</span> <span class='word'>variety</span> <span class='word'>of</span> <span class='word'>skin</span> <span class='word'>tones</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.0 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Distribution</span><span class='ignore'>_</span><span class='ignore'>Results</span><span class='ignore'>_</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Extended.jpg</span><span class='ignore'>}</span> <br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span> <span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>extended</span> <span class='mathgroup'>$</span><span class='math'>5\sigma</span><span class='mathgroup'>$</span> <span class='oword'>ellipse</span> <span class='oword'>region</span> <span class='oword'>MATLAB</span> <span class='oword'>fit</span> <span class='oword'>in</span> <span class='oword'>LCa'Cb</span><span class='ignore'>'</span><span class='ignore'>.</span><span class='ignore'>}</span> <span class='oword'>The</span> <span class='oword'>redistribution</span> <span class='oword'>functions</span> <span class='oword'>for</span> <span class='oword'>each</span> <span class='oword'>axis</span> <span class='oword'>alongside</span> <span class='oword'>summary</span> <span class='oword'>tables</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>key</span> <span class='oword'>parameters</span> <span class='oword'>and</span> <span class='oword'>a</span> <span class='oword'>selection</span> <span class='oword'>of</span> <span class='oword'>calculations</span> <span class='oword'>and</span> <span class='oword'>an</span> <span class='oword'>overview</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>distribution</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>new</span> <span class='oword'>color-space</span><span class='ignore'>.</span> <span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>DistributionResultsFinalExtended</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Distribution</span><span class='ignore'>_</span><span class='ignore'>Results</span><span class='ignore'>_</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Extended</span><span class='ignore'>_</span><span class='ignore'>3D.jpg</span><span class='ignore'>}</span> <br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span> <span class='oword'>The</span> <span class='oword'>tight</span> <span class='oword'>and</span> <span class='oword'>extended</span> <span class='oword'>fits</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>LCa'Cb</span><span class='ignore'>'</span> <span class='oword'>color-space</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>DistributionResultsFinalExtended3D</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>Extending</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>may</span> <span class='word'>also</span> <span class='word'>affect</span> <span class='word'>the</span> <span class='word'>accuracy</span> <span class='word'>required</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>as</span> <span class='word'>mentioned</span> <span class='word'>previously</span><span class='ignore'>.</span> <span class='word'>Extending</span> <span class='word'>out</span> <span class='word'>to</span> <span class='word'>a</span> <span class='mathgroup'>$</span><span class='math'>5\sigma</span><span class='mathgroup'>$</span> <span class='word'>ellipse</span> <span class='word'>region</span> <span class='word'>does</span> <span class='word'>indeed</span> <span class='word'>affect</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='ignore'>(</span><span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>DistributionResultsFinalExtended</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>the</span> <span class='word'>chosen</span> <span class='word'>angle</span> <span class='word'>perturbation</span> <span class='mathgroup'>$</span><span class='mathcmd'>\pm</span><span class='math'>0.144</span><span class='mathgroup'>$</span> <span class='word'>still</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='mathgroup'>$</span><span class='math'>\tau </span><span class='math'>=</span> <span class='math'>0.3094</span><span class='mathgroup'>$</span> <span class='word'>as</span> <span class='mathgroup'>$</span><span class='math'>0.1441</span> <span class='math'>&lt;</span> <span class='math'>0.3094</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>It's</span> <span class='word'>also</span> <span class='word'>notable</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>tight</span> <span class='word'>MATLAB</span> <span class='word'>distribution</span> <span class='word'>requires</span> <span class='word'>a</span> <span class='word'>partition</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>axis</span> <span class='word'>while</span> <span class='word'>the</span> <span class='word'>extended</span> <span class='word'>distribution</span> <span class='word'>requires</span> <span class='word'>a</span> <span class='word'>small</span> <span class='word'>amount</span> <span class='word'>of</span> <span class='word'>redistribution</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>tight</span> <span class='word'>MATLAB</span> <span class='word'>distribution</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>extended</span> <span class='word'>distribution</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>DistributionResultsFinalExtended3D</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Conclusion</span><span class='ignore'>}</span><br>
<br>
<span class='word'>Our</span> <span class='word'>goal</span> <span class='word'>was</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>appropriate</span> <span class='word'>values</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>2D</span> <span class='word'>chromatic</span> <span class='word'>Gaussians</span> <span class='word'>in</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>facilitate</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>processing</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>to</span> <span class='word'>create</span> <span class='word'>a</span> <span class='word'>color-space</span> <span class='word'>that</span> <span class='word'>preserves</span> <span class='word'>all</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>skin</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>show</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>achieved</span> <span class='word'>this</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>will</span> <span class='word'>quickly</span> <span class='word'>demonstrate</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>probability</span> <span class='word'>map</span><span class='ignore'>:</span><br>
<br>
<span class='word'>After</span> <span class='word'>redistribution</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>two</span> <span class='word'>new</span> <span class='word'>spaces</span> <span class='word'>in</span> <span class='word'>which</span> <span class='word'>to</span> <span class='word'>express</span> <span class='word'>the</span> <span class='word'>stats</span> <span class='word'>parameters</span><span class='ignore'>:</span> <span class='word'>the</span> <span class='word'>0-dstMax</span> <span class='word'>range</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>0-1</span> <span class='word'>range</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='word'>0</span> <span class='word'>and</span> <span class='word'>1</span> <span class='word'>correspond</span> <span class='word'>to</span> <span class='word'>different</span> <span class='word'>positions</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>original</span> <span class='word'>unit</span> <span class='word'>space</span> <span class='word'>because</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>compression</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>mean</span> <span class='word'>values</span> <span class='word'>are</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>halfway</span> <span class='word'>point</span> <span class='word'>in</span> <span class='word'>both</span> <span class='mathgroup'>$</span><span class='math'>c</span><span class='math'>_</span><span class='math'>d</span><span class='math'>=</span><span class='math'>dstMax</span><span class='math'>/</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>d</span> <span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>.</span>&nbsp; <span class='word'>The</span> <span class='word'>standard</span> <span class='word'>deviations</span> <span class='word'>are</span> <span class='word'>scaled</span> <span class='word'>to</span> <span class='word'>fit</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>which</span> <span class='word'>is</span> <span class='ignore'>'</span><span class='word'>kept</span><span class='ignore'>'</span> <span class='mathgroup'>$</span><span class='mathcmd'>\sigma</span><span class='math'>_</span><span class='math'>d</span><span class='math'>=</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\sigma</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\lambda</span><span class='math'>_</span><span class='math'>2</span><span class='math'>-</span><span class='mathcmd'>\lambda</span><span class='math'>_</span><span class='math'>1</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>probability</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>pixel</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>redistributed</span> <span class='word'>color-space</span> <span class='word'>can</span> <span class='word'>then</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>using</span> <br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='math'>P</span><span class='math'>(</span><span class='math'>L</span><span class='math'>,</span><span class='math'>Ca</span><span class='math'>,</span><span class='math'>Cb</span><span class='math'>)</span> <span class='math'>=</span> <span class='math'>Exp</span><span class='math'>(</span><span class='math'>-</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>Ca</span><span class='math'>-</span><span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>d</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>Ca</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='mathcmd'>\sigma</span><span class='math'>_</span><span class='math'>d</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>Ca</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>-</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>Cb</span><span class='math'>-</span><span class='mathcmd'>\mu</span><span class='math'>_</span><span class='math'>d</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>Cb</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='mathcmd'>\sigma</span><span class='math'>_</span><span class='math'>d</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>Cb</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>)</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<span class='word'>the</span> <span class='word'>result</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>TransformImages</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95 \textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter3</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>TransformImages.jpg</span><span class='ignore'>}</span> <br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span> <span class='oword'>Images</span> <span class='oword'>of</span> <span class='oword'>hands</span> <span class='oword'>from</span> <span class='oword'>the</span> <span class='oword'>three</span> <span class='oword'>individual</span> <span class='oword'>sets</span> <span class='oword'>processed</span> <span class='oword'>with</span> <span class='oword'>the</span> <span class='oword'>opacity</span> <span class='oword'>given</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>probability</span> <span class='oword'>that</span> <span class='oword'>the</span> <span class='oword'>pixel</span> <span class='oword'>value</span> <span class='oword'>is</span> <span class='oword'>skin</span> <span class='oword'>using</span> <span class='oword'>the</span> <span class='oword'>simply</span> <span class='oword'>product</span> <span class='oword'>of</span> <span class='oword'>Gaussians</span> <span class='oword'>method</span> <span class='oword'>given</span> <span class='oword'>above</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>TransformImages</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>probability</span> <span class='word'>in</span> <span class='word'>these</span> <span class='word'>images</span> <span class='word'>is</span> <span class='word'>indicated</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>opacity</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>as</span> <span class='word'>you</span> <span class='word'>can</span> <span class='word'>see</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>above</span> <span class='word'>images</span><span class='ignore'>,</span> <span class='word'>all</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>detail</span> <span class='word'>is</span> <span class='word'>preserved</span><span class='ignore'>,</span> <span class='word'>therefore</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>preserved</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>a</span> <span class='word'>normal</span> <span class='word'>color-space</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>preservation</span> <span class='word'>of</span> <span class='word'>skin</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>computationally</span> <span class='word'>intensive</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>of</span> <span class='word'>our</span> <span class='word'>bespoke</span> <span class='word'>color-space</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>simply</span> <span class='word'>the</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>two</span> <span class='word'>2D</span> <span class='word'>Gaussians</span><span class='ignore'>,</span> <span class='word'>therefore</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>probability</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>very</span> <span class='word'>simple</span> <span class='word'>function</span><span class='ignore'>.</span> <span class='word'>Thus</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>not</span> <span class='word'>only</span> <span class='word'>preserved</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>information</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>produced</span> <span class='word'>a</span> <span class='word'>simplified</span> <span class='word'>version</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>complicated</span> <span class='word'>computer</span> <span class='word'>vision</span> <span class='word'>task</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>It</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>noted</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>strict</span> <span class='mathgroup'>$</span><span class='math'>1\sigma</span><span class='mathgroup'>$</span> <span class='word'>result</span> <span class='word'>misses</span> <span class='word'>some</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>skin</span><span class='ignore'>;</span> <span class='word'>this</span> <span class='word'>was</span> <span class='word'>expected</span> <span class='word'>as</span> <span class='word'>some</span> <span class='word'>histogram</span> <span class='word'>values</span> <span class='word'>lie</span> <span class='word'>outside</span> <span class='word'>the</span> <span class='word'>Gaussian</span> <span class='word'>fit</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>loosening</span> <span class='word'>the</span> <span class='word'>criteria</span> <span class='word'>is</span> <span class='word'>necessary</span> <span class='word'>to</span> <span class='word'>capture</span> <span class='word'>all</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='mathgroup'>$</span><span class='math'>2\sigma</span><span class='mathgroup'>$</span> <span class='word'>or</span> <span class='mathgroup'>$</span><span class='math'>3\sigma</span><span class='mathgroup'>$</span> <span class='word'>criteria</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>sufficient</span> <span class='word'>to</span> <span class='word'>capture</span> <span class='word'>all</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>Additionally</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>simple</span> <span class='word'>implementation</span> <span class='word'>here</span> <span class='word'>does</span> <span class='word'>not</span> <span class='word'>account</span> <span class='word'>for</span> <span class='word'>unreliable</span> <span class='word'>white-out</span> <span class='word'>and</span> <span class='word'>black-out</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>or</span> <span class='word'>use</span> <span class='word'>nearest</span> <span class='word'>pixel</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>the</span> <span class='word'>final</span> <span class='word'>step</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>this</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>a</span> <span class='word'>classifier</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>explored</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>chapter</span><span class='ignore'>.</span><br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Chapter3/chapter3.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 3248</li>
<li>Words in headers: 49</li>
<li>Words outside text (captions, etc.): 525</li>
<li>Number of headers: 17</li>
<li>Number of floats/tables/figures: 24</li>
<li>Number of math inlines: 58</li>
<li>Number of math displayed: 2</li>
<li>Subcounts:</li>
<span class='subcount'>
<li class='fielddesc'>&nbsp; text+headers+captions (#headers/#floats/#inlines/#displayed)</li>
  <li>4+2+0 (1/0/0/0) Chapter: Skin Statistics}\label{sec:ChapSkin</li>
  <li>120+1+0 (1/0/4/0) Section: Objective}\label{sec:Objective</li>
  <li>62+3+0 (1/0/0/0) Section: iPhone Camera Characteristics} \label{sec:iPhoneCameraCharacteristics</li>
  <li>250+3+18 (1/1/3/0) Subsection: The White Point}\label{sec:WhitePoint</li>
  <li>244+3+9 (1/2/0/0) Subsection: Color Correction Preprocessing</li>
  <li>139+3+3 (1/1/5/0) Subsection: White-Out and Black-Out}\label{sec:WhiteoutAndBlackout</li>
  <li>27+5+0 (1/0/0/0) Section: Algorithm for Generating the Model}\label{sec:AlgorithmForGeneratingModel</li>
  <li>127+3+37 (1/1/0/0) Subsection: RGB Bin Allocation}\label{sec:RGBBinAllocation</li>
  <li>113+3+49 (1/1/0/0) Subsection: Skinning the Bins}\label{sec:SkinningTheBins</li>
  <li>113+3+52 (1/1/3/0) Subsection: Rotating the Bins}\label{sec:RotatingTheBins</li>
  <li>186+3+4 (1/1/0/0) Subsection: Top and Tail}\label{sec:TopAndTail</li>
  <li>36+3+32 (1/1/0/0) Subsection: Collapsing the Bins}\label{sec:CollapsingTheBins</li>
  <li>369+4+17 (1/1/0/0) Subsection: De-Speckling the Bin Values}\label{sec:DeSpeckle</li>
  <li>218+2+34 (1/1/3/0) Subsection: Blob Detection}\label{sec:BlobDetection</li>
  <li>78+3+6 (1/1/6/0) Subsection: The Gaussian Fit}\label{sec:TheGaussianFit</li>
  <li>842+4+233 (1/11/28/1) Section: Sample Sets and Results}\label{sec:SampleSets</li>
  <li>320+1+31 (1/1/6/1) Subsection: Conclusion</li>
</span>
</ul>
</div>
<h2>File: ./Chapter4/chapter4.tex</h2>
<div class='parse'><p>
<span class='cmd'>\chapter</span><span class='ignore'>{</span><span class='hword'>Pattern</span> <span class='hword'>Recognition</span> <span class='hword'>and</span> <span class='hword'>Implementation</span><span class='ignore'>}</span><br>
<br>
<span class='comment'>% **************************** Define Graphics Path **************************</span><br>
<br>
<span class='cmd'>\epstopdfsetup</span><span class='ignore'>{</span><span class='word'>outdir</span><span class='ignore'>=</span><span class='word'>Chapter4</span><span class='ignore'>/</span><span class='word'>Figs</span><span class='ignore'>/</span><span class='word'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><br>
<span class='cmd'>\ifpdf</span><br>
&nbsp;&nbsp;<span class='cmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Raster</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\else</span><br>
&nbsp;&nbsp;<span class='cmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Vector</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\fi</span><br>
<br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Implementing</span> <span class='hword'>the</span> <span class='hword'>Color</span> <span class='hword'>Space</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ImplementingTheColorSpace</span><span class='ignore'>}</span><br>
<br>
<span class='word'>Appendix</span> <span class='word'>C</span> <span class='word'>outlines</span> <span class='word'>the</span> <span class='word'>practical</span> <span class='word'>algorithm</span> <span class='word'>which</span> <span class='word'>implements</span> <span class='word'>the</span> <span class='word'>techniques</span> <span class='word'>developed</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>previous</span> <span class='word'>chapters</span> <span class='word'>taking</span> <span class='word'>account</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>phone</span> <span class='word'>characteristics</span><span class='ignore'>.</span> <br>
<span class='word'>The</span> <span class='word'>resulting</span> <span class='word'>algorithm</span> <span class='word'>produces</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>color-space</span> <span class='word'>along</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>classified</span> <span class='word'>image</span> <span class='word'>which</span> <span class='word'>takes</span> <span class='word'>4</span> <span class='word'>values</span> <span class='word'>relating</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>probability</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>is</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>color</span> <span class='word'>region</span><span class='ignore'>.</span>&nbsp; <br>
<br>
<span class='comment'>%\section{Fingertip Model}\label{sec:FingertipModel}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%We need an appropriate finger model so we can accurately align points on the fingertip between successive images in the video stream. We need to do this because otherwise, any difference between the frames will be overwhelmed by physical movement of the digit rather than movement of the blood inside the digit. For this reason, we target the most stable portion of the finger: the nail.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%A digit has two joints and three segments: the distal, the middle, and the proximal. Each segment is roughly approximated by a rectangle, and the length of each section approximately following a 2-3-5 ratio, with lengths counting from distal to proximal, and where 1 is the $\frac{3}{4}$ width of the middle segment. Our finger model then comprises of the lengths and widths of each segment, the positions of the joints (i.e. {\tiny {\tiny }}the knuckles) between each segment, the position of the tip, and a position in the model marking the point at which the digit goes out of frame.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%Given the width of the middle segment, we can then have an initial guess that the length of the distal segment is 1.5 times the initial width, the middle is 2.25 times that, and the proximal is 3.75 times that. Additionally, the center of the nail feature is not in the center of the distal segment, but a half unit (in our model units) away from the tip. The model can be laid out in units relative to the width of the digit.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>Finger</span> <span class='hword'>Shape</span> <span class='hword'>Detection</span> <span class='hword'>Algorithm</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FingerShapeDetectionAlgorithm</span><span class='ignore'>}</span><br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Finding</span> <span class='hword'>the</span> <span class='hword'>Frame</span> <span class='hword'>Orientation</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FindingTheFrameOrientation</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>first</span> <span class='word'>step</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>then</span> <span class='word'>to</span> <span class='word'>detect</span> <span class='word'>which</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>four</span> <span class='word'>frame</span> <span class='word'>edges</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>is</span> <span class='word'>entering</span> <span class='word'>from</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>simply</span> <span class='word'>by</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>longest</span> <span class='word'>on-object</span> <span class='word'>path</span> <span class='word'>running</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>sides</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>starts</span> <span class='word'>by</span> <span class='word'>looking</span> <span class='word'>down</span> <span class='word'>the</span> <span class='word'>pixels</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>frame</span> <span class='word'>side</span><span class='ignore'>;</span> <span class='word'>when</span> <span class='word'>it</span> <span class='word'>locates</span> <span class='word'>a</span> <span class='word'>high-quaternary</span> <span class='word'>value</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>uses</span> <span class='word'>the</span> <span class='word'>Hurdle</span> <span class='word'>method</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>longest</span> <span class='word'>path</span> <span class='word'>in</span> <span class='word'>that</span> <span class='word'>direction</span> <span class='word'>starting</span> <span class='word'>from</span> <span class='word'>that</span> <span class='word'>point</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>continues</span> <span class='word'>around</span> <span class='word'>all</span> <span class='word'>four</span> <span class='word'>sides</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>longest</span> <span class='word'>path</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>Hurdle</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>assumed</span> <span class='word'>to</span> <span class='word'>correspond</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>entering</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>.</span> <span class='word'>From</span> <span class='word'>this</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>set</span> <span class='word'>a</span> <span class='word'>frame</span> <span class='word'>orientation</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>angle</span> <span class='word'>necessary</span> <span class='word'>to</span> <span class='word'>rotate</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>such</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>entering</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>left</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>we</span> <span class='word'>set</span> <span class='word'>a</span> <span class='word'>direction</span> <span class='word'>vector</span> <span class='word'>pointing</span> <span class='word'>inwards</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>edge</span> <span class='word'>found</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Finding</span> <span class='hword'>the</span> <span class='hword'>End</span> <span class='hword'>of</span> <span class='hword'>the</span> <span class='hword'>Finger</span> <span class='hword'>Shape</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FindingTheEndOfTheFingerShape</span><span class='ignore'>}</span><br>
<span class='word'>Taking</span> <span class='word'>the</span> <span class='word'>longest</span> <span class='word'>Hurdle</span> <span class='word'>path</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>edge</span> <span class='word'>found</span> <span class='word'>above</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>take</span> <span class='word'>the</span> <span class='word'>middle</span> <span class='word'>point</span> <span class='word'>on</span> <span class='word'>that</span> <span class='word'>path</span> <span class='word'>and</span> <span class='word'>start</span> <span class='word'>a</span> <span class='ignore'>'</span><span class='word'>Run-Reach</span><span class='ignore'>'</span> <span class='word'>algorithm</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>direction</span> <span class='word'>found</span> <span class='word'>previously</span> <span class='word'>from</span> <span class='word'>that</span> <span class='word'>point</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>Run-Reach</span> <span class='word'>algorithm</span> <span class='word'>proceeds</span> <span class='word'>as</span> <span class='word'>follows</span><span class='ignore'>:</span><br>
<br>
<span class='word'>It</span> <span class='word'>finds</span> <span class='word'>a</span> <span class='word'>Hurdle</span> <span class='word'>path</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>primary</span> <span class='word'>direction</span><span class='ignore'>,</span> <span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>perpendicularly</span> <span class='word'>away</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>edge</span><span class='ignore'>.</span> <span class='word'>At</span> <span class='word'>the</span> <span class='word'>end</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>Hurdle</span> <span class='word'>path</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>Hurdle</span> <span class='word'>paths</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>perpendicular</span> <span class='word'>directions</span> <span class='word'>to</span> <span class='word'>its</span> <span class='word'>primary</span> <span class='word'>direction</span><span class='ignore'>,</span> <span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>parallel</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>edge</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>then</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>midpoint</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>ends</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>Hurdle</span> <span class='word'>path</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>uses</span> <span class='word'>that</span> <span class='word'>to</span> <span class='word'>start</span> <span class='word'>a</span> <span class='word'>new</span> <span class='word'>Hurdle</span> <span class='word'>path</span> <span class='word'>in</span> <span class='word'>its</span> <span class='word'>primary</span> <span class='word'>direction</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>continues</span> <span class='word'>in</span> <span class='word'>this</span> <span class='word'>way</span> <span class='word'>until</span> <span class='word'>the</span> <span class='word'>end</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>is</span> <span class='word'>found</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FindingTheTip</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>FindingTheTip.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Finding</span> <span class='oword'>the</span> <span class='oword'>End</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>Finger</span> <span class='oword'>Shape</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FindingTheTip</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Filament</span> <span class='hword'>Fill</span> <span class='hword'>the</span> <span class='hword'>Finger</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FilamentFillTheFinger</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>center</span> <span class='word'>points</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>Run-Reach</span> <span class='word'>method</span> <span class='word'>above</span> <span class='word'>form</span> <span class='word'>a</span> <span class='word'>path</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>finger</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>given</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>Filament</span> <span class='word'>Fill</span> <span class='word'>method</span> <span class='word'>described</span> <span class='word'>previously</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>now</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>also</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>top</span> <span class='word'>and</span> <span class='word'>bottom</span> <span class='word'>correspondence</span> <span class='word'>which</span><span class='ignore'>,</span> <span class='word'>although</span> <span class='word'>they're</span> <span class='word'>not</span> <span class='word'>perpendicularly-opposite</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>finger</span><span class='ignore'>,</span> <span class='word'>they</span> <span class='word'>do</span> <span class='word'>allow</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>midpoint</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>found</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span><span class='ignore'>~</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FillamentFill</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Exclude</span> <span class='hword'>Secondary</span> <span class='hword'>Frame</span> <span class='hword'>Edge</span> <span class='hword'>and</span> <span class='hword'>Fingertip</span> <span class='hword'>Points</span> <span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ExcludeSecondaryFrameEdgePointsAndFingertipPoints</span><span class='ignore'>}</span><br>
<span class='word'>We</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>exclude</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>calculation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>midpoints</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>near</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>values</span> <span class='word'>where</span> <span class='word'>one</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>touches</span> <span class='word'>a</span> <span class='word'>frame</span> <span class='word'>edge</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>because</span> <span class='word'>values</span> <span class='word'>toward</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>given</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>necessarily</span> <span class='word'>perfectly</span> <span class='word'>horizontally-aligned</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>give</span> <span class='word'>unreliable</span> <span class='word'>midpoint</span> <span class='word'>values</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>Run-Reach</span> <span class='word'>path</span> <span class='word'>corresponds</span> <span class='word'>to</span> <span class='word'>shorter</span> <span class='word'>and</span> <span class='word'>shorter</span> <span class='word'>chords</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>circle</span><span class='ignore'>.</span> <span class='word'>Values</span> <span class='word'>where</span> <span class='word'>one</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>touches</span> <span class='word'>a</span> <span class='word'>frame</span> <span class='word'>edge</span><span class='ignore'>,</span> <span class='word'>more</span> <span class='word'>likely</span> <span class='word'>than</span> <span class='word'>not</span><span class='ignore'>,</span> <span class='word'>do</span> <span class='word'>not</span> <span class='word'>correspond</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>edge</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>are</span> <span class='word'>simply</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>exits</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='ignore'>(</span><span class='word'>for</span> <span class='word'>example</span><span class='ignore'>,</span> <span class='word'>JSkin</span> <span class='word'>Middle</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ExcludedEdgePointsAndMidlineFit</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>ExcludedEdgePointsAndMidlineFit.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Excluded</span> <span class='oword'>Secondary</span> <span class='oword'>Frame</span> <span class='oword'>Edge</span> <span class='oword'>Points</span> <span class='oword'>and</span> <span class='oword'>Fingertip</span> <span class='oword'>Points</span><span class='ignore'>,</span> <span class='oword'>with</span> <span class='oword'>the</span> <span class='oword'>fit</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>midline</span> <span class='oword'>points</span> <span class='oword'>returned</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>Kink</span> <span class='oword'>Fit</span> <span class='oword'>algorithm</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ExcludedEdgePointsAndMidlineFit</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>To</span> <span class='word'>estimate</span> <span class='word'>which</span> <span class='word'>pairs</span> <span class='word'>of</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>correspond</span> <span class='word'>to</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>length</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>Hurdle</span> <span class='word'>path</span> <span class='word'>for</span> <span class='word'>all</span> <span class='word'>corresponding</span> <span class='word'>bottom-edge</span> <span class='word'>to</span> <span class='word'>top-edge</span> <span class='word'>points</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>values</span> <span class='word'>are</span> <span class='word'>then</span> <span class='word'>sorted</span> <span class='word'>into</span> <span class='word'>ascending</span> <span class='word'>order</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>the</span> <span class='ignore'>'</span><span class='word'>Mean-Median</span><span class='ignore'>'</span> <span class='word'>is</span> <span class='word'>taken</span><span class='ignore'>,</span> <span class='word'>ensuring</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>affected</span> <span class='word'>by</span> <span class='word'>extreme</span> <span class='word'>values</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>tolerance</span> <span class='word'>is</span> <span class='word'>determined</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>by</span> <span class='word'>looking</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>difference</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>low</span> <span class='word'>and</span> <span class='word'>high</span> <span class='word'>ends</span> <span class='word'>of</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='math'>66</span><span class='math'>\%</span><span class='mathgroup'>$</span> <span class='word'>range</span> <span class='word'>used</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>Mean-Median</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Kink</span> <span class='hword'>Fit</span> <span class='hword'>to</span> <span class='hword'>the</span> <span class='hword'>Finger</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>KinkFitToTheFinger</span><span class='ignore'>}</span><br>
<span class='word'>We</span> <span class='word'>now</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>reliable</span> <span class='word'>points</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>midpoint</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>finger</span><span class='ignore'>.</span> <span class='word'>Because</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>is</span> <span class='word'>articulated</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>reasonable</span> <span class='word'>to</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>it</span> <span class='word'>may</span> <span class='word'>well</span> <span class='word'>be</span> <span class='word'>bent</span><span class='ignore'>.</span> <span class='word'>We're</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>action</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>being</span> <span class='word'>pressed</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>surface</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>result</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>is</span> <span class='word'>expected</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>articulated</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>distal-middle</span> <span class='word'>joint</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>is</span> <span class='word'>otherwise</span> <span class='word'>straight</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>fit</span> <span class='word'>a</span> <span class='word'>function</span> <span class='word'>which</span> <span class='word'>consists</span> <span class='word'>of</span> <span class='word'>two</span> <span class='word'>straight-line</span> <span class='word'>segments</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>reliable</span> <span class='word'>middle</span> <span class='word'>points</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>fit</span> <span class='word'>was</span> <span class='word'>found</span> <span class='word'>using</span> <span class='word'>the</span> <span class='ignore'>'</span><span class='word'>Kink</span> <span class='word'>Fit</span><span class='ignore'>'</span> <span class='word'>algorithm</span> <span class='word'>described</span> <span class='word'>in</span> <span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>KinkFitMethod</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>Kink</span> <span class='word'>Fit</span> <span class='word'>algorithm</span> <span class='word'>takes</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>component</span> <span class='word'>is</span> <span class='word'>assumed</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>the</span> <span class='word'>independent</span> <span class='word'>variable</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>component</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>the</span> <span class='word'>dependent</span> <span class='word'>variable</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>because</span> <span class='word'>we</span> <span class='word'>haven't</span> <span class='word'>assumed</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>comes</span> <span class='word'>into</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>from</span> <span class='word'>any</span> <span class='word'>particular</span> <span class='word'>direction</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>problematic</span> <span class='word'>if</span><span class='ignore'>,</span> <span class='word'>say</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>comes</span> <span class='word'>through</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>top</span> <span class='word'>or</span> <span class='word'>bottom</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>components</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>wrong</span> <span class='word'>order</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>Kink</span> <span class='word'>Fit</span> <span class='word'>algorithm</span> <span class='word'>to</span> <span class='word'>work</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>easily</span> <span class='word'>rectified</span> <span class='word'>by</span> <span class='word'>simply</span> <span class='word'>rotating</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>into</span> <span class='word'>a</span> <span class='word'>standard</span> <span class='word'>orientation</span> <span class='word'>as</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>is</span> <span class='word'>coming</span> <span class='word'>in</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>left</span> <span class='word'>side</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>extra</span> <span class='word'>computational</span> <span class='word'>effort</span> <span class='word'>is</span> <span class='word'>minimal</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>is</span> <span class='word'>small</span><span class='ignore'>.</span> <span class='word'>Performing</span> <span class='word'>the</span> <span class='word'>Kink</span> <span class='word'>Fit</span> <span class='word'>algorithm</span> <span class='word'>returns</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>three</span> <span class='word'>points</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>can</span> <span class='word'>then</span> <span class='word'>be</span> <span class='word'>rotated</span> <span class='word'>back</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>original</span> <span class='word'>orientation</span><span class='ignore'>.</span><br>
<br>
<span class='word'>In</span> <span class='word'>practice</span><span class='ignore'>,</span> <span class='word'>however</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>Kink</span> <span class='word'>Fit</span> <span class='word'>algorithm</span> <span class='word'>accepts</span> <span class='word'>the</span> <span class='word'>full</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>midline</span> <span class='word'>points</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>vector</span> <span class='word'>of</span> <span class='word'>pointers</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>reliable</span> <span class='word'>values</span> <span class='word'>within</span> <span class='word'>that</span> <span class='word'>set</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>allows</span> <span class='word'>the</span> <span class='word'>Kink</span> <span class='word'>Fit</span> <span class='word'>algorithm</span> <span class='word'>to</span> <span class='word'>extend</span> <span class='word'>out</span> <span class='word'>the</span> <span class='word'>end</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>line</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>.</span> <span class='word'>Were</span> <span class='word'>this</span> <span class='word'>not</span> <span class='word'>the</span> <span class='word'>case</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>end</span> <span class='word'>points</span> <span class='word'>returned</span> <span class='word'>would</span> <span class='word'>lie</span> <span class='word'>somewhere</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>corresponding</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>and</span> <span class='word'>last</span> <span class='word'>reliable</span> <span class='word'>midline</span> <span class='word'>points</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>result</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ExcludedEdgePointsAndMidlineFit</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Parallel</span> <span class='hword'>Lines</span> <span class='hword'>Fit</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ParallelLinesFit</span><span class='ignore'>}</span><br>
<span class='word'>Our</span> <span class='word'>model</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>finger</span> <span class='word'>assumes</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>edges</span> <span class='word'>are</span> <span class='word'>parallel</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>other</span><span class='ignore'>.</span> <span class='word'>Since</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>line</span> <span class='word'>which</span> <span class='word'>runs</span> <span class='word'>through</span> <span class='word'>the</span> <span class='word'>center</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>finger</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>now</span> <span class='word'>calculate</span> <span class='word'>the</span> <span class='word'>distance</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>to</span> <span class='word'>that</span> <span class='word'>line</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>distances</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>classified</span> <span class='word'>as</span> <span class='word'>good</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>if</span> <span class='word'>they're</span> <span class='word'>parallel</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>central</span> <span class='word'>line</span><span class='ignore'>.</span> <span class='word'>Whether</span> <span class='word'>they</span> <span class='word'>are</span> <span class='word'>parallel</span> <span class='word'>is</span> <span class='word'>determined</span> <span class='word'>by</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>Mean-Median</span> <span class='word'>distance</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>central</span> <span class='word'>line</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>using</span> <span class='word'>a</span> <span class='mathgroup'>$</span><span class='math'>50</span><span class='math'>\%</span><span class='mathgroup'>$</span> <span class='word'>interval</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>portion</span><span class='ignore'>,</span> <span class='word'>because</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>expected</span> <span class='word'>that</span> <span class='word'>up</span> <span class='word'>to</span> <span class='word'>half</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>segment</span><span class='ignore'>,</span> <span class='word'>maybe</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>a</span> <span class='mathgroup'>$</span><span class='math'>75</span><span class='math'>\%</span><span class='mathgroup'>$</span> <span class='word'>confidence</span> <span class='word'>interval</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>middle</span> <span class='word'>segment</span><span class='ignore'>,</span> <span class='word'>because</span> <span class='word'>we</span> <span class='word'>expect</span> <span class='word'>fewer</span> <span class='word'>than</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>4</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>anomalies</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>points</span> <span class='word'>are</span> <span class='word'>then</span> <span class='word'>classified</span> <span class='word'>as</span> <span class='word'>good</span> <span class='word'>if</span> <span class='word'>they</span> <span class='word'>are</span> <span class='word'>of</span> <span class='word'>Mean-Median</span> <span class='word'>distance</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>central</span> <span class='word'>line</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>noted</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>consider</span> <span class='word'>both</span> <span class='word'>the</span> <span class='word'>top</span> <span class='word'>and</span> <span class='word'>bottom</span> <span class='word'>edges</span> <span class='word'>when</span> <span class='word'>calculating</span> <span class='word'>the</span> <span class='word'>Mean-Median</span> <span class='word'>distance</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>technique</span> <span class='word'>successfully</span> <span class='word'>removes</span> <span class='word'>anomalies</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>parallel</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>central</span> <span class='word'>line</span><span class='ignore'>.</span><br>
<br>
<span class='word'>There</span> <span class='word'>is</span> <span class='word'>one</span> <span class='word'>final</span> <span class='word'>step</span><span class='ignore'>:</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>classified</span> <span class='word'>as</span> <span class='word'>good</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>are</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>a</span> <span class='word'>linear</span> <span class='word'>fit</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>parallel</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>central</span> <span class='word'>line</span><span class='ignore'>.</span> <span class='word'>Finally</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>width</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>middle</span> <span class='word'>segments</span> <span class='word'>is</span> <span class='word'>calculated</span> <span class='word'>by</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>distance</span> <span class='word'>between</span> <span class='word'>these</span> <span class='word'>parallel</span> <span class='word'>lines</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ParallelFit</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>ParallelFit.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Initial</span> <span class='oword'>shape-fitting</span> <span class='oword'>stage</span><span class='ignore'>,</span> <span class='oword'>with</span> <span class='oword'>the</span> <span class='oword'>Kink</span> <span class='oword'>Fit</span><span class='ignore'>,</span> <span class='oword'>midline</span><span class='ignore'>,</span> <span class='oword'>and</span> <span class='oword'>Parallel</span> <span class='oword'>Edge</span> <span class='oword'>fit</span><span class='ignore'>,</span> <span class='oword'>with</span> <span class='oword'>AMS</span> <span class='oword'>and</span> <span class='oword'>Direct</span> <span class='oword'>elliptical</span> <span class='oword'>fits</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>tip</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ParallelFit</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Set</span> <span class='hword'>the</span> <span class='hword'>Scale</span> <span class='hword'>Space</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>SetTheScaleSpace</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>images</span> <span class='word'>captured</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>camera</span> <span class='word'>are</span> <span class='word'>large</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>define</span> <span class='word'>three</span> <span class='word'>scales</span><span class='ignore'>:</span> <br>
<span class='envir'>\begin</span><span class='envir'>{description}</span><br>
<span class='cmd'>\item</span><span class='optparm'>[</span><span class='word'>Large</span><span class='optparm'>]</span> <span class='word'>The</span> <span class='word'>original</span> <span class='word'>image</span><br>
<span class='cmd'>\item</span><span class='optparm'>[</span><span class='word'>Medium</span><span class='optparm'>]</span> <span class='word'>The</span> <span class='word'>image</span> <span class='word'>scaled</span> <span class='word'>relative</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>width</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>camera</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span><span class='optparm'>[</span><span class='word'>Small</span><span class='optparm'>]</span> <span class='word'>A</span> <span class='word'>small</span> <span class='word'>image</span> <span class='word'>just</span> <span class='word'>large</span> <span class='word'>enough</span> <span class='word'>to</span> <span class='word'>detect</span> <span class='word'>rapid</span> <span class='word'>movement</span> <span class='word'>between</span> <span class='word'>frames</span><span class='ignore'>.</span><br>
<span class='envir'>\end</span><span class='envir'>{description}</span><br>
<br>
<span class='comment'>% We want these images to be formed without the need for re-sampling. For that reason, we restrict the choice of image sizes to those which are integer factors of the image dimensions. This is done by finding the integer factors of the original image dimensions and then selecting from those factors to scale the image. It should be noted that, to simplify point correspondences, the integer scaling from the small to medium scales is also kept.</span><br>
<br>
<span class='word'>We</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>set</span> <span class='word'>the</span> <span class='word'>mid-scale</span> <span class='word'>such</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>pixels</span> <span class='word'>across</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>segment</span> <span class='word'>is</span> <span class='word'>over</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>target</span> <span class='word'>value</span> <span class='mathgroup'>$</span><span class='math'>w</span><span class='math'>_</span><span class='math'>m</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>are</span> <span class='word'>restricting</span> <span class='word'>the</span> <span class='word'>choice</span> <span class='word'>of</span> <span class='word'>scales</span> <span class='word'>to</span> <span class='word'>integer</span> <span class='word'>factors</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>original</span> <span class='word'>and</span> <span class='word'>integer</span> <span class='word'>multiples</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>small</span> <span class='word'>scale</span> <span class='word'>for</span> <span class='word'>efficient</span> <span class='word'>and</span> <span class='word'>accurate</span> <span class='word'>transformations</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>and</span> <span class='word'>images</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>images</span> <span class='word'>the</span> <span class='word'>factors</span> <span class='word'>are</span><span class='ignore'>:</span><br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='math'>scale</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>i</span><span class='ignore'>}</span> <span class='math'>3</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>j</span><span class='ignore'>}</span> <span class='math'>17</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>k</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>i</span> <span class='math'>&amp;</span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>0</span><span class='math'>,</span><span class='math'>1</span><span class='math'>,</span><span class='math'>2</span><span class='math'>,</span><span class='math'>3</span><span class='math'>,</span><span class='math'>4</span><span class='math'>\}</span> <br>
<span class='math'>&amp;</span>&nbsp; <span class='math'>j</span> <span class='math'>&amp;</span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>0</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>\}</span> <br>
<span class='math'>&amp;</span> <span class='math'>k</span> <span class='math'>&amp;</span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>0</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>\}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>The</span> <span class='word'>small</span> <span class='word'>scale</span> <span class='word'>space</span> <span class='word'>is</span> <span class='word'>made</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>largest</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>small</span> <span class='word'>factors</span> <span class='word'>as</span> <span class='word'>possible</span> <span class='word'>to</span> <span class='word'>achieve</span> <span class='word'>the</span> <span class='word'>desired</span> <span class='word'>image</span> <span class='word'>size</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>gives</span> <span class='word'>the</span> <span class='word'>greatest</span> <span class='word'>flexibility</span> <span class='word'>in</span> <span class='word'>scaling</span> <span class='word'>the</span> <span class='word'>mid-size</span><span class='ignore'>.</span><br>
<span class='envir'>\begin</span><span class='envir'>{table}</span><span class='option'>[h]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>|</span><span class='ignore'>cc</span><span class='ignore'>|</span><span class='ignore'>cc</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>l</span><span class='ignore'>|</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\cline</span><span class='ignore'>{</span><span class='ignore'>5-10</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\multicolumn</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><span class='ignore'>{</span> <span class='ignore'>}</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>0</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>1</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>2</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>3</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>4</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='ignore'>i</span><span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\cline</span><span class='ignore'>{</span><span class='ignore'>1-10</span><span class='ignore'>}</span><br>
<span class='ignore'>k</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>k</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>scale</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span><span class='ignore'>j</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>j</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>scale</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>1</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>4</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>8</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>16</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>scale</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='exclcmd'>\\</span><br>
&nbsp;<span class='exclcmd'>\hline</span> <span class='exclcmd'>\hline</span><br>
<span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>4</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>0</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>4</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>1</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>0</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>1</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <br>
 <span class='ignore'>2448</span> <span class='ignore'>&amp;</span> <span class='ignore'>1224</span>&nbsp; <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>612</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>306</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>153</span> <span class='ignore'>&amp;</span> <span class='ignore'>w</span> <span class='exclcmd'>\\</span><br>
&nbsp;<span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>&amp;</span> <br>
&nbsp; <span class='ignore'>3264</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>1632</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>816</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>408</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>204</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>h</span><span class='exclcmd'>\\</span><br>
&nbsp;<span class='exclcmd'>\cline</span><span class='ignore'>{</span><span class='ignore'>3-10</span><span class='ignore'>}</span><br>
 <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>&amp;</span> <span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>1</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <br>
 <span class='ignore'>816</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>408</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>204</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>102</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>51</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>w</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>&amp;</span> <br>
&nbsp; <span class='ignore'>1088</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>544</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>272</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>136</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>68</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>h</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\hline</span> <br>
&nbsp;<span class='exclcmd'>\hline</span><br>
<span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>4</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>1</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>4</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>17</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>0</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>1</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <br>
 <span class='ignore'>144</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>72</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>36</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>18</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>9</span> <span class='ignore'>&amp;</span> <span class='ignore'>w</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>&amp;</span> <span class='ignore'>&amp;</span> <br>
&nbsp; <span class='ignore'>192</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>96</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>48</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>24</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>12</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>h</span> <span class='exclcmd'>\\</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\cline</span><span class='ignore'>{</span><span class='ignore'>3-10</span><span class='ignore'>}</span><br>
 <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>&amp;</span>&nbsp; <span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>1</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <br>
 <span class='ignore'>48</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>24</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>12</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>6</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>3</span> <span class='ignore'>&amp;</span> <span class='ignore'>w</span> <span class='exclcmd'>\\</span><br>
&nbsp; <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>&amp;</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>&amp;</span> <br>
&nbsp; <span class='ignore'>64</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>32</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>16</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>8</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>4</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>h</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\hline</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>image</span> <span class='oword'>pixel</span> <span class='oword'>dimensions</span> <span class='oword'>for</span> <span class='oword'>all</span> <span class='oword'>possible</span> <span class='oword'>integer</span> <span class='oword'>factor</span> <span class='oword'>scalings</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{table}</span><br>
<br>
<span class='word'>So</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>chosen</span> <span class='word'>small</span> <span class='word'>scale</span> <span class='mathgroup'>$</span><span class='math'>S</span><span class='math'>_</span><span class='math'>s</span> <span class='math'>=</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>3</span><span class='ignore'>}</span> <span class='math'>3</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>1</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>distal</span> <span class='word'>width</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>small</span> <span class='word'>scale</span> <span class='mathgroup'>$</span><span class='math'>w</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>minimum</span> <span class='word'>distal</span> <span class='word'>width</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>medium</span> <span class='word'>scale</span> <span class='mathgroup'>$</span><span class='math'>w</span><span class='math'>_</span><span class='math'>m</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
<span class='word'>Finding</span>&nbsp; <span class='mathgroup'>$</span><span class='math'>i</span><span class='math'>_</span><span class='math'>m</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>j</span><span class='math'>_</span><span class='math'>m</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>minimise</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='math'>_</span><span class='math'>m</span> <span class='math'>+</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\log</span><span class='math'>(</span><span class='math'>3</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\log</span><span class='math'>(</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>j</span><span class='math'>_</span><span class='math'>m</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>and</span> <span class='word'>which</span> <span class='word'>satisfy</span>&nbsp; <span class='mathgroup'>$</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>i</span><span class='math'>_</span><span class='math'>m</span><span class='ignore'>}</span> <span class='math'>3</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>j</span><span class='math'>_</span><span class='math'>m</span><span class='ignore'>}</span> <span class='math'>-</span> <span class='mathcmd'>\lceil</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>w</span><span class='math'>_</span><span class='math'>m</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>w</span><span class='ignore'>}</span> <span class='mathcmd'>\rceil</span> <span class='mathcmd'>\ge</span> <span class='math'>0</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='math'>_</span><span class='math'>m</span><span class='mathcmd'>\le</span> <span class='math'>i</span><span class='math'>_</span><span class='math'>s</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>j</span><span class='math'>_</span><span class='math'>m</span> <span class='mathcmd'>\le</span> <span class='math'>j</span><span class='math'>_</span><span class='math'>s</span><span class='mathgroup'>$</span> <span class='word'>determines</span> <span class='word'>the</span> <span class='word'>medium</span> <span class='word'>scale</span> <span class='word'>space</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Modelling</span> <span class='hword'>the</span> <span class='hword'>Fingertip</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ModellingTheFingertip</span><span class='ignore'>}</span><br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[p!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;<span class='exclcmd'>\noindent</span><br>
&nbsp;<br>
&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>cc</span><span class='ignore'>}</span><br>
&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.45\textwidth, height=0.5\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Model</span><span class='ignore'>_</span><span class='ignore'>FindingD1AndD2</span><span class='ignore'>_</span><span class='ignore'>JSkin</span><span class='ignore'>_</span><span class='ignore'>Little.jpg</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\parbox</span><span class='option'>[b]</span><span class='option'>[0.5\textwidth]</span><span class='option'>[s]</span><span class='ignore'>{</span><span class='ignore'>0.55</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><span class='ignore'>{</span><br>
&nbsp;  <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>a</span><span class='ignore'>)</span> <span class='ignore'>Determining</span> <span class='exclmath'>$</span><span class='math'>d</span><span class='math'>_</span><span class='math'>1</span><span class='exclmath'>$</span> <span class='exclcmd'>\&amp;</span> <span class='exclmath'>$</span><span class='math'>d</span><span class='math'>_</span><span class='math'>2</span><span class='exclmath'>$</span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='ignore'>We</span> <span class='ignore'>have</span> <span class='ignore'>a</span> <span class='ignore'>midline</span> <span class='ignore'>which</span> <span class='ignore'>is</span> <span class='ignore'>given</span> <span class='ignore'>as</span> <span class='ignore'>two</span> <span class='ignore'>points</span> <span class='exclmath'>$</span><span class='math'>M</span><span class='math'>_</span><span class='math'>2</span><span class='exclmath'>$</span> <span class='exclcmd'>\&amp;</span> <span class='exclmath'>$</span><span class='math'>M</span><span class='math'>_</span><span class='math'>3</span><span class='exclmath'>$</span><span class='ignore'>;</span> <span class='ignore'>one</span> <span class='ignore'>somewhere</span> <span class='ignore'>on</span> <span class='ignore'>the</span> <span class='ignore'>digit</span> <span class='ignore'>(</span><span class='exclmath'>$</span><span class='math'>M</span><span class='math'>_</span><span class='math'>2</span><span class='exclmath'>$</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='ignore'>and</span> <span class='ignore'>the</span> <span class='ignore'>other</span> <span class='ignore'>at</span> <span class='ignore'>the</span> <span class='ignore'>tip</span> <span class='ignore'>(</span><span class='exclmath'>$</span><span class='math'>M</span><span class='math'>_</span><span class='math'>3</span><span class='exclmath'>$</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='ignore'>If</span> <span class='ignore'>the</span> <span class='ignore'>finger</span> <span class='ignore'>were</span> <span class='ignore'>straight</span> <span class='ignore'>in</span> <span class='ignore'>the</span> <span class='ignore'>frame</span><span class='ignore'>,</span> <span class='ignore'>then</span> <span class='exclmath'>$</span><span class='math'>d</span><span class='math'>_</span><span class='math'>1</span><span class='math'>=</span><span class='mathcmd'>\tilde</span><span class='ignore'>{</span><span class='math'>d</span><span class='math'>_</span><span class='math'>1</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>and</span> <span class='exclmath'>$</span><span class='math'>d</span><span class='math'>_</span><span class='math'>2</span><span class='math'>=</span><span class='mathcmd'>\tilde</span><span class='ignore'>{</span><span class='math'>d</span><span class='math'>_</span><span class='math'>2</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>could</span> <span class='ignore'>easily</span> <span class='ignore'>be</span> <span class='ignore'>found</span> <span class='ignore'>by</span> <span class='ignore'>finding</span> <span class='ignore'>the</span> <span class='ignore'>points</span> <span class='ignore'>on</span> <span class='ignore'>that</span> <span class='ignore'>line</span><span class='ignore'>.</span> <span class='ignore'>However</span><span class='ignore'>,</span> <span class='ignore'>the</span> <span class='ignore'>fact</span> <span class='ignore'>that</span> <span class='ignore'>the</span> <span class='ignore'>digit</span> <span class='ignore'>can</span> <span class='ignore'>be</span> <span class='ignore'>presented</span> <span class='ignore'>at</span> <span class='ignore'>an</span> <span class='ignore'>angle</span> <span class='ignore'>means</span> <span class='ignore'>that</span> <span class='ignore'>the</span> <span class='ignore'>edge</span> <span class='ignore'>points</span> <span class='ignore'>vertically</span> <span class='ignore'>above</span> <span class='ignore'>and</span> <span class='ignore'>below</span> <span class='ignore'>the</span> <span class='ignore'>point</span> <span class='ignore'>on</span> <span class='ignore'>the</span> <span class='ignore'>midline</span> <span class='ignore'>may</span> <span class='ignore'>include</span> <span class='ignore'>part</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>curved</span> <span class='ignore'>tip</span><span class='ignore'>.</span> <span class='ignore'>This</span> <span class='ignore'>has</span> <span class='ignore'>the</span> <span class='ignore'>effect</span> <span class='ignore'>of</span> <span class='ignore'>making</span> <span class='ignore'>these</span> <span class='ignore'>midpoints</span> <span class='ignore'>diverge</span> <span class='ignore'>from</span> <span class='ignore'>the</span> <span class='ignore'>midline</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>digit</span><span class='ignore'>.</span> <span class='ignore'>This</span> <span class='ignore'>can</span> <span class='ignore'>be</span> <span class='ignore'>corrected</span> <span class='ignore'>by</span> <span class='ignore'>adjusting</span> <span class='ignore'>with</span> <span class='ignore'>half</span> <span class='ignore'>the</span> <span class='ignore'>gradient</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>midline</span> <span class='exclmath'>$</span><span class='math'>\delta</span><span class='mathcmd'>\:</span><span class='math'>mid</span><span class='exclmath'>$</span> <span class='ignore'>to</span> <span class='ignore'>the</span> <span class='ignore'>ratios</span><span class='ignore'>.</span> <span class='exclenv'>\begin</span><span class='exclenv'>{equation*}</span><span class='ignore'>distance</span> <span class='exclcmd'>\:</span><span class='ignore'>on</span> <span class='exclcmd'>\:</span><span class='ignore'>line</span> <span class='ignore'>=</span> <span class='ignore'>(</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span> <span class='ignore'>+</span> <span class='exclcmd'>\left</span><span class='exclcmd'>\lvert</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>1</span><span class='ignore'>}</span><span class='ignore'>{2}\delta</span><span class='exclcmd'>\:</span><span class='ignore'>mid</span><span class='exclcmd'>\right</span><span class='exclcmd'>\lvert</span><span class='ignore'>)</span> <span class='ignore'>w</span><span class='exclenv'>\end</span><span class='exclenv'>{equation*}</span><span class='exclcmd'>\vfill</span><br>
&nbsp;&nbsp;<span class='ignore'>}</span> <span class='exclcmd'>\\</span> <br>
&nbsp;&nbsp;<span class='exclcmd'>\parbox</span><span class='option'>[b]</span><span class='option'>[0.5\textwidth]</span><span class='option'>[s]</span><span class='ignore'>{</span><span class='ignore'>0.45</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><span class='ignore'>{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>b</span><span class='ignore'>)</span> <span class='ignore'>A</span> <span class='ignore'>New</span> <span class='ignore'>Midline</span> <span class='ignore'>Fit</span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='ignore'>We</span> <span class='ignore'>take</span> <span class='ignore'>the</span> <span class='ignore'>set</span> <span class='ignore'>of</span> <span class='ignore'>midline</span> <span class='ignore'>points</span><span class='ignore'>,</span> <span class='ignore'>extract</span> <span class='ignore'>the</span> <span class='ignore'>subset</span> <span class='ignore'>which</span> <span class='ignore'>lies</span> <span class='ignore'>between</span> <span class='exclmath'>$</span><span class='math'>d</span><span class='math'>_</span><span class='math'>1</span><span class='exclmath'>$</span> <span class='ignore'>and</span> <span class='exclmath'>$</span><span class='math'>d</span><span class='math'>_</span><span class='math'>2</span><span class='exclmath'>$</span><span class='ignore'>,</span> <span class='ignore'>and</span> <span class='ignore'>then</span> <span class='ignore'>apply</span> <span class='ignore'>a</span> <span class='ignore'>straight</span> <span class='ignore'>line</span> <span class='ignore'>fit</span> <span class='ignore'>to</span> <span class='ignore'>these</span> <span class='ignore'>points</span><span class='ignore'>.</span> <span class='ignore'>The</span> <span class='ignore'>origin</span> <span class='ignore'>is</span> <span class='ignore'>the</span> <span class='ignore'>fit</span> <span class='ignore'>evaluated</span> <span class='ignore'>at</span> <span class='ignore'>the</span> <span class='exclmath'>$</span><span class='math'>x</span><span class='exclmath'>$</span> <span class='ignore'>component</span> <span class='ignore'>of</span> <span class='exclmath'>$</span><span class='math'>d</span><span class='math'>_</span><span class='math'>2</span><span class='exclmath'>$</span><span class='ignore'>,</span> <span class='ignore'>and</span> <span class='ignore'>we</span> <span class='ignore'>determine</span> <span class='ignore'>an</span> <span class='ignore'>orientation</span> <span class='exclmath'>$</span><span class='math'>\theta</span><span class='exclmath'>$</span><span class='ignore'>,</span> <span class='ignore'>which</span> <span class='ignore'>is</span> <span class='exclmath'>$</span><span class='mathcmd'>\arctan</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>gradient</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>linear</span> <span class='ignore'>model</span><span class='ignore'>.</span> <span class='exclcmd'>\vfill</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class='ignore'>}</span> <span class='ignore'>&amp;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.55\textwidth, height=0.5\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Model</span><span class='ignore'>_</span><span class='ignore'>Midline</span><span class='ignore'>_</span><span class='ignore'>JSkin</span><span class='ignore'>_</span><span class='ignore'>Thumb.jpg</span><span class='ignore'>}</span> <br>
&nbsp; &nbsp; <span class='exclcmd'>\\</span> <br>
&nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.45\textwidth, height=0.5\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Model</span><span class='ignore'>_</span><span class='ignore'>NeutralCoords</span><span class='ignore'>_</span><span class='ignore'>FSkin</span><span class='ignore'>_</span><span class='ignore'>Ring.jpg</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\parbox</span><span class='option'>[b]</span><span class='option'>[0.5\textwidth]</span><span class='option'>[s]</span><span class='ignore'>{</span><span class='ignore'>0.55</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><span class='ignore'>{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>)</span> <span class='ignore'>Determine</span> <span class='ignore'>the</span> <span class='ignore'>Neutral</span> <span class='ignore'>Coordinates</span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='ignore'>We</span> <span class='ignore'>move</span> <span class='ignore'>all</span> <span class='ignore'>the</span> <span class='ignore'>points</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='ignore'>the</span> <span class='ignore'>top</span> <span class='ignore'>and</span> <span class='ignore'>bottom</span> <span class='ignore'>edges</span><span class='ignore'>,</span> <span class='ignore'>and</span> <span class='ignore'>the</span> <span class='ignore'>midline</span> <span class='ignore'>points</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='ignore'>and</span> <span class='ignore'>we</span> <span class='ignore'>translate</span> <span class='ignore'>to</span> <span class='ignore'>the</span> <span class='ignore'>new</span> <span class='ignore'>origin</span><span class='ignore'>.</span> <span class='ignore'>Then</span><span class='ignore'>,</span> <span class='ignore'>we</span> <span class='ignore'>rotate</span> <span class='ignore'>by</span> <span class='exclmath'>$</span><span class='math'>-</span><span class='math'>\theta</span><span class='exclmath'>$</span><span class='ignore'>.</span> <span class='ignore'>This</span> <span class='ignore'>we</span> <span class='ignore'>call</span> <span class='ignore'>the</span> <span class='ignore'>"</span><span class='ignore'>neutral</span> <span class='ignore'>coordinates</span><span class='ignore'>"</span><span class='ignore'>,</span> <span class='ignore'>as</span> <span class='ignore'>the</span> <span class='ignore'>tip</span> <span class='ignore'>is</span> <span class='ignore'>aligned</span> <span class='ignore'>with</span> <span class='ignore'>its</span> <span class='ignore'>midaxis</span> <span class='ignore'>lying</span> <span class='ignore'>on</span> <span class='ignore'>the</span> <span class='exclmath'>$</span><span class='math'>x</span><span class='exclmath'>$</span> <span class='ignore'>axis</span><span class='ignore'>.</span> <span class='ignore'>These</span> <span class='ignore'>points</span> <span class='ignore'>are</span> <span class='ignore'>separated</span> <span class='ignore'>at</span> <span class='ignore'>one</span> <span class='ignore'>distal</span> <span class='ignore'>width</span> <span class='ignore'>from</span> <span class='ignore'>the</span> <span class='ignore'>tip</span><span class='ignore'>;</span> <span class='ignore'>a</span> <span class='ignore'>Trapezian</span> <span class='ignore'>fit</span> <span class='ignore'>is</span> <span class='ignore'>applied</span> <span class='ignore'>to</span> <span class='ignore'>one</span> <span class='ignore'>set</span> <span class='ignore'>of</span> <span class='ignore'>points</span><span class='ignore'>,</span> <span class='ignore'>and</span> <span class='ignore'>an</span> <span class='ignore'>Elliptical</span> <span class='ignore'>fit</span> <span class='ignore'>is</span> <span class='ignore'>applied</span> <span class='ignore'>to</span> <span class='ignore'>the</span> <span class='ignore'>other</span><span class='ignore'>.</span> <span class='ignore'>As</span> <span class='ignore'>a</span> <span class='ignore'>refinement</span> <span class='ignore'>to</span> <span class='ignore'>this</span><span class='ignore'>,</span> <span class='ignore'>although</span> <span class='ignore'>the</span> <span class='ignore'>linear</span> <span class='ignore'>fit</span> <span class='ignore'>is</span> <span class='ignore'>applied</span> <span class='ignore'>as</span> <span class='ignore'>in</span> <span class='ignore'>the</span> <span class='ignore'>Trapezian</span> <span class='ignore'>section</span><span class='ignore'>,</span> <span class='ignore'>the</span> <span class='ignore'>algorithm</span> <span class='ignore'>then</span> <span class='ignore'>looks</span> <span class='ignore'>at</span> <span class='ignore'>the</span> <span class='ignore'>points</span> <span class='ignore'>beyond</span> <span class='ignore'>and</span> <span class='ignore'>before</span> <span class='ignore'>the</span> <span class='ignore'>one</span> <span class='ignore'>distal</span> <span class='ignore'>width</span> <span class='ignore'>region</span><span class='ignore'>;</span> <span class='ignore'>if</span> <span class='ignore'>they're</span> <span class='ignore'>consistent</span> <span class='ignore'>with</span> <span class='ignore'>the</span> <span class='ignore'>fit</span><span class='ignore'>,</span> <span class='ignore'>then</span> <span class='ignore'>they</span> <span class='ignore'>are</span> <span class='ignore'>considered</span> <span class='ignore'>still</span> <span class='ignore'>part</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>straight</span> <span class='ignore'>edge</span><span class='ignore'>.</span> <span class='ignore'>The</span> <span class='ignore'>Elliptical</span> <span class='ignore'>fit</span> <span class='ignore'>is</span> <span class='ignore'>applied</span> <span class='ignore'>as</span> <span class='ignore'>discussed</span> <span class='ignore'>previously</span><span class='ignore'>.</span> <span class='exclcmd'>\vfill</span><br>
&nbsp;&nbsp;<span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><span class='exclcmd'>\\</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\phantomcaption</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<span class='cmd'>\addtocounter</span><span class='ignore'>{</span><span class='ignore'>figure</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='ignore'>1</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[p!]</span><br>
<span class='exclcmd'>\ContinuedFloat</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{minipage}</span><span class='option'>[t]</span><span class='ignore'>{</span><span class='ignore'>1</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{wrapfigure}</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>0.5</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><br>
&nbsp;<span class='exclenv'>\begin</span><span class='exclenv'>{center}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.5\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Model</span><span class='ignore'>_</span><span class='ignore'>ShapeFitting</span><span class='ignore'>_</span><span class='ignore'>FSkin</span><span class='ignore'>_</span><span class='ignore'>Little.jpg</span><span class='ignore'>}</span><br>
&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{center}</span><br>
&nbsp; <span class='exclcmd'>\phantomcaption</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{wrapfigure}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>d</span><span class='ignore'>)</span> <span class='ignore'>Fitting</span> <span class='ignore'>the</span> <span class='ignore'>Shapes</span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='ignore'>The</span> <span class='ignore'>comparison</span> <span class='ignore'>between</span> <span class='ignore'>the</span> <span class='ignore'>elliptical</span> <span class='ignore'>fit</span> <span class='ignore'>methods</span> <span class='ignore'>is</span> <span class='ignore'>done</span> <span class='ignore'>by</span> <span class='ignore'>looking</span> <span class='ignore'>at</span> <span class='ignore'>the</span> <span class='ignore'>distance</span> <span class='ignore'>from</span> <span class='ignore'>the</span> <span class='ignore'>front</span> <span class='ignore'>two</span> <span class='ignore'>points</span> <span class='ignore'>on</span> <span class='ignore'>the</span> <span class='ignore'>trapezium</span> <span class='ignore'>to</span> <span class='ignore'>the</span> <span class='ignore'>edge</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>ellipse</span><span class='ignore'>,</span> <span class='ignore'>and</span> <span class='ignore'>the</span> <span class='ignore'>best</span> <span class='ignore'>of</span> <span class='ignore'>these</span> <span class='ignore'>is</span> <span class='ignore'>chosen</span><span class='ignore'>.</span> <span class='ignore'>Unfortunately</span><span class='ignore'>,</span> <span class='ignore'>this</span> <span class='ignore'>is</span> <span class='ignore'>often</span> <span class='ignore'>not</span> <span class='ignore'>sufficient</span> <span class='ignore'>to</span> <span class='ignore'>make</span> <span class='ignore'>the</span> <span class='ignore'>ellipse</span> <span class='ignore'>join</span> <span class='ignore'>with</span> <span class='ignore'>the</span> <span class='ignore'>trapezium</span> <span class='ignore'>exactly</span> <span class='ignore'>because</span> <span class='ignore'>further</span> <span class='ignore'>on</span> <span class='ignore'>in</span> <span class='ignore'>the</span> <span class='ignore'>algorithm</span><span class='ignore'>,</span> <span class='ignore'>these</span> <span class='ignore'>shapes</span> <span class='ignore'>will</span> <span class='ignore'>be</span> <span class='ignore'>used</span> <span class='ignore'>to</span> <span class='ignore'>perform</span> <span class='ignore'>a</span> <span class='ignore'>mask</span><span class='ignore'>;</span> <span class='ignore'>we</span> <span class='ignore'>want</span> <span class='ignore'>to</span> <span class='ignore'>avoid</span> <span class='ignore'>introducing</span> <span class='ignore'>artefacts</span> <span class='ignore'>which</span> <span class='ignore'>could</span> <span class='ignore'>be</span> <span class='ignore'>interpreted</span> <span class='ignore'>as</span> <span class='ignore'>features</span><span class='ignore'>.</span> <span class='ignore'>So</span><span class='ignore'>,</span> <span class='ignore'>we</span> <span class='ignore'>wish</span> <span class='ignore'>to</span> <span class='ignore'>remove</span> <span class='ignore'>these</span> <span class='ignore'>discontinuous</span> <span class='ignore'>intersections</span> <span class='ignore'>between</span> <span class='ignore'>the</span> <span class='ignore'>ellipse</span> <span class='ignore'>and</span> <span class='ignore'>the</span> <span class='ignore'>trapezium</span><span class='ignore'>.</span> <span class='ignore'>In</span> <span class='ignore'>order</span> <span class='ignore'>to</span> <span class='ignore'>do</span> <span class='ignore'>this</span><span class='ignore'>,</span> <span class='ignore'>we</span> <span class='ignore'>choose</span> <span class='ignore'>three</span> <span class='ignore'>points</span> <span class='ignore'>on</span> <span class='ignore'>the</span> <span class='ignore'>Elliptical</span> <span class='ignore'>fit</span> <span class='ignore'>and</span> <span class='ignore'>the</span> <span class='ignore'>two</span> <span class='ignore'>front</span> <span class='ignore'>points</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>trapezium</span><span class='ignore'>,</span> <span class='ignore'>thereby</span> <span class='ignore'>making</span> <span class='ignore'>a</span> <span class='ignore'>set</span> <span class='ignore'>of</span> <span class='ignore'>five</span> <span class='ignore'>points</span><span class='ignore'>,</span> <span class='ignore'>and</span> <span class='ignore'>we</span> <span class='ignore'>pass</span> <span class='ignore'>these</span> <span class='ignore'>through</span> <span class='ignore'>the</span> <span class='ignore'>direct</span> <span class='ignore'>Elliptical</span> <span class='ignore'>fit</span> <span class='ignore'>algorithm</span><span class='ignore'>.</span> <span class='ignore'>It</span> <span class='ignore'>should</span> <span class='ignore'>be</span> <span class='ignore'>noted</span> <span class='ignore'>that</span> <span class='ignore'>five</span> <span class='ignore'>points</span> <span class='ignore'>is</span> <span class='ignore'>what</span> <span class='ignore'>is</span> <span class='ignore'>required</span> <span class='ignore'>to</span> <span class='ignore'>completely</span> <span class='ignore'>define</span> <span class='ignore'>an</span> <span class='ignore'>ellipse</span><span class='ignore'>;</span> <span class='ignore'>there</span> <span class='ignore'>is</span> <span class='ignore'>only</span> <span class='ignore'>one</span> <span class='ignore'>ellipse</span> <span class='ignore'>which</span> <span class='ignore'>will</span> <span class='ignore'>pass</span> <span class='ignore'>through</span> <span class='ignore'>five</span> <span class='ignore'>points</span><span class='ignore'>.</span><br>
&nbsp; &nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{minipage}</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\subfloat</span><span class='ignore'>{</span><span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.99\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Model</span><span class='ignore'>_</span><span class='ignore'>Finalizing</span><span class='ignore'>_</span><span class='ignore'>FSkin</span><span class='ignore'>_</span><span class='ignore'>Index.jpg</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='exclcmd'>\\</span><br>
&nbsp;&nbsp;<span class='exclenv'>\begin</span><span class='exclenv'>{minipage}</span><span class='ignore'>{</span><span class='ignore'>0.95</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>e</span><span class='ignore'>)</span> <span class='ignore'>Finalizing</span> <span class='ignore'>the</span> <span class='ignore'>Model</span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='ignore'>The</span> <span class='ignore'>coordinates</span> <span class='ignore'>for</span> <span class='ignore'>the</span> <span class='ignore'>ellipse</span> <span class='ignore'>and</span> <span class='ignore'>the</span> <span class='ignore'>trapezian</span> <span class='ignore'>are</span> <span class='ignore'>adjusted</span> <span class='ignore'>so</span> <span class='ignore'>that</span> <span class='ignore'>the</span> <span class='ignore'>origin</span> <span class='ignore'>is</span> <span class='ignore'>at</span> <span class='ignore'>the</span> <span class='ignore'>center</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>ellipse</span><span class='ignore'>,</span> <span class='ignore'>and</span> <span class='ignore'>the</span> <span class='ignore'>ellipse</span> <span class='ignore'>has</span> <span class='ignore'>zero</span> <span class='ignore'>rotation</span><span class='ignore'>.</span> <span class='ignore'>The</span> <span class='ignore'>reason</span> <span class='ignore'>for</span> <span class='ignore'>this</span> <span class='ignore'>is</span> <span class='ignore'>that</span> <span class='ignore'>it</span> <span class='ignore'>makes</span> <span class='ignore'>calculating</span> <span class='ignore'>the</span> <span class='ignore'>distance</span> <span class='ignore'>from</span> <span class='ignore'>the</span> <span class='ignore'>edges</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>ellipse</span> <span class='ignore'>easier</span><span class='ignore'>.</span> <span class='ignore'>So</span><span class='ignore'>,</span> <span class='ignore'>now</span> <span class='ignore'>when</span> <span class='ignore'>we</span> <span class='ignore'>apply</span> <span class='ignore'>the</span> <span class='ignore'>model</span> <span class='ignore'>to</span> <span class='ignore'>the</span> <span class='ignore'>image</span><span class='ignore'>,</span> <span class='ignore'>all</span> <span class='ignore'>that's</span> <span class='ignore'>required</span> <span class='ignore'>is</span> <span class='ignore'>a</span> <span class='ignore'>position</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='ignore'>which</span> <span class='ignore'>is</span> <span class='ignore'>the</span> <span class='ignore'>position</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>center</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>ellipse</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='ignore'>and</span> <span class='ignore'>an</span> <span class='ignore'>orientation</span> <span class='ignore'>about</span> <span class='ignore'>that</span> <span class='ignore'>position</span><span class='ignore'>.</span> <br>
&nbsp; &nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{minipage}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>Fingertip</span> <span class='oword'>Model</span> <span class='oword'>Algorithm</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ModelingFingertip</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>Having</span> <span class='word'>determined</span> <span class='word'>a</span> <span class='word'>measure</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>width</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>portion</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>fingertip</span> <span class='word'>allows</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>more</span> <span class='word'>robust</span> <span class='word'>model</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>fingertip</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>determined</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>measurement</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>width</span> <span class='word'>is</span> <span class='word'>far</span> <span class='word'>more</span> <span class='word'>reliable</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>length</span> <span class='word'>which</span> <span class='word'>has</span> <span class='word'>so</span> <span class='word'>far</span> <span class='word'>been</span> <span class='word'>determined</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>length</span> <span class='word'>has</span> <span class='word'>been</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>evaluating</span> <span class='word'>where</span> <span class='word'>the</span> <span class='ignore'>"</span><span class='word'>kink</span><span class='ignore'>"</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>midline</span> <span class='word'>points</span> <span class='word'>lies</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>example</span><span class='ignore'>,</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>joint</span> <span class='word'>is</span> <span class='word'>un-flexed</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>knuckle</span> <span class='word'>portion</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>overlooked</span> <span class='word'>entirely</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ParallelFit</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>turns</span> <span class='word'>out</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>anatomical</span> <span class='word'>ratios</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distal</span><span class='ignore'>,</span>&nbsp; <span class='word'>middle</span><span class='ignore'>,</span> <span class='word'>and</span>&nbsp; <span class='word'>proximal</span> <span class='word'>lengths</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='math'>:</span><span class='math'>3</span><span class='math'>:</span><span class='math'>5</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>width</span> <span class='mathgroup'>$</span><span class='math'>w</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>distal</span> <span class='word'>length</span> <span class='mathgroup'>$</span><span class='math'>l</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>d</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>ratio</span> <span class='mathgroup'>$</span><span class='math'>2</span> <span class='math'>:</span> <span class='math'>3</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>is</span> <span class='word'>a</span> <span class='word'>far</span> <span class='word'>more</span> <span class='word'>reliable</span> <span class='word'>method</span> <span class='word'>of</span> <span class='word'>determining</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>length</span> <span class='mathgroup'>$</span><span class='math'>l</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>d</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>1.5</span> <span class='math'>w</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<br>
<span class='word'>From</span> <span class='word'>the</span> <span class='word'>kink</span> <span class='word'>fit</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>midline</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>specified</span> <span class='word'>by</span> <span class='word'>three</span> <span class='word'>points</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>now</span> <span class='word'>determine</span> <span class='word'>two</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>this</span> <span class='word'>line</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>are</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>width</span> <span class='ignore'>(</span><span class='mathgroup'>$</span><span class='math'>d</span><span class='math'>_</span><span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>)</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>1</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>width</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='ignore'>(</span><span class='mathgroup'>$</span><span class='math'>d</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>So</span> <span class='word'>the</span> <span class='word'>midline</span> <span class='word'>point</span> <span class='word'>that</span> <span class='word'>lies</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>points</span> <span class='word'>can</span> <span class='word'>now</span> <span class='word'>be</span> <span class='word'>taken</span> <span class='word'>to</span> <span class='word'>correspond</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>straight-edged</span> <span class='word'>section</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>portion</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>finger</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>points</span> <span class='word'>are</span> <span class='word'>passed</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>Trapezian</span> <span class='word'>Fit</span> <span class='word'>method</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>TrapezianFit</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>which</span> <span class='word'>lie</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>half</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>width</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>are</span> <span class='word'>passed</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>Elliptical</span> <span class='word'>Fit</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>EllipticalFitMethod</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>ellipse</span> <span class='word'>is</span> <span class='word'>adjusted</span> <span class='word'>to</span> <span class='word'>correspond</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>near</span> <span class='word'>vertices</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>Trapezian</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>result</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ModelingFingertip</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.99\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Model</span><span class='ignore'>_</span><span class='ignore'>Overlayed.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>models</span> <span class='oword'>overlayed</span> <span class='oword'>on</span> <span class='oword'>the</span> <span class='oword'>source</span> <span class='oword'>images</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingertipModelResult</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>Overlaying</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>on</span> <span class='word'>its</span> <span class='word'>source</span> <span class='word'>image</span> <span class='word'>shows</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>application</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>actually</span> <span class='word'>only</span> <span class='word'>requires</span> <span class='word'>a</span> <span class='word'>position</span> <span class='word'>and</span> <span class='word'>orientation</span><span class='ignore'>,</span> <span class='word'>because</span> <span class='word'>we</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>is</span> <span class='word'>positioned</span> <span class='word'>such</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>presents</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>scale</span> <span class='word'>when</span> <span class='word'>in</span> <span class='word'>contact</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>surface</span> <span class='word'>throughout</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>;</span> <span class='word'>we're</span> <span class='word'>not</span> <span class='word'>accounting</span> <span class='word'>for</span> <span class='word'>perspective</span> <span class='word'>effects</span> <span class='word'>in</span> <span class='word'>this</span> <span class='word'>simple</span> <span class='word'>application</span><span class='ignore'>.</span><br>
<span class='word'>The</span> <span class='word'>model</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>overlayed</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>selection</span> <span class='word'>of</span> <span class='word'>digits</span> <span class='word'>for</span> <span class='word'>three</span> <span class='word'>individuals</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingertipModelResult</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{sidewaysfigure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='cmd'>\centering</span><br>
&nbsp;&nbsp;<span class='cmd'>\includegraphics</span><span class='optparm'>[</span><span class='ignore'>width</span><span class='ignore'>=</span><span class='ignore'>0.95</span><span class='exclcmd'>\textwidth</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Model</span><span class='ignore'>_</span><span class='ignore'>Overlayed</span><span class='ignore'>_</span><span class='ignore'>Boundary</span><span class='ignore'>_</span><span class='ignore'>with</span><span class='ignore'>_</span><span class='ignore'>Tips.jpg</span><span class='ignore'>}</span><br>
&nbsp;&nbsp;<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>models</span> <span class='oword'>and</span> <span class='oword'>model</span> <span class='oword'>boundaries</span> <span class='oword'>overlayed</span> <span class='oword'>on</span> <span class='oword'>the</span> <span class='oword'>source</span> <span class='oword'>images</span><span class='ignore'>.</span> <span class='oword'>With</span> <span class='oword'>tip</span> <span class='oword'>masks</span> <span class='oword'>and</span> <span class='oword'>extracted</span> <span class='oword'>tip</span> <span class='oword'>images</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ModelOverlayedBoundaryWithTips</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{sidewaysfigure}</span><br>
<br>
<br>
<span class='cmd'>\clearpage</span><br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Dynamic</span> <span class='hword'>Tracking</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>DynamicTracking</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>main</span> <span class='word'>purpose</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>dynamic</span> <span class='word'>tracking</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>categorize</span> <span class='word'>the</span> <span class='word'>motion</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>as</span> <span class='ignore'>"</span><span class='word'>rapid</span> <span class='word'>motion</span><span class='ignore'>,</span><span class='ignore'>"</span> <span class='ignore'>"</span><span class='word'>smooth</span> <span class='word'>motion</span><span class='ignore'>,</span><span class='ignore'>"</span> <span class='word'>and</span> <span class='ignore'>"</span><span class='word'>in</span> <span class='word'>contact</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>surface</span><span class='ignore'>.</span><span class='ignore'>"</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{itemize}</span><br>
<span class='cmd'>\item</span> <span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='word'>Rapid</span> <span class='word'>motion</span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>When</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>is</span> <span class='word'>being</span> <span class='word'>moved</span> <span class='word'>into</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>,</span> <span class='word'>or</span> <span class='word'>is</span> <span class='word'>moving</span> <span class='word'>rapidly</span> <span class='word'>across</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>,</span> <span class='word'>or</span> <span class='word'>when</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>is</span> <span class='word'>being</span> <span class='word'>put</span> <span class='word'>into</span> <span class='word'>position</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>pointless</span> <span class='word'>to</span> <span class='word'>attempt</span> <span class='word'>to</span> <span class='word'>detect</span> <span class='word'>a</span> <span class='word'>fingertip</span> <span class='word'>as</span> <span class='word'>this</span> <span class='word'>information</span> <span class='word'>will</span> <span class='word'>quickly</span> <span class='word'>become</span> <span class='word'>irrelevant</span><span class='ignore'>.</span> <span class='word'>Standard</span> <span class='word'>motion</span> <span class='word'>detection</span> <span class='word'>library</span> <span class='word'>routines</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>here</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>unaltered</span> <span class='word'>video</span> <span class='word'>feed</span><span class='ignore'>.</span> <span class='word'>When</span> <span class='word'>these</span> <span class='word'>algorithms</span> <span class='word'>detect</span> <span class='word'>motion</span> <span class='word'>above</span> <span class='word'>a</span> <span class='word'>certain</span> <span class='word'>threshold</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>does</span> <span class='word'>nothing</span> <span class='word'>and</span> <span class='word'>waits</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>motion</span> <span class='word'>detected</span> <span class='word'>to</span> <span class='word'>fall</span> <span class='word'>below</span> <span class='word'>this</span> <span class='word'>threshold</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='word'>Smooth</span> <span class='word'>motion</span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>Smooth</span> <span class='word'>motion</span> <span class='word'>is</span> <span class='word'>when</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>is</span> <span class='word'>being</span> <span class='word'>moved</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>controlled</span> <span class='word'>manner</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>.</span> <span class='word'>When</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>is</span> <span class='word'>moving</span> <span class='word'>in</span> <span class='word'>such</span> <span class='word'>a</span> <span class='word'>way</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>reasonable</span> <span class='word'>to</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>a</span> <span class='word'>finger</span> <span class='word'>press</span> <span class='word'>is</span> <span class='word'>imminent</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>takes</span> <span class='word'>a</span> <span class='word'>frame</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>small</span> <span class='word'>scale</span> <span class='word'>space</span> <span class='word'>and</span> <span class='word'>processes</span> <span class='word'>it</span> <span class='word'>into</span> <span class='word'>a</span> <span class='word'>pixel-categorized</span> <span class='word'>image</span> <span class='word'>as</span> <span class='word'>in</span> <span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>QuaternaryPixelClassification</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>frame</span> <span class='word'>orientation</span> <span class='word'>and</span> <span class='word'>digit</span> <span class='word'>tip</span> <span class='word'>selection</span> <span class='word'>are</span> <span class='word'>found</span> <span class='word'>as</span> <span class='word'>in</span> <span class='word'>Sections</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FindingTheFrameOrientation</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FindingTheEndOfTheFingerShape</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>a</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>of</span> <span class='word'>only</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>is</span> <span class='word'>performed</span> <span class='word'>similar</span> <span class='word'>to</span> <span class='word'>Sections</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FilamentFill</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FilamentFillTheFinger</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>now</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>path</span> <span class='word'>being</span> <span class='word'>shortened</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>length</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>section</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>position</span> <span class='word'>and</span> <span class='word'>orientation</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>are</span> <span class='word'>obtained</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>Force</span> <span class='word'>Analogue</span> <span class='word'>Shape</span> <span class='word'>Detection</span> <span class='word'>algorithm</span> <span class='word'>outlined</span> <span class='word'>below</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ForceAnalogue</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>continues</span> <span class='word'>tracking</span> <span class='word'>until</span> <span class='word'>the</span> <span class='word'>change</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>position</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>between</span> <span class='word'>successive</span> <span class='word'>frames</span> <span class='word'>falls</span> <span class='word'>below</span> <span class='word'>a</span> <span class='word'>threshold</span><span class='ignore'>,</span> <span class='word'>at</span> <span class='word'>which</span> <span class='word'>point</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>decides</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>is</span> <span class='word'>likely</span> <span class='word'>in</span> <span class='word'>contact</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>surface</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>control</span> <span class='word'>passes</span> <span class='word'>to</span> <span class='word'>the</span> <span class='ignore'>"</span><span class='word'>in</span> <span class='word'>contact</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>surface</span><span class='ignore'>"</span> <span class='word'>part</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='word'>In</span> <span class='word'>contact</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>surface</span> <span class='ignore'>(</span><span class='word'>ICWaS</span><span class='ignore'>)</span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>When</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>is</span> <span class='word'>relatively</span> <span class='word'>immobile</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>is</span> <span class='word'>likely</span> <span class='word'>in</span> <span class='word'>contact</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>surface</span><span class='ignore'>;</span> <span class='word'>we</span> <span class='word'>now</span> <span class='word'>want</span> <span class='word'>to</span> <span class='word'>observe</span> <span class='word'>the</span> <span class='word'>blood</span> <span class='word'>flow</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>frame</span> <span class='word'>is</span> <span class='word'>now</span> <span class='word'>captured</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>medium</span> <span class='word'>space</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>is</span> <span class='word'>cropped</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>in</span> <span class='word'>its</span> <span class='word'>current</span> <span class='word'>position</span> <span class='word'>and</span> <span class='word'>orientation</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>cropped</span> <span class='word'>image</span> <span class='word'>is</span> <span class='word'>put</span> <span class='word'>into</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>color-space</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>gradient</span> <span class='word'>filter</span> <span class='word'>is</span> <span class='word'>applied</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>grayscale</span> <span class='word'>channel</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>iteration</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>gradient-filtered</span> <span class='word'>image</span> <span class='word'>is</span> <span class='word'>stored</span><span class='ignore'>;</span> <span class='word'>if</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>subsequent</span> <span class='word'>iteration</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>gradient</span> <span class='word'>filter</span> <span class='word'>is</span> <span class='word'>compared</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>and</span> <span class='word'>an</span> <span class='word'>alignment</span> <span class='word'>transform</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>current</span> <span class='word'>frame</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>frame</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>improve</span> <span class='word'>the</span> <span class='word'>accuracy</span> <span class='word'>and</span> <span class='word'>avoid</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>being</span> <span class='word'>distracted</span> <span class='word'>by</span> <span class='word'>movements</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>edge</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>gradient-filtered</span> <span class='word'>images</span> <span class='word'>are</span> <span class='word'>masked</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>removes</span> <span class='word'>edge-related</span> <span class='word'>gradient</span> <span class='word'>features</span><span class='ignore'>,</span> <span class='word'>focusing</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>nail</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>stable</span> <span class='word'>during</span> <span class='word'>a</span> <span class='word'>finger</span> <span class='word'>press</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>transform</span> <span class='word'>is</span> <span class='word'>applied</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>chromatic</span> <span class='word'>channels</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>aligns</span> <span class='word'>the</span> <span class='word'>images</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>difference</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>between</span> <span class='word'>successive</span> <span class='word'>frames</span><span class='ignore'>;</span> <span class='word'>this</span> <span class='word'>gives</span> <span class='word'>us</span> <span class='word'>the</span> <span class='word'>blood</span> <span class='word'>flow</span><span class='ignore'>.</span> <br>
<span class='envir'>\end</span><span class='envir'>{itemize}</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Rapid</span> <span class='hword'>Motion</span> <span class='hword'>Tracking</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>RapidMotionTracking</span><span class='ignore'>}</span><br>
<span class='word'>Before</span> <span class='word'>any</span> <span class='word'>fingertip</span> <span class='word'>tracking</span> <span class='word'>is</span> <span class='word'>performed</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>checks</span> <span class='word'>to</span> <span class='word'>see</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>is</span> <span class='word'>still</span> <span class='word'>in</span> <span class='word'>motion</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>by</span> <span class='word'>first</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>difference</span> <span class='word'>between</span> <span class='word'>subsequent</span> <span class='word'>grayscaled</span> <span class='word'>frames</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>raw</span> <span class='word'>video</span> <span class='word'>feed</span> <span class='word'>using</span> <span class='word'>OpenCV's</span> <span class='ignore'>`</span><span class='word'>absdiff</span><span class='ignore'>'</span> <span class='word'>method</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>account</span> <span class='word'>for</span> <span class='word'>changes</span> <span class='word'>in</span> <span class='word'>lighting</span> <span class='word'>and</span> <span class='word'>contrast</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>binary</span> <span class='word'>threshold</span> <span class='word'>is</span> <span class='word'>applied</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>frames</span><span class='ignore'>,</span> <span class='word'>after</span> <span class='word'>which</span> <span class='word'>an</span> <span class='word'>erosion</span> <span class='word'>operation</span> <span class='ignore'>(</span><span class='word'>the</span> <span class='ignore'>`</span><span class='word'>erode</span><span class='ignore'>'</span> <span class='word'>method</span><span class='ignore'>)</span> <span class='word'>is</span> <span class='word'>performed</span> <span class='word'>to</span> <span class='word'>further</span> <span class='word'>reduce</span> <span class='word'>artifacts</span> <span class='word'>and</span> <span class='word'>false</span> <span class='word'>positives</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>the</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>changes</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>is</span> <span class='word'>above</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>threshold</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>is</span> <span class='word'>considered</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>in</span> <span class='word'>rapid</span> <span class='word'>motion</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Smooth</span> <span class='hword'>Motion</span> <span class='hword'>Tracking</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>SmoothMotionTracking</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>find-tip</span> <span class='word'>algorithm</span> <span class='ignore'>(</span><span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FindingTheEndOfTheFingerShape</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>gives</span> <span class='word'>us</span> <span class='word'>a</span> <span class='word'>path</span> <span class='word'>which</span> <span class='word'>we</span> <span class='word'>know</span> <span class='word'>lies</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>digit</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>path</span><span class='ignore'>,</span> <span class='word'>however</span><span class='ignore'>,</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>necessarily</span> <span class='word'>particularly</span> <span class='word'>well-aligned</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>this</span> <span class='word'>reason</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>don't</span> <span class='word'>ask</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>shortened</span> <span class='word'>path</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='math'>1</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>distal</span> <span class='word'>widths</span> <span class='word'>along</span> <span class='word'>that</span> <span class='word'>path</span><span class='ignore'>;</span> <span class='word'>such</span> <span class='word'>a</span> <span class='word'>path</span> <span class='word'>might</span> <span class='word'>actually</span> <span class='word'>end</span> <span class='word'>closer</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>than</span> <span class='word'>desired</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>isn't</span> <span class='word'>necessarily</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>axis</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>account</span> <span class='word'>for</span> <span class='word'>this</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>ask</span> <span class='word'>for</span> <span class='word'>two</span> <span class='word'>distal</span> <span class='word'>widths</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>The</span> <span class='word'>next</span> <span class='word'>problem</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>addressed</span> <span class='word'>results</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>operation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>method</span><span class='ignore'>;</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>isn't</span> <span class='word'>necessarily</span> <span class='word'>presented</span> <span class='word'>perpendicularly</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>edge</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>algorithm</span> <span class='word'>finds</span> <span class='word'>points</span> <span class='word'>perpendicular</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>edge</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>adjust</span> <span class='word'>by</span> <span class='word'>half</span> <span class='word'>the</span> <span class='word'>gradient</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>path</span><span class='ignore'>,</span> <span class='word'>similarly</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>method</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>fingertip</span> <span class='word'>model</span> <span class='word'>algorithm</span> <span class='word'>illustrated</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ModelingFingertip</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>is</span> <span class='word'>run</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>find-tip</span> <span class='word'>path</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>distance</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>(</span><span class='math'>2</span><span class='math'>+</span><span class='mathcmd'>\left</span><span class='mathcmd'>\lvert</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='math'>{2}\delta path</span><span class='mathcmd'>\right</span><span class='mathcmd'>\lvert</span><span class='math'>)</span><span class='math'>w</span><span class='mathgroup'>$</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>gives</span> <span class='word'>us</span> <span class='word'>three</span> <span class='word'>sets</span> <span class='word'>of</span> <span class='word'>points</span><span class='ignore'>:</span> <span class='word'>the</span> <span class='word'>top</span><span class='ignore'>,</span> <span class='word'>middle</span> <span class='word'>and</span> <span class='word'>bottom</span> <span class='word'>edges</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>definitely</span> <span class='word'>include</span> <span class='word'>points</span> <span class='word'>relating</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Now</span> <span class='word'>we</span> <span class='word'>refine</span> <span class='word'>these</span> <span class='word'>points</span><span class='ignore'>;</span> <span class='word'>because</span> <span class='word'>we</span> <span class='word'>know</span> <span class='word'>the</span> <span class='word'>orientation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>determine</span> <span class='word'>which</span> <span class='word'>points</span> <span class='word'>correspond</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>top</span> <span class='word'>edge</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>which</span> <span class='word'>points</span> <span class='word'>correspond</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>bottom</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>now</span> <span class='word'>put</span> <span class='word'>them</span> <span class='word'>into</span> <span class='word'>standard</span> <span class='word'>orientation</span> <span class='word'>as</span> <span class='word'>in</span> <span class='word'>steps</span> <span class='word'>a</span> <span class='word'>and</span> <span class='word'>b</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ModelingFingertip</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>We</span> <span class='word'>now</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>which</span> <span class='word'>would</span> <span class='word'>ideally</span> <span class='word'>correspond</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>First</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>obtain</span> <span class='word'>a</span> <span class='word'>reasonably</span> <span class='word'>good</span> <span class='word'>measure</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>orientation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>;</span> <span class='word'>given</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>midline</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>which</span> <span class='word'>reasonably</span> <span class='word'>correspond</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>segment</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>linear</span> <span class='word'>fit</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>middle</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>of</span> <span class='word'>these</span> <span class='word'>points</span> <span class='word'>provides</span> <span class='word'>a</span> <span class='word'>good</span> <span class='word'>measure</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>orientation</span> <span class='word'>with</span> <span class='word'>little</span> <span class='word'>computational</span> <span class='word'>cost</span><span class='ignore'>.</span> <span class='word'>Rather</span> <span class='word'>than</span> <span class='word'>reorientating</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>points</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>neutral</span> <span class='word'>coordinates</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>rotate</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>to</span> <span class='word'>correspond</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>coordinates</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>easily</span> <span class='word'>achieved</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>is</span> <span class='word'>centered</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>ellipse</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>so</span> <span class='word'>involves</span> <span class='word'>a</span> <span class='word'>rotation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>four</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>trapezian</span> <span class='word'>and</span> <span class='word'>adding</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>ellipse's</span> <span class='word'>orientation</span><span class='ignore'>.</span><br>
<br>
<span class='word'>In</span> <span class='word'>the</span> <span class='word'>model's</span> <span class='word'>new</span> <span class='word'>orientation</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>furthest</span> <span class='word'>point</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>in</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='math'>x</span><span class='mathgroup'>$</span> <span class='word'>axis</span><span class='ignore'>.</span> <span class='ignore'>(</span><span class='word'>It</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>noted</span> <span class='word'>that</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>necessarily</span> <span class='word'>what</span> <span class='word'>we</span> <span class='word'>would</span> <span class='word'>refer</span> <span class='word'>to</span> <span class='word'>as</span> <span class='word'>the</span> <span class='ignore'>"</span><span class='word'>tip</span><span class='ignore'>"</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>.</span><span class='ignore'>)</span> <span class='word'>We</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>this</span> <span class='word'>point</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>corresponds</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>point</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>midline</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>points</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>follows</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>back</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>frame</span> <span class='word'>edge</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>point</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>midline</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>create</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>x</span><span class='mathgroup'>$</span> <span class='word'>axis</span> <span class='word'>coordinates</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>midline</span> <span class='word'>point</span> <span class='word'>corresponds</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>furthest</span> <span class='word'>point</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>in</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='math'>x</span><span class='mathgroup'>$</span> <span class='word'>axis</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>do</span> <span class='word'>this</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>divides</span> <span class='word'>up</span> <span class='word'>the</span> <span class='word'>shape</span> <span class='word'>vertically</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>relatively</span> <span class='word'>regular</span> <span class='word'>fashion</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>are</span> <span class='word'>dividing</span> <span class='word'>up</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>way</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>would</span> <span class='word'>expect</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>to</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>were</span> <span class='word'>an</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>put</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>and</span> <span class='word'>points</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>into</span> <span class='word'>a</span> <span class='mathgroup'>$</span><span class='math'>1</span><span class='math'>:</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>correspondence</span><span class='ignore'>.</span> <span class='word'>So</span> <span class='word'>although</span> <span class='word'>the</span> <span class='word'>fingertip</span> <span class='word'>model</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>relatively</span> <span class='word'>arbitrary</span> <span class='word'>geometric</span> <span class='word'>shape</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>regularity</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>method</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>force</span> <span class='word'>analogue</span> <span class='word'>shape</span> <span class='word'>detection</span> <span class='word'>algorithm</span> <span class='word'>as</span> <span class='word'>outlined</span> <span class='word'>previously</span> <span class='ignore'>(</span><span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ForceAnalogue</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Model</span><span class='ignore'>_</span><span class='ignore'>Centroids</span><span class='ignore'>_</span><span class='ignore'>With</span><span class='ignore'>_</span><span class='ignore'>Pos</span><span class='ignore'>_</span><span class='ignore'>Orientation.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Finding</span> <span class='oword'>the</span> <span class='oword'>Position</span> <span class='oword'>and</span> <span class='oword'>Orientation</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>Tip</span><span class='ignore'>.</span> <span class='oword'>A</span> <span class='oword'>side-effect</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>pre-alignment</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>model</span> <span class='oword'>means</span> <span class='oword'>that</span><span class='ignore'>,</span> <span class='oword'>almost</span> <span class='oword'>always</span><span class='ignore'>,</span>&nbsp; <span class='oword'>the</span> <span class='oword'>change</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>orientation</span> <span class='oword'>from</span> <span class='oword'>the</span> <span class='oword'>force</span> <span class='oword'>analogue</span> <span class='oword'>shape</span> <span class='oword'>detection</span> <span class='oword'>algorithm</span> <span class='oword'>is</span> <span class='oword'>negligible</span><span class='ignore'>.</span> <span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PositionAndOrientation</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>A</span> <span class='word'>side-effect</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>pre-alignment</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>means</span> <span class='word'>that</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>almost</span> <span class='word'>always</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>the</span> <span class='word'>change</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>orientation</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>force</span> <span class='word'>analogue</span> <span class='word'>shape</span> <span class='word'>detection</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>negligible</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>distribution</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>around</span> <span class='word'>the</span> <span class='word'>perimeter</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>is</span> <span class='word'>dependant</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>orientation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>means</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>centroid</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>constant</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>so</span> <span class='word'>a</span> <span class='word'>shape-based</span> <span class='word'>area</span> <span class='word'>centroid</span> <span class='word'>is</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>modeling</span> <span class='word'>stage</span> <span class='ignore'>(</span><span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PositionAndOrientation</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.85\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Smooth</span><span class='ignore'>_</span><span class='ignore'>Dynamic</span><span class='ignore'>_</span><span class='ignore'>Sequence.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Smooth</span> <span class='oword'>Dynamic</span> <span class='oword'>Sequence</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>SmoothDynamicSequence</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<br>
<span class='word'>In</span> <span class='word'>practice</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>first</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>rough</span> <span class='word'>orientation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>and</span> <span class='word'>rotates</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>accordingly</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>model</span> <span class='word'>is</span> <span class='word'>re-centered</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>centroid</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>current</span> <span class='word'>orientation</span> <span class='word'>before</span> <span class='word'>the</span> <span class='word'>FASDM</span> <span class='word'>method</span> <span class='word'>is</span> <span class='word'>used</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>In</span> <span class='word'>addition</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>FASDM</span> <span class='word'>method</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>also</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>length</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>vectors</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>and</span> <span class='word'>translated</span> <span class='word'>model</span> <span class='word'>points</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>be</span> <span class='word'>clear</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>distance</span> <span class='word'>is</span> <span class='word'>signed</span> <span class='word'>according</span> <span class='word'>to</span> <span class='word'>which</span> <span class='word'>point</span> <span class='word'>is</span> <span class='word'>further</span> <span class='word'>away</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>center</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>allows</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>scaled</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>upshot</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>correctly</span> <span class='word'>follows</span> <span class='word'>a</span> <span class='word'>digit</span> <span class='word'>even</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>moves</span> <span class='word'>closer</span> <span class='word'>or</span> <span class='word'>further</span> <span class='word'>away</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>camera</span><span class='ignore'>.</span> <span class='ignore'>(</span><span class='word'>Fingers</span> <span class='word'>do</span> <span class='word'>not</span> <span class='word'>normally</span> <span class='word'>change</span> <span class='word'>shape</span><span class='ignore'>.</span><span class='ignore'>)</span><br>
<span class='cmd'>\clearpage</span><br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>ICWaS</span> <span class='hword'>Method</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ICWaS</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>ICWaS</span> <span class='word'>method</span> <span class='word'>performs</span> <span class='word'>three</span> <span class='word'>main</span> <span class='word'>tasks</span><span class='ignore'>:</span> <span class='word'>cropping</span> <span class='word'>the</span> <span class='word'>midscale</span> <span class='word'>image</span> <span class='word'>around</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>;</span> <span class='word'>providing</span> <span class='word'>a</span> <span class='word'>multiplicative</span> <span class='word'>mask</span> <span class='word'>which</span> <span class='word'>highlights</span> <span class='word'>blood</span> <span class='word'>flow</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='word'>aligning</span> <span class='word'>successive</span> <span class='word'>frames</span> <span class='word'>in-order</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>color</span> <span class='word'>differences</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>color-space</span><span class='ignore'>.</span> <span class='word'>Combining</span> <span class='word'>these</span> <span class='word'>three</span> <span class='word'>tasks</span> <span class='word'>allows</span> <span class='word'>the</span> <span class='word'>blood</span> <span class='word'>flow</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>shown</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsubsection</span><span class='ignore'>{</span><span class='hword'>ICWaS</span> <span class='hword'>Setup</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ICWaSSetup</span><span class='ignore'>}</span><br>
<span class='word'>From</span> <span class='word'>the</span> <span class='word'>Smooth</span> <span class='word'>Movement</span> <span class='word'>Tracking</span> <span class='ignore'>(</span><span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>SmoothMotionTracking</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>model</span> <span class='word'>position</span> <span class='word'>and</span> <span class='word'>orientation</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>small</span> <span class='word'>scale</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>track</span> <span class='word'>the</span> <span class='word'>blood</span> <span class='word'>flow</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>medium</span> <span class='word'>scale</span> <span class='word'>image</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>first</span> <span class='word'>we</span> <span class='word'>must</span> <span class='word'>put</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>medium</span> <span class='word'>scale</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>as</span> <span class='word'>simple</span> <span class='word'>as</span> <span class='word'>multiplying</span> <span class='word'>the</span> <span class='word'>coordinates</span> <span class='word'>by</span> <span class='word'>a</span> <span class='word'>scaling</span> <span class='word'>factor</span> <span class='word'>as</span> <span class='word'>shown</span> <span class='word'>in</span> <span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ScaleSpace</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Now</span> <span class='word'>we</span> <span class='word'>want</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>extreme</span> <span class='word'>top</span><span class='ignore'>,</span> <span class='word'>bottom</span><span class='ignore'>,</span> <span class='word'>left</span> <span class='word'>and</span> <span class='word'>right</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>in</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>crop</span> <span class='word'>the</span> <span class='word'>midscale</span> <span class='word'>image</span> <span class='word'>appropriately</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>model</span> <span class='word'>is</span> <span class='word'>comprised</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>quadrilateral</span> <span class='word'>and</span> <span class='word'>an</span> <span class='word'>ellipse</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>extreme</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>quadrilateral</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>just</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>minimum</span> <span class='word'>and</span> <span class='word'>maximum</span> <span class='word'>values</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>coordinates</span> <span class='word'>of</span> <span class='word'>its</span> <span class='word'>vertices</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>ellipse's</span> <span class='word'>extreme</span> <span class='word'>edges</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>using</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{minipage}</span><span class='ignore'>{</span><span class='ignore'>0.7</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>ll</span><span class='ignore'>}</span><br>
<span class='math'>e</span><span class='math'>_</span><span class='math'>1</span><span class='math'>=</span> <span class='mathcmd'>\Bigg</span><span class='math'>(</span> <span class='math'>x</span><span class='math'>_</span><span class='math'>0</span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>a-b</span><span class='math'>)</span> <span class='math'>(</span><span class='math'>a</span><span class='math'>+</span><span class='math'>b</span><span class='math'>)</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>A</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>,</span> <span class='math'>y</span><span class='math'>_</span><span class='math'>0</span><span class='math'>+</span><span class='math'>A</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\Bigg</span><span class='math'>)</span><span class='mathcmd'>\\</span><br>
<span class='math'>e</span><span class='math'>_</span><span class='math'>2</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\Bigg</span><span class='math'>(</span> <span class='math'>x</span><span class='math'>_</span><span class='math'>0</span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>a-b</span><span class='math'>)</span> <span class='math'>(</span><span class='math'>a</span><span class='math'>+</span><span class='math'>b</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>A</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>,</span> <span class='math'>y</span><span class='math'>_</span><span class='math'>0-A</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\Bigg</span><span class='math'>)</span><span class='mathcmd'>\\</span><br>
<span class='math'>e</span><span class='math'>_</span><span class='math'>3</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\Bigg</span><span class='math'>(</span> <span class='math'>x</span><span class='math'>_</span><span class='math'>0-B</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>,</span> <span class='math'>y</span><span class='math'>_</span><span class='math'>0</span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>a-b</span><span class='math'>)</span> <span class='math'>(</span><span class='math'>a</span><span class='math'>+</span><span class='math'>b</span><span class='math'>)</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>B</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\Bigg</span><span class='math'>)</span><span class='mathcmd'>\\</span><br>
<span class='math'>e</span><span class='math'>_</span><span class='math'>4</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\Bigg</span><span class='math'>(</span> <span class='math'>x</span><span class='math'>_</span><span class='math'>0</span><span class='math'>+</span><span class='math'>B</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>,</span> <span class='math'>y</span><span class='math'>_</span><span class='math'>0</span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>a-b</span><span class='math'>)</span> <span class='math'>(</span><span class='math'>a</span><span class='math'>+</span><span class='math'>b</span><span class='math'>)</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>B</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\Bigg</span><span class='math'>)</span><span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span><span class='mathcmd'>\quad</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
<span class='math'>A</span><span class='math'>=</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>a</span><span class='math'>^</span><span class='math'>2</span> <span class='mathcmd'>\tan</span> <span class='math'>^</span><span class='math'>2</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span><span class='math'>+</span><span class='math'>b</span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='math'>B</span><span class='math'>=</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>a</span><span class='math'>^</span><span class='math'>2</span><span class='math'>+</span><span class='math'>b</span><span class='math'>^</span><span class='math'>2</span> <span class='mathcmd'>\tan</span> <span class='math'>^</span><span class='math'>2</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\Pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>&lt;</span> <span class='math'>\theta </span><span class='math'>&lt;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\Pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<span class='envir'>\end</span><span class='envir'>{minipage}</span><span class='comment'>%%%%%%%%%%%%%%%%</span><br>
<span class='envir'>\begin</span><span class='envir'>{minipage}</span><span class='ignore'>{</span><span class='ignore'>0.3</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><br>
 <span class='cmd'>\includegraphics</span><span class='optparm'>[</span><span class='ignore'>width</span><span class='ignore'>=</span><span class='exclcmd'>\textwidth</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Elliptical</span><span class='ignore'>_</span><span class='ignore'>Bounds.jpg</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{minipage}</span><br>
<br>
<br>
<span class='word'>However</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>only</span> <span class='word'>want</span> <span class='word'>to</span> <span class='word'>include</span> <span class='word'>extreme</span> <span class='word'>points</span> <span class='word'>which</span> <span class='word'>lie</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>curve</span> <span class='word'>which</span> <span class='word'>models</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>curve</span> <span class='word'>which</span> <span class='word'>models</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>part</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>ellipse</span> <span class='word'>which</span> <span class='word'>falls</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>quadrilateral</span> <span class='word'>closest</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>;</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>check</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>extreme</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>ellipse</span> <span class='word'>are</span> <span class='word'>on</span> <span class='word'>this</span> <span class='word'>part</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>curve</span> <span class='word'>by</span> <span class='word'>checking</span> <span class='word'>that</span> <span class='word'>they</span> <span class='word'>lie</span> <span class='word'>at</span> <span class='word'>an</span> <span class='word'>angular</span> <span class='word'>position</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>angles</span> <span class='word'>at</span> <span class='word'>which</span> <span class='word'>the</span> <span class='word'>tipmost</span> <span class='word'>quadrilateral</span> <span class='word'>points</span> <span class='word'>lie</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Now</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>the</span> <span class='word'>extreme</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>points</span> <span class='word'>are</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>a</span> <span class='word'>bounding</span> <span class='word'>box</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>includes</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>pixels</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>small</span> <span class='word'>scale</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>Translating</span> <span class='word'>these</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>medium</span> <span class='word'>scale</span> <span class='word'>space</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>subtract</span> <span class='word'>the</span> <span class='word'>scaling</span> <span class='word'>factor</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>lower</span> <span class='word'>coordinates</span> <span class='word'>and</span> <span class='word'>add</span> <span class='word'>the</span> <span class='word'>scaling</span> <span class='word'>factor</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>higher</span> <span class='word'>coordinates</span><span class='ignore'>,</span> <span class='word'>ensuring</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>box</span> <span class='word'>does</span> <span class='word'>not</span> <span class='word'>crop</span> <span class='word'>any</span> <span class='word'>pixels</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>medium</span> <span class='word'>scale</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>now</span> <span class='word'>take</span> <span class='word'>the</span> <span class='word'>medium</span> <span class='word'>scale</span> <span class='word'>RGB</span> <span class='word'>image</span><span class='ignore'>,</span> <span class='word'>crop</span> <span class='word'>it</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>bounding</span> <span class='word'>box</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>pass</span> <span class='word'>the</span> <span class='word'>extracted</span> <span class='word'>tip</span> <span class='word'>image</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>color-space</span> <span class='word'>processing</span> <span class='word'>routines</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>grayscale</span> <span class='word'>image</span> <span class='word'>is</span> <span class='word'>saved</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>template</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>template</span> <span class='word'>matching</span> <span class='word'>algorithm</span><span class='ignore'>.</span><br>
<br>
<span class='word'>During</span> <span class='word'>a</span> <span class='word'>finger</span> <span class='word'>press</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>expect</span> <span class='word'>the</span> <span class='word'>flesh</span> <span class='word'>to</span> <span class='word'>deform</span> <span class='word'>around</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>,</span> <span class='word'>making</span> <span class='word'>the</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>unreliable</span> <span class='word'>for</span> <span class='word'>alignment</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>construct</span> <span class='word'>a</span> <span class='word'>binary</span> <span class='word'>mask</span> <span class='word'>which</span> <span class='word'>tells</span> <span class='word'>the</span> <span class='word'>template</span> <span class='word'>matching</span> <span class='word'>algorithm</span> <span class='word'>which</span> <span class='word'>pixels</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>for</span> <span class='word'>alignment</span><span class='ignore'>.</span> <span class='word'>Using</span> <span class='word'>OpenCV's</span> <span class='word'>drawing</span> <span class='word'>routines</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>render</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>midscale</span> <span class='word'>tip</span> <span class='word'>image</span> <span class='word'>coordinates</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>way</span> <span class='word'>which</span> <span class='word'>actually</span> <span class='word'>renders</span> <span class='word'>the</span> <span class='word'>model</span> <span class='ignore'>'</span><span class='word'>slightly</span><span class='ignore'>'</span> <span class='word'>by</span> <span class='word'>four</span> <span class='word'>or</span> <span class='word'>five</span> <span class='word'>pixels</span> <span class='word'>smaller</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>proper</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>effectively</span> <span class='word'>eliminates</span> <span class='word'>the</span> <span class='word'>edge</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>next</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>background</span><span class='ignore'>,</span> <span class='word'>pushing</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>to</span> <span class='word'>rely</span> <span class='word'>on</span> <span class='word'>features</span> <span class='word'>which</span> <span class='word'>do</span> <span class='word'>not</span> <span class='word'>deform</span><span class='ignore'>,</span> <span class='word'>such</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>nail</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsubsection</span><span class='ignore'>{</span><span class='hword'>Blood</span> <span class='hword'>Flow</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>BloodFlow</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.00\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Fig</span><span class='ignore'>_</span><span class='ignore'>Channels</span><span class='ignore'>_</span><span class='ignore'>JSkin.jpg</span><span class='ignore'>}</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.86\textwidth]{Chapter4/Figs/Final_Fig_Difference_JSkin.jpg}</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.86\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Fig</span><span class='ignore'>_</span><span class='ignore'>Total</span><span class='ignore'>_</span><span class='ignore'>Difference</span><span class='ignore'>_</span><span class='ignore'>JSkin.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.00\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Fig</span><span class='ignore'>_</span><span class='ignore'>Misc</span><span class='ignore'>_</span><span class='ignore'>JSkin.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>resulting</span> <span class='oword'>sequence</span> <span class='oword'>of</span> <span class='oword'>images</span> <span class='oword'>from</span> <span class='oword'>the</span> <span class='oword'>ICWaS</span> <span class='oword'>algorithm</span> <span class='oword'>followed</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>differences</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>metric</span> <span class='oword'>is</span> <span class='oword'>the</span> <span class='oword'>result</span> <span class='oword'>of</span> <span class='oword'>summing</span> <span class='oword'>the</span> <span class='oword'>positive</span> <span class='oword'>and</span> <span class='oword'>negative</span> <span class='oword'>changes</span> <span class='oword'>separately</span> <span class='oword'>and</span> <span class='oword'>then</span> <span class='oword'>dividing</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>number</span> <span class='oword'>of</span> <span class='oword'>pixels</span><span class='ignore'>.</span> <span class='oword'>Finally</span><span class='ignore'>,</span> <span class='oword'>the</span> <span class='oword'>initial</span> <span class='oword'>image</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>sequence</span> <span class='oword'>is</span> <span class='oword'>shown</span> <span class='oword'>with</span> <span class='oword'>the</span> <span class='oword'>model</span> <span class='oword'>outline</span><span class='ignore'>,</span> <span class='oword'>the</span> <span class='oword'>slightly</span> <span class='oword'>larger</span> <span class='oword'>model</span> <span class='oword'>used</span> <span class='oword'>to</span> <span class='oword'>set</span> <span class='oword'>the</span> <span class='oword'>crop</span> <span class='oword'>frame</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>slightly</span> <span class='oword'>smaller</span> <span class='oword'>model</span> <span class='oword'>used</span> <span class='oword'>for</span> <span class='oword'>setting</span> <span class='oword'>the</span> <span class='oword'>mask</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ICWaSResultJSkin</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.820\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Fig</span><span class='ignore'>_</span><span class='ignore'>Channels</span><span class='ignore'>_</span><span class='ignore'>FSkin.jpg</span><span class='ignore'>}</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.660\textwidth]{Chapter4/Figs/Final_Fig_Difference_FSkin.jpg}</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.660\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Fig</span><span class='ignore'>_</span><span class='ignore'>Total</span><span class='ignore'>_</span><span class='ignore'>Difference</span><span class='ignore'>_</span><span class='ignore'>FSkin.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.820\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Fig</span><span class='ignore'>_</span><span class='ignore'>Misc</span><span class='ignore'>_</span><span class='ignore'>FSkin.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>resulting</span> <span class='oword'>sequence</span> <span class='oword'>of</span> <span class='oword'>images</span> <span class='oword'>from</span> <span class='oword'>the</span> <span class='oword'>ICWaS</span> <span class='oword'>algorithm</span> <span class='oword'>followed</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>differences</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>metric</span> <span class='oword'>is</span> <span class='oword'>the</span> <span class='oword'>result</span> <span class='oword'>of</span> <span class='oword'>summing</span> <span class='oword'>the</span> <span class='oword'>positive</span> <span class='oword'>and</span> <span class='oword'>negative</span> <span class='oword'>changes</span> <span class='oword'>separately</span> <span class='oword'>and</span> <span class='oword'>then</span> <span class='oword'>dividing</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>number</span> <span class='oword'>of</span> <span class='oword'>pixels</span><span class='ignore'>.</span> <span class='oword'>Finally</span><span class='ignore'>,</span> <span class='oword'>the</span> <span class='oword'>initial</span> <span class='oword'>image</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>sequence</span> <span class='oword'>is</span> <span class='oword'>shown</span> <span class='oword'>with</span> <span class='oword'>the</span> <span class='oword'>model</span> <span class='oword'>outline</span><span class='ignore'>,</span> <span class='oword'>the</span> <span class='oword'>slightly</span> <span class='oword'>larger</span> <span class='oword'>model</span> <span class='oword'>used</span> <span class='oword'>to</span> <span class='oword'>set</span> <span class='oword'>the</span> <span class='oword'>crop</span> <span class='oword'>frame</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>slightly</span> <span class='oword'>smaller</span> <span class='oword'>model</span> <span class='oword'>used</span> <span class='oword'>for</span> <span class='oword'>setting</span> <span class='oword'>the</span> <span class='oword'>mask</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ICWaSResultFSkin</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.00\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Fig</span><span class='ignore'>_</span><span class='ignore'>Channels</span><span class='ignore'>_</span><span class='ignore'>NSkin.jpg</span><span class='ignore'>}</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.86\textwidth]{Chapter4/Figs/Final_Fig_Difference_NSkin.jpg}</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.86\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Fig</span><span class='ignore'>_</span><span class='ignore'>Total</span><span class='ignore'>_</span><span class='ignore'>Difference</span><span class='ignore'>_</span><span class='ignore'>NSkin.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=1.00\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Final</span><span class='ignore'>_</span><span class='ignore'>Fig</span><span class='ignore'>_</span><span class='ignore'>Misc</span><span class='ignore'>_</span><span class='ignore'>NSkin.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>resulting</span> <span class='oword'>sequence</span> <span class='oword'>of</span> <span class='oword'>images</span> <span class='oword'>from</span> <span class='oword'>the</span> <span class='oword'>ICWaS</span> <span class='oword'>algorithm</span> <span class='oword'>followed</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>differences</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>metric</span> <span class='oword'>is</span> <span class='oword'>the</span> <span class='oword'>result</span> <span class='oword'>of</span> <span class='oword'>summing</span> <span class='oword'>the</span> <span class='oword'>positive</span> <span class='oword'>and</span> <span class='oword'>negative</span> <span class='oword'>changes</span> <span class='oword'>separately</span> <span class='oword'>and</span> <span class='oword'>then</span> <span class='oword'>dividing</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>number</span> <span class='oword'>of</span> <span class='oword'>pixels</span><span class='ignore'>.</span> <span class='oword'>Finally</span><span class='ignore'>,</span> <span class='oword'>the</span> <span class='oword'>initial</span> <span class='oword'>image</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>sequence</span> <span class='oword'>is</span> <span class='oword'>shown</span> <span class='oword'>with</span> <span class='oword'>the</span> <span class='oword'>model</span> <span class='oword'>outline</span><span class='ignore'>,</span> <span class='oword'>the</span> <span class='oword'>slightly</span> <span class='oword'>larger</span> <span class='oword'>model</span> <span class='oword'>used</span> <span class='oword'>to</span> <span class='oword'>set</span> <span class='oword'>the</span> <span class='oword'>crop</span> <span class='oword'>frame</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>slightly</span> <span class='oword'>smaller</span> <span class='oword'>model</span> <span class='oword'>used</span> <span class='oword'>for</span> <span class='oword'>setting</span> <span class='oword'>the</span> <span class='oword'>mask</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ICWaSResultNSkin</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>We</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>digit's</span> <span class='word'>movement</span> <span class='word'>will</span> <span class='word'>not</span> <span class='word'>take</span> <span class='word'>it</span> <span class='word'>outside</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>bounding</span> <span class='word'>box</span> <span class='word'>set</span> <span class='word'>up</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>initialization</span> <span class='word'>step</span> <span class='ignore'>(</span><span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ICWaSSetup</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>capture</span> <span class='word'>the</span> <span class='word'>tip</span> <span class='word'>image</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>video</span> <span class='word'>feed</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>RGB</span> <span class='word'>tip</span> <span class='word'>image</span> <span class='word'>is</span> <span class='word'>converted</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>color-space</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>grayscale</span> <span class='word'>channel</span> <span class='word'>image</span> <span class='word'>is</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>align</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>previous</span> <span class='word'>captured</span> <span class='word'>frame</span><span class='ignore'>;</span> <span class='word'>if</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>pass</span> <span class='word'>through</span> <span class='word'>the</span> <span class='word'>loop</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>captured</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>initialization</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>frame</span> <span class='word'>alignment</span> <span class='word'>metric</span> <span class='word'>is</span> <span class='word'>masked</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>binary</span> <span class='word'>rastered</span> <span class='word'>model</span> <span class='word'>image</span> <span class='word'>generated</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>initialization</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>image</span> <span class='word'>alignment</span> <span class='word'>pixel</span> <span class='word'>shift</span> <span class='word'>updates</span> <span class='word'>the</span> <span class='word'>change</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>position</span> <span class='word'>since</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>frame</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>the</span> <span class='word'>change</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>position</span> <span class='word'>since</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>frame</span> <span class='word'>is</span> <span class='word'>greater</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>ICWaS</span> <span class='word'>threshold</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>control</span> <span class='word'>passes</span> <span class='word'>back</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>Smooth</span> <span class='word'>Motion</span> <span class='word'>routine</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>current</span> <span class='word'>frame</span> <span class='word'>is</span> <span class='word'>aligned</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>previous</span> <span class='word'>frame</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>difference</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>channels</span><span class='ignore'>;</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>blood</span> <span class='word'>flow</span> <span class='ignore'>(</span><span class='word'>Figures</span>&nbsp; <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ICWaSResultJSkin</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ICWaSResultFSkin</span><span class='ignore'>}</span> <span class='cmd'>\&amp;</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ICWaSResultNSkin</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>steps</span> <span class='word'>are</span> <span class='word'>repeated</span> <span class='word'>until</span> <span class='word'>the</span> <span class='word'>change</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>position</span> <span class='word'>since</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>frame</span> <span class='word'>causes</span> <span class='word'>the</span> <span class='word'>routine</span> <span class='word'>to</span> <span class='word'>transfer</span> <span class='word'>control</span> <span class='word'>back</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>Smooth</span> <span class='word'>Motion</span> <span class='word'>routine</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\clearpage</span><br>
<br>
<span class='cmd'>\subsubsection</span><span class='ignore'>{</span><span class='hword'>Blood</span> <span class='hword'>Flow</span> <span class='hword'>Metric</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>BloodFlowMetric</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[tbph]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>sixChannelsWeightsGrfx</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='option'>[Normalized the 6-channel metrics.]</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>normalized</span> <span class='oword'>6-channel</span> <span class='oword'>metrics</span><span class='ignore'>,</span> <span class='oword'>revealing</span> <span class='oword'>the</span> <span class='oword'>shape</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>distributions</span> <span class='oword'>and</span> <span class='oword'>facilitating</span> <span class='oword'>numerical</span> <span class='oword'>techniques</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>sixchannelsweightsgrfx</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[tbph]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>sixChannelFitGrfx</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>A</span> <span class='oword'>functional</span> <span class='oword'>fit</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>6-channel</span> <span class='oword'>metrics</span> <span class='oword'>for</span> <span class='oword'>both</span> <span class='oword'>the</span> <span class='ignore'>'</span><span class='oword'>Press</span><span class='ignore'>'</span> <span class='oword'>and</span> <span class='ignore'>'</span><span class='oword'>No-Press</span><span class='ignore'>'</span> <span class='oword'>data</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>fit</span> <span class='oword'>uses</span> <span class='oword'>a</span> <span class='oword'>combination</span> <span class='oword'>of</span> <span class='oword'>a</span> <span class='oword'>Gaussian</span> <span class='oword'>and</span> <span class='oword'>a</span> <span class='oword'>straight</span> <span class='oword'>line</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>sixchannelfitgrfx</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[tbph]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>anyliticCorrelationGrfx</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='option'>[The Analytic Correlation.]</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>Analytic</span> <span class='oword'>Correlation</span><span class='ignore'>.</span> <span class='oword'>Fixing</span> <span class='oword'>the</span> <span class='oword'>points</span> <span class='oword'>for</span> <span class='oword'>the</span> <span class='oword'>linear</span> <span class='oword'>combination</span><span class='ignore'>,</span> <span class='oword'>as</span> <span class='oword'>seen</span> <span class='oword'>in</span> <span class='oword'>top</span> <span class='oword'>right</span> <span class='oword'>diagram</span><span class='ignore'>,</span> <span class='oword'>an</span> <span class='oword'>analytic</span> <span class='oword'>solution</span> <span class='oword'>is</span> <span class='oword'>found</span> <span class='oword'>for</span> <span class='oword'>the</span> <span class='oword'>correlation</span> <span class='oword'>matrix</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>anyliticcorrelationgrfx</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[tbph]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>numericCorrelationGrfx</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>numerically-found</span> <span class='oword'>correlation</span> <span class='oword'>matrix</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>numericcorrelationgrfx</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\mL</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>L</span><span class='ignore'>^</span><span class='ignore'>-</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\pL</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>L</span><span class='ignore'>^</span><span class='ignore'>+</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\mCa</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Ca</span><span class='ignore'>^</span><span class='ignore'>-</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\pCa</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Ca</span><span class='ignore'>^</span><span class='ignore'>+</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\mCb</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Cb</span><span class='ignore'>^</span><span class='ignore'>-</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\pCb</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Cb</span><span class='ignore'>^</span><span class='ignore'>+</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\CmL</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>C</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='ignore'>\mL</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\CpL</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>C</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='ignore'>\pL</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\CmCa</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>C</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='ignore'>\mCa</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\CpCa</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>C</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='ignore'>\pCa</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\CmCb</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>C</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='ignore'>\mCb</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\CpCb</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>C</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='ignore'>\pCb</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='word'>We</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>6-channel</span> <span class='word'>metric</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>ICWaS</span> <span class='word'>method</span> <span class='word'>which</span> <span class='word'>we</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>to</span> <span class='word'>detect</span> <span class='word'>the</span> <span class='word'>presence</span> <span class='word'>of</span> <span class='word'>mechanical</span> <span class='word'>stress</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>tip</span><span class='ignore'>,</span> <span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>tip</span> <span class='word'>pressing</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>surface</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>simplest</span> <span class='word'>solution</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>form</span> <span class='word'>a</span> <span class='word'>linear</span> <span class='word'>combination</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>6-channel</span> <span class='word'>metric</span> <span class='word'>and</span> <span class='word'>to</span> <span class='word'>set</span> <span class='word'>a</span> <span class='word'>threshold</span> <span class='word'>above</span> <span class='word'>which</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>tip</span> <span class='word'>is</span> <span class='word'>considered</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>pressing</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>surface</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>The</span> <span class='word'>metric</span> <span class='word'>needs</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>able</span> <span class='word'>to</span> <span class='word'>distinguish</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>sliding</span> <span class='word'>slowly</span> <span class='word'>across</span> <span class='word'>the</span> <span class='word'>surface</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>pressing</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>surface</span><span class='ignore'>.</span> <span class='word'>Two</span> <span class='word'>ICWaS</span> <span class='word'>runs</span> <span class='word'>are</span> <span class='word'>compared</span> <span class='word'>in</span> <span class='word'>Figure</span>&nbsp; <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>sixchannelsweightsgrfx</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>one</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>sliding</span> <span class='word'>slowly</span> <span class='word'>across</span> <span class='word'>the</span> <span class='word'>surface</span> <span class='ignore'>(</span><span class='ignore'>'</span><span class='word'>No-Press</span><span class='ignore'>'</span> <span class='word'>data</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>other</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>pressing</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>surface</span> <span class='word'>then</span> <span class='word'>releasing</span> <span class='word'>pressure</span> <span class='ignore'>(</span><span class='ignore'>'</span><span class='word'>Press</span><span class='ignore'>'</span> <span class='word'>data</span><span class='ignore'>)</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>First</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>6-channel</span> <span class='word'>metrics</span> <span class='word'>are</span> <span class='word'>normalized</span> <span class='word'>to</span> <span class='word'>reveal</span> <span class='word'>the</span> <span class='word'>shape</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distributions</span> <span class='word'>and</span> <span class='word'>to</span> <span class='word'>facilitate</span> <span class='word'>numerical</span> <span class='word'>techniques</span> <span class='ignore'>(</span><span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>sixchannelsweightsgrfx</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>Then</span> <span class='word'>we</span> <span class='word'>fit</span> <span class='word'>a</span> <span class='word'>function</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>combination</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>straight</span> <span class='word'>line</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>Gaussian</span><span class='ignore'>,</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>sets</span> <span class='word'>of</span> <span class='word'>data</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>sixchannelfitgrfx</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='math'>f</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>set</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>channel</span><span class='ignore'>}</span> <span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='math'>=</span> <span class='math'>A</span> <span class='math'>e</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>0.5</span> <span class='math'>(</span><span class='math'>x-\mu </span><span class='math'>)</span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\sigma </span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>+</span><span class='math'>m</span> <span class='math'>x</span> <span class='math'>+</span><span class='math'>c</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<span class='word'>The</span> <span class='word'>6</span> <span class='word'>Press</span> <span class='word'>data</span> <span class='word'>functions</span> <span class='word'>clearly</span> <span class='word'>exhibit</span> <span class='word'>a</span> <span class='word'>common</span> <span class='word'>peak</span>&nbsp; <span class='word'>and</span> <span class='word'>a</span> <span class='word'>similar</span> <span class='word'>variance</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>illustrated</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>anyliticcorrelationgrfx</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>allows</span> <span class='word'>the</span> <span class='word'>Press</span> <span class='word'>data</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>divided</span> <span class='word'>into</span> <span class='word'>regions</span> <span class='word'>where</span> <span class='word'>we</span> <span class='word'>want</span> <span class='word'>the</span> <span class='word'>combined</span> <span class='word'>metric</span> <span class='word'>to</span> <span class='word'>register</span> <span class='word'>minimally</span> <span class='word'>and</span> <span class='word'>maximally</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>is</span> <span class='word'>also</span> <span class='word'>desirable</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>combined</span> <span class='word'>metric</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>flat</span> <span class='word'>when</span> <span class='word'>no</span> <span class='word'>pressure</span> <span class='word'>is</span> <span class='word'>being</span> <span class='word'>applied</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>considerations</span> <span class='word'>allow</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>equations</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>defined</span><span class='ignore'>:</span><br>
<br>
<br>
<span class='cmd'>\newlength</span><span class='ignore'>{</span><span class='exclcmd'>\savedbelowdisplayskip</span><span class='ignore'>}</span><br>
<span class='cmd'>\newlength</span><span class='ignore'>{</span><span class='exclcmd'>\savedabovedisplayskip</span><span class='ignore'>}</span><br>
<span class='cmd'>\newlength</span><span class='ignore'>{</span><span class='exclcmd'>\savedbelowdisplayshortskip</span><span class='ignore'>}</span><br>
<span class='cmd'>\newlength</span><span class='ignore'>{</span><span class='exclcmd'>\savedabovedisplayshortskip</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\savedbelowdisplayskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\belowdisplayskip</span><span class='ignore'>}</span> <span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\savedbelowdisplayshortskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\belowdisplayshortskip</span><span class='ignore'>}</span><br>
<span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\savedabovedisplayskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\abovedisplayskip</span><span class='ignore'>}</span> <span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\savedabovedisplayshortskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\abovedisplayshortskip</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\belowdisplayskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span> <span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\belowdisplayshortskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><br>
<span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\abovedisplayskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span> <span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\abovedisplayshortskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{multline*}</span><br>
<span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>np</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>=</span>&nbsp; &nbsp; <span class='cmd'>\CmCa</span> <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>np</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='cmd'>\mCa</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='cmd'>\CpCa</span> <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>np</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='cmd'>\pCa</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>+</span>&nbsp;  <span class='cmd'>\\</span><br>
&nbsp;<span class='cmd'>\CmCb</span> <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>np</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='cmd'>\mCb</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='cmd'>\CpCb</span> <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>np</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='cmd'>\pCb</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>+</span>&nbsp;  <span class='cmd'>\\</span> <br>
&nbsp;<span class='cmd'>\CmL</span>    <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>np</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span>&nbsp; <span class='cmd'>\mL</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='cmd'>\CpL</span>   <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>np</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span>&nbsp;  <span class='cmd'>\pL</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span>&nbsp;  <br>
<span class='envir'>\end</span><span class='envir'>{multline*}</span><br>
<span class='envir'>\begin</span><span class='envir'>{multline}</span><br>
<span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>p</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>=</span>&nbsp; <br>
 <span class='cmd'>\CmCa</span> <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>p</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='cmd'>\mCa</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='cmd'>\CpCa</span> <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>p</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='cmd'>\pCa</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>+</span>&nbsp; <span class='cmd'>\\</span><br>
&nbsp;<span class='cmd'>\CmCb</span> <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>p</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='cmd'>\mCb</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='cmd'>\CpCb</span> <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>p</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='cmd'>\pCb</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='cmd'>\\</span> <br>
&nbsp; <span class='cmd'>\CmL</span>    <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>p</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span>&nbsp; <span class='cmd'>\mL</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='cmd'>\CpL</span>   <span class='word'>F</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>p</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>{</span>&nbsp;  <span class='cmd'>\pL</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>x</span><span class='ignore'>)</span> <br>
<span class='envir'>\end</span><span class='envir'>{multline}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>eqn</span><span class='ignore'>:</span><span class='ignore'>FnpFp</span><span class='ignore'>}</span><br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='math'>F</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>np</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>start</span><span class='ignore'>}</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='math'>F</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>start</span><span class='ignore'>}</span><span class='math'>)</span> <span class='math'>=</span> <span class='math'>F</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>np</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>end</span><span class='ignore'>}</span><span class='math'>)</span> <span class='math'>=</span> <span class='math'>F</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>end</span><span class='ignore'>}</span><span class='math'>)</span> <span class='mathcmd'>\nonumber</span>  <span class='mathcmd'>\\</span><br>
<span class='math'>F</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>np</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>low</span><span class='ignore'>}</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='math'>F</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>low</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\nonumber</span>  <span class='mathcmd'>\\</span><br>
<span class='math'>F</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>np</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>high</span><span class='ignore'>}</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='math'>F</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>high</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eqn</span><span class='math'>:</span><span class='math'>AnanyticSolutionConditions</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<br>
<span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\belowdisplayskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\savedbelowdisplayskip</span><span class='ignore'>}</span> <span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\belowdisplayshortskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\savedbelowdisplayshortskip</span><span class='ignore'>}</span><br>
<span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\abovedisplayskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\savedabovedisplayskip</span><span class='ignore'>}</span> <span class='cmd'>\setlength</span><span class='ignore'>{</span><span class='exclcmd'>\abovedisplayshortskip</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\savedabovedisplayshortskip</span><span class='ignore'>}</span><br>
<br>
<span class='word'>These</span> <span class='word'>conditions</span> <span class='ignore'>(</span><span class='word'>Equation</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eqn</span><span class='ignore'>:</span><span class='ignore'>AnanyticSolutionConditions</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>solved</span> <span class='word'>for</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>6</span> <span class='word'>linear</span> <span class='word'>coefficients</span> <span class='ignore'>(</span><span class='word'>Equation</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eqn</span><span class='ignore'>:</span><span class='ignore'>FnpFp</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>results</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>anyliticcorrelationgrfx</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='word'>For</span> <span class='word'>completeness</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>numerical</span> <span class='word'>technique</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>6</span> <span class='word'>linear</span> <span class='word'>coefficients</span> <span class='word'>was</span> <span class='word'>also</span> <span class='word'>attempted</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>success</span> <span class='word'>was</span> <span class='word'>scored</span> <span class='word'>by</span> <span class='word'>checking</span> <span class='word'>the</span> <span class='ignore'>'</span><span class='word'>correct</span><span class='ignore'>'</span> <span class='word'>classification</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>as</span> <span class='word'>Press</span> <span class='word'>or</span> <span class='word'>No-Press</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>results</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>numericcorrelationgrfx</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>The</span> <span class='word'>two</span> <span class='word'>different</span> <span class='word'>methods</span> <span class='word'>were</span> <span class='word'>run</span> <span class='word'>using</span> <span class='word'>data</span> <span class='word'>from</span> <span class='word'>different</span> <span class='word'>individuals</span> <span class='word'>and</span> <span class='word'>different</span> <span class='word'>digits</span><span class='ignore'>.</span> <br>
<br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Dynamic</span> <span class='hword'>State</span> <span class='hword'>Transitions</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>DynamicStateTransitions</span><span class='ignore'>}</span><br>
<span class='word'>For</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>three</span> <span class='word'>states</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>define</span> <span class='word'>a</span> <span class='word'>metric</span> <span class='word'>which</span> <span class='word'>characterizes</span> <span class='word'>the</span> <span class='word'>motion</span> <span class='word'>detected</span><span class='ignore'>.</span> <span class='word'>Using</span> <span class='word'>these</span> <span class='word'>metrics</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>define</span> <span class='word'>four</span> <span class='word'>tolerances</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>state</span> <span class='word'>transitions</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>metric</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>rapid</span> <span class='word'>motion</span> <span class='word'>detection</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>eroded</span> <span class='word'>difference</span> <span class='word'>image</span> <span class='ignore'>(</span><span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>DynamicTracking</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>if</span> <span class='word'>two</span> <span class='word'>consecutive</span> <span class='word'>images</span> <span class='word'>are</span> <span class='word'>the</span> <span class='word'>same</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>metric</span> <span class='word'>is</span> <span class='word'>0</span><span class='ignore'>.</span> <span class='word'>And</span> <span class='word'>if</span> <span class='word'>every</span> <span class='word'>pixel</span> <span class='word'>has</span> <span class='word'>changed</span> <span class='word'>by</span> <span class='word'>its</span> <span class='word'>maximum</span> <span class='word'>amount</span> <span class='ignore'>(</span><span class='word'>e.g</span><span class='ignore'>.</span> <span class='word'>every</span> <span class='word'>pixel</span> <span class='word'>black</span><span class='ignore'>/</span><span class='word'>white</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>metric</span> <span class='word'>is</span> <span class='word'>255</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>only</span> <span class='word'>question</span> <span class='word'>remaining</span> <span class='word'>is</span> <span class='word'>what</span> <span class='word'>sort</span> <span class='word'>of</span> <span class='word'>values</span> <span class='word'>should</span> <span class='word'>we</span> <span class='word'>expect</span> <span class='word'>for</span> <span class='word'>rapid</span> <span class='word'>finger</span> <span class='word'>movement</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>can</span> <span class='word'>roughly</span> <span class='word'>estimate</span> <span class='word'>that</span> <span class='word'>a</span> <span class='word'>finger</span> <span class='word'>occupies</span> <span class='word'>about</span> <span class='word'>10</span><span class='ignore'>\%</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>;</span> <span class='word'>given</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>background</span> <span class='word'>is</span> <span class='word'>illuminated</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>amount</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>expect</span> <span class='word'>pixel</span> <span class='word'>differences</span> <span class='word'>around</span> <span class='word'>20</span><span class='ignore'>\%</span><span class='ignore'>.</span> <span class='word'>Thus</span><span class='ignore'>,</span> <span class='word'>although</span> <span class='word'>the</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>metric</span> <span class='word'>is</span> <span class='word'>actually</span> <span class='word'>0-255</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>actually</span> <span class='word'>expect</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>quite</span> <span class='word'>low</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[tbph]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>ICWaSAlignment</span><span class='ignore'>&amp;</span><span class='ignore'>Metric</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>ICWaS</span> <span class='oword'>alignment</span> <span class='oword'>and</span> <span class='oword'>Metric</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>icwasalignmentmetric</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>metric</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>smooth</span> <span class='word'>motion</span> <span class='word'>detection</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>distance</span> <span class='word'>moved</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>divided</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>distal</span> <span class='word'>width</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>SmoothMotionTracking</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>Significant</span> <span class='word'>values</span> <span class='word'>for</span> <span class='word'>this</span> <span class='word'>metric</span> <span class='word'>are</span> <span class='word'>0</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>hasn't</span> <span class='word'>had</span> <span class='word'>to</span> <span class='word'>move</span><span class='ignore'>;</span> <span class='word'>1</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>is</span> <span class='word'>moved</span> <span class='word'>by</span> <span class='word'>a</span> <span class='word'>finger</span> <span class='word'>width</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>assigned</span> <span class='word'>a</span> <span class='word'>negative</span> <span class='word'>value</span> <span class='word'>when</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>detected</span><span class='ignore'>,</span> <span class='word'>moved</span> <span class='word'>out</span> <span class='word'>of</span> <span class='word'>frame</span><span class='ignore'>,</span> <span class='word'>or</span> <span class='word'>if</span> <span class='word'>an</span> <span class='word'>insufficient</span> <span class='word'>amount</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>remains</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>for</span> <span class='word'>negative</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>isn't</span> <span class='word'>updated</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>ICWaS</span> <span class='word'>detection</span> <span class='word'>method</span> <span class='word'>returns</span> <span class='word'>the</span> <span class='word'>distance</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>bounding</span> <span class='word'>box</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>fingertip</span> <span class='word'>has</span> <span class='word'>had</span> <span class='word'>to</span> <span class='word'>move</span> <span class='word'>to</span> <span class='word'>align</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>previous</span> <span class='word'>frame</span> <span class='ignore'>(</span><span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ICWaS</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>OpenCV's</span> <span class='word'>alignment</span> <span class='word'>routine</span> <span class='word'>requires</span> <span class='word'>the</span> <span class='word'>images</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>well-aligned</span> <span class='word'>in</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>function</span> <span class='word'>properly</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>before</span> <span class='word'>attempting</span> <span class='word'>alignment</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>initially</span> <span class='word'>checks</span> <span class='word'>for</span> <span class='word'>large</span> <span class='word'>movements</span> <span class='word'>and</span> <span class='word'>does</span> <span class='word'>not</span> <span class='word'>perform</span> <span class='word'>the</span> <span class='word'>alignment</span> <span class='word'>if</span> <span class='word'>such</span> <span class='word'>movement</span> <span class='word'>is</span> <span class='word'>detected</span><span class='ignore'>,</span> <span class='word'>avoiding</span> <span class='word'>long</span> <span class='word'>iterations</span> <span class='word'>of</span> <span class='word'>OpenCV's</span> <span class='word'>routine</span> <span class='word'>which</span> <span class='word'>would</span> <span class='word'>ultimately</span> <span class='word'>result</span> <span class='word'>in</span> <span class='word'>an</span> <span class='word'>error</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>make</span> <span class='word'>this</span> <span class='word'>robust</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>routine</span> <span class='word'>also</span> <span class='word'>catches</span> <span class='word'>any</span> <span class='word'>error</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>alignment</span> <span class='word'>routine</span><span class='ignore'>.</span> <span class='word'>Both</span> <span class='word'>of</span> <span class='word'>these</span> <span class='word'>result</span> <span class='word'>in</span> <span class='word'>an</span> <span class='word'>negative</span> <span class='word'>value</span> <span class='word'>being</span> <span class='word'>returned</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[tbph]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>instantaniousShiftGrfx</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>rapid</span> <span class='oword'>and</span> <span class='oword'>smooth</span> <span class='oword'>dynamic</span> <span class='oword'>tracking</span> <span class='oword'>metrics</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>instantaniousshiftgrfx</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>In</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>set</span> <span class='word'>reasonable</span> <span class='word'>values</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>tolerances</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>version</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>was</span> <span class='word'>written</span> <span class='word'>which</span><span class='ignore'>,</span> <span class='word'>regardless</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>state</span><span class='ignore'>,</span> <span class='word'>performed</span> <span class='word'>both</span> <span class='word'>the</span> <span class='word'>rapid</span> <span class='word'>and</span> <span class='word'>smooth</span> <span class='word'>tracking</span> <span class='word'>routines</span><span class='ignore'>.</span> <span class='word'>Using</span> <span class='word'>timed</span> <span class='word'>intervals</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>was</span> <span class='word'>run</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>user</span> <span class='word'>performing</span> <span class='word'>motions</span> <span class='word'>which</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>classified</span> <span class='word'>as</span> <span class='word'>a</span> <span class='ignore'>'</span><span class='word'>rapid</span> <span class='word'>movement</span><span class='ignore'>,</span> <span class='ignore'>'</span><span class='word'>smooth</span> <span class='word'>movement</span><span class='ignore'>'</span> <span class='word'>and</span> <span class='ignore'>'</span><span class='word'>ICWaS</span> <span class='word'>movement</span><span class='ignore'>'</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>results</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>instantaniousshiftgrfx</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[tbph]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>smoothedShiftGrfx</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>rapid</span> <span class='oword'>and</span> <span class='oword'>smooth</span> <span class='oword'>dynamic</span> <span class='oword'>tracking</span> <span class='oword'>metrics</span> <span class='oword'>with</span> <span class='oword'>values</span> <span class='oword'>smoothed</span> <span class='oword'>by</span> <span class='oword'>averaging</span> <span class='oword'>with</span> <span class='oword'>previous</span> <span class='oword'>values</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>smoothedshiftgrfx</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>From</span> <span class='word'>this</span> <span class='word'>figure</span><span class='ignore'>,</span> <span class='word'>you</span> <span class='word'>can</span> <span class='word'>see</span> <span class='word'>the</span> <span class='word'>metrics</span> <span class='word'>are</span> <span class='word'>fairly</span> <span class='word'>noisy</span><span class='ignore'>;</span> <span class='word'>we</span> <span class='word'>want</span> <span class='word'>to</span> <span class='word'>avoid</span> <span class='word'>triggering</span> <span class='word'>a</span> <span class='word'>state</span> <span class='word'>transition</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>basis</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>single</span> <span class='word'>video</span> <span class='word'>frame</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>problem</span> <span class='word'>is</span> <span class='word'>effectively</span> <span class='word'>solved</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>simply</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>current</span> <span class='word'>metric</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>previous</span> <span class='word'>value</span><span class='ignore'>,</span> <span class='word'>thus</span> <span class='word'>smoothing</span> <span class='word'>out</span> <span class='word'>the</span> <span class='word'>noise</span> <span class='word'>and</span> <span class='word'>stabilizing</span> <span class='word'>the</span> <span class='word'>state</span> <span class='word'>transitions</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>illustrated</span> <span class='word'>by</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>smoothedshiftgrfx</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Putting</span> <span class='hword'>it</span> <span class='hword'>All</span> <span class='hword'>Together</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>PuttingItAllTogether</span><span class='ignore'>}</span><br>
<span class='word'>So</span> <span class='word'>far</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>said</span> <span class='word'>little</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>app</span> <span class='word'>itself</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>app</span> <span class='word'>associated</span> <span class='word'>with</span> <span class='word'>this</span> <span class='word'>project</span> <span class='word'>is</span> <span class='word'>designed</span> <span class='word'>to</span> <span class='word'>demonstrate</span> <span class='word'>how</span> <span class='word'>the</span> <span class='word'>fast</span> <span class='word'>color-space</span> <span class='word'>transform</span> <span class='word'>developed</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>conjunction</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>simple</span> <span class='word'>shape</span> <span class='word'>detection</span> <span class='word'>routines</span> <span class='word'>developed</span> <span class='word'>in</span> <span class='word'>this</span> <span class='word'>chapter</span> <span class='word'>to</span> <span class='word'>create</span> <span class='word'>a</span> <span class='word'>simple</span> <span class='word'>fingertip</span> <span class='word'>mechanical-stress</span> <span class='word'>detector</span> <span class='word'>using</span> <span class='word'>an</span> <span class='word'>iPhone</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Quite</span> <span class='word'>later</span> <span class='word'>on</span> <span class='word'>in</span> <span class='word'>development</span><span class='ignore'>,</span> <span class='word'>an</span> <span class='word'>iOS</span> <span class='word'>update</span> <span class='word'>was</span> <span class='word'>released</span> <span class='word'>which</span> <span class='word'>allows</span> <span class='word'>in-code</span> <span class='word'>control</span> <span class='word'>of</span> <span class='word'>camera</span> <span class='word'>properties</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>which</span> <span class='word'>optimises</span> <span class='word'>these</span> <span class='word'>settings</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>app</span> <span class='word'>is</span> <span class='word'>described</span> <span class='word'>in</span> <span class='word'>Appendix</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>iPhoneCameraSetup</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='word'>It</span> <span class='word'>is</span> <span class='word'>considered</span> <span class='word'>good</span> <span class='word'>practice</span> <span class='word'>when</span> <span class='word'>developing</span> <span class='word'>an</span> <span class='word'>iPhone</span> <span class='word'>app</span> <span class='word'>to</span> <span class='word'>split</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>into</span> <span class='word'>three</span> <span class='word'>parts</span><span class='ignore'>:</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>handles</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>computation</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>view</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>handles</span> <span class='word'>display</span> <span class='word'>and</span> <span class='word'>interprets</span> <span class='word'>user</span> <span class='word'>gestures</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>controller</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>intermediary</span><span class='ignore'>.</span> <span class='word'>Each</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>considered</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>running</span> <span class='word'>in</span> <span class='word'>its</span> <span class='word'>own</span> <span class='word'>thread</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>recommended</span> <span class='word'>division</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>control</span> <span class='word'>assigns</span> <span class='word'>each</span> <span class='word'>step</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>program</span> <span class='word'>as</span> <span class='word'>indicated</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressUI</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.97\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Fingerpress</span><span class='ignore'>_</span><span class='ignore'>UI.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Fingerpress</span> <span class='oword'>UI</span> <span class='oword'>flowchart</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressUI</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>chart</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressUI</span><span class='ignore'>}</span> <span class='word'>fails</span> <span class='word'>to</span> <span class='word'>address</span> <span class='word'>how</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>,</span> <span class='word'>controller</span> <span class='word'>and</span> <span class='word'>view</span> <span class='word'>are</span> <span class='word'>each</span> <span class='word'>running</span> <span class='word'>in</span> <span class='word'>their</span> <span class='word'>own</span> <span class='word'>threads</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>so</span> <span class='word'>control</span> <span class='word'>never</span> <span class='word'>actually</span> <span class='word'>passes</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>controller</span><span class='ignore'>,</span> <span class='word'>or</span> <span class='word'>vice</span> <span class='word'>versa</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>MVC</span> <span class='word'>structure</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>view</span> <span class='word'>may</span> <span class='word'>only</span> <span class='word'>message</span> <span class='word'>the</span> <span class='word'>controller</span> <span class='word'>to</span> <span class='word'>indicate</span> <span class='word'>that</span> <span class='word'>an</span> <span class='word'>event</span> <span class='word'>has</span> <span class='word'>happened</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>instance</span><span class='ignore'>,</span> <span class='word'>when</span> <span class='word'>processing</span> <span class='word'>a</span> <span class='word'>video</span> <span class='word'>stream</span><span class='ignore'>,</span> <span class='word'>if</span> <span class='word'>every</span> <span class='word'>time</span> <span class='word'>the</span> <span class='word'>dynamic</span> <span class='word'>tracking</span> <span class='word'>part</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>required</span> <span class='word'>a</span> <span class='word'>new</span> <span class='word'>image</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>request</span> <span class='word'>message</span> <span class='word'>must</span> <span class='word'>be</span> <span class='word'>sent</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>controller</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>it</span> <span class='word'>would</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>wait</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>controller</span> <span class='word'>to</span> <span class='word'>get</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>video</span> <span class='word'>stream</span> <span class='word'>and</span> <span class='word'>send</span> <span class='word'>it</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>,</span> <span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>would</span> <span class='word'>often</span> <span class='word'>be</span> <span class='word'>waiting</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>controller</span> <span class='word'>to</span> <span class='word'>respond</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>this</span> <span class='word'>reason</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>practice</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>uses</span> <span class='word'>OpenCV's</span> <span class='word'>video</span> <span class='word'>stream</span> <span class='word'>handling</span> <span class='word'>capabilities</span> <span class='word'>to</span> <span class='word'>get</span> <span class='word'>an</span> <span class='word'>image</span> <span class='word'>directly</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>video</span> <span class='word'>stream</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Fingerpress</span><span class='ignore'>_</span><span class='ignore'>Finger</span><span class='ignore'>_</span><span class='ignore'>Model.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Finger</span> <span class='oword'>model</span> <span class='oword'>flowchart</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressFingerModel</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.49\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Fingerpress</span><span class='ignore'>_</span><span class='ignore'>Std</span><span class='ignore'>_</span><span class='ignore'>Coordinates.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.49\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Fingerpress</span><span class='ignore'>_</span><span class='ignore'>Rapid</span><span class='ignore'>_</span><span class='ignore'>Movement.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Flowcharts</span> <span class='oword'>for</span> <span class='oword'>finding</span> <span class='oword'>image</span> <span class='oword'>points</span> <span class='oword'>in</span> <span class='oword'>standard</span> <span class='oword'>coordinates</span> <span class='ignore'>(</span><span class='oword'>left</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='oword'>and</span> <span class='oword'>rapid</span> <span class='oword'>motion</span> <span class='oword'>detection</span> <span class='ignore'>(</span><span class='oword'>right</span><span class='ignore'>)</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressStdCoordinates</span><span class='ignore'>&amp;</span><span class='ignore'>RapidMovement</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.90\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Fingerpress</span><span class='ignore'>_</span><span class='ignore'>Smooth</span><span class='ignore'>_</span><span class='ignore'>Movement.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Smooth</span> <span class='oword'>movement</span> <span class='oword'>flowchart</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressSmoothMovement</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Fingerpress</span><span class='ignore'>_</span><span class='ignore'>ICWaS.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>ICWaS</span> <span class='oword'>flowchart</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressICWaS</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>charts</span> <span class='word'>in</span> <span class='word'>Figures</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressFingerModel</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressStdCoordinates</span><span class='ignore'>&amp;</span><span class='ignore'>RapidMovement</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressSmoothMovement</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FingerpressICWaS</span><span class='ignore'>}</span> <span class='word'>more</span> <span class='word'>accurately</span> <span class='word'>depict</span> <span class='word'>the</span> <span class='word'>actual</span> <span class='word'>implementation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>by</span> <span class='word'>showing</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>flow</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>elements</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>accessible</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>controller</span><span class='ignore'>.</span> <br>
<span class='cmd'>\clearpage</span><br>
<br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Chapter4/chapter4.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 4677</li>
<li>Words in headers: 74</li>
<li>Words outside text (captions, etc.): 445</li>
<li>Number of headers: 20</li>
<li>Number of floats/tables/figures: 24</li>
<li>Number of math inlines: 30</li>
<li>Number of math displayed: 4</li>
<li>Subcounts:</li>
<span class='subcount'>
<li class='fielddesc'>&nbsp; text+headers+captions (#headers/#floats/#inlines/#displayed)</li>
  <li>4+4+0 (1/0/0/0) Chapter: Pattern Recognition and Implementation</li>
  <li>54+4+0 (1/0/0/0) Section: Implementing the Color Space}\label{sec:ImplementingTheColorSpace</li>
  <li>0+5+0 (1/0/0/0) Section: The Finger Shape Detection Algorithm}\label{sec:FingerShapeDetectionAlgorithm</li>
  <li>137+4+0 (1/0/0/0) Subsection: Finding the Frame Orientation}\label{sec:FindingTheFrameOrientation</li>
  <li>125+7+7 (1/1/0/0) Subsection: Finding the End of the Finger Shape}\label{sec:FindingTheEndOfTheFingerShape</li>
  <li>75+4+0 (1/0/0/0) Subsection: Filament Fill the Finger}\label{sec:FilamentFillTheFinger</li>
  <li>181+7+21 (1/1/1/0) Subsection: Exclude Secondary Frame Edge and Fingertip Points }\label{sec:ExcludeSecondaryFrameEdgePointsAndFingertipPoints</li>
  <li>310+5+0 (1/0/0/0) Subsection: Kink Fit to the Finger}\label{sec:KinkFitToTheFinger</li>
  <li>224+3+21 (1/1/3/0) Subsection: Parallel Lines Fit}\label{sec:ParallelLinesFit</li>
  <li>171+4+10 (1/1/10/1) Subsection: Set the Scale Space}\label{sec:SetTheScaleSpace</li>
  <li>306+3+28 (1/3/9/0) Subsection: Modelling the Fingertip}\label{sec:ModellingTheFingertip</li>
  <li>471+2+0 (1/0/0/0) Section: Dynamic Tracking}\label{sec:DynamicTracking</li>
  <li>95+3+0 (1/0/0/0) Subsection: Rapid Motion Tracking}\label{sec:RapidMotionTracking</li>
  <li>744+3+37 (1/2/7/0) Subsection: Smooth Motion Tracking}\label{sec:SmoothMotionTracking</li>
  <li>999+9+270 (4/7/0/3) Subsection: ICWaS Method}\label{sec:ICWaS</li>
  <li>457+3+26 (1/3/0/0) Subsection: Dynamic State Transitions}\label{sec:DynamicStateTransitions</li>
  <li>324+4+25 (1/5/0/0) Section: Putting it All Together}\label{sec:PuttingItAllTogether</li>
</span>
</ul>
</div>
<h2>File: ./Chapter5/chapter5.tex</h2>
<div class='parse'><p>
<span class='comment'>%*****************************************************************************************</span><br>
<span class='comment'>%*********************************** Fourth Chapter **************************************</span><br>
<span class='comment'>%*****************************************************************************************</span><br>
<br>
<span class='cmd'>\chapter</span><span class='ignore'>{</span><span class='hword'>Future</span> <span class='hword'>Work</span> <span class='hword'>and</span> <span class='hword'>Discussion</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\ifpdf</span><br>
&nbsp;&nbsp;<span class='cmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Raster</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>PDF</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\else</span><br>
&nbsp;&nbsp;<span class='cmd'>\graphicspath</span><span class='ignore'>{</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Vector</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\fi</span><br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Results</span> <span class='hword'>and</span> <span class='hword'>Evaluation</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ResultsAndEvaluation</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>primary</span> <span class='word'>focus</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>project</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>develop</span> <span class='word'>and</span> <span class='word'>implement</span> <span class='word'>a</span> <span class='word'>color-space</span> <span class='word'>algorithm</span> <span class='word'>that</span> <span class='word'>is</span> <span class='word'>efficient</span> <span class='word'>enough</span> <span class='word'>to</span> <span class='word'>run</span> <span class='word'>on</span> <span class='word'>mobile</span> <span class='word'>devices</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>also</span> <span class='word'>accurate</span> <span class='word'>enough</span> <span class='word'>for</span> <span class='word'>broad</span> <span class='word'>applications</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>Chapter</span> <span class='word'>2</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>color-space</span> <span class='word'>conversion</span> <span class='word'>method</span> <span class='word'>was</span> <span class='word'>developed</span> <span class='word'>which</span> <span class='word'>simultaneously</span> <span class='word'>avoided</span> <span class='word'>using</span> <span class='word'>floating-point</span> <span class='word'>operations</span> <span class='word'>and</span> <span class='word'>preserved</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>color-space</span><span class='ignore'>.</span> <span class='word'>Preserving</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>color-space</span> <span class='word'>is</span> <span class='word'>something</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>even</span> <span class='word'>achieved</span> <span class='word'>by</span> <span class='word'>floating-point</span> <span class='word'>methods</span> <span class='word'>because</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>even</span> <span class='word'>if</span> <span class='word'>we</span> <span class='word'>assume</span> <span class='word'>floating</span> <span class='word'>point</span> <span class='word'>numbers</span> <span class='word'>are</span> <span class='word'>represented</span> <span class='word'>with</span> <span class='word'>infinite</span> <span class='word'>precision</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>these</span> <span class='word'>methods</span> <span class='word'>only</span> <span class='word'>use</span> <span class='word'>the</span> <span class='word'>floating</span> <span class='word'>point</span> <span class='word'>representation</span> <span class='word'>internally</span> <span class='word'>and</span> <span class='word'>lose</span> <span class='word'>information</span> <span class='word'>when</span> <span class='word'>converting</span> <span class='word'>back</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>integer</span> <span class='word'>data</span> <span class='word'>types</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>chromatic</span> <span class='word'>channels</span> <span class='ignore'>(</span><span class='word'>see</span> <span class='word'>Appendix</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>app</span><span class='ignore'>:</span><span class='ignore'>PreservationOfColorInformation</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <br>
<br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Timing</span> <span class='hword'>the</span> <span class='hword'>Methods</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>TimingTheMethods</span><span class='ignore'>}</span><br>
<br>
<span class='word'>To</span> <span class='word'>evaluate</span> <span class='word'>the</span> <span class='word'>integer-based</span> <span class='word'>color-space</span> <span class='word'>conversion</span> <span class='word'>method</span> <span class='word'>in</span> <span class='word'>comparison</span> <span class='word'>with</span> <span class='word'>an</span> <span class='word'>equivalent</span> <span class='word'>floating</span> <span class='word'>point</span> <span class='word'>method</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>floating</span> <span class='word'>point</span> <span class='word'>color-space</span> <span class='word'>conversion</span> <span class='word'>was</span> <span class='word'>implemented</span> <span class='word'>which</span> <span class='word'>first</span> <span class='word'>converted</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>into</span> <span class='word'>a</span> <span class='word'>double</span> <span class='word'>precision</span> <span class='word'>unit</span> <span class='word'>range</span><span class='ignore'>,</span> <span class='word'>performed</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>double</span> <span class='word'>precision</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>redistributed</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>redistribution</span> <span class='word'>function</span> <span class='word'>described</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>integer</span> <span class='word'>range</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>compared</span> <span class='word'>below</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>optimized</span> <span class='word'>integer</span> <span class='word'>method</span> <span class='word'>presented</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Obtaining</span> <span class='word'>clean</span> <span class='word'>running</span> <span class='word'>times</span> <span class='word'>for</span> <span class='word'>multi-core</span> <span class='word'>CPUs</span> <span class='word'>running</span> <span class='word'>multiple</span> <span class='word'>threads</span> <span class='word'>is</span> <span class='word'>problematic</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>account</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>variability</span> <span class='word'>in</span> <span class='word'>performance</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>algorithms</span> <span class='word'>were</span> <span class='word'>run</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>input</span> <span class='word'>1</span><span class='ignore'>,</span><span class='word'>000</span> <span class='word'>times</span><span class='ignore'>.</span> <span class='word'>Theoretically</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>time</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>for</span> <span class='word'>every</span> <span class='word'>run</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>input</span><span class='ignore'>,</span> <span class='word'>however</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>TimingVariationPlot</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>timings</span> <span class='word'>vary</span> <span class='word'>away</span> <span class='word'>from</span> <span class='word'>a</span> <span class='word'>baseline</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>statistical</span> <span class='word'>positive</span> <span class='word'>error</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>is</span> <span class='word'>reasonable</span> <span class='word'>to</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>this</span> <span class='word'>variation</span> <span class='word'>is</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>interrupts</span> <span class='word'>from</span> <span class='word'>system</span> <span class='word'>processes</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>so</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>performance</span> <span class='word'>is</span> <span class='word'>best</span> <span class='word'>measured</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>minimum</span> <span class='word'>runtime</span> <span class='word'>from</span> <span class='word'>this</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>1</span><span class='ignore'>,</span><span class='word'>000</span> <span class='word'>runs</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>For</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>this</span> <span class='word'>test</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>integer</span> <span class='word'>method</span> <span class='word'>is</span> <span class='word'>about</span> <span class='word'>4.9</span> <span class='word'>times</span> <span class='word'>faster</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>floating</span> <span class='word'>point</span> <span class='word'>method</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>significant</span> <span class='word'>gain</span> <span class='word'>given</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>transform</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>most</span> <span class='word'>computationally-intensive</span> <span class='word'>operation</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>entire</span> <span class='word'>algorithm</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Timing</span><span class='ignore'>_</span><span class='ignore'>Variation</span><span class='ignore'>_</span><span class='ignore'>Plot.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Timing</span> <span class='oword'>variation</span> <span class='oword'>plot</span><span class='ignore'>.</span> <span class='oword'>Comparison</span> <span class='oword'>of</span> <span class='oword'>process</span> <span class='oword'>run</span> <span class='oword'>times</span> <span class='oword'>using</span> <span class='oword'>the</span> <span class='oword'>floating</span> <span class='oword'>point</span> <span class='oword'>method</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>integer</span> <span class='oword'>optimized</span> <span class='oword'>method</span> <span class='oword'>with</span> <span class='oword'>the</span> <span class='oword'>same</span> <span class='oword'>image</span> <span class='oword'>input</span> <span class='oword'>data</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>TimingVariationPlot</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Optimization</span> <span class='hword'>Variation</span> <span class='hword'>with</span> <span class='hword'>Input</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>OptimizationVariationWithInput</span><span class='ignore'>}</span><br>
<br>
<span class='word'>Now</span> <span class='word'>we</span> <span class='word'>evaluate</span> <span class='word'>the</span> <span class='word'>performance</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>with</span> <span class='word'>differing</span> <span class='word'>input</span> <span class='word'>images</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>the</span> <span class='word'>purpose</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>test</span><span class='ignore'>,</span> <span class='word'>images</span> <span class='word'>generated</span> <span class='word'>with</span> <span class='word'>varying</span> <span class='word'>tonal</span> <span class='word'>characteristics</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>by</span> <span class='word'>generating</span> <span class='word'>images</span> <span class='word'>with</span> <span class='word'>random</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>within</span> <span class='word'>random</span> <span class='word'>ranges</span><span class='ignore'>.</span> <span class='word'>Each</span> <span class='word'>image</span> <span class='word'>was</span> <span class='word'>processed</span> <span class='word'>1</span><span class='ignore'>,</span><span class='word'>000</span> <span class='word'>times</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>minimum</span> <span class='word'>runtime</span> <span class='word'>from</span> <span class='word'>those</span> <span class='word'>1</span><span class='ignore'>,</span><span class='word'>000</span> <span class='word'>runs</span> <span class='word'>was</span> <span class='word'>taken</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>an</span> <span class='word'>indication</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>difficulty</span> <span class='word'>of</span> <span class='word'>that</span> <span class='word'>image</span> <span class='word'>when</span> <span class='word'>presented</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>algorithms</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithms</span> <span class='word'>were</span> <span class='word'>run</span> <span class='word'>over</span> <span class='word'>100</span> <span class='word'>different</span> <span class='word'>images</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>standard</span> <span class='word'>deviation</span> <span class='word'>from</span> <span class='word'>that</span> <span class='word'>mean</span> <span class='word'>were</span> <span class='word'>found</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>methods</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>performance</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithms</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ToneVariationPlot</span><span class='ignore'>}</span> <span class='word'>below</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Tone</span><span class='ignore'>_</span><span class='ignore'>Variation</span><span class='ignore'>_</span><span class='ignore'>Plot.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Tone</span> <span class='oword'>variation</span> <span class='oword'>plot</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ToneVariationPlot</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>Here</span> <span class='word'>the</span> <span class='word'>performance</span> <span class='word'>gain</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>slightly</span> <span class='word'>lower</span> <span class='word'>than</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>test</span> <span class='word'>image</span> <span class='word'>used</span> <span class='word'>above</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>confidently</span> <span class='word'>said</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>method</span> <span class='word'>presented</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span> <span class='word'>is</span> <span class='word'>4-to-5</span> <span class='word'>times</span> <span class='word'>faster</span> <span class='word'>than</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>usual</span> <span class='word'>floating</span> <span class='word'>point</span> <span class='word'>methods</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Future</span> <span class='hword'>Applications</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FutureApplications</span><span class='ignore'>}</span><br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Medical</span> <span class='hword'>Applications</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>MedicalApplications</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>benefit</span> <span class='word'>of</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>conversion</span> <span class='word'>algorithm</span> <span class='word'>in</span> <span class='word'>medical</span> <span class='word'>applications</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>it's</span> <span class='word'>lossless</span> <span class='word'>without</span> <span class='word'>negatively</span> <span class='word'>affecting</span> <span class='word'>performance</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>especially</span> <span class='word'>beneficial</span> <span class='word'>when</span> <span class='word'>performing</span> <span class='word'>comparisons</span> <span class='word'>between</span> <span class='word'>chromophores</span> <span class='word'>with</span> <span class='word'>very</span> <span class='word'>subtle</span> <span class='word'>differences</span> <span class='word'>such</span> <span class='word'>as</span> <span class='word'>oxyhemoglobin</span> <span class='word'>and</span> <span class='word'>deoxyhemoglobin</span> <span class='word'>or</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>types</span> <span class='word'>of</span> <span class='word'>eumelanin</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>losing</span> <span class='word'>information</span> <span class='word'>makes</span> <span class='word'>telling</span> <span class='word'>them</span> <span class='word'>apart</span> <span class='word'>that</span> <span class='word'>much</span> <span class='word'>harder</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>two</span> <span class='word'>benefits</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>immediately</span> <span class='word'>suggest</span> <span class='word'>a</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>possible</span> <span class='word'>future</span> <span class='word'>applications</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Possible</span> <span class='word'>applications</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>are</span><span class='ignore'>:</span> <span class='word'>monitoring</span> <span class='word'>inflammation</span><span class='ignore'>,</span> <span class='word'>mole</span> <span class='word'>mapping</span> <span class='word'>and</span> <span class='word'>monitoring</span> <span class='ignore'>(</span><span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>MelanomaImages</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>checking</span> <span class='word'>eye</span> <span class='word'>health</span> <span class='word'>and</span> <span class='word'>detecting</span> <span class='word'>for</span> <span class='word'>anaemia</span><span class='ignore'>.</span><br>
<br>
<span class='word'>As</span> <span class='word'>for</span> <span class='word'>applications</span> <span class='word'>beyond</span> <span class='word'>phone</span> <span class='word'>cameras</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>different</span> <span class='word'>medical</span> <span class='word'>cameras</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>designed</span> <span class='word'>for</span> <span class='word'>medical</span> <span class='word'>diagnostics</span> <span class='word'>and</span> <span class='word'>telemedicine</span> <span class='ignore'>(</span><span class='word'>see</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>MedicalExaminationCameras</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>these</span> <span class='word'>cameras</span> <span class='word'>also</span> <span class='word'>tend</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>color-space</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>again</span> <span class='word'>has</span> <span class='word'>the</span> <span class='word'>disadvantage</span> <span class='word'>of</span> <span class='word'>requiring</span> <span class='word'>the</span> <span class='word'>examiner</span> <span class='word'>to</span> <span class='word'>perform</span> <span class='word'>a</span> <span class='word'>naked-eye</span> <span class='word'>comparison</span><span class='ignore'>,</span> <span class='word'>relying</span> <span class='word'>on</span> <span class='word'>their</span> <span class='word'>knowledge</span> <span class='word'>and</span> <span class='word'>experience</span> <span class='word'>to</span> <span class='word'>make</span> <span class='word'>a</span> <span class='word'>diagnosis</span><span class='ignore'>.</span> <span class='word'>By</span> <span class='word'>adapting</span> <span class='word'>our</span> <span class='word'>color-space</span> <span class='word'>to</span> <span class='word'>target</span> <span class='word'>specific</span> <span class='word'>chromophores</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>possible</span> <span class='word'>to</span> <span class='word'>accurately</span> <span class='word'>diagnose</span> <span class='word'>any</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>conditions</span> <span class='word'>without</span> <span class='word'>relying</span> <span class='word'>as</span> <span class='word'>much</span> <span class='word'>on</span> <span class='word'>expertise</span><span class='ignore'>.</span> <br>
<br>
<br>
<span class='comment'>%One possible application of the algorithm is monitoring inflammation. By adapting the color-space to distinguish between healthy and inflamed tissue, one might be able measure the degree of inflammation over a period of time by, for the sake of example, photographing parts of the user's body prone to inflammation throughout the day and using the algorithm to perform the comparison. This has the benefit of measuring the degree of inflammation without having to rely on subjective reporting, and could allow individuals to discover triggers for conditions like eczema, arthritis and other such inflammatory diseases. Combining this approach with diet and lifestyle monitoring functions --- other factors which may contribute to inflammation --- could serve as a simple and empowering means of increasing users' quality of life.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%In mole mapping, a series of photographs of moles are taken over a period of time to track changes in size, color or shape in order to detect conditions such as malignant melanoma. However, identifying changes in such skin lesions is often limited to the doctor performing naked-eye comparisons between RGB photos of the areas of concern (Figure \ref{fig:MelanomaImages}). This poses a problem when checking for changes in color, in part due to the RGB color-space not separating the luminosity from the chromatic information and differences in lighting conditions. Using our color-space, it is possible to highlight such changes more clearly; the color-space can be adapted to detect changes in coloration between successive skin lesion images, thereby eliminating the need for guesswork. Additionally, by floating the mean the algorithm can account for variable lighting conditions.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%Blood flow patterns in the retina are a good indication of eye health. As such, a retina imaging app for monitoring these blood flow patterns is another potential application of the algorithm. It is possible to adapt the color-space to discriminate between oxygenated and de-oxygenated blood flow and use the image alignment such that, with a simple lens manipulator which fits over the phone's camera, one could photograph their own retina daily and measure the difference overtime. The alignment algorithms could be used to monitor any burst blood vessels, even within the eyeball itself. Another, similar application would involve detecting for anaemia; the skin under the eyelids lacks pigmentation, appearing pale if there is little blood. One might be able to take a photo of the skin under the eyelids with their phone camera and use the algorithm to check for a lack of blood flow.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%As for applications beyond phone cameras, a number of different medical cameras have been designed for medical diagnostics (see Figure \ref{fig:MedicalExaminationCameras}), especially for use in telemedicine and thermal imaging, many of which are commercially available. These cameras are typically HD video cameras, some of which support a variety of attachments for different types of examinations such as tongue depressors for laryngoscopy. However, these cameras also tend to use the RGB color-space, which again has the disadvantage of requiring the examiner to perform a naked-eye comparison, relying on their knowledge and experience to make a diagnosis. By adapting our color-space to target specific chromophores, it may be possible to accurately diagnose any number of conditions without relying as much on expertise. </span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.45\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>DermLite-DL1.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>DermLite</span> <span class='oword'>DL1</span><span class='ignore'>;</span> <span class='oword'>A</span> <span class='oword'>dermatoscope</span> <span class='oword'>attachment</span> <span class='oword'>available</span> <span class='oword'>for</span> <span class='oword'>several</span> <span class='oword'>smart</span> <span class='oword'>devices</span><span class='ignore'>,</span> <span class='oword'>used</span> <span class='oword'>in</span> <span class='oword'>diagnosing</span> <span class='oword'>skin</span> <span class='oword'>disorders</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>DermatoscopePhone</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.45\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>melanoma-images.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>A</span> <span class='oword'>skin</span> <span class='oword'>lesion</span> <span class='oword'>photographed</span> <span class='oword'>under</span> <span class='oword'>different</span> <span class='oword'>lighting</span> <span class='oword'>conditions</span><span class='ignore'>.</span> <span class='ignore'>(</span><span class='oword'>Photos</span> <span class='oword'>by</span> <span class='oword'>Kevin</span> <span class='oword'>Jakob</span><span class='ignore'>,</span> <span class='oword'>Illingworth</span> <span class='oword'>Research</span><span class='ignore'>.</span><span class='ignore'>)</span><br>
&nbsp; &nbsp; <span class='oword'>Identifying</span> <span class='oword'>changes</span> <span class='oword'>in</span> <span class='oword'>such</span> <span class='oword'>skin</span> <span class='oword'>lesions</span> <span class='oword'>is</span> <span class='oword'>often</span> <span class='oword'>limited</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>doctor</span> <span class='oword'>performing</span> <span class='oword'>naked-eye</span> <span class='oword'>comparisons</span> <span class='oword'>between</span> <span class='oword'>RGB</span> <span class='oword'>photos</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>areas</span> <span class='oword'>of</span> <span class='oword'>concern</span> <span class='ignore'>.</span> <span class='oword'>This</span> <span class='oword'>poses</span> <span class='oword'>a</span> <span class='oword'>problem</span> <span class='oword'>when</span> <span class='oword'>checking</span> <span class='oword'>for</span> <span class='oword'>changes</span> <span class='oword'>in</span> <span class='oword'>color</span><span class='ignore'>,</span> <span class='oword'>in</span> <span class='oword'>part</span> <span class='oword'>due</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>RGB</span> <span class='oword'>color-space</span> <span class='oword'>not</span> <span class='oword'>separating</span> <span class='oword'>the</span> <span class='oword'>luminosity</span> <span class='oword'>from</span> <span class='oword'>the</span> <span class='oword'>chromatic</span> <span class='oword'>information</span> <span class='oword'>and</span> <span class='oword'>differences</span> <span class='oword'>in</span> <span class='oword'>lighting</span> <span class='oword'>conditions</span><span class='ignore'>.</span> <span class='oword'>Using</span> <span class='oword'>our</span> <span class='oword'>color-space</span><span class='ignore'>,</span> <span class='oword'>it</span> <span class='oword'>is</span> <span class='oword'>possible</span> <span class='oword'>to</span> <span class='oword'>highlight</span> <span class='oword'>such</span> <span class='oword'>changes</span> <span class='oword'>more</span> <span class='oword'>clearly</span><span class='ignore'>;</span> <span class='oword'>the</span> <span class='oword'>color-space</span> <span class='oword'>can</span> <span class='oword'>be</span> <span class='oword'>adapted</span> <span class='oword'>to</span> <span class='oword'>detect</span> <span class='oword'>changes</span> <span class='oword'>in</span> <span class='oword'>coloration</span> <span class='oword'>between</span> <span class='oword'>successive</span> <span class='oword'>skin</span> <span class='oword'>lesion</span> <span class='oword'>images</span><span class='ignore'>,</span> <span class='oword'>thereby</span> <span class='oword'>eliminating</span> <span class='oword'>the</span> <span class='oword'>need</span> <span class='oword'>for</span> <span class='oword'>guesswork</span><span class='ignore'>.</span> <span class='oword'>Additionally</span><span class='ignore'>,</span> <span class='oword'>by</span> <span class='ignore'>'</span><span class='oword'>floating</span> <span class='oword'>the</span> <span class='oword'>mean</span><span class='ignore'>'</span> <span class='oword'>the</span> <span class='oword'>algorithm</span> <span class='oword'>can</span> <span class='oword'>account</span> <span class='oword'>for</span> <span class='oword'>variable</span> <span class='oword'>lighting</span> <span class='oword'>conditions</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>MelanomaImages</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.45\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>TEHD</span><span class='ignore'>_</span><span class='ignore'>1.png</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.45\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter5</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>examination-clinical-dermoscan-x2.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>A</span> <span class='oword'>few</span> <span class='oword'>different</span> <span class='oword'>medical</span> <span class='oword'>examination</span> <span class='oword'>cameras</span><span class='ignore'>.</span> <span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>MedicalExaminationCameras</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\subsection{Scientific Applications}\label{sec:ScientificApplications}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\subsubsection{A Study of Human Chromatic Diversity}\label{sec:AStudyOfHumanChromaticDiversity}</span><br>
<span class='comment'>%In Chapter 3, we used a sample set of skin images from three individuals; it was interesting to see, in the lumiochromatic color-space LCaCb, how close these skin statistics were to each other in the chromatic plane. It would also be interesting to perform the work of Chapter 3 for a large and chromatically diverse group of people. An attempt was made to look at a diverse sample of individuals using images collected in the Humanae project (\cite{Dass2012}). This failed, however, as we had no control over the camera or the image compression performed before making them available on the Internet. Ultimately, it would be interesting to see if it were possible to estimate the levels of the skin chromophores identified in Chapter 1 using the skin statistics of the individual.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\subsubsection{Chromatic Statistics for Injuries and Defects}\label{sec:ChromaticStatisticsForInjuriesAndDefects}</span><br>
<span class='comment'>%If we have the normal skin statistics for an individual, we could take images of a site of injury and build the chromatic histogram (Figure \ref{fig:Fill_the_Bins}). We could find the difference between the sets and create a profile for the injury or defect. In order to do this, it would be useful to have built the statistics for the injury site prior to injury; this is an issue if this is to be done in-lab as it would necessitate causing the injury or defect in order to study the effect. This could be overcome using crowdsourcing. For instance, one might go skydiving as a hobby and so would often bruise their legs, so we could build the skin statistics for their uninjured skin and simply wait for a bruise to appear. </span><br>
<span class='comment'>%</span><br>
<span class='comment'>%An issue of this approach would be the consistency of lighting conditions; this could be overcome if we have adapted the method to allow us to set a new white point as outlined in Section \ref{sec:GeneralizingTheRotation}. We could take an uninjured skin patch for which we already have a previous image from which we build the skin statistics, and comparing the two would allow us to find a white point which accounts for the ambient lighting conditions. Our generalized transform could then compensate for the changing lighting conditions. Any difference in the statistics now is due to the injury, and our theoretical model built in Chapter 1 should allow us to interpret this in terms of the chromophores, the key one being the bilirubin, which is a chromophore which causes the yellow-and-green coloration in bruises.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\subsubsection{Repetitive Strain Study}\label{sec:RepetitiveStrainStudy}</span><br>
<span class='comment'>%The algorithm we developed in Chapter 4 focuses on the mechanical stress to the fingertip when pressing on a surface; in the Figures \ref{fig:ICWaSResultJSkin}, \ref{fig:ICWaSResultFSkin} and \ref{fig:ICWaSResultNSkin}, it can be seen that the stress also shows in the knuckle. In fact, the mechanical strain can be seen in all the joints of the hand. This suggests that we could build an algorithm which monitors the stress in the joints of the hand by observing the blood flow using the routines developed above. By monitoring the strain put on the joints of an individual's hands while they perform a task, we could measure the overall strain that they have placed on their finger joints. If we combine this with the techniques to measure inflammation presented in Section \ref{sec:MedicalApplications}, we could get a measure of the damage suffered by the individual. </span><br>
<span class='comment'>%</span><br>
<span class='comment'>%Once developed, such a monitoring system could be used in studies which assess different ergonomic designs and workplace practices. </span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\subsection{Computer Vision Applications}\label{sec:ComputerVisionApplications}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\subsubsection{A Novel Canny Edge Detection Algorithm}\label{sec:ANovelCannyEdgeDetectionAlgorithm}</span><br>
<span class='comment'>%The trinary classification developed in Chapter 4 can also be used for an edge detection routine which operates similarly to the Canny edge detection. The Canny edge detection operates by finding edges using a high threshold which is then lowered as the routine traces along the edge, allowing the edge to be extended from a strong edge into a weak edge. This also allows Canny edge detection to "hurdle" over minor defects in the image of the edge. The trinary classified image can be binarized and presented to standard edge detection techniques, thus we can find all of the strong edges. </span><br>
<span class='comment'>%</span><br>
<span class='comment'>%The edges which end surrounded by possible "probably not skin" values can easily be found and marked. Other marked ends which lie close to each other are joined if the pixel values on the path between them are all "probably not skin" (i.e. "1") or higher. This is similar to the Canny edge detection in that it allows us to join edges by using a lower threshold across the joint. It differs from Canny, however, in that it does not allow the edge to extend into a lower threshold edge. This would be undesirable using the trinary classification because the low threshold "probably not skin" classification often appears in patches which extend across the true edge often resulting from shadow or reflection. This method could be refined by taking into account the orientation of the edges at their end points, which could be used to determine how edges should actually be connected. This is similar to the "hurdle" method presented in Section \ref{sec:HurdleMethod}, but applied to edges.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\subsubsection{Finger Feature Detection}\label{sec:FingerFeatureDetection}</span><br>
<span class='comment'>%The modeling techniques developed in Chapter 4 can be relatively straightforwardly extended to model the entire digit, or even the whole hand. In Chapter 4, we found that the distal width could be used to find a good estimate for the position of the knuckle using the distal, middle and proximal ratios. With this initial model, the next question is what features can we expect to find at these positions in the image? The luminosity axis shows a striking feature at the knuckle position: the knuckle wrinkles. These wrinkles are consistent to each knuckle (i.e. when flexed, they present in the same way), and they're easily identified by orientation, running across the digit as opposed to along it. Additionally, the knuckle wrinkles curve around the center of the knuckle. This could be used to refine the model and track the knuckles. In the chromatic channels, they also display blood flow when flexed.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Color</span> <span class='hword'>Space</span> <span class='hword'>Algorithm</span> <span class='hword'>Improvements</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ColorSpaceAlgorithmImprovements</span><span class='ignore'>}</span><br>
<span class='word'>Here</span> <span class='word'>we</span> <span class='word'>suggest</span> <span class='word'>several</span> <span class='word'>improvements</span> <span class='word'>which</span> <span class='word'>could</span> <span class='word'>be</span> <span class='word'>made</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>algorithm</span> <span class='word'>developed</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>improvements</span> <span class='word'>presented</span> <span class='word'>herein</span> <span class='word'>address</span> <span class='word'>generalizing</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>to</span> <span class='word'>accommodate</span> <span class='word'>the</span> <span class='word'>characteristics</span> <span class='word'>of</span> <span class='word'>cameras</span> <span class='word'>other</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>iPhone's</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>consider</span> <span class='word'>three</span> <span class='word'>adaptations</span><span class='ignore'>;</span> <span class='word'>one</span> <span class='word'>to</span> <span class='word'>allow</span> <span class='word'>for</span> <span class='word'>multi-spectral</span> <span class='word'>cameras</span><span class='ignore'>,</span> <span class='word'>another</span> <span class='word'>to</span> <span class='word'>allow</span> <span class='word'>for</span> <span class='word'>cameras</span> <span class='word'>which</span> <span class='word'>do</span> <span class='word'>not</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>fixed</span> <span class='word'>white</span> <span class='word'>point</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>third</span> <span class='word'>to</span> <span class='word'>handle</span> <span class='word'>RAW</span> <span class='word'>images</span> <span class='word'>captured</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>CCD</span> <span class='word'>without</span> <span class='word'>the</span> <span class='word'>iPhone's</span> <span class='word'>pre-processing</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>practice</span><span class='ignore'>,</span> <span class='word'>these</span> <span class='word'>three</span> <span class='word'>adaptations</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>combined</span><span class='ignore'>.</span> <span class='word'>Hopefully</span> <span class='word'>it</span> <span class='word'>shouldn't</span> <span class='word'>be</span> <span class='word'>too</span> <span class='word'>difficult</span> <span class='word'>to</span> <span class='word'>imagine</span> <span class='word'>how</span> <span class='word'>this</span> <span class='word'>could</span> <span class='word'>be</span> <span class='word'>done</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>in</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>practically</span> <span class='word'>proceeding</span><span class='ignore'>,</span> <span class='word'>each</span> <span class='word'>one</span> <span class='word'>would</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>tackled</span> <span class='word'>individually</span> <span class='word'>first</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Generalizing</span> <span class='hword'>the</span> <span class='hword'>Rotation</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>GeneralizingTheRotation</span><span class='ignore'>}</span><br>
<span class='word'>In</span> <span class='word'>Chapter</span> <span class='word'>2</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>derived</span> <span class='word'>an</span> <span class='word'>expression</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>consisting</span> <span class='word'>entirely</span> <span class='word'>of</span> <span class='word'>integers</span> <span class='word'>which</span> <span class='word'>rotates</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>into</span> <span class='word'>a</span> <span class='word'>custom</span> <span class='word'>color-space</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>luminosity</span> <span class='word'>axis</span> <span class='word'>and</span> <span class='word'>two</span> <span class='word'>chromatic</span> <span class='word'>axes</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>orientation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>axes</span> <span class='word'>is</span> <span class='word'>specified</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>free</span> <span class='word'>rotation</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>axis</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>only</span> <span class='word'>restriction</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>free</span> <span class='word'>parameter</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>which</span> <span class='word'>results</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>requirement</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>matrix</span> <span class='word'>to</span> <span class='word'>consist</span> <span class='word'>entirely</span> <span class='word'>of</span> <span class='word'>integer</span> <span class='word'>values</span> <span class='word'>within</span> <span class='word'>a</span> <span class='word'>specific</span> <span class='word'>range</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>question</span> <span class='word'>remains</span><span class='ignore'>:</span> <span class='word'>is</span> <span class='word'>it</span> <span class='word'>possible</span> <span class='word'>to</span> <span class='word'>achieve</span> <span class='word'>a</span> <span class='word'>similar</span> <span class='word'>result</span> <span class='word'>without</span> <span class='word'>restricting</span> <span class='word'>one</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axes</span><span class='ignore'>?</span><br>
<br>
<span class='word'>In</span> <span class='word'>this</span> <span class='word'>work</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>assumed</span> <span class='word'>that</span> <span class='word'>an</span> <span class='word'>8-bit</span> <span class='word'>per-channel</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>(</span><span class='math'>255</span><span class='math'>,</span> <span class='math'>255</span><span class='math'>,</span> <span class='math'>255</span><span class='math'>)</span><span class='mathgroup'>$</span> <span class='word'>corresponds</span> <span class='word'>with</span> <span class='word'>white</span><span class='ignore'>.</span> <span class='word'>This</span><span class='ignore'>,</span> <span class='word'>however</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>result</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>pre-processing</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>iPhone</span><span class='ignore'>.</span> <span class='word'>Extending</span> <span class='word'>this</span> <span class='word'>work</span> <span class='word'>to</span> <span class='word'>other</span> <span class='word'>devices</span> <span class='word'>or</span> <span class='word'>accessing</span> <span class='word'>the</span> <span class='word'>iPhone's</span> <span class='word'>RAW</span> <span class='word'>camera</span> <span class='word'>feed</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>desirable</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>different</span> <span class='word'>point</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>camera's</span> <span class='word'>white</span> <span class='word'>point</span><span class='ignore'>.</span> <span class='word'>Another</span> <span class='word'>reason</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>adjust</span> <span class='word'>for</span> <span class='word'>local</span> <span class='word'>ambient</span> <span class='word'>light</span> <span class='word'>conditions</span><span class='ignore'>;</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>common</span> <span class='word'>in</span> <span class='word'>digital</span> <span class='word'>photography</span> <span class='word'>to</span> <span class='word'>choose</span> <span class='word'>a</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>from</span> <span class='word'>a</span> <span class='word'>reference</span> <span class='word'>white</span> <span class='word'>object</span> <span class='word'>to</span> <span class='word'>set</span> <span class='word'>a</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>image</span><span class='ignore'>,</span> <span class='word'>allowing</span> <span class='word'>a</span> <span class='word'>color</span> <span class='word'>correction</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>performed</span><span class='ignore'>.</span><br>
<br>
<span class='word'>An</span> <span class='word'>arbitrary</span> <span class='word'>rotation</span> <span class='word'>is</span> <span class='word'>determined</span> <span class='word'>by</span> <span class='word'>three</span> <span class='word'>angles</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>so</span> <span class='word'>it's</span> <span class='word'>conceivable</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>work</span> <span class='word'>of</span> <span class='word'>Chapter</span> <span class='word'>2</span> <span class='ignore'>(</span><span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ConstructingANewColorSpace</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>could</span> <span class='word'>be</span> <span class='word'>repeated</span> <span class='word'>for</span> <span class='word'>this</span> <span class='word'>arbitrary</span> <span class='word'>rotation</span><span class='ignore'>.</span> <span class='word'>Whilst</span> <span class='word'>it</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>possible</span><span class='ignore'>,</span> <span class='word'>an</span> <span class='word'>alternative</span> <span class='word'>approach</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>preferable</span> <span class='word'>given</span> <span class='word'>the</span> <span class='word'>complexity</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>general</span> <span class='word'>rotation</span> <span class='word'>equations</span><span class='ignore'>.</span> <span class='word'>First</span> <span class='word'>we</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>solution</span> <span class='word'>exists</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>form</span> <span class='word'>an</span> <span class='word'>initial</span> <span class='word'>guess</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>solution</span> <span class='word'>by</span> <span class='word'>quantizing</span> <span class='word'>the</span> <span class='word'>floating</span> <span class='word'>point</span> <span class='word'>representation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>matrix</span><span class='ignore'>.</span> <span class='word'>Next</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>error</span> <span class='word'>produced</span> <span class='word'>by</span> <span class='word'>our</span> <span class='word'>approximate</span> <span class='word'>quantized</span> <span class='word'>rotation</span> <span class='word'>by</span> <span class='word'>rotating</span> <span class='word'>the</span> <span class='word'>corners</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span> <span class='word'>and</span> <span class='word'>comparing</span> <span class='word'>the</span> <span class='word'>results</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>numerically</span> <span class='word'>search</span> <span class='word'>around</span> <span class='word'>this</span> <span class='word'>approximation</span> <span class='word'>for</span> <span class='word'>improvements</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>question</span> <span class='word'>that</span> <span class='word'>remains</span> <span class='word'>is</span> <span class='word'>what</span> <span class='word'>search</span> <span class='word'>area</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>included</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Because</span> <span class='word'>the</span> <span class='word'>general</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>split</span> <span class='word'>into</span> <span class='word'>the</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>three</span> <span class='word'>individual</span> <span class='word'>matrices</span><span class='ignore'>,</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>dependent</span> <span class='word'>on</span> <span class='word'>only</span> <span class='word'>one</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>three</span> <span class='word'>free</span> <span class='word'>parameters</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>work</span> <span class='word'>in</span> <span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ConstructingANewColorSpace</span><span class='ignore'>}</span> <span class='word'>could</span> <span class='word'>be</span> <span class='word'>repeated</span> <span class='word'>relatively</span> <span class='word'>straightforwardly</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>these</span> <span class='word'>three</span> <span class='word'>individual</span> <span class='word'>matrices</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>from</span> <span class='word'>this</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>quantization</span> <span class='word'>criteria</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>a</span> <span class='word'>minimum</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>maximum</span> <span class='word'>angle</span> <span class='word'>step</span> <span class='word'>size</span> <span class='ignore'>(</span><span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PtbToChan</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>separate</span> <span class='word'>matrices</span> <span class='word'>a</span> <span class='word'>minimum</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>maximum</span> <span class='word'>step</span> <span class='word'>size</span><span class='ignore'>,</span> <span class='word'>it's</span> <span class='word'>a</span> <span class='word'>reasonable</span> <span class='word'>idea</span> <span class='word'>to</span> <span class='word'>search</span> <span class='word'>around</span> <span class='word'>our</span> <span class='word'>initial</span> <span class='word'>approximation</span> <span class='word'>in</span> <span class='word'>steps</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>minimum</span> <span class='word'>step</span> <span class='word'>size</span> <span class='word'>to</span> <span class='word'>either</span> <span class='word'>side</span> <span class='word'>out</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>maximum</span> <span class='word'>distance</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>step</span> <span class='word'>size</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>three</span> <span class='word'>angles</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>search</span> <span class='word'>within</span> <span class='word'>a</span> <span class='word'>cube</span> <span class='word'>with</span> <span class='word'>sides</span> <span class='word'>defined</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>step</span> <span class='word'>sizes</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>those</span> <span class='word'>rotation</span> <span class='word'>matrices</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>cubic</span> <span class='word'>grid</span> <span class='word'>defined</span> <span class='word'>by</span> <span class='word'>their</span> <span class='word'>minimum</span> <span class='word'>step</span> <span class='word'>sizes</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>result</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>there</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>relatively</span> <span class='word'>small</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>possible</span> <span class='word'>optimized</span> <span class='word'>choices</span><span class='ignore'>.</span> <span class='word'>Although</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>solving</span> <span class='word'>the</span> <span class='word'>problem</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>degree</span> <span class='word'>that</span> <span class='word'>was</span> <span class='word'>done</span> <span class='word'>in</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ConstructingANewColorSpace</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='word'>we</span> <span class='word'>reduced</span> <span class='word'>it</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>mathematical</span> <span class='word'>function</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>provides</span> <span class='word'>a</span> <span class='word'>practical</span> <span class='word'>way</span> <span class='word'>of</span> <span class='word'>achieving</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>results</span> <span class='word'>without</span> <span class='word'>excessive</span> <span class='word'>computational</span> <span class='word'>effort</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>set-up</span><span class='ignore'>.</span> <br>
<br>
<span class='comment'>%\subsection{Multi-Channel Color Spaces}\label{sec:MultiChannelColorSpaces}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%As mentioned in Chapter 1, the RGB color-space is an approximation to the full spectrum of light. However, cameras which are not confined to the three-channel approximation are becoming commercially available (Figure \ref{fig:MultiSpectralCameras}); such a multi-channel image contains far more information about the objects in frame. So where the camera is being used for computer vision tasks the chromatic space can be used to discriminate between different objects and surfaces in ways which are undetectable in the standard RGB color-space.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{figure}</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; \begin{tabular}{cc}</span><br>
<span class='comment'>%&nbsp; \subfloat[Triwave EC701.]{</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=.49\textwidth]{Chapter5/Figs/multispec-triwave.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; }&amp;</span><br>
<span class='comment'>%&nbsp; \subfloat[HyperCam by University of Washington and Microsoft Research.]{</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=.49\textwidth]{Chapter5/Figs/multispec-hypercam.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; } \\</span><br>
<span class='comment'>%&nbsp; &nbsp; \multicolumn{2}{c}{</span><br>
<span class='comment'>%&nbsp; &nbsp; \subfloat[Optec multi-spectral camera.]{</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; \includegraphics[width=.49\textwidth]{Chapter5/Figs/multispec-optec.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; }</span><br>
<span class='comment'>%&nbsp; &nbsp; }</span><br>
<span class='comment'>%&nbsp; \end{tabular}</span><br>
<span class='comment'>%&nbsp; \caption{A variety of multi-spectral cameras currently in use.}</span><br>
<span class='comment'>%&nbsp; \label{fig:MultiSpectralCameras}</span><br>
<span class='comment'>%\end{figure}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%The basic design of these multi-spectral cameras is essentially the same as for the RGB cameras where the spectrum of light on each point in the scene (roughly speaking; see Chapter 1) is represented by a combination of Gaussians, the only difference being we have more Gaussians. Each channel can therefore be considered an orthogonal axis in a multi-dimensional color-space. The multi-dimensional color-space contains a point which corresponds to white, so it is just as possible to construct a color-space with a luminosity axis and $n-1$ chromatic axes for an $n$-channel image. Transformation to this color-space is defined by a multi-dimensional rotation; this rotation could be optimized in a similar way to that presented in Chapter 2. However, our requirement in Chapter 2 was that the immediate result of the rotation would fit into a data type no more than twice the bit depth of each channel. An $n$-channel color-space will be rotated by an $n$ x $n$ rotation matrix; if we have $m$ bits per channel and the quantized rotation matrix is expressed in $l$-bit integers, the result is $l + m + (n-1) \leqslant 2m$. For the larger values of $n$, the rotation matrix would have to be expressed in smaller data types, so aside from special rotation angles which just happen to produce integer rotation matrices, it's unlikely that our criterion can be met. So for multi-channel images to still be able to use integer rotation matrices, the target data type will undoubtedly have to be significantly larger. </span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Using</span> <span class='hword'>the</span> <span class='hword'>RAW</span> <span class='hword'>Image</span> <span class='hword'>From</span> <span class='hword'>the</span> <span class='hword'>Camera</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>UsingTheRAWImageFromTheCamera</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>RAW</span> <span class='word'>camera</span> <span class='word'>image</span> <span class='word'>contains</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>captured</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>camera</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>without</span> <span class='word'>any</span> <span class='word'>pre-processing</span><span class='ignore'>.</span> <span class='word'>Individual</span> <span class='word'>CCDs</span> <span class='word'>have</span> <span class='word'>different</span> <span class='word'>sensitivities</span> <span class='word'>in</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>their</span> <span class='word'>channels</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>so</span> <span class='word'>the</span> <span class='word'>corresponding</span> <span class='word'>bit</span> <span class='word'>depth</span> <span class='word'>of</span> <span class='word'>each</span> <span class='word'>channel</span> <span class='word'>may</span> <span class='word'>actually</span> <span class='word'>vary</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>likely</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>iPhone's</span> <span class='word'>camera</span> <span class='word'>as</span> <span class='word'>we</span> <span class='word'>found</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>3</span> <span class='word'>that</span> <span class='word'>certain</span> <span class='word'>RGB</span> <span class='word'>values</span> <span class='word'>appear</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>inaccessible</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>inaccessible</span> <span class='word'>values</span> <span class='word'>also</span> <span class='word'>appear</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>relatively</span> <span class='word'>evenly-spread</span> <span class='word'>throughout</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>produced</span> <span class='word'>what</span> <span class='word'>we</span> <span class='word'>referred</span> <span class='word'>to</span> <span class='word'>as</span> <span class='ignore'>"</span><span class='word'>speckling</span><span class='ignore'>"</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>statistics</span> <span class='word'>gathered</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>3</span> <span class='word'>as</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>Despeckle</span><span class='ignore'>_</span><span class='ignore'>the</span><span class='ignore'>_</span><span class='ignore'>Bins</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
<span class='word'>A</span> <span class='word'>possible</span> <span class='word'>explanation</span> <span class='word'>for</span> <span class='word'>the</span> <span class='ignore'>"</span><span class='word'>speckling</span><span class='ignore'>"</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>one</span> <span class='word'>or</span> <span class='word'>more</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>iPhone</span> <span class='word'>camera's</span> <span class='word'>channels</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>truly</span> <span class='word'>captured</span> <span class='word'>at</span> <span class='word'>an</span> <span class='word'>8-bit</span> <span class='word'>depth</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>a</span> <span class='word'>smaller</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>the</span> <span class='word'>CCD</span> <span class='word'>actually</span> <span class='word'>captures</span> <span class='word'>is</span> <span class='word'>stretched</span> <span class='word'>to</span> <span class='word'>fit</span> <span class='word'>the</span> <span class='word'>full</span> <span class='word'>8-bit</span> <span class='word'>range</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>is</span> <span class='word'>also</span> <span class='word'>entirely</span> <span class='word'>possible</span> <span class='word'>that</span> <span class='word'>one</span> <span class='word'>or</span> <span class='word'>more</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>channels</span> <span class='word'>may</span> <span class='word'>actually</span> <span class='word'>be</span> <span class='word'>captured</span> <span class='word'>at</span> <span class='word'>a</span> <span class='word'>higher</span> <span class='word'>bit</span> <span class='word'>depth</span> <span class='word'>than</span> <span class='word'>8-bit</span><span class='ignore'>.</span> <span class='word'>But</span> <span class='word'>in</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>now</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>allow</span> <span class='word'>each</span> <span class='word'>channel</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>to</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>variable</span> <span class='word'>bit</span> <span class='word'>depth</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>will</span> <span class='word'>affect</span> <span class='word'>several</span> <span class='word'>things</span><span class='ignore'>;</span> <span class='word'>it</span> <span class='word'>changes</span> <span class='word'>the</span> <span class='word'>integer</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>allowed</span> <span class='word'>values</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>for</span> <span class='word'>determining</span> <span class='word'>the</span> <span class='word'>optimal</span> <span class='word'>angle</span> <span class='word'>could</span> <span class='word'>be</span> <span class='word'>adapted</span> <span class='word'>by</span> <span class='word'>weighting</span> <span class='word'>the</span> <span class='word'>channels</span> <span class='word'>appropriately</span><span class='ignore'>.</span> <span class='word'>But</span> <span class='word'>otherwise</span><span class='ignore'>,</span> <span class='word'>adapting</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>RAW</span> <span class='word'>camera</span> <span class='word'>image</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>relatively</span> <span class='word'>straightforward</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Implementation</span> <span class='hword'>Improvements</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ImplementationImprovements</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>An</span> <span class='hword'>Empirical</span> <span class='hword'>WoBo</span> <span class='hword'>Algorithm</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>EmpicialWoBoAlgorithm</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>White-out</span> <span class='word'>Black-out</span> <span class='word'>algorithm</span> <span class='word'>outlined</span> <span class='word'>in</span> <span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>WhiteoutAndBlackout</span><span class='ignore'>}</span> <span class='word'>uses</span> <span class='word'>theoretical</span> <span class='word'>values</span> <span class='word'>based</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>extent</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>store</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>Looking</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>empirical</span> <span class='word'>results</span> <span class='word'>presented</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>WhitePoint</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>there's</span> <span class='word'>more</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>WoBo</span> <span class='word'>behaviour</span> <span class='word'>than</span> <span class='word'>simply</span> <span class='word'>saturating</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>type</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>performance</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>CCD</span> <span class='word'>changes</span> <span class='word'>with</span> <span class='word'>overall</span> <span class='word'>ambient</span> <span class='word'>light</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>pre-processing</span> <span class='word'>performed</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>device</span> <span class='word'>also</span> <span class='word'>has</span> <span class='word'>an</span> <span class='word'>effect</span> <span class='word'>which</span> <span class='word'>takes</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>away</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>naive</span> <span class='word'>data</span> <span class='word'>point</span> <span class='word'>values</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>extent</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>Although</span> <span class='word'>it</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>possible</span> <span class='word'>to</span> <span class='word'>reverse-engineer</span> <span class='word'>both</span> <span class='word'>the</span> <span class='word'>pre-processing</span> <span class='word'>and</span> <span class='word'>CCD</span> <span class='word'>characteristics</span> <span class='word'>simultaneously</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>a</span> <span class='word'>difficult</span> <span class='word'>task</span> <span class='word'>at</span> <span class='word'>best</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>if</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>device</span> <span class='word'>we</span> <span class='word'>were</span> <span class='word'>able</span> <span class='word'>to</span> <span class='word'>obtain</span> <span class='word'>the</span> <span class='word'>RAW</span> <span class='word'>image</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>CCD</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>repeatedly</span> <span class='word'>performing</span> <span class='word'>empirical</span> <span class='word'>tests</span><span class='ignore'>,</span> <span class='word'>such</span> <span class='word'>as</span> <span class='word'>those</span> <span class='word'>performed</span> <span class='word'>to</span> <span class='word'>generate</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>WhitePoint</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>CCD</span> <span class='word'>characteristics</span> <span class='word'>could</span> <span class='word'>be</span> <span class='word'>obtained</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>we</span> <span class='word'>know</span> <span class='word'>how</span> <span class='word'>the</span> <span class='word'>CCD</span> <span class='word'>detects</span> <span class='word'>objects</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>certain</span> <span class='word'>color</span> <span class='word'>under</span> <span class='word'>different</span> <span class='word'>ambient</span> <span class='word'>luminosities</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>a</span> <span class='word'>more</span> <span class='word'>nuanced</span> <span class='word'>algorithm</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>determine</span> <span class='word'>if</span> <span class='word'>a</span> <span class='word'>certain</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>has</span> <span class='word'>suffered</span> <span class='word'>from</span> <span class='word'>white-out</span> <span class='word'>or</span> <span class='word'>black-out</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Auto-Adjusting</span> <span class='hword'>the</span> <span class='hword'>Variance</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>AutoAdjustingTheVariance</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>presented</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>4</span> <span class='word'>uses</span> <span class='word'>a</span> <span class='word'>reference</span> <span class='word'>image</span> <span class='word'>to</span> <span class='word'>float</span> <span class='word'>the</span> <span class='word'>mean</span><span class='ignore'>,</span> <span class='word'>yet</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>makes</span> <span class='word'>no</span> <span class='word'>attempt</span> <span class='word'>to</span> <span class='word'>adjust</span> <span class='word'>the</span> <span class='word'>variance</span> <span class='word'>to</span> <span class='word'>local</span> <span class='word'>ambient</span> <span class='word'>light</span> <span class='word'>conditions</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>to</span> <span class='word'>work</span> <span class='word'>well</span><span class='ignore'>,</span> <span class='word'>however</span> <span class='word'>it</span> <span class='word'>was</span> <span class='word'>initially</span> <span class='word'>found</span> <span class='word'>that</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>standard</span> <span class='word'>deviation</span> <span class='word'>2.3</span> <span class='word'>times</span> <span class='word'>larger</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>value</span> <span class='word'>found</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>3</span> <span class='word'>produced</span> <span class='word'>better</span> <span class='word'>results</span><span class='ignore'>=</span> <span class='ignore'>(</span><span class='word'>see</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>RelaxedSigma</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span> <span class='word'>Although</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>was</span> <span class='word'>tested</span> <span class='word'>against</span> <span class='word'>a</span> <span class='word'>selection</span> <span class='word'>of</span> <span class='word'>background</span> <span class='word'>colors</span><span class='ignore'>,</span> <span class='word'>backgrounds</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>notably</span> <span class='word'>close</span> <span class='word'>to</span> <span class='word'>skin</span> <span class='word'>colors</span> <span class='word'>were</span> <span class='word'>avoided</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>practical</span> <span class='word'>applications</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>may</span> <span class='word'>therefore</span> <span class='word'>be</span> <span class='word'>useful</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>value</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>standard</span> <span class='word'>deviation</span> <span class='word'>close</span> <span class='word'>to</span> <span class='word'>that</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>3</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>images</span> <span class='word'>chosen</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>included</span> <span class='word'>in</span> <span class='word'>this</span> <span class='word'>document</span> <span class='word'>were</span> <span class='word'>taken</span> <span class='word'>against</span> <span class='word'>a</span> <span class='word'>green</span> <span class='word'>background</span> <span class='word'>because</span> <span class='word'>that</span> <span class='word'>gave</span> <span class='word'>the</span> <span class='word'>cleanest</span> <span class='word'>results</span><span class='ignore'>;</span> <span class='word'>a</span> <span class='word'>value</span> <span class='word'>of</span> <span class='word'>2.3</span><span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span> <span class='word'>produced</span> <span class='word'>good</span> <span class='word'>results</span> <span class='word'>in</span> <span class='word'>this</span> <span class='word'>ideal</span> <span class='word'>background</span> <span class='word'>condition</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>we'll</span> <span class='word'>choose</span> <span class='word'>2.3</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>upper</span> <span class='word'>limit</span> <span class='word'>and</span> <span class='word'>1</span><span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>lower</span> <span class='word'>limit</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>reference</span> <span class='word'>image</span> <span class='word'>where</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>good</span> <span class='word'>idea</span> <span class='word'>that</span> <span class='word'>there</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>finger</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>portion</span> <span class='word'>of</span> <span class='word'>that</span> <span class='word'>finger</span> <span class='word'>is</span> <span class='word'>within</span> <span class='word'>a</span> <span class='word'>known</span> <span class='word'>frame</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>the</span> <span class='word'>lower</span> <span class='word'>criteria</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>nearly</span> <span class='word'>all</span><span class='ignore'>,</span> <span class='word'>if</span> <span class='word'>not</span> <span class='word'>all</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>within</span> <span class='word'>that</span> <span class='word'>frame</span> <span class='word'>are</span> <span class='word'>categorized</span> <span class='word'>as</span> <span class='word'>skin</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>value</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>standard</span> <span class='word'>deviation</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>choice</span> <span class='word'>between</span> <span class='word'>1</span><span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>2.3</span><span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='ignore'>"</span><span class='word'>score</span><span class='ignore'>"</span> <span class='word'>the</span> <span class='word'>choice</span> <span class='word'>as</span> <span class='word'>follows</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{enumerate}</span><br>
<span class='cmd'>\item</span> <span class='word'>The</span> <span class='word'>proportion</span> <span class='word'>of</span> <span class='word'>pixels</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>known</span> <span class='word'>skin</span> <span class='word'>region</span> <span class='word'>successfully</span> <span class='word'>classified</span> <span class='word'>as</span> <span class='word'>skin</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>The</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>found</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>algorithm</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>classified</span> <span class='word'>as</span> <span class='word'>bad</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>which</span> <span class='word'>also</span> <span class='word'>lie</span> <span class='word'>outside</span> <span class='word'>the</span> <span class='word'>approximated</span> <span class='word'>digit</span> <span class='word'>edge</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>The</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>edge</span> <span class='word'>points</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>Filament</span> <span class='word'>fill</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>classified</span> <span class='word'>as</span> <span class='word'>bad</span> <span class='word'>edge</span> <span class='word'>points</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>which</span> <span class='word'>lie</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>.</span><br>
<span class='envir'>\end</span><span class='envir'>{enumerate}</span><br>
<br>
<span class='word'>So</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>score</span> <span class='word'>where</span> <span class='word'>measure</span> <span class='word'>1</span> <span class='word'>is</span> <span class='word'>too</span> <span class='word'>low</span> <span class='word'>suggests</span> <span class='word'>that</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>increased</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>we</span> <span class='word'>know</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>skin</span> <span class='word'>are</span> <span class='word'>classified</span> <span class='word'>as</span> <span class='word'>not</span> <span class='word'>skin</span><span class='ignore'>;</span> <span class='word'>if</span> <span class='word'>measure</span> <span class='word'>2</span> <span class='word'>is</span> <span class='word'>too</span> <span class='word'>high</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>reduce</span> <span class='word'>the</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='word'>if</span> <span class='word'>measure</span> <span class='word'>3</span> <span class='word'>is</span> <span class='word'>too</span> <span class='word'>high</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>increase</span> <span class='word'>the</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<br>
<span class='word'>This</span> <span class='word'>suggests</span> <span class='word'>a</span> <span class='word'>way</span> <span class='word'>that</span> <span class='word'>an</span> <span class='word'>algorithm</span> <span class='word'>could</span> <span class='word'>be</span> <span class='word'>developed</span> <span class='word'>which</span> <span class='word'>appropriately</span> <span class='word'>adjusts</span> <span class='word'>the</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span> <span class='word'>striking</span> <span class='word'>a</span> <span class='word'>compromise</span> <span class='word'>between</span> <span class='word'>false</span> <span class='word'>negatives</span> <span class='word'>and</span> <span class='word'>false</span> <span class='word'>positives</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>actual</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>thresholds</span> <span class='word'>and</span> <span class='word'>criteria</span> <span class='word'>used</span> <span class='word'>can</span> <span class='word'>best</span> <span class='word'>be</span> <span class='word'>determined</span> <span class='word'>empirically</span><span class='ignore'>.</span><br>
<br>
<span class='word'>One</span> <span class='word'>way</span> <span class='word'>of</span> <span class='word'>proceeding</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>to</span> <span class='word'>combine</span> <span class='word'>the</span> <span class='word'>three</span> <span class='word'>measures</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>weighted</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>measures</span> <span class='word'>2</span> <span class='word'>and</span> <span class='word'>3</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>weighted</span> <span class='word'>reciprocal</span> <span class='word'>of</span> <span class='word'>measure</span> <span class='word'>1</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>combine</span> <span class='word'>the</span> <span class='word'>measures</span> <span class='word'>in</span> <span class='word'>this</span> <span class='word'>fashion</span> <span class='word'>and</span> <span class='word'>minimize</span> <span class='word'>the</span> <span class='word'>result</span> <span class='word'>with</span> <span class='word'>respect</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Statistics</span> <span class='hword'>Gathering</span> <span class='hword'>Method</span> <span class='hword'>for</span> <span class='hword'>the</span> <span class='hword'>App</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>StatisticsGatheringMethod</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>statistical</span> <span class='word'>model</span> <span class='word'>presented</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>3</span> <span class='word'>was</span> <span class='word'>found</span> <span class='word'>using</span> <span class='word'>algorithms</span> <span class='word'>written</span> <span class='word'>in</span> <span class='word'>MatLab</span><span class='ignore'>.</span> <span class='word'>There</span> <span class='word'>is</span> <span class='word'>no</span> <span class='word'>real</span> <span class='word'>barrier</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>entire</span> <span class='word'>method</span> <span class='word'>being</span> <span class='word'>written</span> <span class='word'>in</span> <span class='word'>C</span><span class='ignore'>+</span><span class='ignore'>+</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>OpenCV</span> <span class='word'>library</span> <span class='word'>running</span> <span class='word'>on</span> <span class='word'>an</span> <span class='word'>iPhone</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>only</span> <span class='word'>user</span> <span class='word'>input</span> <span class='word'>needed</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>to</span> <span class='word'>select</span> <span class='word'>which</span> <span class='word'>color</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>background</span> <span class='word'>and</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>skin</span><span class='ignore'>.</span><br>
<br>
<span class='comment'>%</span><br>
<span class='comment'>%\subsection{Improved ICWaS Alignment}\label{sec:ImprovedICWaSAlignment}</span><br>
<span class='comment'>%To align successive frames, the ICWaS developed in Chapter 4 uses OpenCV's template aligning routines which operates by performing a translation of one frame and computing a per-pixel difference. This works because the alignment is already quite good. There are two ways in which this can be improved; the allowed transforms can be increased to include rotation and perspective adjustments, and the alignment methodology can be improved to utilize more constant features of the fingertip image than the per-pixel approach. </span><br>
<span class='comment'>%</span><br>
<span class='comment'>%It's a simple matter to allow for a more general transform, however the per-pixel based comparison is wholly inappropriate to find a more general transform as we would have to try all possible results of the transform and compare them. This would be computationally far too expensive. So, to find a more general transform, we must turn each frame into a set of feature points which can be put into a correspondence, or perform some image transform which simplifies the alignment problem.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\subsection{More Designed Metric for Mechanical Stress}\label{sec:MoreDesignedMetricForMechanicalStress}</span><br>
<span class='comment'>%The metric method which is very briefly presented at the end of Chapter 4 (see Figures \ref{fig:ICWaSResultJSkin}, \ref{fig:ICWaSResultFSkin} and \ref{fig:ICWaSResultNSkin}) relies on a pixel-to-pixel comparison; it is well known that pixel-based methods are unreliable for detecting movement, and our mechanical stress measurement relies on detecting the flow of blood. The metric should therefore account for neighboring pixels. </span><br>
<span class='comment'>%</span><br>
<span class='comment'>%There are many possible methodologies for detecting movement which would improve the pixel-based method of Chapter 4. Mechanical stress tends to move pooled blood from one area to another within the stressed tissue. The upshot of this is that as one portion of the image loses blood, another gains it. This is different to the circulatory blood, which is pumped in through the arteries and capillaries and flows out through the veins. A better metric may be to compare blobs in the negative and positive chromatic difference images. To be clear, the algorithm would find blobs using a negative thresholding and a positive thresholding; the largest blobs in each of these spaces would be considered good indicators of pooled blood flow.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%Another possibility arises from incidental observations of the pooled blood flow images; for each individual's digit, the pooled blood flow pattern is fairly consistent under similar mechanical stress conditions. This suggests that it may be possible to construct a blood flow model for a given digit. Regarding the app, we can imagine generalizing the reference image idea to asking the user to press on a surface several times, allowing the blood flow model to be generated for that digit.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Conclusion</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ConclusionCh5</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>finger</span> <span class='word'>press</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>simple</span> <span class='word'>application</span> <span class='word'>to</span> <span class='word'>demonstrate</span> <span class='word'>the</span> <span class='word'>viability</span> <span class='word'>of</span> <span class='word'>detecting</span> <span class='word'>blood</span> <span class='word'>movement</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>standard</span> <span class='word'>camera</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>mobile</span> <span class='word'>device</span><span class='ignore'>.</span> <span class='word'>Many</span> <span class='word'>previous</span> <span class='word'>authors</span> <span class='word'>have</span> <span class='word'>dismissed</span> <span class='word'>using</span> <span class='word'>bespoke</span> <span class='word'>color-spaces</span> <span class='word'>for</span> <span class='word'>such</span> <span class='word'>applications</span> <span class='word'>simply</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>transform</span> <span class='word'>itself</span> <span class='word'>is</span> <span class='word'>computationally</span> <span class='word'>intensive</span> <span class='word'>and</span> <span class='word'>significantly</span> <span class='word'>loses</span> <span class='word'>information</span> <span class='word'>when</span> <span class='word'>applied</span> <span class='word'>using</span> <span class='word'>standard</span> <span class='word'>library</span> <span class='word'>color-spaces</span><span class='ignore'>.</span><br>
<br>
<span class='word'>It</span> <span class='word'>is</span> <span class='word'>hoped</span> <span class='word'>that</span><span class='ignore'>,</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>rigorous</span> <span class='word'>optimization</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>transform</span> <span class='word'>itself</span>&nbsp; <span class='word'>that</span> <span class='word'>these</span> <span class='word'>color-spaces</span> <span class='word'>can</span> <span class='word'>see</span> <span class='word'>greater</span> <span class='word'>application</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>future</span><span class='ignore'>,</span> <span class='word'>although</span> <span class='word'>it's</span> <span class='word'>recognized</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>level</span> <span class='word'>of</span> <span class='word'>attention</span> <span class='word'>that's</span> <span class='word'>currently</span> <span class='word'>required</span> <span class='word'>to</span> <span class='word'>make</span> <span class='word'>the</span> <span class='word'>routine</span> <span class='word'>as</span> <span class='word'>efficient</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>one</span> <span class='word'>designed</span> <span class='word'>herein</span> <span class='word'>will</span> <span class='word'>likely</span> <span class='word'>be</span> <span class='word'>beyond</span> <span class='word'>the</span> <span class='word'>patience</span> <span class='word'>of</span> <span class='word'>many</span> <span class='word'>practitioners</span><span class='ignore'>,</span> <span class='word'>some</span> <span class='word'>of</span> <span class='word'>whom</span> <span class='word'>are</span> <span class='word'>medical</span> <span class='word'>professionals</span> <span class='word'>and</span> <span class='word'>not</span> <span class='word'>computer</span> <span class='word'>scientists</span><span class='ignore'>.</span> <span class='word'>Also</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>hoped</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>work</span> <span class='word'>presented</span> <span class='word'>here</span> <span class='word'>has</span> <span class='word'>addressed</span> <span class='word'>the</span> <span class='word'>concerns</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>associated</span> <span class='word'>loss</span> <span class='word'>of</span> <span class='word'>information</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Finally</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>use</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>2D</span> <span class='word'>Gaussian</span> <span class='word'>model</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>color-space</span> <span class='word'>has</span> <span class='word'>been</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>of</span> <span class='word'>much</span> <span class='word'>debate</span><span class='ignore'>;</span> <span class='word'>some</span> <span class='word'>authors</span> <span class='word'>insist</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>statistical</span> <span class='word'>model</span> <span class='word'>be</span> <span class='word'>extended</span> <span class='word'>to</span> <span class='word'>all</span> <span class='word'>three</span> <span class='word'>dimensions</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Shin2002a</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>hopefully</span> <span class='word'>it</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>from</span> <span class='word'>this</span> <span class='word'>work</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>channel</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>effectively</span> <span class='word'>removed</span> <span class='word'>from</span> <span class='word'>consideration</span> <span class='word'>because</span> <span class='word'>its</span> <span class='word'>influence</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>statistics</span> <span class='word'>is</span> <span class='word'>an</span> <span class='word'>artefact</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>white-out</span> <span class='word'>and</span> <span class='word'>black-out</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>fairness</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>authors</span> <span class='word'>who</span> <span class='word'>have</span> <span class='word'>argued</span> <span class='word'>for</span> <span class='word'>its</span> <span class='word'>inclusion</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>is</span> <span class='word'>considered</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>Quaternary</span> <span class='word'>Pixel</span> <span class='word'>Classification</span> <span class='word'>outlined</span> <span class='word'>in</span> <span class='word'>Section</span><span class='ignore'>~</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>QuaternaryPixelClassification</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>however</span> <span class='word'>this</span> <span class='word'>part</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>theoretically</span> <span class='word'>derived</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>two-dimensional</span> <span class='word'>chromatic</span> <span class='word'>statistics</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>be</span> <span class='word'>clear</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>authors</span> <span class='word'>who</span> <span class='word'>argued</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>full</span> <span class='word'>three-dimensional</span> <span class='word'>model</span> <span class='word'>were</span> <span class='word'>correct</span> <span class='word'>in</span> <span class='word'>that</span> <span class='word'>luminosity</span> <span class='word'>has</span> <span class='word'>an</span> <span class='word'>effect</span><span class='ignore'>,</span> <span class='word'>however</span> <span class='word'>they</span> <span class='word'>were</span> <span class='word'>including</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>model</span> <span class='word'>camera</span> <span class='word'>effects</span> <span class='word'>which</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>compensated</span> <span class='word'>for</span> <span class='word'>by</span> <span class='word'>application</span> <span class='word'>of</span> <span class='word'>theory</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>The</span> <span class='word'>secondary</span> <span class='word'>controversy</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>computational</span> <span class='word'>cost</span> <span class='word'>of</span> <span class='word'>applying</span> <span class='word'>a</span> <span class='word'>2D</span> <span class='word'>Gaussian</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>has</span> <span class='word'>led</span> <span class='word'>to</span> <span class='word'>authors</span> <span class='word'>using</span> <span class='word'>elliptical</span> <span class='word'>functions</span><span class='ignore'>,</span> <span class='word'>rectangular</span> <span class='word'>functions</span><span class='ignore'>,</span> <span class='word'>etc</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>developed</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span> <span class='word'>takes</span> <span class='word'>advantage</span> <span class='word'>of</span> <span class='word'>all</span> <span class='word'>these</span> <span class='word'>methods</span> <span class='word'>to</span> <span class='word'>produce</span> <span class='word'>a</span> <span class='word'>composite</span> <span class='word'>algorithm</span> <span class='word'>which</span> <span class='word'>very</span> <span class='word'>efficiently</span> <span class='word'>applies</span> <span class='word'>a</span> <span class='word'>2D</span> <span class='word'>Gaussian</span> <span class='word'>distribution</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>central</span> <span class='word'>trick</span> <span class='word'>employed</span> <span class='word'>was</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>bespoke</span> <span class='word'>color-space</span> <span class='word'>in</span> <span class='word'>which</span> <span class='word'>the</span> <span class='word'>long</span> <span class='word'>axis</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>2D</span> <span class='word'>Gaussian</span> <span class='word'>is</span> <span class='word'>aligned</span> <span class='word'>parallel</span> <span class='word'>to</span> <span class='word'>one</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axes</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>color-space</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>means</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>2D</span> <span class='word'>Gaussian</span> <span class='word'>is</span> <span class='word'>functionally</span> <span class='word'>expressed</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>one-dimensional</span> <span class='word'>Gaussians</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>advantages</span> <span class='word'>of</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>three-dimensional</span> <span class='word'>model</span> <span class='word'>would</span> <span class='word'>appear</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>re-gained</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>Quaternary</span> <span class='word'>Pixel</span> <span class='word'>Classification</span> <span class='word'>algorithm</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>by</span> <span class='word'>judicious</span> <span class='word'>collection</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>statistics</span> <span class='word'>as</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>3</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>In</span> <span class='word'>conclusion</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>presented</span> <span class='word'>a</span> <span class='word'>rigorous</span> <span class='word'>statistical</span> <span class='word'>method</span> <span class='word'>and</span> <span class='word'>model</span> <span class='word'>for</span> <span class='word'>human</span> <span class='word'>skin</span> <span class='word'>detection</span> <span class='word'>which</span> <span class='word'>has</span><span class='ignore'>,</span> <span class='word'>to</span> <span class='word'>my</span> <span class='word'>understanding</span><span class='ignore'>,</span> <span class='word'>addressed</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>concerns</span> <span class='word'>expressed</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>current</span> <span class='word'>literature</span><span class='ignore'>.</span></p></div>
<br>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Chapter5/chapter5.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 2562</li>
<li>Words in headers: 48</li>
<li>Words outside text (captions, etc.): 161</li>
<li>Number of headers: 14</li>
<li>Number of floats/tables/figures: 5</li>
<li>Number of math inlines: 12</li>
<li>Number of math displayed: 0</li>
<li>Subcounts:</li>
<span class='subcount'>
<li class='fielddesc'>&nbsp; text+headers+captions (#headers/#floats/#inlines/#displayed)</li>
  <li>0+4+0 (1/0/0/0) Chapter: Future Work and Discussion</li>
  <li>114+3+0 (1/0/0/0) Section: Results and Evaluation}\label{sec:ResultsAndEvaluation</li>
  <li>215+3+24 (1/1/0/0) Subsection: Timing the Methods}\label{sec:TimingTheMethods</li>
  <li>149+4+3 (1/1/0/0) Subsection: Optimization Variation with Input}\label{sec:OptimizationVariationWithInput</li>
  <li>0+2+0 (1/0/0/0) Section: Future Applications}\label{sec:FutureApplications</li>
  <li>168+2+134 (1/3/0/0) Subsection: Medical Applications}\label{sec:MedicalApplications</li>
  <li>110+4+0 (1/0/0/0) Section: Color Space Algorithm Improvements}\label{sec:ColorSpaceAlgorithmImprovements</li>
  <li>494+3+0 (1/0/3/0) Subsection: Generalizing the Rotation}\label{sec:GeneralizingTheRotation</li>
  <li>228+7+0 (1/0/0/0) Subsection: Using the RAW Image From the Camera}\label{sec:UsingTheRAWImageFromTheCamera</li>
  <li>0+2+0 (1/0/0/0) Section: Implementation Improvements}\label{sec:ImplementationImprovements</li>
  <li>175+4+0 (1/0/0/0) Subsection: An Empirical WoBo Algorithm}\label{sec:EmpicialWoBoAlgorithm</li>
  <li>422+3+0 (1/0/9/0) Subsection: Auto-Adjusting the Variance}\label{sec:AutoAdjustingTheVariance</li>
  <li>54+6+0 (1/0/0/0) Subsection: Statistics Gathering Method for the App}\label{sec:StatisticsGatheringMethod</li>
  <li>433+1+0 (1/0/0/0) Section: Conclusion}\label{sec:ConclusionCh5</li>
</span>
</ul>
</div>
<h2>File: ./Chapter2/AppendixChapter2.tex</h2>
<div class='parse'><p>
<br>
<span class='cmd'>\chapter</span><span class='ignore'>{</span><span class='hword'>An</span> <span class='hword'>Integer</span> <span class='hword'>Rotation</span> <span class='hword'>Matrix</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>app</span><span class='ignore'>:</span><span class='ignore'>AnIntegerRotationMatrix</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Rotation</span> <span class='hword'>Matrix</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>RotationMatrix</span><span class='ignore'>}</span><br>
<br>
<span class='word'>Any</span> <span class='word'>rotation</span> <span class='word'>about</span> <span class='word'>an</span> <span class='word'>axis</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>represented</span> <span class='word'>by</span> <span class='word'>a</span> <span class='word'>3x3</span> <span class='word'>square</span> <span class='word'>matrix</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>3D</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>Since</span> <span class='word'>they</span> <span class='word'>are</span> <span class='word'>invertible</span><span class='ignore'>,</span> <span class='word'>they're</span> <span class='word'>guaranteed</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>non-singular</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>there</span> <span class='word'>are</span> <span class='word'>many</span> <span class='word'>ways</span> <span class='word'>in</span> <span class='word'>which</span> <span class='word'>to</span> <span class='word'>rotate</span> <span class='word'>an</span> <span class='word'>object</span> <span class='word'>from</span> <span class='word'>one</span> <span class='word'>position</span> <span class='word'>to</span> <span class='word'>another</span><span class='ignore'>,</span> <span class='word'>or</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>combination</span> <span class='word'>of</span> <span class='word'>different</span> <span class='word'>rotations</span> <span class='word'>to</span> <span class='word'>get</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>point</span><span class='ignore'>,</span> <span class='word'>they</span> <span class='word'>aren't</span> <span class='word'>necessarily</span> <span class='word'>unique</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>this</span> <span class='word'>application</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>require</span> <span class='word'>rotation</span> <span class='word'>about</span> <span class='word'>three</span> <span class='word'>different</span> <span class='word'>axes</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>expressed</span> <span class='word'>thus</span><span class='ignore'>:</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{alignat}</span><span class='ignore'>{</span><span class='word'>1</span><span class='ignore'>}</span><br>
<span class='cmd'>\R</span><span class='ignore'>_</span><span class='word'>x</span><span class='ignore'>(</span><span class='word'>\theta</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span><span class='ignore'>=</span> <span class='envir'>\begin</span><span class='envir'>{bmatrix}</span><br>
<span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='cmd'>\\</span><br>
<span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='cmd'>\cos</span> <span class='word'>\theta </span><span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>-</span><span class='cmd'>\sin</span> <span class='word'>\theta </span><span class='cmd'>\\</span><span class='option'>[3pt]</span><br>
<span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='cmd'>\sin</span> <span class='word'>\theta&nbsp; </span><span class='ignore'>&amp;</span>&nbsp; <span class='cmd'>\cos</span> <span class='word'>\theta </span><span class='cmd'>\\</span><span class='option'>[3pt]</span><br>
<span class='envir'>\end</span><span class='envir'>{bmatrix}</span><span class='cmd'>\\</span><span class='option'>[6pt]</span><br>
<span class='cmd'>\R</span><span class='ignore'>_</span><span class='word'>y</span><span class='ignore'>(</span><span class='word'>\theta</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span><span class='ignore'>=</span> <span class='envir'>\begin</span><span class='envir'>{bmatrix}</span><br>
<span class='cmd'>\cos</span> <span class='word'>\theta </span><span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='cmd'>\sin</span> <span class='word'>\theta </span><span class='cmd'>\\</span><span class='option'>[3pt]</span><br>
<span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='cmd'>\\</span><span class='option'>[3pt]</span><br>
<span class='ignore'>-</span><span class='cmd'>\sin</span> <span class='word'>\theta </span><span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='cmd'>\cos</span> <span class='word'>\theta </span><span class='cmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{bmatrix}</span><span class='cmd'>\\</span><span class='option'>[6pt]</span><br>
<span class='cmd'>\R</span><span class='ignore'>_</span><span class='word'>z</span><span class='ignore'>(</span><span class='word'>\theta</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span><span class='ignore'>=</span> <span class='envir'>\begin</span><span class='envir'>{bmatrix}</span><br>
<span class='cmd'>\cos</span> <span class='word'>\theta </span><span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>-</span><span class='cmd'>\sin</span> <span class='word'>\theta </span><span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='cmd'>\\</span><span class='option'>[3pt]</span><br>
<span class='cmd'>\sin</span> <span class='word'>\theta </span><span class='ignore'>&amp;</span> <span class='cmd'>\cos</span> <span class='word'>\theta </span><span class='ignore'>&amp;</span> <span class='word'>0</span><span class='cmd'>\\</span><span class='option'>[3pt]</span><br>
<span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>1</span><span class='cmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{bmatrix}</span><br>
<span class='envir'>\end</span><span class='envir'>{alignat}</span><br>
<br>
<br>
<span class='word'>Any</span> <span class='word'>rotation</span> <span class='word'>which</span> <span class='word'>orients</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>such</span> <span class='word'>that</span> <span class='word'>one</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>axes</span> <span class='word'>lies</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>direction</span> <span class='word'>is</span> <span class='word'>sufficient</span><span class='ignore'>;</span> <span class='word'>a</span> <span class='word'>rotation</span> <span class='word'>which</span> <span class='word'>aligns</span> <span class='word'>the</span> <span class='word'>L</span> <span class='word'>axis</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>direction</span> <span class='word'>is</span> <span class='word'>produced</span> <span class='word'>by</span> <span class='word'>a</span> <span class='word'>rotation</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='math'>{\pi}4</span><span class='mathgroup'>$</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>red</span> <span class='ignore'>(</span><span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='word'>R</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>axis</span><span class='ignore'>,</span> <span class='word'>followed</span> <span class='word'>by</span> <span class='word'>a</span> <span class='word'>rotation</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\arctan</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>green</span> <span class='ignore'>(</span><span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='word'>G</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>axis</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>leaves</span> <span class='word'>one</span> <span class='word'>free</span> <span class='word'>rotational</span> <span class='word'>degree</span> <span class='word'>of</span> <span class='word'>freedom</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>L</span> <span class='word'>axis</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>resulting</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>is</span> <span class='word'>given</span> <span class='word'>by</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>RotationMatrix</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\R</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>xyz</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='math'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sine</span><span class='ignore'>{</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sine</span><span class='ignore'>{</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>\theta </span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<br>
<span class='word'>Where</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>remaining</span> <span class='word'>rotational</span> <span class='word'>degree</span> <span class='word'>of</span> <span class='word'>freedom</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Using</span> <span class='word'>the</span> <span class='word'>standard</span> <span class='word'>rotation</span> <span class='word'>matrices</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>get</span> <span class='word'>a</span> <span class='word'>luminosity</span> <span class='word'>axis</span> <span class='word'>which</span> <span class='word'>spans</span> <span class='word'>the</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='math'>:</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>length</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>remaining</span> <span class='word'>axes</span> <span class='word'>are</span> <span class='word'>dependent</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>used</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>problem</span> <span class='word'>because</span><span class='ignore'>,</span> <span class='word'>ultimately</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>want</span> <span class='word'>the</span> <span class='word'>axes</span> <span class='word'>to</span> <span class='word'>fit</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>an</span> <span class='word'>appropriate</span> <span class='word'>data</span> <span class='word'>type</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>more</span> <span class='word'>useful</span> <span class='word'>to</span> <span class='word'>have</span> <span class='word'>a</span> <span class='word'>matrix</span> <span class='word'>which</span> <span class='word'>provided</span> <span class='word'>the</span> <span class='word'>specified</span> <span class='word'>rotation</span> <span class='word'>and</span> <span class='word'>scaled</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>to</span> <span class='word'>known</span> <span class='word'>lengths</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>luminosity</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>straightforward</span><span class='ignore'>;</span> <span class='word'>simply</span> <span class='word'>divide</span> <span class='word'>by</span> <span class='mathgroup'>$</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>other</span> <span class='word'>two</span> <span class='word'>axes</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>an</span> <span class='word'>explicit</span> <span class='word'>form</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>lengths</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>resulting</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>rotation</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Because</span> <span class='word'>the</span> <span class='word'>absolute</span> <span class='word'>values</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axes</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>have</span> <span class='word'>no</span> <span class='word'>meaning</span><span class='ignore'>,</span> <span class='word'>we're</span> <span class='word'>only</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>position</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>relative</span> <span class='word'>to</span> <span class='word'>its</span> <span class='word'>start</span> <span class='word'>and</span> <span class='word'>end</span><span class='ignore'>,</span> <span class='word'>equivalent</span> <span class='word'>to</span> <span class='word'>talking</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>position</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>relative</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='math'>:</span><span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>compared</span> <span class='word'>to</span> <span class='word'>about</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='math'>:</span><span class='math'>255</span><span class='mathgroup'>$</span> <span class='word'>in</span> <span class='word'>unsigned</span><span class='ignore'>,</span> <span class='word'>8-bit</span> <span class='word'>integers</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>upside</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>if</span> <span class='word'>we're</span> <span class='word'>rotating</span> <span class='word'>the</span> <span class='word'>cube</span> <span class='word'>about</span> <span class='word'>its</span> <span class='word'>corner</span><span class='ignore'>,</span> <span class='word'>we're</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>minimum</span> <span class='word'>and</span> <span class='word'>maximum</span> <span class='word'>values</span> <span class='word'>possible</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>axis</span> <span class='word'>direction</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>will</span> <span class='word'>correspond</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>corner</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span><span class='ignore'>.</span> <span class='word'>With</span> <span class='word'>the</span> <span class='word'>L</span> <span class='word'>axis</span> <span class='word'>aligned</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>direction</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>L</span> <span class='word'>axis</span> <span class='word'>is</span> <span class='word'>0</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>x</span> <span class='word'>and</span> <span class='word'>y</span> <span class='word'>axes</span> <span class='word'>are</span> <span class='word'>symmetrical</span><span class='ignore'>,</span> <span class='word'>spanning</span> <span class='word'>a</span> <span class='word'>range</span> <span class='word'>centered</span> <span class='word'>on</span> <span class='word'>0</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>their</span> <span class='word'>values</span> <span class='word'>is</span> <span class='word'>dependent</span> <span class='word'>upon</span> <span class='word'>the</span> <span class='word'>remaining</span> <span class='word'>degree</span> <span class='word'>of</span> <span class='word'>freedom</span><span class='ignore'>.</span><br>
<br>
<span class='word'>We</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>know</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axes</span><span class='ignore'>,</span> <span class='word'>how</span> <span class='word'>far</span> <span class='word'>out</span> <span class='word'>each</span> <span class='word'>point</span> <span class='word'>is</span><span class='ignore'>.</span> <span class='word'>Because</span> <span class='word'>we're</span> <span class='word'>effectively</span> <span class='word'>rotating</span> <span class='word'>a</span> <span class='word'>hexagon</span><span class='ignore'>,</span> <span class='word'>whatever</span> <span class='word'>the</span> <span class='word'>answer</span> <span class='word'>is</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>know</span> <span class='word'>the</span> <span class='word'>function</span> <span class='word'>is</span> <span class='word'>going</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>periodic</span><span class='ignore'>,</span> <span class='word'>repeating</span> <span class='word'>every</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>radians</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>only</span> <span class='word'>have</span> <span class='word'>to</span> <span class='word'>solve</span> <span class='word'>it</span> <span class='word'>in</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='math'>:</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>region</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>generalize</span><span class='ignore'>.</span> <span class='word'>First</span> <span class='word'>we</span> <span class='word'>take</span> <span class='word'>the</span> <span class='word'>coordinates</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span> <span class='word'>and</span> <span class='word'>perform</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>color</span> <span class='word'>space</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{multline}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>YabCube</span><span class='ignore'>}</span><br>
&nbsp;<span class='cmd'>\R</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='word'>xyz</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='word'>\theta</span><span class='ignore'>)</span><span class='cmd'>\cdot</span><br>
<span class='envir'>\begin</span><span class='envir'>{pmatrix}</span><br>
 <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='cmd'>\\</span><br>
 <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='cmd'>\\</span><br>
 <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>0</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='ignore'>&amp;</span> <span class='word'>1</span> <span class='cmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{pmatrix}</span><br>
 <span class='ignore'>=</span> <span class='cmd'>\\</span><br>
<span class='cmd'>\resizebox</span><span class='ignore'>{</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>!</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='comment'>%</span><br>
<span class='mathgroup'>$</span><span class='mathcmd'>\displaystyle</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='mathgroup'>$</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{multline}</span><br>
<br>
<br>
<span class='word'>The</span> <span class='word'>extent</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>axis</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>and</span> <span class='word'>minimum</span> <span class='word'>values</span> <span class='word'>of</span> <span class='word'>each</span> <span class='word'>row</span><span class='ignore'>,</span> <span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>the</span> <span class='word'>extreme</span> <span class='word'>corner</span> <span class='word'>positions</span> <span class='word'>relative</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>new</span> <span class='word'>axis</span><span class='ignore'>.</span> <span class='word'>An</span> <span class='word'>additional</span> <span class='word'>symmetry</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>hexagonal</span> <span class='word'>projection</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>cube</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>say</span> <span class='word'>that</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>whatever</span> <span class='word'>functional</span> <span class='word'>form</span> <span class='word'>is</span> <span class='word'>taken</span> <span class='word'>by</span> <span class='word'>one</span> <span class='word'>of</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>dependant</span> <span class='word'>ranges</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>the</span> <span class='word'>other</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>a</span> <span class='word'>simple</span> <span class='word'>phase</span> <span class='word'>shift</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>recognizing</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>minimum</span> <span class='word'>value</span> <span class='word'>is</span> <span class='word'>simply</span> <span class='mathgroup'>$</span><span class='math'>-</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>times</span> <span class='word'>the</span> <span class='word'>maximum</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>simplified</span> <span class='word'>the</span> <span class='word'>problem</span> <span class='word'>to</span> <span class='word'>solving</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>AxisRangeMinMax</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\max</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\pm</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\sin</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='mathcmd'>\pm</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\cos</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>,</span> <span class='mathcmd'>\pm</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Where</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='math'>0</span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='mathcmd'>\leq</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>A</span> <span class='word'>graphical</span> <span class='word'>representation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>problem</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span><span class='ignore'>~</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>YABCubeEval</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span> <span class='comment'>%hi-res</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>CornersOf</span><span class='ignore'>_</span><span class='ignore'>theRGBCube.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Evaluation</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>color</span> <span class='oword'>space</span> <span class='oword'>problem</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>cube</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>top-left</span> <span class='oword'>shows</span> <span class='oword'>the</span> <span class='oword'>positions</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>axes</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>rotated</span> <span class='oword'>space</span><span class='ignore'>;</span> <span class='oword'>the</span> <span class='oword'>white</span> <span class='oword'>and</span> <span class='oword'>black</span> <span class='oword'>disks</span> <span class='oword'>on</span> <span class='oword'>the</span> <span class='oword'>vertical</span> <span class='oword'>axis</span> <span class='oword'>represent</span> <span class='oword'>the</span> <span class='oword'>white</span> <span class='oword'>point</span> <span class='oword'>and</span> <span class='oword'>black</span> <span class='oword'>point</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>luminosity</span> <span class='oword'>axis</span><span class='ignore'>,</span> <span class='oword'>and</span> <span class='oword'>the</span> <span class='oword'>other</span> <span class='oword'>disks</span> <span class='oword'>represent</span> <span class='oword'>the</span> <span class='oword'>ends</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>chromatic</span> <span class='oword'>axes</span> <span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>Ca</span><span class='ignore'>}</span> <span class='oword'>and</span> <span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>Cb</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>graphs</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>top-right</span> <span class='oword'>and</span> <span class='oword'>bottom-left</span> <span class='oword'>show</span> <span class='oword'>the</span> <span class='oword'>positions</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>corners</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>RGB</span> <span class='oword'>cube</span> <span class='oword'>relative</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>chromatic</span> <span class='oword'>axes</span> <span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>Ca</span><span class='ignore'>}</span> <span class='oword'>and</span> <span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='oword'>Cb</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>bottom-right</span> <span class='oword'>graphic</span> <span class='oword'>shows</span> <span class='oword'>the</span> <span class='oword'>RGB</span> <span class='oword'>cube</span> <span class='oword'>viewed</span> <span class='oword'>down</span> <span class='oword'>the</span> <span class='oword'>luminosity</span> <span class='oword'>axis</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>graphics</span> <span class='oword'>were</span> <span class='oword'>generated</span> <span class='oword'>by</span> <span class='oword'>interactive</span> <span class='oword'>code</span> <span class='oword'>written</span> <span class='oword'>in</span> <span class='oword'>Mathematica</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>value</span> <span class='oword'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='oword'>was</span> <span class='oword'>an</span> <span class='oword'>arbitrary</span> <span class='oword'>value</span> <span class='oword'>from</span> <span class='oword'>a</span> <span class='oword'>snapshot</span> <span class='oword'>taken</span> <span class='oword'>from</span> <span class='oword'>the</span> <span class='oword'>interactive</span> <span class='oword'>graphic</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>YABCubeEval</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>In</span> <span class='word'>the</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='math'>:</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>both</span> <span class='word'>sin</span> <span class='word'>and</span> <span class='word'>cos</span> <span class='word'>are</span> <span class='word'>positive</span><span class='ignore'>,</span> <span class='word'>therefore</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>ranges</span> <span class='word'>are</span> <span class='word'>given</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>following</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>}</span><br>
&nbsp;<span class='exclcmd'>\hline</span><br>
&nbsp;&nbsp;<span class='ignore'>&amp;</span> <span class='ignore'>Min</span> <span class='ignore'>&amp;</span> <span class='ignore'>Max</span> <span class='exclcmd'>\\</span> <span class='exclcmd'>\hline</span><br>
&nbsp;<span class='ignore'>L</span> <span class='ignore'>&amp;</span> <span class='exclmath'>\(</span><span class='math'>0</span><span class='exclmath'>\)</span> <span class='ignore'>&amp;</span> <span class='exclmath'>\(</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='exclmath'>\)</span> <span class='exclcmd'>\\</span><br>
&nbsp;<span class='ignore'>Ca</span> <span class='ignore'>&amp;</span> <span class='exclmath'>\(</span><span class='math'>-</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>(</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>-</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='exclmath'>\)</span><span class='ignore'>&amp;</span><span class='exclmath'>\(</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>(</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>-</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='exclmath'>\)</span><span class='exclcmd'>\\</span><br>
 <span class='ignore'>Cb</span> <span class='ignore'>&amp;</span> <span class='exclmath'>\(</span><span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='exclmath'>\)</span><span class='ignore'>&amp;</span><span class='exclmath'>\(</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='exclmath'>\)</span><span class='exclcmd'>\\</span><br>
&nbsp;<span class='exclcmd'>\hline</span><br>
<span class='envir'>\end</span><span class='envir'>{tabular}</span><br>
<br>
<span class='word'>The</span> <span class='word'>lengths</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>after</span> <span class='word'>rotation</span> <span class='word'>are</span> <span class='word'>given</span> <span class='word'>by</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>L</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='math'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
<span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span>  <br>
<span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
<span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\quad</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>-</span> <span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>It</span> <span class='word'>is</span> <span class='word'>convenient</span> <span class='word'>to</span> <span class='word'>produce</span> <span class='word'>a</span> <span class='word'>transformation</span> <span class='word'>which</span> <span class='word'>will</span> <span class='word'>result</span> <span class='word'>in</span> <span class='word'>axes</span> <span class='word'>of</span> <span class='word'>known</span> <span class='word'>length</span><span class='ignore'>.</span> <span class='word'>Because</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>cannot</span> <span class='word'>include</span> <span class='word'>a</span> <span class='word'>translation</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>desire</span> <span class='word'>a</span> <span class='word'>transformation</span> <span class='word'>matrix</span> <span class='word'>which</span> <span class='word'>will</span> <span class='word'>result</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>ranges</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='math'>:</span><span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='ignore'>-</span><span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='math'>{1}2</span><span class='math'>:</span><span class='mathcmd'>\frac</span><span class='math'>{1}2</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='ignore'>-</span><span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='math'>{1}2</span><span class='math'>:</span><span class='mathcmd'>\frac</span><span class='math'>{1}2</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>Such</span> <span class='word'>a</span> <span class='word'>transformation</span> <span class='word'>is</span> <span class='word'>easily</span> <span class='word'>obtained</span> <span class='word'>by</span> <span class='word'>multiplying</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>by</span> <span class='word'>a</span> <span class='word'>diagonal</span> <span class='word'>matrix</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>reciprocal</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>maximums</span> <span class='word'>found</span> <span class='word'>above</span> <span class='word'>placed</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>diagonal</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>will</span> <span class='word'>scale</span> <span class='word'>each</span> <span class='word'>axis</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>unit</span> <span class='word'>length</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>normalized</span> <span class='ignore'>'</span><span class='word'>rotation</span><span class='ignore'>'</span> <span class='word'>matrix</span> <span class='word'>is</span> <span class='word'>given</span> <span class='word'>by</span><span class='ignore'>:</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>NormRxyz3</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\nS</span><span class='option'>[\theta]</span>  <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
 <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\quad</span> <br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>-</span> <span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <br>
 <span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\overline</span><span class='ignore'>{</span><span class='mathcmd'>\R</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>xyz</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\nS</span><span class='option'>[\theta]</span> <span class='mathcmd'>\otimes</span> <span class='math'>R</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>xyz</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
<span class='math'>&amp;</span><span class='math'>=</span><span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>ccc</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\cos</span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span> <span class='math'>-</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span> <br>
&nbsp;  <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\cos</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\cos</span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span>&nbsp; <span class='math'>-</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <br>
&nbsp;  <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\cos</span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span> <span class='math'>-</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\cos</span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span> <span class='math'>-</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <br>
 <span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\sin</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\cos</span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span>&nbsp; <span class='math'>-</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <br>
&nbsp;  <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span>&nbsp; <span class='math'>-</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>This</span> <span class='word'>matrix</span> <span class='word'>is</span> <span class='word'>no</span> <span class='word'>longer</span> <span class='word'>technically</span> <span class='word'>a</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>as</span> <span class='word'>its</span> <span class='word'>inverse</span> <span class='word'>is</span> <span class='word'>no</span> <span class='word'>longer</span> <span class='word'>equal</span> <span class='word'>to</span> <span class='word'>its</span> <span class='word'>transpose</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>now</span> <span class='word'>equal</span> <span class='word'>to</span><span class='ignore'>:</span><br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>NormRxyz3Inverse</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\overline</span><span class='ignore'>{</span><span class='mathcmd'>\R</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>xyz</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>1</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='math'>=</span><br>
<span class='mathcmd'>\left</span><span class='math'>(</span>&nbsp;  <span class='mathcmd'>\inS</span><span class='option'>[\theta]</span> <span class='mathcmd'>\bigotimes</span> <span class='math'>R</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>xyz</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>T</span><span class='ignore'>}</span> <br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Factoring</span> <span class='hword'>the</span> <span class='hword'>Rotation</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>RotationMatrix</span><span class='ignore'>}</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>factored</span> <span class='word'>by</span> <span class='word'>rows</span> <span class='word'>to</span> <span class='word'>give</span> <span class='word'>a</span> <span class='word'>matrix</span> <span class='word'>which</span> <span class='word'>has</span> <span class='word'>one</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>largest</span> <span class='word'>element</span> <span class='word'>in</span> <span class='word'>each</span> <span class='word'>row</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>factorisation</span> <span class='word'>is</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>facilitate</span> <span class='word'>the</span> <span class='word'>quantisation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>The</span> <span class='word'>first</span> <span class='word'>row</span> <span class='word'>is</span> <span class='word'>simply</span> <span class='word'>factored</span> <span class='word'>by</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>give</span> <span class='word'>all</span> <span class='word'>ones</span> <span class='word'>which</span> <span class='word'>fits</span> <span class='word'>our</span> <span class='word'>criteria</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>second</span> <span class='word'>and</span> <span class='word'>third</span> <span class='word'>rows</span> <span class='word'>each</span> <span class='word'>sum</span> <span class='word'>to</span> <span class='word'>zero</span> <span class='ignore'>(</span><span class='mathgroup'>$</span><span class='mathcmd'>\uR</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>[</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='math'>,</span><span class='math'>0</span><span class='math'>,</span><span class='math'>0</span><span class='math'>]</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>vector</span> <span class='word'>of</span> <span class='word'>ones</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>allowing</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>state</span> <span class='word'>that</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>rows</span> <span class='word'>has</span> <span class='word'>one</span> <span class='word'>element</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>opposite</span> <span class='word'>sign</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>other</span> <span class='word'>two</span> <span class='word'>elements</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>discretization</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>and</span> <span class='word'>third</span> <span class='word'>rows</span> <span class='word'>then</span> <span class='word'>only</span> <span class='word'>requires</span> <span class='mathgroup'>$</span><span class='mathcmd'>\rRange</span> <span class='math'>=</span> <span class='math'>2</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\tRange</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>is</span> <span class='word'>also</span> <span class='word'>possible</span> <span class='word'>to</span> <span class='word'>pull</span> <span class='word'>out</span> <span class='word'>common</span> <span class='word'>factors</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>rows</span><span class='ignore'>,</span> <span class='word'>resulting</span> <span class='word'>in</span> <span class='word'>all</span> <span class='word'>elements</span> <span class='word'>taking</span> <span class='word'>values</span> <span class='word'>between</span> <span class='ignore'>-</span><span class='word'>1</span> <span class='word'>and</span> <span class='word'>1</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>RotCommonFactors</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\uR</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='math'>=</span><br>
<span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\bigotimes</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\cos</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span> <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>-</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>-</span> <span class='mathcmd'>\sin</span> <span class='math'>(</span><span class='math'>\theta </span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>-</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>To</span> <span class='word'>facilitate</span> <span class='word'>the</span> <span class='word'>quantization</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>next</span> <span class='word'>factor</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>and</span> <span class='word'>third</span> <span class='word'>rows</span> <span class='word'>such</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>largest</span> <span class='word'>element</span> <span class='word'>of</span> <span class='word'>each</span> <span class='word'>row</span> <span class='word'>equals</span> <span class='word'>exactly</span> <span class='word'>1</span><span class='ignore'>.</span> <span class='word'>As</span> <span class='word'>previously</span> <span class='word'>mentioned</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>largest</span> <span class='word'>element</span> <span class='word'>has</span> <span class='word'>the</span> <span class='word'>opposite</span> <span class='word'>sign</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>other</span> <span class='word'>two</span> <span class='word'>elements</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>row</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>steps</span> <span class='word'>required</span> <span class='word'>to</span> <span class='word'>perform</span> <span class='word'>the</span> <span class='word'>factorization</span> <span class='word'>are</span> <span class='word'>as</span> <span class='word'>follows</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{itemize}</span><br>
<span class='cmd'>\item</span><span class='ignore'>{</span><span class='word'>Find</span> <span class='word'>the</span> <span class='word'>sign</span> <span class='word'>of</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>elements</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='cmd'>\item</span><span class='ignore'>{</span><span class='word'>Determine</span> <span class='word'>which</span> <span class='word'>of</span> <span class='word'>those</span> <span class='word'>elements</span> <span class='word'>is</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>opposite</span> <span class='word'>sign</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='cmd'>\item</span><span class='ignore'>{</span><span class='word'>Factor</span> <span class='word'>each</span> <span class='word'>row</span> <span class='word'>by</span> <span class='word'>that</span> <span class='word'>largest</span> <span class='word'>element</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{itemize}</span><br>
<br>
<span class='word'>The</span> <span class='word'>sign</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>elements</span> <span class='word'>is</span> <span class='word'>most</span> <span class='word'>easily</span> <span class='word'>seen</span> <span class='word'>by</span> <span class='word'>looking</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>as</span> <span class='word'>phase</span> <span class='word'>shifted</span> <span class='word'>sine</span> <span class='word'>functions</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>RRot</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\rR</span><span class='option'>[\theta]</span><span class='math'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\sine</span><span class='ignore'>{</span><span class='math'>\theta </span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\sine</span><span class='ignore'>{</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>3</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\sine</span><span class='ignore'>{</span><span class='math'>\theta </span><span class='math'>-</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\sine</span><span class='ignore'>{</span><span class='math'>\theta </span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\sine</span><span class='ignore'>{</span><span class='math'>\theta </span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>6</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\sine</span><span class='ignore'>{</span><span class='math'>\theta </span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>So</span> <span class='word'>the</span> <span class='word'>signs</span> <span class='word'>look</span> <span class='word'>like</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>MatrixSigns</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\raisebox</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>10mm</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\includegraphics</span><span class='optparm'>[</span><span class='math'>width</span> <span class='math'>=</span> <span class='math'>20mm</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='math'>Chapter2</span><span class='math'>/</span><span class='math'>Figs</span><span class='math'>/</span><span class='math'>SignOfrR21.jpg</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\scalebox</span><span class='ignore'>{</span><span class='math'>0.68</span><span class='ignore'>}</span><span class='option'>[0.9]</span><span class='ignore'>{</span><span class='exclmath'>\(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>11</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\um</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\um</span> <span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='exclmath'>\)</span><span class='ignore'>}</span><br>
 <span class='math'>&amp;</span> <br>
 <span class='mathcmd'>\raisebox</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>10mm</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\includegraphics</span><span class='optparm'>[</span><span class='math'>width</span> <span class='math'>=</span> <span class='math'>20mm</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='math'>Chapter2</span><span class='math'>/</span><span class='math'>Figs</span><span class='math'>/</span><span class='math'>SignOfrR22.jpg</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\scalebox</span><span class='ignore'>{</span><span class='math'>0.68</span><span class='ignore'>}</span><span class='option'>[0.9]</span><span class='ignore'>{</span><span class='exclmath'>\(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\um</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\um</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>3</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
&nbsp; <span class='exclmath'>\)</span><span class='ignore'>}</span><br>
 <span class='math'>&amp;</span> <br>
 <span class='mathcmd'>\raisebox</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>10mm</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\includegraphics</span><span class='optparm'>[</span><span class='math'>width</span> <span class='math'>=</span> <span class='math'>20mm</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='math'>Chapter2</span><span class='math'>/</span><span class='math'>Figs</span><span class='math'>/</span><span class='math'>SignOfrR23.jpg</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\scalebox</span><span class='ignore'>{</span><span class='math'>0.68</span><span class='ignore'>}</span><span class='option'>[0.9]</span><span class='ignore'>{</span><span class='exclmath'>\(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>7</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\um</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\um</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='exclmath'>\)</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\raisebox</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>10mm</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\includegraphics</span><span class='optparm'>[</span><span class='math'>width</span> <span class='math'>=</span> <span class='math'>20mm</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='math'>Chapter2</span><span class='math'>/</span><span class='math'>Figs</span><span class='math'>/</span><span class='math'>SignOfrR31.jpg</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\scalebox</span><span class='ignore'>{</span><span class='math'>0.68</span><span class='ignore'>}</span><span class='option'>[0.9]</span><span class='ignore'>{</span><span class='exclmath'>\(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>4</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\um</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\um</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='exclmath'>\)</span><span class='ignore'>}</span><br>
 <span class='math'>&amp;</span> <br>
<span class='mathcmd'>\raisebox</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>10mm</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\includegraphics</span><span class='optparm'>[</span><span class='math'>width</span> <span class='math'>=</span> <span class='math'>20mm</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='math'>Chapter2</span><span class='math'>/</span><span class='math'>Figs</span><span class='math'>/</span><span class='math'>SignOfrR32.jpg</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\scalebox</span><span class='ignore'>{</span><span class='math'>0.68</span><span class='ignore'>}</span><span class='option'>[0.9]</span><span class='ignore'>{</span><span class='exclmath'>\(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>\pi </span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='math'>0</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='math'>\pi&nbsp; </span><span class='mathcmd'>\\</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
 <span class='exclmath'>\)</span><span class='ignore'>}</span><br>
 <span class='math'>&amp;</span> <br>
&nbsp; <span class='mathcmd'>\raisebox</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>10mm</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\includegraphics</span><span class='optparm'>[</span><span class='math'>width</span> <span class='math'>=</span> <span class='math'>20mm</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='math'>Chapter2</span><span class='math'>/</span><span class='math'>Figs</span><span class='math'>/</span><span class='math'>SignOfrR33.jpg</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
&nbsp;<span class='mathcmd'>\scalebox</span><span class='ignore'>{</span><span class='math'>0.68</span><span class='ignore'>}</span><span class='option'>[0.9]</span><span class='ignore'>{</span><span class='exclmath'>\(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\um</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>\theta </span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='exclmath'>\)</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>Each</span> <span class='word'>row</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>series</span> <span class='word'>of</span> <span class='word'>three</span> <span class='word'>sin</span> <span class='word'>waves</span> <span class='word'>each</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>out</span> <span class='word'>of</span> <span class='word'>phase</span> <span class='word'>with</span> <span class='word'>each</span> <span class='word'>other</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>rows</span> <span class='word'>are</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>out</span> <span class='word'>of</span> <span class='word'>phase</span> <span class='word'>with</span> <span class='word'>each</span> <span class='word'>other</span><span class='ignore'>.</span><br>
<span class='word'>The</span> <span class='word'>largest</span> <span class='word'>element</span> <span class='word'>changes</span> <span class='word'>every</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>radians</span> <span class='word'>repeating</span> <span class='word'>every</span> <span class='mathgroup'>$</span><span class='math'>\pi</span><span class='mathgroup'>$</span> <span class='word'>radians</span><span class='ignore'>.</span><br>
<span class='cmd'>\pagebreak</span><br>
<span class='envir'>\begin</span><span class='envir'>{table}</span><span class='option'>[h]</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <br>
<span class='ignore'>&amp;</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span> <br>
<span class='ignore'>Scale</span> <span class='ignore'>:</span> <span class='exclmath'>$</span><span class='math'>fS</span><span class='math'>[</span><span class='math'>\theta</span><span class='math'>]</span><span class='exclmath'>$</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\raisebox</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='ignore'>13mm</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\includegraphics</span><span class='option'>[width = 26mm]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>fRWheel.jpg</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><br>
<span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>Factored</span> <span class='ignore'>Rotation</span> <span class='ignore'>:</span> <span class='exclmath'>$</span><span class='math'>fR</span><span class='math'>[</span><span class='math'>\theta</span><span class='math'>]</span><span class='exclmath'>$</span> <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <br>
<span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>A</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cos</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span><span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\um</span><span class='exclcmd'>\sec</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\sec</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='ignore'>\theta</span><span class='ignore'>-</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\um</span><span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\secant</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\um</span><span class='exclcmd'>\secant</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\sin</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>B</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\um</span><span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='ignore'>&amp;</span>&nbsp; <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\um</span><span class='exclcmd'>\cos</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\cosecant</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\cosecant</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\um</span><span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\secant</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\um</span><span class='exclcmd'>\secant</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\sin</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span>&nbsp; <span class='exclcmd'>\)</span> <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>C</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\um</span><span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\um</span><span class='exclcmd'>\sin</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\um</span><span class='exclcmd'>\cos</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\cosecant</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\cosecant</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\csc</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\um</span><span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\csc</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>D</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='ignore'>\theta</span><span class='ignore'>-</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\um</span><span class='exclcmd'>\sin</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosecant</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\um</span><span class='exclcmd'>\cos</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\cosecant</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\csc</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>-</span><span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\csc</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>E</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='ignore'>\theta</span><span class='ignore'>-</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\um</span><span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span><span class='exclcmd'>\)</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosecant</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\um</span><span class='exclcmd'>\cos</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\cosecant</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\secant</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\sin</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\um</span><span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\secant</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>F</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span><span class='exclcmd'>\(</span> <br>
<span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cos</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\um</span><span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span><span class='exclcmd'>\)</span>   <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\um</span><span class='exclcmd'>\sec</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\sec</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='exclcmd'>\sine</span><span class='ignore'>{</span><span class='ignore'>\theta</span><span class='ignore'>-</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\secant</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\sin</span> <span class='ignore'>(</span><span class='ignore'>\theta </span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\um</span><span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='ignore'>\theta </span><span class='ignore'>}</span> <span class='exclcmd'>\secant</span><span class='ignore'>{</span><span class='ignore'>\theta </span><span class='ignore'>+</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span>&nbsp; <span class='exclcmd'>\)</span>  <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Table</span> <span class='oword'>of</span> <span class='oword'>factored</span> <span class='oword'>rotation</span> <span class='oword'>matrices</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>tab</span><span class='ignore'>:</span><span class='ignore'>factoredRotationMatrix1</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{table}</span><br>
<br>
<span class='word'>By</span> <span class='word'>defining</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>as</span> <span class='mathgroup'>$</span><span class='math'>\theta&nbsp; </span><span class='math'>=</span> <span class='math'>\Theta </span><span class='math'>+</span> <span class='mathcmd'>\thetaA</span><span class='mathgroup'>$</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='mathcmd'>\thetaA</span> <span class='math'>=</span> <span class='math'>\theta </span><span class='mathcmd'>\!</span><span class='mathcmd'>\!</span><span class='mathcmd'>\mod</span> <span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\Theta</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>starting</span> <span class='word'>value</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>in</span> <span class='word'>which</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>lies</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>and</span> <span class='word'>substituting</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>function</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fRe</span><span class='option'>[\phi]</span> <span class='mathgroup'>$</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>fReDef</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\fRe</span><span class='option'>[\phi]</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\um</span> <span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>1</span><span class='math'>+</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\phi </span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>we</span> <span class='word'>can</span> <span class='word'>now</span> <span class='word'>rewrite</span> <span class='word'>the</span> <span class='word'>factored</span> <span class='word'>rotation</span> <span class='word'>as</span> <span class='word'>shown</span> <span class='word'>in</span> <span class='word'>Table</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>tab</span><span class='ignore'>:</span><span class='ignore'>factoredRotationMatrix</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{table}</span><span class='option'>[h]</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span>&nbsp; <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span> <br>
<span class='exclmath'>$</span><span class='math'>\Theta</span><span class='exclmath'>$</span> <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\raisebox</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='ignore'>13mm</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\includegraphics</span><span class='option'>[width = 26mm]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>fRWheel.jpg</span><span class='ignore'>}</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><span class='ignore'>&amp;</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span> <br>
<span class='ignore'>Scale</span> <span class='ignore'>:</span> <span class='exclmath'>$</span><span class='math'>fS</span><span class='math'>[</span><span class='math'>\theta</span><span class='math'>]</span><span class='exclmath'>$</span> <span class='exclcmd'>\\</span><br>
<span class='exclmath'>$</span><span class='mathcmd'>\fSs</span><span class='option'>[ \theta ]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSe</span><span class='option'>[ \theta ]</span> <span class='exclmath'>$</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><span class='ignore'>&amp;</span>&nbsp; <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span> <br>
<span class='ignore'>Factored</span> <span class='ignore'>Rotation</span> <span class='exclcmd'>\\</span> <span class='exclmath'>$</span><span class='math'>fR</span><span class='math'>[</span><span class='math'>\theta</span><span class='math'>]</span><span class='exclmath'>$</span>&nbsp; <span class='exclcmd'>\\</span> <span class='ignore'>where</span> <span class='exclmath'>$</span><span class='mathcmd'>\thetaA</span> <span class='math'>=</span> <span class='math'>\theta </span><span class='mathcmd'>\!</span><span class='mathcmd'>\!</span><span class='mathcmd'>\mod</span> <span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='exclmath'>$</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <br>
<span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>A</span><span class='ignore'>}</span> <span class='ignore'>:</span> <span class='exclmath'>$</span><span class='math'>0</span><span class='exclmath'>$</span><span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span>  <span class='ignore'>1</span> <span class='exclcmd'>\\</span> <span class='ignore'>1</span><span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\otimes</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span> <span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span><span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>ccc</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span><span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>-</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>B</span><span class='ignore'>}</span> <span class='ignore'>:</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span>  <span class='ignore'>-</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span> <span class='ignore'>1</span><span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\otimes</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span> <span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='ignore'>&amp;</span>&nbsp; <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>ccc</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>-</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span>&nbsp; <span class='exclcmd'>\)</span> <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>C</span><span class='ignore'>}</span> <span class='ignore'>:</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span>  <span class='ignore'>-</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span> <span class='ignore'>-</span><span class='ignore'>1</span><span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\otimes</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span> <span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>ccc</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>-</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>D</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>:</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span>  <span class='ignore'>1</span> <span class='exclcmd'>\\</span> <span class='ignore'>-</span><span class='ignore'>1</span><span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\otimes</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span> <span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>ccc</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>-</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>E</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>:</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span>  <span class='ignore'>1</span> <span class='exclcmd'>\\</span> <span class='ignore'>1</span><span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\otimes</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span> <span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span><span class='exclcmd'>\)</span>  <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span>  <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>ccc</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>-</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\)</span>  <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='exclcmd'>\rule</span><span class='option'>[-2ex]</span><span class='ignore'>{</span><span class='ignore'>0pt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>5.5ex</span><span class='ignore'>}</span> <span class='exclcmd'>\bf</span><span class='ignore'>{</span><span class='ignore'>F</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>:</span> <span class='exclmath'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>&amp;</span><span class='exclcmd'>\(</span> <br>
<span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span>  <span class='ignore'>-</span><span class='ignore'>1</span> <span class='exclcmd'>\\</span> <span class='ignore'>1</span><span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='exclcmd'>\otimes</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>c</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span><span class='ignore'>{</span><span class='exclcmd'>\Pii</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\cosine</span> <span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span><span class='exclcmd'>\)</span>   <span class='ignore'>&amp;</span> <span class='exclcmd'>\(</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='ignore'>ccc</span><span class='ignore'>}</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='exclcmd'>\\</span><br>
 <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>-</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
 <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\fReq</span><span class='ignore'>{</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\!</span><span class='exclcmd'>\right</span><span class='ignore'>)</span>&nbsp; <span class='exclcmd'>\)</span>  <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Simplified</span> <span class='oword'>table</span> <span class='oword'>of</span> <span class='oword'>factored</span> <span class='oword'>rotation</span> <span class='oword'>matrices</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>tab</span><span class='ignore'>:</span><span class='ignore'>factoredRotationMatrix</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{table}</span><br>
<br>
<span class='word'>We</span> <span class='word'>can</span> <span class='word'>now</span> <span class='word'>relate</span> <span class='word'>the</span> <span class='word'>functions</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>other</span><span class='ignore'>,</span> <span class='word'>since</span> <span class='word'>they</span> <span class='word'>are</span> <span class='word'>now</span> <span class='word'>essentially</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>function</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\thetaA</span><span class='mathgroup'>$</span> <span class='word'>has</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>domain</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>they</span> <span class='word'>take</span> <span class='word'>have</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>range</span><span class='ignore'>,</span> <span class='word'>despite</span> <span class='word'>being</span> <span class='word'>in</span> <span class='word'>different</span> <span class='word'>positions</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>matrix</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>write</span> <span class='word'>the</span> <span class='word'>piecewise</span> <span class='word'>function</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fR</span><span class='mathgroup'>$</span> <span class='word'>independently</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>function</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fRO</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>re-orders</span> <span class='word'>the</span> <span class='word'>elements</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>matrix</span> <span class='word'>in</span> <span class='word'>region</span> <span class='mathgroup'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>A</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>appropriately</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>other</span> <span class='word'>regions</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>factoredMatrixDef</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\fR</span><span class='option'>[\theta]</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='option'>[ \fRm, \theta \right]</span>  <span class='math'>&amp;</span> <br>
<span class='mathcmd'>\fRm</span><br>
<span class='math'>&amp;</span> <span class='math'>=</span> <br>
<span class='mathcmd'>\left</span><span class='math'>(</span><span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>fRe</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\thetaA</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>fRe</span><span class='ignore'>}</span> <span class='math'>(</span><span class='math'>-</span><span class='mathcmd'>\thetaA</span> <span class='math'>)</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>fRe</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\thetaA</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>fRe</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\thetaA</span> <span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='comment'>%\begin{align}\label{eq:factoredMatrixDef}</span><br>
<span class='comment'>%\fR[\theta] &amp; = \fRO \left[ \fRm, \theta \right] \\</span><br>
<span class='comment'>%&amp; = \fRO \left[</span><br>
<span class='comment'>%\left(\begin{smallmatrix}</span><br>
<span class='comment'>% 1 &amp; 1 &amp; 1 \\</span><br>
<span class='comment'>% \text{fRe} (\thetaA)&nbsp; &amp; 1 &amp; \text{fRe} (-\thetaA ) \\</span><br>
<span class='comment'>% \text{fRe} \left(\frac{\pi }{6}-\thetaA \right) &amp; \text{fRe} \left(\thetaA -\frac{\pi }{6}\right) &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix}\right) , \theta \right]</span><br>
<span class='comment'>%\end{align}</span><br>
<br>
<span class='word'>The</span> <span class='word'>scaling</span> <span class='word'>factor</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fS</span> <span class='math'>(</span> <span class='mathcmd'>\thetaA</span> <span class='math'>)</span><span class='mathgroup'>$</span> <span class='word'>can</span> <span class='word'>also</span> <span class='word'>be</span> <span class='word'>further</span> <span class='word'>simplified</span> <span class='word'>by</span> <span class='word'>separating</span> <span class='word'>the</span> <span class='word'>sign</span> <span class='word'>and</span> <span class='word'>combining</span> <span class='word'>the</span> <span class='word'>functional</span> <span class='word'>parts</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='mathcmd'>\fSe</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <br>
<span class='math'>&amp;</span><span class='math'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\thetaA</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\thetaA</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\lor</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\lor</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='math'>\pi&nbsp; </span><span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\thetaA</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\thetaA</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='math'>0</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\lor</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span> <span class='math'>&lt;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\lor</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span> <span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<span class='word'>This</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>simplified</span> <span class='word'>into</span> <br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='mathcmd'>\fSe</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span><span class='math'>=</span> <br>
<span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{matrix}</span><br>
 <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{matrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\quad</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>-</span> <span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>then</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fS</span> <span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='math'>=</span> <span class='mathcmd'>\fSe</span> <span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSs</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fSs</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>piecewise</span> <span class='word'>function</span> <span class='word'>containing</span> <span class='word'>the</span> <span class='word'>signs</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>The</span> <span class='word'>scaling</span> <span class='word'>factors</span> <span class='word'>combine</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>normalisation</span> <span class='word'>scaling</span> <span class='word'>factor</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>L</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>found</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>previous</span> <span class='word'>section</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>simple</span> <span class='word'>way</span><br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\nS</span><span class='option'>[\theta]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\rS</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSe</span> <span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span>&nbsp;  <span class='math'>=</span> <br>
<span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>The</span> <span class='word'>fully</span> <span class='word'>factorized</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>can</span> <span class='word'>now</span> <span class='word'>be</span> <span class='word'>written</span> <span class='word'>as</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>TheFactoredRoationMatrix</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\R</span><span class='option'>[\theta]</span> <span class='math'>&amp;</span> <span class='math'>=</span>&nbsp; <span class='mathcmd'>\inS</span><span class='option'>[\theta]</span><span class='mathcmd'>\otimes</span> <span class='mathcmd'>\nS</span><span class='option'>[\theta]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\rS</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSe</span> <span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSs</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\otimes</span><span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='option'>[&nbsp; \fRm, \theta \right]</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
 <span class='word'>and</span> <span class='word'>so</span> <br>
 <br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='mathcmd'>\R</span><span class='option'>[\theta]</span> <br>
<span class='math'>&amp;</span> <span class='math'>=</span>&nbsp; <span class='mathcmd'>\inS</span><span class='option'>[\theta]</span><span class='mathcmd'>\otimes</span> <span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSs</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\otimes</span><span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='option'>[&nbsp; \fRm, \theta \right]</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
<span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span>  <br>
<span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sin</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\cos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
<span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>with</span><span class='ignore'>{</span><span class='mathcmd'>\tiny</span> <span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\quad</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\vartheta</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\theta </span><span class='math'>-</span> <span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\theta</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='mathcmd'>\fRm</span><br>
 <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>fRe</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\thetaA</span><span class='math'>)</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>fRe</span><span class='ignore'>}</span> <span class='math'>(</span><span class='math'>-</span><span class='mathcmd'>\thetaA</span> <span class='math'>)</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>fRe</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\thetaA</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>fRe</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\thetaA</span> <span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='math'>&amp;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>with</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\,</span> <span class='math'>&amp;</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\fRe</span><span class='option'>[\phi]</span> <span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\um</span> <span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>1</span><span class='math'>+</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\phi </span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\thetaA</span> <span class='math'>=</span> <span class='math'>\theta </span><span class='mathcmd'>\!</span><span class='mathcmd'>\!</span><span class='mathcmd'>\mod</span> <span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\one</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\quad</span> <span class='ignore'>1</span> <span class='ignore'>\quad</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\mOne</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>-</span><span class='ignore'>1</span> <span class='ignore'>\ </span><span class='ignore'>}</span><br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>=</span>&nbsp; <br>
<span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='math'>&amp;</span><br>
<span class='mathcmd'>\fSs</span><span class='option'>[\theta ]</span>   <span class='math'>&amp;</span><span class='math'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
&nbsp;<span class='mathcmd'>\one</span> <span class='mathcmd'>\\</span>  <span class='mathcmd'>\one</span> <span class='mathcmd'>\\</span> <span class='mathcmd'>\one</span><span class='mathcmd'>\\</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <br>
 <span class='math'>&amp;</span> <span class='math'>0</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span>&nbsp; <span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
&nbsp; <span class='mathcmd'>\one</span> <span class='mathcmd'>\\</span>  <span class='mathcmd'>\mOne</span> <span class='mathcmd'>\\</span> <span class='mathcmd'>\one</span><span class='mathcmd'>\\</span><br>
&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
&nbsp; <span class='mathcmd'>\right</span><span class='math'>)</span> <br>
&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span>&nbsp; <span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
&nbsp; <span class='mathcmd'>\one</span> <span class='mathcmd'>\\</span>  <span class='mathcmd'>\mOne</span> <span class='mathcmd'>\\</span> <span class='mathcmd'>\mOne</span><span class='mathcmd'>\\</span><br>
&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
&nbsp; <span class='mathcmd'>\right</span><span class='math'>)</span><br>
&nbsp;  <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span>&nbsp; <span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
&nbsp; <span class='mathcmd'>\one</span> <span class='mathcmd'>\\</span>  <span class='mathcmd'>\one</span> <span class='mathcmd'>\\</span> <span class='mathcmd'>\mOne</span><span class='mathcmd'>\\</span><br>
&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
&nbsp; <span class='mathcmd'>\right</span><span class='math'>)</span> <br>
&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span>&nbsp; <span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>A</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>3</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>B</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>3</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>C</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>3</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>,</span> <span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>]</span>&nbsp; <span class='math'>&amp;</span><span class='math'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>A</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>3</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>B</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>3</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>C</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>3</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>0</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>A</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>C</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>B</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>A</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>B</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>C</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>A</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>3</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>C</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>3</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>B</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>3</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>A</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>B</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>C</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>A</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>A</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>C</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>C</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>B</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>&amp;</span> <span class='math'>B</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='math'>\pi 
</span><span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>This</span> <span class='word'>achieves</span> <span class='word'>our</span> <span class='word'>goal</span> <span class='word'>of</span> <span class='word'>factoring</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>such</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>largest</span> <span class='word'>element</span> <span class='word'>of</span> <span class='word'>each</span> <span class='word'>matrix</span> <span class='word'>row</span> <span class='word'>is</span> <span class='word'>one</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Quantizing</span> <span class='hword'>the</span> <span class='hword'>Rotation</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>factored</span> <span class='word'>rotation</span> <span class='mathgroup'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>fR</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>TheFactoredRoationMatrix</span><span class='ignore'>}</span> <span class='word'>contains</span> <span class='word'>4</span> <span class='word'>non-integer</span> <span class='word'>elements</span> <span class='word'>lying</span> <span class='word'>between</span> <span class='mathgroup'>$</span><span class='math'>-</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>we</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>quantize</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='mathcmd'>\R</span><span class='option'>[\theta]</span>  <span class='math'>&amp;</span> <span class='math'>=</span>&nbsp; <span class='mathcmd'>\inS</span><span class='option'>[\theta]</span><span class='mathcmd'>\otimes</span> <span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSs</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\otimes</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>fR</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\textbf</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span> <span class='math'>&amp;</span><span class='mathcmd'>\,</span><span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>fR</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='option'>[&nbsp; \fRm, \theta \right]</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>This</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>done</span> <span class='word'>simply</span> <span class='word'>by</span> <span class='word'>multiplying</span> <span class='word'>it</span> <span class='word'>by</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n</span> <span class='math'>-</span> <span class='math'>2</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='math'>n</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>bit</span> <span class='word'>depth</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>integer</span> <span class='word'>type</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>rounding</span> <span class='word'>the</span> <span class='word'>result</span><span class='ignore'>:</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>quantizedMatrixDef</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\qR</span><span class='option'>[\theta, n]</span> <span class='math'>&amp;</span><span class='math'>=</span><br>
<span class='mathcmd'>\textbf</span><span class='ignore'>{</span><span class='math'>Round</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>[</span><br>
<span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
 <span class='math'>1</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span> <span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='mathcmd'>\bigotimes</span><br>
<span class='mathcmd'>\fR</span><span class='option'>[\theta]</span> <span class='mathcmd'>\right</span><span class='math'>]</span> <br>
<span class='mathcmd'>\quad</span> <span class='math'>&amp;</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>and</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <br>
<span class='mathcmd'>\qS</span><span class='option'>[n]</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>c</span><span class='ignore'>}</span><br>
 <span class='math'>1</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2-n</span> <span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2-n</span> <span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>Since</span> <span class='word'>every</span> <span class='word'>row</span> <span class='word'>in</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fR</span><span class='mathgroup'>$</span> <span class='word'>always</span> <span class='word'>has</span> <span class='word'>an</span> <span class='word'>element</span> <span class='word'>equal</span> <span class='word'>to</span> <span class='word'>1</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>will</span> <span class='word'>exploit</span> <span class='word'>the</span> <span class='word'>full</span> <span class='word'>range</span> <span class='mathgroup'>$</span> <span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\fR</span> <span class='mathcmd'>\le</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>integer</span> <span class='word'>type</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='mathcmd'>\fR</span><span class='option'>[ \theta ]</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\qS</span><span class='option'>[n]</span>  <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\qR</span><span class='option'>[ \theta, n]</span>  <span class='math'>+</span> <span class='mathcmd'>\dqR</span><span class='option'>[ \theta, n ]</span> <span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\qS</span><span class='option'>[n]</span>  <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\qR</span><span class='option'>[ \theta, n ]</span> <span class='math'>+</span>&nbsp; <span class='mathcmd'>\dfR</span><span class='option'>[ \theta, n ]</span> <br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>Thus</span> <span class='word'>far</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>assumed</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>achieve</span> <span class='word'>a</span> <span class='word'>bit</span> <span class='word'>depth</span> <span class='word'>of</span> <span class='word'>two</span> <span class='word'>less</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>bit</span> <span class='word'>depth</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>type</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>representation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>matrix</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>are</span> <span class='word'>now</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>position</span> <span class='word'>to</span> <span class='word'>assess</span> <span class='word'>whether</span> <span class='word'>the</span> <span class='word'>representation</span> <span class='word'>introduces</span> <span class='word'>any</span> <span class='word'>errors</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Given</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>type</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>bit</span> <span class='word'>depth</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>n</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>work</span> <span class='word'>out</span> <span class='word'>any</span> <span class='word'>errors</span> <span class='word'>introduced</span> <span class='word'>by</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>difference</span> <span class='word'>between</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>quantized</span> <span class='word'>rotation</span> <span class='mathgroup'>$</span><span class='mathcmd'>\qR</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>unquantized</span> <span class='word'>rotation</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fR</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>All</span> <span class='word'>the</span> <span class='word'>factoring</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>is</span> <span class='word'>mathematically</span> <span class='word'>exact</span> <span class='word'>up</span> <span class='word'>to</span> <span class='word'>and</span> <span class='word'>including</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fR</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>any</span> <span class='word'>errors</span> <span class='word'>that</span> <span class='word'>are</span> <span class='word'>introduced</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>during</span> <span class='word'>the</span> <span class='word'>rounding</span><span class='ignore'>.</span><br>
<br>
<span class='word'>We</span> <span class='word'>are</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>error</span> <span class='word'>introduced</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>quantization</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>introduce</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dfR</span><span class='option'>[\theta]</span><span class='mathgroup'>$</span> <span class='word'>associated</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>transform</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fR</span><span class='option'>[\theta]</span><span class='mathgroup'>$</span> <span class='word'>produced</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>rounding</span><span class='ignore'>.</span> <span class='word'>Defining</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\fRm</span><span class='option'>[ \theta ]</span> <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\qS</span><span class='option'>[ n ]</span>  <span class='mathcmd'>\otimes</span>  <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\qRm</span><span class='option'>[ \theta, n ]</span>  <span class='math'>+</span> <span class='mathcmd'>\dqRm</span><span class='option'>[ \theta, n ]</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<span class='word'>because</span> <span class='mathgroup'>$</span><span class='mathcmd'>\qS</span><span class='mathgroup'>$</span> <span class='word'>has</span> <span class='word'>equal</span> <span class='word'>elements</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>and</span> <span class='word'>third</span> <span class='word'>rows</span><br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
<span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <span class='mathcmd'>\qS</span><span class='option'>[n]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>A</span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>]</span> <span class='math'>=</span> <span class='mathcmd'>\qS</span><span class='option'>[n]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fRO</span><span class='option'>[ \mathbf{A} ]</span>  <br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<span class='word'>then</span><br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\fR</span><span class='option'>[ \theta ]</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <span class='mathcmd'>\fRm</span><span class='option'>[ \theta ]</span> <span class='mathcmd'>\right</span><span class='math'>]</span> <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <span class='mathcmd'>\qS</span><span class='option'>[ n ]</span>  <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\qRm</span><span class='option'>[ \theta, n ]</span>  <span class='math'>+</span> <span class='mathcmd'>\dqRm</span><span class='option'>[ \theta, n ]</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>]</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\qS</span><span class='option'>[ n ]</span>  <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <span class='mathcmd'>\qRm</span><span class='option'>[ \theta, n ]</span>  <span class='math'>+</span> <span class='mathcmd'>\dqRm</span><span class='option'>[ \theta, n ]</span>  <span class='mathcmd'>\right</span><span class='math'>]</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\qS</span><span class='option'>[ n ]</span>  <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <span class='mathcmd'>\qRm</span><span class='option'>[ \theta, n ]</span>   <span class='mathcmd'>\right</span><span class='math'>]</span>&nbsp; <span class='math'>+</span> <span class='mathcmd'>\qS</span><span class='option'>[ n ]</span>  <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <span class='mathcmd'>\dqRm</span><span class='option'>[ \theta, n ]</span>  <span class='mathcmd'>\right</span><span class='math'>]</span>&nbsp; <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>perturbation</span> <span class='word'>depends</span> <span class='word'>entirely</span> <span class='word'>on</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqRm</span><span class='option'>[\theta,n]</span><span class='mathgroup'>$</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\dqRe</span><span class='option'>[\phi]</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Round</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>[</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span> <span class='mathcmd'>\fRe</span><span class='option'>[\phi ]</span> <span class='mathcmd'>\right</span><span class='math'>]</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><span class='mathcmd'>\fRe</span><span class='option'>[\phi ]</span> <span class='mathcmd'>\\</span><br>
<span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Round</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='option'>[ 2^{n-2} \frac{\um 1}{2} \left(1+\sqrt{3} \tan (\phi )\right)&nbsp; \right]</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\um</span> <span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>1</span><span class='math'>+</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\phi </span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
<span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Round</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='option'>[ 2^{n-3} \right]</span><span class='math'>+</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Round</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='option'>[ 2^{n-3}\sqrt{3} \tan (\phi ) \right]</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\phi </span><span class='math'>)</span><span class='mathcmd'>\\</span><br>
<span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Round</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='option'>[ 2^{n-3}\sqrt{3} \tan (\phi ) \right]</span><span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\phi </span><span class='math'>)</span><span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\dfRe</span><span class='option'>[\phi]</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2-n</span><span class='ignore'>}</span> <span class='mathcmd'>\dqRe</span><span class='option'>[\phi]</span>  <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>perturbation</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqR</span><span class='option'>[\theta]</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>rearrangement</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqRm</span> <span class='math'>=</span> <span class='mathcmd'>\dqR</span><span class='option'>[\thetaA]</span> <span class='mathgroup'>$</span>&nbsp; <span class='word'>where</span> <span class='mathgroup'>$</span><span class='mathcmd'>\thetaA</span> <span class='math'>=</span> <span class='math'>\theta </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span><br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\dqR</span><span class='option'>[\theta]</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\fRO</span><span class='option'>[\dqRm, \theta ]</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>&amp;</span><span class='math'>=</span><br>
 <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
 <span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>              <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='math'>&amp;</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ -\thetaA ]</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span>   <span class='math'>&amp;</span> <span class='mathcmd'>\dqRe</span><span class='option'>[\thetaA-\Pii{6} ]</span> <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='math'>,</span> <span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>]</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>perturbation</span> <span class='word'>introduced</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>channel</span> <span class='word'>is</span> <span class='word'>further</span> <span class='word'>simplified</span> <span class='word'>by</span> <span class='word'>recognizing</span> <span class='word'>that</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fRe</span><span class='option'>[-\phi]</span><span class='math'>=</span><span class='math'>-</span><span class='math'>1</span><span class='math'>-</span><span class='mathcmd'>\fRe</span><span class='option'>[\phi]</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>find</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqRe</span><span class='option'>[-\phi]</span><span class='math'>=</span><span class='math'>-</span><span class='mathcmd'>\dqRe</span><span class='option'>[\phi]</span><span class='mathgroup'>$</span> <span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>sum</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>perturbations</span> <span class='word'>in</span> <span class='word'>each</span> <span class='word'>row</span> <span class='word'>equals</span> <span class='word'>zero</span><span class='ignore'>.</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>analyse</span> <span class='word'>the</span> <span class='word'>quantization</span> <span class='word'>error</span> <span class='word'>in</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>just</span> <span class='word'>one</span> <span class='word'>function</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqRe</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>matrix</span> <span class='word'>ordering</span> <span class='word'>function</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqR</span><span class='option'>[\theta]</span> <span class='math'>=</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <span class='mathcmd'>\dqR</span><span class='option'>[ \thetaA ]</span><span class='math'>,</span> <span class='math'>\theta&nbsp; </span><span class='mathcmd'>\right</span><span class='math'>]</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\dqR</span><span class='option'>[\theta]</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\fROm</span> <span class='mathcmd'>\left</span><span class='math'>[</span>&nbsp; <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
 <span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>              <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span>   <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='mathcmd'>\otimes</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
 <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span>&nbsp; &nbsp; <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span>&nbsp;  <span class='math'>0</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='math'>1</span>&nbsp; <span class='math'>&amp;</span>&nbsp; &nbsp; <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>1</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='math'>1</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>-</span> <span class='math'>1</span>&nbsp; <span class='math'>&amp;</span>&nbsp;  <span class='math'>0</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp; <span class='math'>,</span><span class='math'>\theta </span><span class='mathcmd'>\right</span><span class='math'>]</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\dqEO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <br>
&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp; <span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span><br>
&nbsp; <span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>              <span class='mathcmd'>\\</span><br>
&nbsp; <span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span>   <span class='mathcmd'>\\</span><br>
&nbsp;<span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp; <span class='mathcmd'>\right</span><span class='math'>]</span><br>
&nbsp; <span class='mathcmd'>\otimes</span><br>
&nbsp;<span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span> <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>where</span><br>
<span class='comment'>%\begin{equation}</span><br>
<span class='comment'>%\fROm \left[&nbsp; \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0&nbsp;  &amp; 0&nbsp;  &amp; 0&nbsp; \\</span><br>
<span class='comment'>% a&nbsp;  &amp; 0&nbsp;  &amp; -a \\</span><br>
<span class='comment'>% b &amp; - b &amp; 0&nbsp; &nbsp; \\</span><br>
<span class='comment'>% \end{smallmatrix} </span><br>
<span class='comment'>%\right)&nbsp; ,\theta \right] =</span><br>
<span class='comment'>%\begin{cases}</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% a &amp; 0 &amp; -a \\</span><br>
<span class='comment'>% b &amp; -b &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; 0\leq (\theta&nbsp; \bmod \pi )&lt;\frac{\pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; b &amp; -b \\</span><br>
<span class='comment'>% -a &amp; a &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{6}\leq (\theta&nbsp; \bmod \pi )&lt;\frac{\pi }{3} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; -a &amp; a \\</span><br>
<span class='comment'>% -b &amp; 0 &amp; b \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{3}\leq (\theta&nbsp; \bmod \pi )&lt;\frac{\pi }{2} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% b &amp; -b &amp; 0 \\</span><br>
<span class='comment'>% a &amp; 0 &amp; -a \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{2}\leq (\theta&nbsp; \bmod \pi )&lt;\frac{2 \pi }{3} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -a &amp; a &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; b &amp; -b \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{2 \pi }{3}\leq (\theta&nbsp; \bmod \pi )&lt;\frac{5 \pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -b &amp; 0 &amp; b \\</span><br>
<span class='comment'>% 0 &amp; -a &amp; a \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{5 \pi }{6}\leq (\theta&nbsp; \bmod \pi )&lt;\pi </span><br>
<span class='comment'>%\end{cases}</span><br>
<span class='comment'>%\end{equation}</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='mathcmd'>\dqEO</span><span class='math'>[</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>(</span><br>
&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span> <span class='math'>a</span>&nbsp;  <span class='mathcmd'>\\</span> <span class='math'>b</span>&nbsp; <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='math'>,</span><span class='math'>\theta </span><span class='math'>]</span> <span class='math'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>0</span> <span class='mathcmd'>\\</span> <span class='math'>a</span>&nbsp; <span class='mathcmd'>\\</span> <span class='math'>b</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>0</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>0</span> <span class='mathcmd'>\\</span> <span class='math'>b</span>&nbsp; <span class='mathcmd'>\\</span> <span class='math'>a</span> <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='math'>)</span> <span class='math'>&lt;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>perturbationFunctionSigns</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span> <span class='math'>=</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>0</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>-</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>5</span> <span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathcmd'>\leq</span> <span class='math'>(</span><span class='math'>\theta&nbsp; </span><span class='mathcmd'>\bmod</span> <span class='math'>\pi </span><span class='math'>)</span><span class='math'>&lt;</span><span class='math'>\pi 
</span><span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>We</span> <span class='word'>can</span> <span class='word'>now</span> <span class='word'>express</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>and</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>channel</span> <span class='word'>elements</span> <span class='word'>themselves</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>structure</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\fROm</span><span class='mathgroup'>$</span> <span class='word'>means</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>channel</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>either</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span><span class='mathgroup'>$</span> <span class='word'>or</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span><span class='mathgroup'>$</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>difference</span> <span class='word'>between</span> <span class='word'>two</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span><span class='ignore'>.</span> <span class='word'>Given</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>are</span> <span class='word'>positive</span><span class='ignore'>,</span> <span class='word'>being</span> <span class='word'>unsigned</span> <span class='word'>integers</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>extreme</span> <span class='word'>values</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>are</span> <span class='word'>when</span> <span class='word'>one</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>is</span> <span class='word'>zero</span><span class='ignore'>.</span><br>
<br>
<span class='comment'>%\begin{align}</span><br>
<span class='comment'>%\nR[\theta]&nbsp; &amp; = \vec{S}&nbsp; \otimes \fSs(\theta) \otimes \fRO \left[&nbsp; \fRm, \theta \right] \\</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &amp; = \vec{S}&nbsp; \otimes \fSs(\theta) \otimes\qS[ n ] \otimes \fRO \left[ \qRm[ \theta, n ]&nbsp; + \dqRm[ \theta, n ]&nbsp; , \theta\right]</span><br>
<span class='comment'>%\end{align}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='mathcmd'>\nR</span><span class='option'>[\theta]</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\nRa</span><span class='option'>[\theta]</span><span class='math'>+</span><span class='mathcmd'>\dnR</span><span class='option'>[\theta]</span> <span class='mathcmd'>\\</span> <br>
<span class='mathcmd'>\textbf</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span>  <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\nRa</span><span class='option'>[\theta]</span>   <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSs</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\otimes</span><span class='mathcmd'>\qS</span><span class='option'>[ n ]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span>&nbsp;  <span class='mathcmd'>\qRm</span><span class='option'>[ \theta, n ]</span> <span class='math'>,</span> <span class='math'>\theta</span><span class='mathcmd'>\right</span><span class='math'>]</span>&nbsp;  <span class='mathcmd'>\\</span><br>
<span class='comment'>% \dnR[\theta]&nbsp;  &amp;=&nbsp; \vec{S}&nbsp; \otimes \fSs(\theta) \otimes\qS[ n ] \otimes \fRO \left[ \dqRm[ \theta, n ] , \theta\right]&nbsp; \\</span><br>
<span class='mathcmd'>\dnR</span><span class='option'>[\theta]</span>   <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSs</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\otimes</span><span class='mathcmd'>\qS</span><span class='option'>[ n ]</span> <span class='mathcmd'>\otimes</span> <br>
<span class='mathcmd'>\dqEO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>0</span> <span class='mathcmd'>\\</span>  <span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>  <span class='mathcmd'>\\</span>  <span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span>   <span class='mathcmd'>\\</span> <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>]</span> <span class='mathcmd'>\otimes</span><br>
 <span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span>  <span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>dnR</span><span class='math'>_</span><span class='math'>Expanded</span><span class='math'>_</span><span class='math'>and</span><span class='math'>_</span><span class='math'>Quantised</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
 <br>
<br>
<span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>channel</span> <span class='word'>elements</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dW</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>for</span> <span class='word'>an</span> <span class='word'>input</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='mathgroup'>$</span><span class='mathcmd'>\rgb</span><span class='math'>=</span> <span class='math'>2</span><span class='math'>^</span><span class='math'>n</span><span class='mathcmd'>\normed</span><span class='ignore'>{</span><span class='mathcmd'>\rgb</span><span class='ignore'>}</span> <span class='mathgroup'>$</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='math'>0</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\normed</span><span class='ignore'>{</span><span class='mathcmd'>\rgb</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\le</span> <span class='math'>1</span><span class='mathgroup'>$</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\w</span><span class='math'>+</span><span class='mathcmd'>\dW</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\nRa</span><span class='option'>[\theta]</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\rgb</span><span class='math'>+</span><span class='mathcmd'>\dnR</span><span class='option'>[\theta]</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\rgb</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\dW</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\dnR</span><span class='option'>[\theta]</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\normed</span><span class='ignore'>{</span><span class='mathcmd'>\rgb</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>Expanding</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dnR</span><span class='option'>[\theta]</span> <span class='mathgroup'>$</span> <span class='word'>using</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>dnR</span><span class='ignore'>_</span><span class='ignore'>Expanded</span><span class='ignore'>_</span><span class='ignore'>and</span><span class='ignore'>_</span><span class='ignore'>Quantised</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>thePerturbationToTheRotatedChannelElements</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\dW</span>  <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\vec</span><span class='ignore'>{</span><span class='math'>S</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\otimes</span><span class='mathcmd'>\qS</span><span class='option'>[ n ]</span>  <span class='mathcmd'>\otimes</span> <br>
<span class='mathcmd'>\fSs</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathcmd'>\otimes</span> <br>
<span class='mathcmd'>\dqEO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><span class='math'>0</span>&nbsp;  <span class='mathcmd'>\\</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>  <span class='mathcmd'>\\</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span>  <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>]</span> <span class='mathcmd'>\otimes</span> <br>
<span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span>  <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\normed</span><span class='ignore'>{</span><span class='mathcmd'>\rgb</span><span class='ignore'>}</span>&nbsp; <br>
<span class='mathcmd'>\\</span><br>
<span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span>  <span class='math'>2</span> <span class='mathcmd'>\\</span>  <span class='math'>2</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\dqEO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>              <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span>   <br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSs</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\normed</span><span class='ignore'>{</span><span class='mathcmd'>\rgb</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\dqEO</span> <span class='mathcmd'>\left</span><span class='math'>[</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
 <span class='math'>0</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span><br>
 <span class='math'>2</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>              <span class='mathcmd'>\\</span><br>
 <span class='math'>2</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span>   <br>
<span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><br>
<span class='mathcmd'>\right</span><span class='math'>]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fSs</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\dqs</span><span class='option'>[\theta]</span> <span class='mathcmd'>\cdot</span> <span class='mathcmd'>\normed</span><span class='ignore'>{</span><span class='mathcmd'>\rgb</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<br>
<span class='comment'>%&nbsp;  % Checks for the scaling products.</span><br>
<span class='comment'>%\begin{align*}</span><br>
<span class='comment'>%2^n \, \vec{S}&nbsp; \otimes \qS[n] </span><br>
<span class='comment'>% &amp;= 2^n \, \left( \begin{smallmatrix}&nbsp; \frac{1}{3}&nbsp; \\&nbsp; \frac{1}{2}&nbsp; \\&nbsp; \frac{1}{2}&nbsp; \\ \end{smallmatrix} \right)&nbsp; \otimes </span><br>
<span class='comment'>% \left( \begin{smallmatrix} 1&nbsp; \\&nbsp; 2^{2-n } \\&nbsp; 2^{2-n }&nbsp; \\ \end{smallmatrix} \right)&nbsp; \\ </span><br>
<span class='comment'>%&amp;= \left( \begin{smallmatrix} \frac{2^n}{3}&nbsp; \\ 2 \\ 2 \\ \end{smallmatrix} \right)</span><br>
<span class='comment'>%\end{align*}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{align}</span><br>
<span class='comment'>%\fSs[\theta ]&nbsp;  &amp;=</span><br>
<span class='comment'>%\begin{cases}</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>% \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; \one \\&nbsp; \one \\ \one\\</span><br>
<span class='comment'>% \end{smallmatrix} </span><br>
<span class='comment'>% \right)&nbsp; </span><br>
<span class='comment'>% &amp; 0\leq (\theta&nbsp; \bmod \frac{2 \pi }{3}&nbsp; )&lt;\frac{\pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%&nbsp; \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp;  \one \\&nbsp; \mOne \\ \one\\</span><br>
<span class='comment'>%&nbsp; \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp; \right) </span><br>
<span class='comment'>%&nbsp; &amp; \frac{\pi }{6}\leq (\theta&nbsp; \bmod \frac{2 \pi }{3}&nbsp; )&lt;\frac{\pi }{3} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%&nbsp; \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp;  \one \\&nbsp; \mOne \\ \mOne\\</span><br>
<span class='comment'>%&nbsp; \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp; \right)</span><br>
<span class='comment'>%&nbsp;  &amp; \frac{\pi }{3}\leq (\theta&nbsp; \bmod \frac{2 \pi }{3}&nbsp; )&lt;\frac{\pi }{2} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%&nbsp; \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp;  \one \\&nbsp; \one \\ \mOne\\</span><br>
<span class='comment'>%&nbsp; \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp; \right) </span><br>
<span class='comment'>%&nbsp; &amp; \frac{\pi }{2}\leq (\theta&nbsp; \bmod \frac{2 \pi }{3}&nbsp; )&lt;\frac{2 \pi }{3} </span><br>
<span class='comment'>%\end{cases} \\</span><br>
<span class='comment'>%\dqs[\theta] &amp;=</span><br>
<span class='comment'>%\begin{cases}</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; 0 &amp; -1 \\</span><br>
<span class='comment'>% 1 &amp; -1 &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; 0\leq (\theta&nbsp; \bmod \pi )&lt;\frac{\pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; 1 &amp; -1 \\</span><br>
<span class='comment'>% -1 &amp; 1 &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{6}\leq (\theta&nbsp; \bmod \pi )&lt;\frac{\pi }{3} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; -1 &amp; 1 \\</span><br>
<span class='comment'>% -1 &amp; 0 &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{3}\leq (\theta&nbsp; \bmod \pi )&lt;\frac{\pi }{2} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; -1 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; 0 &amp; -1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{2}\leq (\theta&nbsp; \bmod \pi )&lt;\frac{2 \pi }{3} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 1 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; 1 &amp; -1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{2 \pi }{3}\leq (\theta&nbsp; \bmod \pi )&lt;\frac{5 \pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 0 &amp; 1 \\</span><br>
<span class='comment'>% 0 &amp; -1 &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{5 \pi }{6}\leq (\theta&nbsp; \bmod \pi )&lt;\pi </span><br>
<span class='comment'>%\end{cases} \\</span><br>
<span class='comment'>%\end{align}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{align}</span><br>
<span class='comment'>%\fSs[\theta ]&nbsp; \otimes \dqs[\theta] &amp;=</span><br>
<span class='comment'>%\begin{cases}</span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>% \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; \one \\&nbsp; \one \\ \one\\</span><br>
<span class='comment'>% \end{smallmatrix} </span><br>
<span class='comment'>% \right)&nbsp; \otimes </span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; 0 &amp; -1 \\</span><br>
<span class='comment'>% 1 &amp; -1 &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; 0\leq \theta&lt;\frac{\pi }{6} \\</span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>%&nbsp; \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp;  \one \\&nbsp; \mOne \\ \one\\</span><br>
<span class='comment'>%&nbsp; \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp; \right) \otimes \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; 1 &amp; -1 \\</span><br>
<span class='comment'>% -1 &amp; 1 &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{6}\leq \theta&lt;\frac{\pi }{3} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%&nbsp;  \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; &nbsp; \one \\&nbsp; \mOne \\ \mOne\\</span><br>
<span class='comment'>%&nbsp;  \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp;  \right) \otimes \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; -1 &amp; 1 \\</span><br>
<span class='comment'>% -1 &amp; 0 &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{3}\leq \theta&lt;\frac{\pi }{2} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%&nbsp;  \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; &nbsp; \one \\&nbsp; \one \\ \mOne\\</span><br>
<span class='comment'>%&nbsp;  \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp;  \right) \otimes </span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; -1 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; 0 &amp; -1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{2}\leq \theta&lt;\frac{2 \pi }{3} \\</span><br>
<span class='comment'>%%</span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>% \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; \one \\&nbsp; \one \\ \one\\</span><br>
<span class='comment'>% \end{smallmatrix} </span><br>
<span class='comment'>% \right)&nbsp; \otimes </span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 1 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; 1 &amp; -1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{2 \pi }{3}\leq \theta&lt;\frac{5 \pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%&nbsp;  \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; &nbsp; \one \\&nbsp; \mOne \\ \one\\</span><br>
<span class='comment'>%&nbsp;  \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp;  \right) \otimes </span><br>
<span class='comment'>%&nbsp;  \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 0 &amp; 1 \\</span><br>
<span class='comment'>% 0 &amp; -1 &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{5 \pi }{6}\leq \theta&lt;\pi \\</span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>%&nbsp;  \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; &nbsp; \one \\&nbsp; \mOne \\ \mOne\\</span><br>
<span class='comment'>%&nbsp;  \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp;  \right) \otimes </span><br>
<span class='comment'>%&nbsp;  \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; 0 &amp; -1 \\</span><br>
<span class='comment'>% 1 &amp; -1 &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \pi \leq \theta&lt;\frac{7 \pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%&nbsp; &nbsp; \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; &nbsp;  \one \\&nbsp; \one \\ \mOne\\</span><br>
<span class='comment'>%&nbsp; &nbsp; \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp; &nbsp; \right) \otimes </span><br>
<span class='comment'>%&nbsp; &nbsp; \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; 1 &amp; -1 \\</span><br>
<span class='comment'>% -1 &amp; 1 &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{7 \pi }{6}\leq \theta&lt;\frac{8 \pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%&nbsp; \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp;  \one \\&nbsp; \one \\ \one\\</span><br>
<span class='comment'>%&nbsp; \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp; \right)&nbsp; \otimes </span><br>
<span class='comment'>%&nbsp; \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; -1 &amp; 1 \\</span><br>
<span class='comment'>% -1 &amp; 0 &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{8 \pi }{6}\leq \theta&lt;\frac{9 \pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%&nbsp;  \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; &nbsp; \one \\&nbsp; \mOne \\ \one\\</span><br>
<span class='comment'>%&nbsp;  \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp;  \right) \otimes \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; -1 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; 0 &amp; -1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{9 \pi }{6}\leq \theta&lt;\frac{10 \pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%&nbsp; &nbsp; \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; &nbsp;  \one \\&nbsp; \mOne \\ \mOne\\</span><br>
<span class='comment'>%&nbsp; &nbsp; \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp; &nbsp; \right) \otimes </span><br>
<span class='comment'>%&nbsp; &nbsp; \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 1 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; 1 &amp; -1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{10 \pi }{6}\leq \theta&lt;\frac{11 \pi }{6} \\</span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>%&nbsp;  \begin{smallmatrix}</span><br>
<span class='comment'>%&nbsp; &nbsp; \one \\&nbsp; \one \\ \mOne\\</span><br>
<span class='comment'>%&nbsp;  \end{smallmatrix} </span><br>
<span class='comment'>%&nbsp;  \right) \otimes \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 0 &amp; 1 \\</span><br>
<span class='comment'>% 0 &amp; -1 &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{11 \pi }{6}\leq \theta&lt; 2 \pi </span><br>
<span class='comment'>%\end{cases} </span><br>
<span class='comment'>%\end{align}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{align}</span><br>
<span class='comment'>%\fSs[\theta ]&nbsp; \otimes \dqs[\theta] &amp;=</span><br>
<span class='comment'>%\begin{cases}</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; 0 &amp; -1 \\</span><br>
<span class='comment'>% 1 &amp; -1 &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; 0\leq \theta&lt;\frac{\pi }{6} \\</span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; -1 &amp; 1 \\</span><br>
<span class='comment'>% -1 &amp; 1 &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{6}\leq \theta&lt;\frac{\pi }{3} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; 1 &amp; -1 \\</span><br>
<span class='comment'>% 1 &amp; 0 &amp; -1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{3}\leq \theta&lt;\frac{\pi }{2} \\</span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; -1 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 0 &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{\pi }{2}\leq \theta&lt;\frac{2 \pi }{3} \\</span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 1 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; 1 &amp; -1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{2 \pi }{3}\leq \theta&lt;\frac{5 \pi }{6} \\</span><br>
<span class='comment'>%&nbsp;  \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; 0 &amp; -1 \\</span><br>
<span class='comment'>% 0 &amp; -1 &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{5 \pi }{6}\leq \theta&lt;\pi \\ </span><br>
<span class='comment'>%&nbsp;  \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 0 &amp; 1 \\</span><br>
<span class='comment'>% -1 &amp; 1 &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \pi \leq \theta&lt;\frac{7 \pi }{6} \\</span><br>
<span class='comment'>%&nbsp; &nbsp; \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; 1 &amp; -1 \\</span><br>
<span class='comment'>% 1 &amp; -1 &amp; 0 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{7 \pi }{6}\leq \theta&lt;\frac{8 \pi }{6} \\ </span><br>
<span class='comment'>%&nbsp; \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; -1 &amp; 1 \\</span><br>
<span class='comment'>% -1 &amp; 0 &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{8 \pi }{6}\leq \theta&lt;\frac{9 \pi }{6} \\</span><br>
<span class='comment'>% \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 1 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; 0 &amp; -1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{9 \pi }{6}\leq \theta&lt;\frac{10 \pi }{6} \\</span><br>
<span class='comment'>%&nbsp; &nbsp; \left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% 1 &amp; -1 &amp; 0 \\</span><br>
<span class='comment'>% 0 &amp; -1 &amp; 1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{10 \pi }{6}\leq \theta&lt;\frac{11 \pi }{6} \\</span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>%\begin{smallmatrix}</span><br>
<span class='comment'>% 0 &amp; 0 &amp; 0 \\</span><br>
<span class='comment'>% -1 &amp; 0 &amp; 1 \\</span><br>
<span class='comment'>% 0 &amp; 1 &amp; -1 \\</span><br>
<span class='comment'>%\end{smallmatrix} </span><br>
<span class='comment'>%\right) &amp; \frac{11 \pi }{6}\leq \theta&lt; 2 \pi </span><br>
<span class='comment'>%\end{cases} </span><br>
<span class='comment'>%\end{align}</span><br>
<br>
<br>
<span class='word'>So</span><span class='ignore'>,</span> <span class='word'>to</span> <span class='word'>minimize</span> <span class='word'>the</span> <span class='word'>perturbation</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>simultaneously</span> <span class='word'>minimize</span> <span class='mathgroup'>$</span><span class='mathcmd'>\pm</span> <span class='math'>2</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>  <span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\pm</span> <span class='math'>2</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span><span class='mathgroup'>$</span><br>
<br>
<br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.99\textwidth]{Chapter2/Figs/PtbToChanBoth.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{Perturbation in the chromatic channels.}&nbsp; \label{fig:PtbToChan}</span><br>
<span class='comment'>%\end{figure}</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{sidewaysfigure}</span><span class='option'>[p]</span><br>
&nbsp;<span class='cmd'>\centering</span><br>
&nbsp;&nbsp;<span class='cmd'>\includegraphics</span><span class='optparm'>[</span><span class='ignore'>width</span><span class='ignore'>=</span><span class='ignore'>0.99</span><span class='exclcmd'>\textwidth</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>PtbToChanBothWithPoints.jpg</span><span class='ignore'>}</span><br>
&nbsp;&nbsp;<span class='cmd'>\caption</span><span class='ignore'>{</span> <span class='oword'>Perturbation</span> <span class='oword'>to</span> <span class='oword'>channels</span> <span class='oword'>a</span> <span class='oword'>and</span> <span class='oword'>b</span> <span class='oword'>against</span> <span class='oword'>angle</span> <span class='mathgroup'>$</span><span class='mathcmd'>\thetaA</span><span class='mathgroup'>$</span> <span class='cmd'>\\</span><br>
&nbsp;&nbsp;<span class='oword'>For</span> <span class='oword'>n</span> <span class='ignore'>=</span> <span class='oword'>8</span>&nbsp; <span class='oword'>with</span> <span class='mathgroup'>$</span><span class='math'>\iota</span><span class='mathgroup'>$</span> <span class='oword'>regions</span> <span class='oword'>shaded</span> <span class='oword'>and</span> <span class='oword'>extrema</span> <span class='oword'>labelled</span> <span class='ignore'>}</span>  <span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PtbToChan</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{sidewaysfigure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>maxima</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>function</span> <span class='word'>are</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='mathcmd'>\pm</span> <span class='math'>2</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>  <span class='math'>=</span> <span class='mathcmd'>\pm</span> <span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\pm</span> <span class='math'>2</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span><span class='math'>=</span> <span class='mathcmd'>\pm</span> <span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>minima</span> <span class='word'>are</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='mathcmd'>\pm</span> <span class='math'>2</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \thetaA ]</span>  <span class='math'>=</span> <span class='math'>0</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\pm</span> <span class='math'>2</span> <span class='mathcmd'>\dqRe</span><span class='option'>[ \Pii{6} -\thetaA]</span> <span class='math'>=</span> <span class='math'>0</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>corresponding</span> <span class='word'>values</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\thetaA</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>all</span> <span class='word'>that</span> <span class='word'>is</span> <span class='word'>needed</span> <span class='word'>is</span> <span class='word'>an</span> <span class='word'>inverse</span> <span class='word'>function</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqRe</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>essence</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dqRe</span><span class='option'>[\phi]</span><span class='mathgroup'>$</span> <span class='word'>discretizes</span> <span class='mathgroup'>$</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\phi </span><span class='math'>)</span><span class='mathgroup'>$</span> <span class='word'>into</span> <span class='word'>steps</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>3-n</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>minima</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>inverse</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\phi </span><span class='math'>)</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>given</span> <span class='word'>that</span><br>
<span class='mathgroup'>$</span><span class='math'>0</span><span class='mathcmd'>\le</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\phi </span><span class='math'>)</span><span class='mathcmd'>\le</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>0</span> <span class='mathcmd'>\le</span> <span class='math'>\phi </span><span class='mathcmd'>\le</span> <span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>say</span> <span class='word'>that</span> <span class='mathgroup'>$</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Round</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='option'>[ 2^{n-3}\sqrt{3} \tan (\phi ) \right]</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span> <span class='math'>0</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>,</span> <span class='mathcmd'>\cdots</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span> <span class='math'>\}</span><span class='mathgroup'>$</span> <br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\dqRe</span><span class='option'>[\phi]</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='math'>0</span> <span class='math'>&amp;</span> <span class='mathcmd'>\dqRe</span><span class='option'>[\Pii{6}-\phi]</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='math'>0</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>when</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='comment'>% 2^{n-3}\sqrt{3} \tan (\phi ) &amp;= \text{Round}\left[ 2^{n-3}\sqrt{3} \tan (\phi ) \right]&nbsp; &amp; </span><br>
<span class='comment'>% 2^{n-3}\sqrt{3} \tan (\Pii{6}-\phi ) &amp;= \text{Round}\left[ 2^{n-3}\sqrt{3} \tan (\Pii{6}-\phi ) \right]\\</span><br>
<span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\phi </span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='math'>m</span> <span class='math'>&amp;</span> <br>
<span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='mathcmd'>\Pii</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>\phi </span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>m</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span><span class='mathcmd'>\quad</span> <span class='math'>m</span><span class='math'>=</span><span class='math'>0</span><span class='math'>,</span><span class='math'>1</span><span class='math'>,</span><span class='math'>2</span> <span class='mathcmd'>\cdots</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>&amp;</span> <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>m</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>3-n</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span><br>
 <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>&amp;</span> <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='math'>m</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='math'>-</span> <span class='math'>2</span> <span class='math'>m</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>maxima</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>recognizing</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>rounding</span> <span class='word'>error</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>half</span> <span class='word'>and</span> <span class='word'>evaluating</span> <span class='word'>at</span> <span class='word'>these</span> <span class='word'>points</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='mathcmd'>\dqRe</span><span class='option'>[\maximaTheta{b} ]</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\pm</span> <span class='math'>1</span> <span class='math'>&amp;</span> <span class='mathcmd'>\dqRe</span><span class='option'>[\Pii{6}-\maximaTheta{a} ]</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\pm</span> <span class='math'>1</span>&nbsp; <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>when</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>=</span><span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>3-n</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>m</span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span><br>
<span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>m</span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='math'>-</span> <span class='math'>2</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>m</span><span class='math'>+</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>2</span> <span class='math'>m</span><span class='math'>+</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2-n</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span><br>
&nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='math'>(</span><span class='math'>2</span> <span class='math'>m</span><span class='math'>+</span><span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n-2</span> <span class='math'>m-1</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\quad</span><span class='math'>&amp;</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>with</span><span class='ignore'>}</span><span class='mathcmd'>\quad</span>   <span class='math'>m</span> <span class='math'>=</span>&nbsp; <span class='math'>0</span><span class='math'>,</span><span class='math'>1</span><span class='math'>,</span><span class='math'>2</span><span class='math'>,</span><span class='math'>3</span> <span class='mathcmd'>\cdots</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span> <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>We</span> <span class='word'>are</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>compromise</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>perturbations</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>channel</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>perturbations</span> <span class='word'>intersect</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>useful</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>able</span> <span class='word'>to</span> <span class='word'>assign</span> <span class='word'>a</span> <span class='word'>relative</span> <span class='word'>importance</span> <span class='mathgroup'>$</span><span class='math'>\alpha</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\beta</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>channel</span> <span class='word'>a</span> <span class='word'>and</span> <span class='word'>b</span> <span class='word'>respectively</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{gather*}</span><br>
<span class='word'>\beta </span><span class='cmd'>\;</span> <span class='cmd'>\dqRe</span><span class='option'>[\phi]</span> <span class='ignore'>=</span> <span class='word'>\alpha </span><span class='cmd'>\;</span> <span class='cmd'>\dqRe</span><span class='option'>[\frac{\pi}{6} -\phi]</span>  <span class='cmd'>\quad</span> <span class='cmd'>\textbf</span><span class='ignore'>{</span><span class='word'>when</span><span class='ignore'>}</span> <span class='cmd'>\\</span><br>
<span class='envir'>\begin</span><span class='envir'>{split}</span><br>
<span class='word'>\beta </span><span class='cmd'>\text</span><span class='ignore'>{</span><span class='word'>Round</span><span class='ignore'>}</span><span class='cmd'>\left</span><span class='option'>[ 2^{n-3}\sqrt{3} \tan (\phi ) \right]</span> <span class='ignore'>-</span> <span class='word'>\alpha </span><span class='cmd'>\text</span><span class='ignore'>{</span><span class='word'>Round</span><span class='ignore'>}</span><span class='cmd'>\left</span><span class='option'>[ 2^{n-3}\sqrt{3} \tan (\frac{\pi}{6} - \phi ) \right]</span> <span class='cmd'>\\</span><br>
<span class='ignore'>=</span>&nbsp;  <span class='word'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>n-3</span><span class='ignore'>}</span> <span class='cmd'>\left</span><span class='ignore'>(</span><span class='cmd'>\sqrt</span><span class='ignore'>{</span><span class='word'>3</span><span class='ignore'>}</span> <span class='word'>\alpha&nbsp; </span><span class='cmd'>\tan</span> <span class='ignore'>(</span><span class='word'>\theta </span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='word'>2</span> <span class='word'>\beta&nbsp; </span><span class='cmd'>\sin</span> <span class='ignore'>(</span><span class='word'>\theta </span><span class='ignore'>)</span> <span class='cmd'>\sec</span> <span class='cmd'>\left</span><span class='ignore'>(</span><span class='cmd'>\frac</span><span class='ignore'>{</span><span class='word'>\pi </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='word'>6</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='word'>\theta </span><span class='cmd'>\right</span><span class='ignore'>)</span><span class='cmd'>\right</span><span class='ignore'>)</span><br>
<span class='envir'>\end</span><span class='envir'>{split}</span><br>
<span class='envir'>\end</span><span class='envir'>{gather*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>values</span> <span class='mathgroup'>$</span><span class='math'>\alpha</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\beta</span><span class='mathgroup'>$</span> <span class='word'>can</span> <span class='word'>only</span> <span class='word'>move</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>of</span> <span class='word'>intersection</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>bounds</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>extrema</span><span class='ignore'>.</span> <span class='word'>Therefore</span><span class='ignore'>,</span> <span class='word'>any</span> <span class='word'>solution</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>of</span> <span class='word'>intersection</span> <span class='word'>will</span> <span class='word'>enable</span> <span class='word'>the</span> <span class='word'>bounding</span> <span class='word'>extrema</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>identified</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>We</span> <span class='word'>solve</span> <span class='word'>first</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='math'>\alpha</span><span class='math'>=</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\beta</span><span class='math'>=</span><span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>Recognizing</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>rounded</span> <span class='word'>part</span> <span class='word'>can</span> <span class='word'>only</span> <span class='word'>take</span> <span class='word'>certain</span> <span class='word'>values</span><br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='math'>i</span> <span class='math'>=</span>&nbsp; <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Round</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='option'>[ 2^{n-3}\sqrt{3} \tan (\phi ) \right]</span> <span class='math'>-</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Round</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='option'>[ 2^{n-3}\sqrt{3} \tan (\frac{\pi}{6} - \phi ) \right]</span><br>
 <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span><span class='mathcmd'>\quad</span> <span class='math'>i</span><span class='math'>=</span><span class='math'>0</span><span class='math'>,</span><span class='math'>1</span><span class='math'>,</span><span class='math'>2</span> <span class='mathcmd'>\cdots</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><br>
 <span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<span class='word'>then</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{gather*}</span><br>
<span class='cmd'>\thetaX</span><span class='ignore'>{</span><span class='word'>i</span><span class='ignore'>}</span><span class='ignore'>=</span><span class='cmd'>\arctan</span><span class='cmd'>\left</span><span class='ignore'>(</span><span class='cmd'>\frac</span><span class='ignore'>{</span><span class='cmd'>\sqrt</span><span class='ignore'>{</span><span class='word'>i</span><span class='ignore'>^</span><span class='word'>2</span> <span class='word'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>6-2</span> <span class='word'>n</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='word'>i</span> <span class='word'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>4-n</span><span class='ignore'>}</span><span class='ignore'>+</span><span class='word'>49</span><span class='ignore'>}</span><span class='ignore'>+</span><span class='word'>i</span> <span class='word'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>3-n</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='word'>7</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='word'>2</span> <span class='cmd'>\sqrt</span><span class='ignore'>{</span><span class='word'>3</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='cmd'>\right</span><span class='ignore'>)</span> <span class='cmd'>\quad</span> <span class='cmd'>\text</span><span class='ignore'>{</span><span class='word'>where</span><span class='ignore'>}</span><span class='cmd'>\quad</span> <span class='word'>i</span><span class='ignore'>=</span><span class='word'>0</span><span class='ignore'>,</span><span class='word'>1</span><span class='ignore'>,</span><span class='word'>2</span> <span class='cmd'>\cdots</span> <span class='word'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>n-2</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{gather*}</span><br>
<br>
<span class='word'>Each</span> <span class='word'>point</span> <span class='word'>of</span> <span class='word'>intersection</span> <span class='word'>is</span> <span class='word'>defined</span> <span class='word'>and</span> <span class='word'>bounded</span> <span class='word'>by</span> <span class='word'>4</span> <span class='word'>extrema</span><span class='ignore'>.</span> <span class='word'>Comparing</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>functional</span> <span class='word'>form</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>extrema</span> <span class='word'>allows</span> <span class='word'>these</span> <span class='word'>4</span> <span class='word'>points</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>identified</span><span class='ignore'>.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{align*}</span><br>
<span class='comment'>% \minimaTheta{a} = &amp; \arctan\left(\frac{2m \sqrt{3} }{2^n - 2 m}\right) &amp;</span><br>
<span class='comment'>% \minimaTheta{b} = &amp; \arctan\left(\frac{2m 2^{2-n}}{\sqrt{3}}&nbsp; &nbsp; &nbsp;  \right) \\ </span><br>
<span class='comment'>% &amp; \text{with}\quad&nbsp;  m =&nbsp; 0,1,2,3 \cdots2^{n-3} \\</span><br>
<span class='comment'>% \hat{\phi&nbsp; &nbsp; }_{a}&nbsp; = &amp; \arctan\left(\frac{\sqrt{3} (2 m+1)}{2^n-(2 m+1)}&nbsp; \right) &amp;</span><br>
<span class='comment'>% \hat{\phi&nbsp;  }_{b}&nbsp; = &amp; \arctan\left(\frac{(2 m+1) 2^{2-n}}{\sqrt{3}}&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \right) \\</span><br>
<span class='comment'>% &amp;\text{with}\quad&nbsp;  m =&nbsp; 0,1,2,3 \cdots2^{n-3}-1 </span><br>
<span class='comment'>%\end{align*}</span><br>
<span class='comment'>%</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>ExtremaFunctions</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span><span class='math'>=</span> <span class='math'>&amp;</span> <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>l</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='math'>-</span> <span class='math'>l</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span><br>
 <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span><span class='math'>=</span> <span class='math'>&amp;</span> <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>l</span> <span class='mathcmd'>\;</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2-n</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='mathcmd'>\\</span> <br>
 <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>2m</span><span class='ignore'>}</span> <span class='math'>&amp;</span><br>
 <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>2m</span><span class='ignore'>}</span> <br>
 <span class='math'>&amp;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>with</span><span class='ignore'>}</span><span class='mathcmd'>\quad</span>   <span class='math'>m</span> <span class='math'>=</span>&nbsp; <span class='math'>0</span><span class='math'>,</span><span class='math'>1</span><span class='math'>,</span><span class='math'>2</span><span class='math'>,</span><span class='math'>3</span> <span class='mathcmd'>\cdots</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>2m</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span> <span class='math'>&amp;</span><br>
&nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>2m</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span> <br>
 <span class='math'>&amp;</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>with</span><span class='ignore'>}</span><span class='mathcmd'>\quad</span>   <span class='math'>m</span> <span class='math'>=</span>&nbsp; <span class='math'>0</span><span class='math'>,</span><span class='math'>1</span><span class='math'>,</span><span class='math'>2</span><span class='math'>,</span><span class='math'>3</span> <span class='mathcmd'>\cdots</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span> <br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='comment'>%\begin{tabular}{|c|c|c|c|}</span><br>
<span class='comment'>%\hline</span><br>
<span class='comment'>%&nbsp; &amp; Channel a &amp; Channel b &amp;&nbsp; m \\ </span><br>
<span class='comment'>%\hline Minima&nbsp; &amp;&nbsp; $ \minimaTheta{a}(m)&nbsp; =&nbsp; \extremaTheta{a}{2m}&nbsp; $ &amp; $ \minimaTheta{b}(m)&nbsp; = \extremaTheta{b}{2m}&nbsp; $ &amp;&nbsp; $m \in \{ 0,1,2,3 \cdots2^{n-3}&nbsp; \} $\\ </span><br>
<span class='comment'>%\hline Maxima&nbsp; &amp;&nbsp; $ \maximaTheta{a}(m)&nbsp; = \extremaTheta{a}{2m+1}&nbsp;  $ &amp; $ \maximaTheta{b}(m)&nbsp; = \extremaTheta{b}{2m+1}&nbsp; $&nbsp; &amp; $ m \in \{ 0,1,2,3 \cdots2^{n-3} -1 \}&nbsp; $ \\ </span><br>
<span class='comment'>%\hline </span><br>
<span class='comment'>%\end{tabular} </span><br>
<br>
<span class='word'>Separating</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>intersection</span> <span class='word'>into</span> <span class='word'>even</span> <span class='word'>and</span> <span class='word'>odd</span> <span class='word'>terms</span> <span class='word'>facilitates</span> <span class='word'>the</span> <span class='word'>identification</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\hline</span><br>
&nbsp;<span class='ignore'>&amp;</span> <span class='ignore'>Channel</span> <span class='ignore'>a</span> <span class='ignore'>&amp;</span> <span class='ignore'>Channel</span> <span class='ignore'>b</span> <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>i</span> <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='ignore'>Minima</span>&nbsp; <span class='ignore'>&amp;</span>&nbsp; <span class='exclmath'>$</span> <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span><span class='math'>=</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span> <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span><span class='math'>=</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span> <span class='math'>i</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>0</span><span class='math'>,</span><span class='math'>2</span><span class='math'>,</span><span class='math'>4</span><span class='math'>,</span><span class='math'>6</span><span class='mathcmd'>\cdots</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span> <span class='math'>\}</span> <span class='exclmath'>$</span><span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <span class='ignore'>Maxima</span>&nbsp; <span class='ignore'>&amp;</span>&nbsp; <span class='exclmath'>$</span>&nbsp; &nbsp;  <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span><span class='math'>=</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span>&nbsp; &nbsp;  <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span><span class='math'>=</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span> <span class='math'>i</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>1</span><span class='math'>,</span><span class='math'>3</span><span class='math'>,</span><span class='math'>5</span><span class='math'>,</span><span class='math'>7</span><span class='mathcmd'>\cdots</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span><span class='math'>\}</span>&nbsp; <span class='exclmath'>$</span> <span class='exclcmd'>\\</span> <br>
<span class='exclcmd'>\hline</span> <br>
<span class='envir'>\end</span><span class='envir'>{tabular}</span><br>
<br>
<br>
<span class='word'>The</span> <span class='word'>following</span> <span class='word'>ranges</span> <span class='word'>are</span> <span class='word'>guaranteed</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>true</span> <span class='word'>for</span> <span class='word'>even</span> <span class='word'>or</span> <span class='word'>odd</span> <span class='word'>values</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>with</span> <span class='word'>very</span> <span class='word'>specific</span> <span class='word'>values</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>p</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>q</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{align*}</span><br>
<span class='comment'>%\begin{array}{cc}</span><br>
<span class='comment'>%&nbsp; \extremaTheta{b}{p} &amp; &lt; \\</span><br>
<span class='comment'>%&nbsp; \extremaTheta{a} {q-1} &amp; &lt; </span><br>
<span class='comment'>%\end{array}</span><br>
<span class='comment'>%&amp;\thetaX{i} </span><br>
<span class='comment'>%\begin{array}{cc}</span><br>
<span class='comment'>%&nbsp; &lt; &amp; \extremaTheta{a}{q}&nbsp; \\</span><br>
<span class='comment'>%&nbsp; &lt; &amp; \extremaTheta{b}{p+1}&nbsp; </span><br>
<span class='comment'>%\end{array} </span><br>
<span class='comment'>%&amp; \bigvee</span><br>
<span class='comment'>%\begin{array}{cc}</span><br>
<span class='comment'>%&nbsp; \extremaTheta{a}{q} &amp; &lt; \\</span><br>
<span class='comment'>%&nbsp; \extremaTheta{b} {p+1} &amp; &lt; </span><br>
<span class='comment'>%\end{array}</span><br>
<span class='comment'>%&amp;\thetaX{i+1}</span><br>
<span class='comment'>%\begin{array}{cc}</span><br>
<span class='comment'>%&nbsp; &lt; &amp; \extremaTheta{b}{p+2}&nbsp; \\</span><br>
<span class='comment'>%&nbsp; &lt; &amp; \extremaTheta{a}{q+1}&nbsp; </span><br>
<span class='comment'>%\end{array} &amp; </span><br>
<span class='comment'>%\begin{array}{cc}</span><br>
<span class='comment'>%p &amp;\in \{ 2 \mathbb{N} +1 \}&nbsp; \\</span><br>
<span class='comment'>%q &amp;\in \{ 2 \mathbb{N} +1 \}&nbsp; \\</span><br>
<span class='comment'>%i&nbsp; &amp;\in \{ 2 \mathbb{N} +1 \}</span><br>
<span class='comment'>%\end{array}</span><br>
<span class='comment'>%\end{align*}</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>p-1</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>&lt;</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>q</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>&lt;</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='math'>&amp;</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='math'>&lt;</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>q</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;<span class='math'>&lt;</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span>&nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='math'>&amp;</span> <span class='mathcmd'>\bigvee</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>q</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>&lt;</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>p</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>&lt;</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='math'>&amp;</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='math'>&lt;</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>p</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;<span class='math'>&lt;</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>q</span><span class='math'>+</span><span class='math'>2</span><span class='ignore'>}</span>&nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='math'>&amp;</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
<span class='math'>p</span>&nbsp; <span class='math'>&amp;</span><span class='mathcmd'>\in</span> <span class='math'>\{</span> <span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span>&nbsp; <span class='math'>\}</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='math'>q</span>&nbsp; <span class='math'>&amp;</span><span class='mathcmd'>\in</span> <span class='math'>\{</span> <span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span>&nbsp; <span class='math'>\}</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='math'>2</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\le</span> <span class='math'>i</span>&nbsp; <span class='mathcmd'>\le</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span> <span class='math'>-</span><span class='math'>1</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<br>
<span class='word'>This</span> <span class='word'>slightly</span> <span class='word'>glib</span> <span class='word'>definition</span> <span class='word'>illustrates</span> <span class='word'>the</span> <span class='word'>pattern</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>extrema</span> <span class='word'>bounding</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>intersection</span><span class='ignore'>.</span> <span class='word'>At</span> <span class='word'>the</span> <span class='word'>start</span> <span class='word'>of</span> <span class='word'>a</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\Pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>region</span><span class='ignore'>,</span> <span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>for</span> <span class='word'>low</span> <span class='word'>values</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>p</span><span class='math'>=</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>q</span><span class='math'>=</span><span class='math'>i</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>maxima</span> <span class='word'>swap</span> <span class='word'>orderings</span> <span class='word'>between</span> <span class='word'>certain</span> <span class='word'>values</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>within</span> <span class='word'>a</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\Pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>region</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>evident</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>inescapable</span> <span class='word'>indices</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>i-1</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='math'>+</span><span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>regardless</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>starting</span> <span class='word'>values</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>either</span> <span class='word'>the</span> <span class='word'>maxima</span> <span class='word'>or</span> <span class='word'>minima</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>whilst</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>true</span> <span class='word'>that</span> <span class='mathgroup'>$</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <span class='math'>&gt;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>always</span> <span class='word'>true</span> <span class='word'>that</span> <span class='mathgroup'>$</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span> <span class='math'>&gt;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>leads</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>question</span> <span class='word'>of</span> <span class='word'>what</span> <span class='word'>happens</span> <span class='word'>when</span> <span class='word'>this</span> <span class='word'>boundary</span> <span class='mathgroup'>$</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>crossed</span><span class='ignore'>.</span> <span class='word'>Firstly</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>even-odd</span> <span class='word'>ordering</span> <span class='ignore'>(</span><span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>the</span> <span class='word'>a-b</span> <span class='word'>channel</span> <span class='word'>ordering</span><span class='ignore'>)</span> <span class='word'>is</span> <span class='word'>flipped</span><span class='ignore'>;</span> <span class='word'>secondly</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>indices</span> <span class='word'>are</span> <span class='word'>shifted</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='word'>second</span> <span class='word'>transition</span> <span class='word'>restores</span> <span class='word'>the</span> <span class='word'>a-b</span> <span class='word'>ordering</span> <span class='word'>and</span> <span class='word'>shifts</span> <span class='word'>the</span> <span class='word'>indices</span> <span class='word'>again</span><span class='ignore'>.</span> <span class='word'>As</span> <span class='word'>the</span> <span class='word'>index</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>passes</span> <span class='word'>the</span> <span class='word'>half</span> <span class='word'>way</span> <span class='word'>point</span> <span class='mathgroup'>$</span><span class='mathcmd'>\meanIndx</span> <span class='math'>=</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>transitions</span> <span class='word'>occur</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>opposite</span> <span class='word'>direction</span><span class='ignore'>,</span> <span class='word'>restoring</span> <span class='word'>the</span> <span class='word'>indices</span> <span class='word'>and</span> <span class='word'>ordering</span><span class='ignore'>.</span> <span class='word'>Transitions</span> <span class='word'>occur</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>satisfies</span> <span class='mathgroup'>$</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-\iota</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>with</span> <span class='mathgroup'>$</span><span class='math'>\iota </span><span class='mathcmd'>\in</span> <span class='math'>\{</span> <span class='math'>1</span><span class='math'>,</span><span class='math'>2</span><span class='math'>,</span><span class='math'>3</span> <span class='mathcmd'>\cdots</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>7-4</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='math'>\}</span> <span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{gather*}</span><br>
<span class='cmd'>\meanIndx</span> <span class='ignore'>=</span> <span class='word'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>n-3</span><span class='ignore'>}</span> <span class='cmd'>\qquad</span><br>
<span class='cmd'>\varGamma</span><span class='ignore'>(</span><span class='word'>\iota</span><span class='ignore'>,</span> <span class='word'>n</span><span class='ignore'>)</span> <span class='ignore'>=</span> <span class='cmd'>\sqrt</span><span class='ignore'>{</span><span class='word'>\iota </span><span class='ignore'>^</span><span class='word'>2</span> <span class='ignore'>-</span> <span class='word'>14</span> <span class='word'>\iota </span><span class='cmd'>\meanIndx</span> <span class='ignore'>+</span> <span class='cmd'>\meanIndx</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span> <br>
<span class='envir'>\end</span><span class='envir'>{gather*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>region</span> <span class='mathgroup'>$</span><span class='math'>\iota</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>highest</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\iota</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>which</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>condition</span> <span class='word'>remains</span> <span class='word'>true</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{gather*}</span><br>
<span class='cmd'>\meanIndx</span> <span class='ignore'>-</span><span class='cmd'>\varGamma</span><span class='ignore'>(</span><span class='word'>\iota</span><span class='ignore'>,</span> <span class='word'>n</span><span class='ignore'>)</span> <span class='cmd'>\leq</span> <span class='word'>i</span> <span class='cmd'>\leq</span> <span class='cmd'>\varGamma</span><span class='ignore'>(</span><span class='word'>\iota</span><span class='ignore'>,</span> <span class='word'>n</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='cmd'>\meanIndx</span> <br>
<span class='envir'>\end</span><span class='envir'>{gather*}</span><br>
<br>
<span class='word'>For</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>n</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>intersection</span> <span class='word'>index</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>from</span> <span class='word'>this</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>find</span> <span class='mathgroup'>$</span><span class='math'>\iota</span><span class='mathgroup'>$</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{gather}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>indexFromTheta</span><span class='ignore'>}</span><br>
<span class='ignore'>i</span><span class='ignore'>(</span><span class='exclcmd'>\thetaA</span><span class='ignore'>,</span> <span class='ignore'>n</span><span class='ignore'>)</span> <span class='ignore'>=</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='exclcmd'>\meanIndx</span> <span class='exclcmd'>\tan</span> <span class='ignore'>(</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>)</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\tan</span> <span class='ignore'>(</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>)</span><span class='ignore'>+</span><span class='ignore'>7</span><span class='exclcmd'>\right</span><span class='ignore'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\tan</span> <span class='ignore'>(</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>)</span><span class='ignore'>+</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <br>
<span class='exclcmd'>\quad</span> <span class='exclcmd'>\text</span><span class='ignore'>{</span><span class='ignore'>where</span><span class='ignore'>}</span> <span class='exclcmd'>\quad</span> <span class='exclcmd'>\thetaA</span> <span class='ignore'>=</span> <span class='ignore'>\theta </span><span class='exclcmd'>\bmod</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span>&nbsp; <span class='exclcmd'>\\</span><br>
 <span class='ignore'>\iota</span><span class='ignore'>(</span><span class='ignore'>i</span><span class='ignore'>,</span><span class='ignore'>n</span><span class='ignore'>)</span>&nbsp; <span class='ignore'>=</span> <span class='exclcmd'>\left</span><span class='exclcmd'>\lfloor</span> <span class='ignore'>7</span><span class='exclcmd'>\ </span><span class='exclcmd'>\meanIndx</span><span class='ignore'>-</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>i</span><span class='ignore'>^</span><span class='ignore'>2</span> <span class='ignore'>-</span> <span class='ignore'>2</span> <span class='ignore'>i</span> <span class='exclcmd'>\;</span> <span class='exclcmd'>\meanIndx</span> <span class='ignore'>+</span> <span class='ignore'>49</span><span class='exclcmd'>\ </span><span class='exclcmd'>\meanIndx</span><span class='ignore'>^</span><span class='ignore'>2</span> <span class='ignore'>}</span><span class='exclcmd'>\right</span><span class='exclcmd'>\rfloor</span> <br>
<span class='envir'>\end</span><span class='envir'>{gather}</span><br>
<br>
<span class='word'>The</span> <span class='word'>sequence</span> <span class='word'>of</span> <span class='word'>a-b</span> <span class='word'>channel</span> <span class='word'>extrema</span> <span class='word'>depends</span> <span class='word'>on</span> <span class='word'>both</span> <span class='word'>the</span> <span class='word'>index</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>region</span> <span class='mathgroup'>$</span><span class='math'>\iota</span><span class='mathgroup'>$</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>way</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>extremaBounds</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-\iota-1</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>&lt;</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>&lt;</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='math'>&amp;</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='math'>&lt;</span> <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;<span class='math'>&lt;</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-\iota</span><span class='ignore'>}</span>&nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='math'>&amp;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>when</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>lcl</span><span class='ignore'>}</span><br>
<span class='math'>i</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span><span class='math'>+</span><span class='math'>1</span><span class='math'>\}</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\land</span> <span class='math'>&amp;</span> <span class='math'>\iota </span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span><span class='math'>+</span><span class='math'>1</span><span class='math'>\}</span> <span class='mathcmd'>\ </span> <span class='mathcmd'>\lor</span> <span class='mathcmd'>\\</span> <br>
<span class='math'>i</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span>&nbsp; &nbsp;  <span class='math'>\}</span> <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\land</span> <span class='math'>&amp;</span> <span class='math'>\iota </span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span>&nbsp; &nbsp; <span class='math'>\}</span> <span class='mathcmd'>\\</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='mathcmd'>\\</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>&lt;</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-\iota-1</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>&lt;</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='math'>&amp;</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='math'>&lt;</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-\iota</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span><br>
&nbsp;<span class='math'>&lt;</span> <span class='math'>&amp;</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='math'>&amp;</span> <br>
<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>when</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>lcl</span><span class='ignore'>}</span><br>
 <span class='math'>(</span><span class='math'>i</span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span><span class='math'>+</span><span class='math'>1</span><span class='math'>\}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\land</span> <span class='math'>&amp;</span> <span class='math'>\iota </span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span>&nbsp; &nbsp; <span class='math'>\}</span><span class='math'>)</span> <span class='mathcmd'>\ </span><span class='mathcmd'>\lor</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>(</span><span class='math'>i</span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span>&nbsp; &nbsp; <span class='math'>\}</span> <span class='math'>&amp;</span> <span class='mathcmd'>\land</span> <span class='math'>&amp;</span> <span class='math'>\iota </span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span><span class='math'>+</span><span class='math'>1</span><span class='math'>\}</span><span class='math'>)</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>The</span> <span class='word'>other</span> <span class='word'>two</span> <span class='word'>ranges</span> <span class='word'>can</span> <span class='word'>swap</span> <span class='word'>direction</span> <span class='word'>around</span> <span class='word'>the</span> <span class='word'>central</span> <span class='word'>value</span>&nbsp; <span class='mathgroup'>$</span><span class='mathcmd'>\overline</span><span class='ignore'>{</span><span class='math'>m</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>region</span> <span class='word'>governed</span> <span class='word'>by</span> <span class='mathgroup'>$</span><span class='math'>\Gamma</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>distance</span> <span class='word'>from</span> <span class='mathgroup'>$</span><span class='mathcmd'>\overline</span><span class='ignore'>{</span><span class='math'>m</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>at</span> <span class='word'>which</span> <span class='word'>the</span> <span class='word'>order</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>extrema</span> <span class='word'>switch</span> <span class='word'>between</span> <span class='word'>channels</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\lessGtrOp</span><span class='ignore'>}</span><span class='option'>[1]</span><span class='ignore'>{</span> <span class='ignore'>\underset</span><span class='ignore'>{</span> <span class='ignore'>\mbox</span><span class='ignore'>{</span><span class='ignore'>\small</span><span class='ignore'>$</span><span class='ignore'>#</span><span class='ignore'>1</span><span class='ignore'>$</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span> <span class='ignore'>\mbox</span><span class='ignore'>{</span><span class='ignore'>\Huge</span><span class='ignore'>$</span><span class='ignore'>\lessgtr</span><span class='ignore'>$</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>}</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{gather*}</span><br>
<span class='cmd'>\overline</span><span class='ignore'>{</span><span class='word'>m</span><span class='ignore'>}</span><span class='ignore'>=</span><span class='cmd'>\frac</span><span class='ignore'>{</span><span class='word'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='word'>2</span><span class='ignore'>}</span> <span class='cmd'>\left</span><span class='ignore'>(</span><span class='word'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>n-3</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='word'>1</span><span class='cmd'>\right</span><span class='ignore'>)</span> <span class='cmd'>\qquad</span><br>
<span class='cmd'>\varGamma</span><span class='ignore'>(</span><span class='word'>n</span><span class='ignore'>)</span><span class='ignore'>=</span><span class='cmd'>\frac</span><span class='ignore'>{</span><span class='word'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='word'>2</span><span class='ignore'>}</span> <span class='cmd'>\sqrt</span><span class='ignore'>{</span><span class='word'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>2</span> <span class='ignore'>(</span><span class='word'>n-3</span><span class='ignore'>)</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='word'>14</span><span class='cmd'>\ </span><span class='word'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='word'>n-3</span><span class='ignore'>}</span><span class='ignore'>+</span><span class='word'>1</span><span class='ignore'>}</span> <span class='cmd'>\\</span><br>
<span class='cmd'>\lessGtrOp</span><span class='ignore'>{</span><span class='word'>m</span><span class='ignore'>}</span> <span class='ignore'>=</span><span class='envir'>\begin</span><span class='envir'>{cases}</span><br>
<span class='ignore'>&lt;</span> <span class='ignore'>&amp;</span> <span class='cmd'>\quad</span>    <span class='word'>m</span> <span class='ignore'>&lt;</span>&nbsp;  <span class='cmd'>\bar</span><span class='ignore'>{</span><span class='word'>m</span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='word'>\Gamma </span><span class='cmd'>\;</span> <span class='cmd'>\vee</span> <span class='cmd'>\;</span> <span class='word'>m</span> <span class='ignore'>&gt;</span> <span class='cmd'>\bar</span><span class='ignore'>{</span><span class='word'>m</span><span class='ignore'>}</span> <span class='ignore'>+</span> <span class='word'>\Gamma&nbsp;  </span><span class='cmd'>\\</span><br>
<span class='ignore'>&gt;</span> <span class='ignore'>&amp;</span> <span class='cmd'>\quad</span>  <span class='cmd'>\bar</span><span class='ignore'>{</span><span class='word'>m</span><span class='ignore'>}</span> <span class='ignore'>-</span> <span class='word'>\Gamma </span><span class='cmd'>\leq</span> <span class='word'>m</span> <span class='cmd'>\leq</span> <span class='cmd'>\bar</span><span class='ignore'>{</span><span class='word'>m</span><span class='ignore'>}</span> <span class='ignore'>+</span> <span class='word'>\Gamma </span><span class='cmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{cases}</span><span class='cmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{gather*}</span><br>
<br>
<span class='word'>This</span> <span class='word'>allows</span> <span class='word'>the</span> <span class='word'>bounds</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>intersection</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>concisely</span> <span class='word'>written</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>ccccc</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m-1</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>m</span> <span class='math'>-</span> <span class='ignore'>{</span><span class='mathcmd'>\textstyle</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>)</span><span class='ignore'>}</span>&nbsp; &nbsp;  <span class='math'>&amp;</span> <span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>2m</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp;  <span class='math'>&amp;</span><span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>m</span> <span class='math'>-</span> <span class='ignore'>{</span><span class='mathcmd'>\textstyle</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>)</span><span class='ignore'>}</span>&nbsp;  <span class='math'>&amp;</span>&nbsp;  <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; &nbsp; &nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span><span class='math'>m</span><span class='ignore'>}</span>&nbsp; &nbsp;  <span class='math'>&amp;</span> <span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>2m</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span><span class='math'>m</span><span class='ignore'>}</span>&nbsp;  <span class='math'>&amp;</span>&nbsp;  <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>(</span><span class='math'>m</span><span class='math'>+</span><span class='math'>1</span><span class='math'>)</span> <br>
 <span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<br>
<span class='word'>or</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m-1</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>m</span> <span class='math'>-</span> <span class='ignore'>{</span><span class='mathcmd'>\textstyle</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>)</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; &nbsp;  <span class='math'>&amp;</span> <span class='math'>&lt;</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>2m</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>m</span> <span class='math'>-</span> <span class='ignore'>{</span><span class='mathcmd'>\textstyle</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>)</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span>&nbsp;  <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>&amp;</span>&nbsp;  <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='mathcmd'>\quad</span><br>
<span class='math'>&amp;</span> <span class='mathcmd'>\quad</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp;  <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp; <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span><span class='math'>m</span><span class='ignore'>}</span>&nbsp; &nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>2m</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
 <span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span><span class='math'>m</span><span class='ignore'>}</span>&nbsp; &nbsp;  <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>+</span><span class='math'>1</span><span class='math'>)</span>&nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='word'>Adjusting</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>intersection</span> <span class='word'>index</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>see</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>intersection</span> <span class='word'>points</span> <span class='word'>are</span> <span class='word'>best</span> <span class='word'>classified</span> <span class='word'>by</span> <span class='word'>being</span> <span class='word'>either</span> <span class='word'>odd</span> <span class='word'>or</span> <span class='word'>even</span> <span class='word'>values</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; &nbsp;  <span class='math'>&amp;</span> <span class='math'>&lt;</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='math'>&amp;</span> <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><span class='mathcmd'>\quad</span><br>
<span class='math'>&amp;</span> <span class='mathcmd'>\quad</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp;  <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
 <span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; &nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp; &nbsp; <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>+</span><span class='math'>1</span><span class='math'>)</span>&nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
<span class='mathcmd'>\overbrace</span><span class='ignore'>{</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span> <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; &nbsp;  <span class='math'>&amp;</span>&nbsp; <span class='math'>&lt;</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span>&nbsp;  <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>&amp;</span>&nbsp;  <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>i</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span> <span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span> <span class='math'>\}</span> <span class='ignore'>}</span><br>
<span class='mathcmd'>\quad</span><br>
 <span class='mathcmd'>\quad</span><br>
 <span class='mathcmd'>\overbrace</span><span class='ignore'>{</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp;  <span class='math'>&amp;</span> <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp;  <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
 <span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='math'>&amp;</span>&nbsp; &nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp; &nbsp; <span class='math'>&amp;</span>&nbsp; &nbsp;  <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>i</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span> <span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span> <span class='math'>+</span><span class='math'>1</span> <span class='math'>\}</span> <span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<span class='word'>Recalling</span> <span class='word'>the</span> <span class='word'>definitions</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>extrema</span> <span class='word'>functions</span><br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
 <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; &nbsp;  <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; &nbsp; &nbsp; <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span>&nbsp; <span class='math'>i</span> <span class='math'>&amp;</span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>0</span><span class='math'>,</span><span class='math'>2</span><span class='math'>,</span><span class='math'>4</span><span class='math'>,</span><span class='math'>6</span><span class='mathcmd'>\cdots</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span> <span class='math'>\}</span> <span class='mathcmd'>\\</span> <br>
<span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span>&nbsp; <span class='math'>i</span> <span class='math'>&amp;</span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>1</span><span class='math'>,</span><span class='math'>3</span><span class='math'>,</span><span class='math'>5</span><span class='math'>,</span><span class='math'>7</span><span class='mathcmd'>\cdots</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span><span class='math'>\}</span>&nbsp; <br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='word'>the</span> <span class='word'>boundary</span> <span class='word'>relations</span> <span class='word'>become</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
<span class='mathcmd'>\overbrace</span><span class='ignore'>{</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span> <span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span>&nbsp; &nbsp; <span class='math'>&amp;</span>&nbsp; <span class='math'>&lt;</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span>&nbsp;  <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>&amp;</span>&nbsp;  <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>i</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span> <span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span> <span class='math'>\}</span> <span class='ignore'>}</span><br>
<span class='mathcmd'>\quad</span><br>
 <span class='mathcmd'>\quad</span><br>
 <span class='mathcmd'>\overbrace</span><span class='ignore'>{</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
&nbsp; <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span>&nbsp;  <span class='math'>&amp;</span> <span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span>&nbsp; &nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp;  <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>cc</span><span class='ignore'>}</span><br>
 <span class='math'>&lt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='math'>&amp;</span>&nbsp; &nbsp; <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\\</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\lessGtrOp</span><span class='ignore'>{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>i-1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span>&nbsp; &nbsp; <span class='math'>&amp;</span>&nbsp; &nbsp;  <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp;  <br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
<span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>i</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span> <span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span> <span class='math'>+</span><span class='math'>1</span> <span class='math'>\}</span> <span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<br>
<span class='cmd'>\parpic</span><span class='ignore'>(</span><span class='word'>79mm</span><span class='ignore'>,</span><span class='word'>104mm</span><span class='ignore'>)</span><span class='ignore'>[</span><span class='word'>r</span><span class='ignore'>]</span><span class='ignore'>{</span><span class='cmd'>\fbox</span><span class='ignore'>{</span><span class='cmd'>\parbox</span><span class='ignore'>{</span><span class='ignore'>76mm</span><span class='ignore'>}</span><span class='ignore'>{</span><br>
<span class='cmd'>\includegraphics</span><span class='optparm'>[</span><span class='ignore'>width</span><span class='ignore'>=</span><span class='ignore'>76mm</span><span class='optparm'>]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>GeometryClassifyPoint.jpg</span><span class='ignore'>}</span>  <span class='cmd'>\\</span><br>
<span class='cmd'>\centering</span>  <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>h</span><span class='math'>_</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>h</span><span class='math'>_</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='math'>h</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>a</span><span class='math'>+</span><span class='math'>b</span><span class='ignore'>}</span> <span class='mathgroup'>$</span> <span class='cmd'>\\</span><br>
<span class='cmd'>\centering</span> <span class='mathgroup'>$</span><span class='math'>a</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>2m</span><span class='ignore'>}</span>&nbsp; <span class='math'>=</span>&nbsp; &nbsp;  <span class='mathcmd'>\|</span> <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m-1</span><span class='math'>)</span> <span class='math'>-</span>&nbsp; &nbsp;  <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span> <span class='mathcmd'>\|</span>  <span class='mathgroup'>$</span> <span class='cmd'>\\</span><br>
<span class='cmd'>\centering</span> <span class='mathgroup'>$</span><span class='math'>b</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>2m</span><span class='ignore'>}</span>&nbsp; <span class='math'>=</span> <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; &nbsp;  <span class='math'>-</span> <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span><span class='mathgroup'>$</span> <span class='cmd'>\\</span><br>
<span class='cmd'>\centering</span> <span class='mathgroup'>$</span><span class='math'>a</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>2m</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp;  <span class='math'>=</span>&nbsp; &nbsp;  <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; &nbsp;  <span class='math'>-</span>&nbsp; &nbsp; &nbsp; <span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span><span class='mathgroup'>$</span>&nbsp; &nbsp; <span class='cmd'>\\</span>   <br>
<span class='cmd'>\centering</span> <span class='mathgroup'>$</span><span class='math'>b</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>2m</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='math'>=</span> <span class='mathcmd'>\|</span> <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>m</span><span class='math'>)</span>&nbsp; &nbsp;  <span class='math'>-</span> <span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>(</span><span class='math'>m</span><span class='math'>+</span><span class='math'>1</span><span class='math'>)</span> <span class='mathcmd'>\|</span> <span class='mathgroup'>$</span>&nbsp; <span class='cmd'>\\</span><br>
<span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='ignore'>}</span><br>
<span class='word'>We</span> <span class='word'>want</span> <span class='word'>to</span> <span class='word'>classify</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>intersection</span> <span class='word'>as</span> <span class='word'>greater</span> <span class='word'>or</span> <span class='word'>lesser</span> <span class='word'>than</span> <span class='word'>a</span> <span class='word'>tolerance</span> <span class='mathgroup'>$</span><span class='math'>0</span> <span class='math'>&lt;</span> <span class='math'>\tau </span><span class='mathcmd'>\le</span> <span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>do</span> <span class='word'>this</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>make</span> <span class='word'>a</span> <span class='word'>linear</span> <span class='word'>approximation</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>extrema</span><span class='ignore'>.</span> <span class='word'>There</span> <span class='word'>is</span> <span class='word'>one</span> <span class='word'>point</span> <span class='word'>of</span> <span class='word'>intersection</span> <span class='word'>between</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>maxima</span> <span class='word'>and</span> <span class='word'>corresponding</span> <span class='word'>minima</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='word'>bit</span> <span class='word'>of</span> <span class='word'>geometry</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>write</span> <span class='word'>a</span> <span class='word'>classification</span> <span class='word'>criteria</span> <span class='word'>for</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>intersection</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='word'>Defining</span> <span class='word'>a</span> <span class='word'>function</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>degree</span> <span class='word'>of</span> <span class='word'>error</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>of</span> <span class='word'>intersection</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>linear</span> <span class='word'>approximation</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>four</span> <span class='word'>extrema</span> <span class='word'>surrounding</span> <span class='word'>the</span> <span class='word'>point</span> <span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>generalizing</span> <span class='word'>to</span> <span class='word'>allow</span> <span class='word'>for</span> <span class='word'>different</span> <span class='word'>maximum</span> <span class='word'>errors</span> <span class='mathgroup'>$</span><span class='math'>\alpha</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>channel</span> <span class='mathgroup'>$</span><span class='math'>a</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\beta</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>channel</span> <span class='word'>b</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>conditions</span> <span class='word'>on</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\iota</span><span class='mathgroup'>$</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>more</span> <span class='word'>compactly</span> <span class='word'>written</span> <span class='word'>by</span> <span class='word'>applying</span> <span class='word'>a</span> <span class='word'>condition</span> <span class='word'>to</span> <span class='word'>their</span> <span class='word'>product</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>generalizedPerturbation</span><span class='ignore'>}</span><br>
<span class='math'>h</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>\iota</span><span class='math'>,</span> <span class='math'>\alpha</span><span class='math'>,</span> <span class='math'>\beta</span><span class='math'>)</span>&nbsp; <span class='math'>=</span> <span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\alpha&nbsp; \beta&nbsp; </span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota </span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-\iota </span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='ignore'>}</span><br>
<span class='ignore'>{</span><span class='math'>\beta&nbsp; </span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota </span><span class='ignore'>}</span> <span class='math'>-</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota </span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>+</span> <span class='math'>\alpha&nbsp; </span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-\iota -1</span><span class='ignore'>}</span> <span class='math'>-</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-\iota </span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span><br>
&nbsp; <span class='math'>i</span> <span class='math'>+</span> <span class='math'>\iota </span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span>&nbsp; &nbsp;  <span class='math'>\}</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\alpha&nbsp; \beta&nbsp; </span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-\iota -1</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota </span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='ignore'>}</span><br>
<span class='ignore'>{</span><span class='math'>\beta&nbsp; </span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span> <span class='math'>i</span><span class='math'>+</span><span class='math'>\iota </span><span class='ignore'>}</span> <span class='math'>-</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span> <span class='math'>i</span><span class='math'>+</span><span class='math'>\iota </span><span class='math'>+</span> <span class='math'>1</span> <span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>+</span><span class='math'>\alpha&nbsp; </span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-\iota -1</span><span class='ignore'>}</span> <span class='math'>-</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-\iota </span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span> <br>
<span class='math'>i</span> <span class='math'>+</span> <span class='math'>\iota </span><span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>2</span> <span class='mathcmd'>\mathbb</span><span class='ignore'>{</span><span class='math'>N</span><span class='ignore'>}</span>&nbsp; <span class='math'>+</span> <span class='math'>1</span> <span class='math'>\}</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>allows</span> <span class='word'>the</span> <span class='word'>criteria</span> <span class='word'>for</span> <span class='word'>an</span> <span class='word'>acceptable</span> <span class='word'>perturbation</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>written</span> <span class='word'>as</span> <span class='mathgroup'>$</span><span class='math'>\tau </span><span class='mathcmd'>\ge</span> <span class='math'>h</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>\iota</span><span class='math'>)</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='word'>more</span> <span class='word'>useful</span> <span class='word'>formulation</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>specify</span> <span class='word'>an</span> <span class='word'>acceptable</span> <span class='word'>perturbation</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>channel</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha </span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\tau</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\alpha</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta </span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\tau</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\beta</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>may</span> <span class='word'>as</span> <span class='word'>well</span> <span class='word'>choose</span> <span class='mathgroup'>$</span><span class='math'>\tau </span><span class='math'>=</span> <span class='math'>1</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>and</span> <span class='word'>use</span> <span class='word'>the</span> <span class='word'>channel</span> <span class='word'>specific</span> <span class='word'>values</span> <span class='word'>to</span> <span class='word'>control</span> <span class='word'>the</span> <span class='word'>acceptable</span> <span class='word'>perturbation</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{gather}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>generalizedPerturbationCondition</span><span class='ignore'>}</span><br>
<span class='ignore'>h</span><span class='ignore'>(</span><span class='ignore'>i</span><span class='ignore'>,</span><span class='ignore'>\iota</span><span class='ignore'>,</span> <span class='exclcmd'>\tau</span><span class='ignore'>_</span><span class='ignore'>\alpha</span><span class='ignore'>,</span> <span class='exclcmd'>\tau</span><span class='ignore'>_</span><span class='ignore'>\beta</span><span class='ignore'>)</span>&nbsp; <span class='ignore'>=</span>&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
<span class='exclcmd'>\frac</span><span class='ignore'>{</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>i</span><span class='ignore'>+</span><span class='ignore'>\iota </span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>i-\iota </span><span class='ignore'>}</span> <span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>}</span><br>
<span class='ignore'>{</span><span class='exclcmd'>\tau</span><span class='ignore'>_</span><span class='ignore'>\alpha&nbsp; </span><span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>i</span><span class='ignore'>+</span><span class='ignore'>\iota </span><span class='ignore'>}</span> <span class='ignore'>-</span> <span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>i</span><span class='ignore'>+</span><span class='ignore'>\iota </span><span class='ignore'>+</span><span class='ignore'>1</span><span class='ignore'>}</span>&nbsp; <span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>+</span> <span class='exclcmd'>\tau</span><span class='ignore'>_</span><span class='ignore'>\beta&nbsp; </span><span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>i-\iota -1</span><span class='ignore'>}</span> <span class='ignore'>-</span> <span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>i-\iota </span><span class='ignore'>}</span> <span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>}</span>&nbsp; <span class='ignore'>&amp;</span><br>
&nbsp; <span class='ignore'>i</span> <span class='ignore'>+</span> <span class='ignore'>\iota </span><span class='exclcmd'>\in</span> <span class='ignore'>\{</span><span class='ignore'>2</span> <span class='exclcmd'>\mathbb</span><span class='ignore'>{</span><span class='ignore'>N</span><span class='ignore'>}</span>&nbsp; &nbsp;  <span class='ignore'>\}</span>&nbsp; <span class='exclcmd'>\\</span><br>
<span class='exclcmd'>\frac</span><span class='ignore'>{</span>&nbsp; <span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>i-\iota -1</span><span class='ignore'>}</span><span class='ignore'>-</span><span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>i</span><span class='ignore'>+</span><span class='ignore'>\iota </span><span class='ignore'>+</span><span class='ignore'>1</span><span class='ignore'>}</span> <span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>}</span><br>
<span class='ignore'>{</span><span class='exclcmd'>\tau</span><span class='ignore'>_</span><span class='ignore'>\alpha&nbsp; </span><span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span> <span class='ignore'>i</span><span class='ignore'>+</span><span class='ignore'>\iota </span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>a</span><span class='ignore'>}</span> <span class='ignore'>{</span> <span class='ignore'>i</span><span class='ignore'>+</span><span class='ignore'>\iota </span><span class='ignore'>+</span> <span class='ignore'>1</span> <span class='ignore'>}</span> <span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>+</span><span class='exclcmd'>\tau</span><span class='ignore'>_</span><span class='ignore'>\beta </span><span class='exclcmd'>\left</span><span class='ignore'>(</span> <span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>i-\iota -1</span><span class='ignore'>}</span> <span class='ignore'>-</span><span class='exclcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='ignore'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='ignore'>i-\iota </span><span class='ignore'>}</span> <span class='exclcmd'>\right</span><span class='ignore'>)</span> <span class='ignore'>}</span>&nbsp; <span class='ignore'>&amp;</span> <br>
<span class='ignore'>i</span> <span class='ignore'>+</span> <span class='ignore'>\iota </span><span class='exclcmd'>\in</span> <span class='ignore'>\{</span><span class='ignore'>2</span> <span class='exclcmd'>\mathbb</span><span class='ignore'>{</span><span class='ignore'>N</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>+</span> <span class='ignore'>1</span> <span class='ignore'>\}</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><span class='exclcmd'>\\</span><br>
<span class='ignore'>1</span> <span class='exclcmd'>\ge</span> <span class='ignore'>h</span><span class='ignore'>(</span><span class='ignore'>i</span><span class='ignore'>,</span><span class='ignore'>\iota</span><span class='ignore'>,</span> <span class='exclcmd'>\tau</span><span class='ignore'>_</span><span class='ignore'>\alpha</span><span class='ignore'>,</span> <span class='exclcmd'>\tau</span><span class='ignore'>_</span><span class='ignore'>\beta</span><span class='ignore'>)</span> <br>
<span class='envir'>\end</span><span class='envir'>{gather}</span><br>
<br>
<span class='word'>Given</span> <span class='word'>a</span> <span class='word'>desired</span> <span class='word'>angle</span> <span class='word'>of</span> <span class='word'>rotation</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span><span class='ignore'>;</span> <span class='word'>a</span> <span class='word'>data</span> <span class='word'>type</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>determines</span> <span class='mathgroup'>$</span><span class='math'>n</span><span class='mathgroup'>$</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>acceptable</span> <span class='word'>channel</span> <span class='word'>perturbations</span><span class='ignore'>,</span> <span class='word'>specified</span> <span class='word'>by</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='mathgroup'>$</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>nearest</span> <span class='word'>angle</span> <span class='word'>which</span> <span class='word'>minimises</span> <span class='word'>the</span> <span class='word'>quantisation</span> <span class='word'>error</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>close</span> <span class='word'>estimate</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>error</span> <span class='word'>which</span> <span class='word'>can</span> <span class='word'>occur</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{gather}</span><br>
 <span class='exclcmd'>\iota</span>  <span class='ignore'>=</span> <span class='exclcmd'>\left</span><span class='exclcmd'>\lfloor</span> <span class='ignore'>7</span><span class='exclcmd'>\ </span><span class='exclcmd'>\meanIndx</span><span class='ignore'>-</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>i</span><span class='ignore'>^</span><span class='ignore'>2</span> <span class='ignore'>-</span> <span class='ignore'>2</span> <span class='ignore'>i</span> <span class='exclcmd'>\;</span> <span class='exclcmd'>\meanIndx</span> <span class='ignore'>+</span> <span class='ignore'>49</span><span class='exclcmd'>\ </span><span class='exclcmd'>\meanIndx</span><span class='ignore'>^</span><span class='ignore'>2</span> <span class='ignore'>}</span><span class='exclcmd'>\right</span><span class='exclcmd'>\rfloor</span>  <span class='exclcmd'>\quad</span><span class='exclcmd'>\quad</span><span class='exclcmd'>\quad</span> <span class='exclcmd'>\meanIndx</span> <span class='ignore'>=</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-3</span><span class='ignore'>}</span>&nbsp; <span class='exclcmd'>\\</span><br>
<span class='ignore'>i</span> <span class='ignore'>=</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='exclcmd'>\meanIndx</span> <span class='exclcmd'>\tan</span> <span class='ignore'>(</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>)</span> <span class='exclcmd'>\left</span><span class='ignore'>(</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\tan</span> <span class='ignore'>(</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>)</span><span class='ignore'>+</span><span class='ignore'>7</span><span class='exclcmd'>\right</span><span class='ignore'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\tan</span> <span class='ignore'>(</span><span class='exclcmd'>\thetaA</span> <span class='ignore'>)</span><span class='ignore'>+</span><span class='exclcmd'>\sqrt</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <br>
<span class='exclcmd'>\quad</span> <span class='exclcmd'>\text</span><span class='ignore'>{</span><span class='ignore'>where</span><span class='ignore'>}</span> <span class='exclcmd'>\quad</span> <span class='exclcmd'>\thetaA</span> <span class='ignore'>=</span> <span class='ignore'>\theta </span><span class='exclcmd'>\bmod</span> <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>6</span><span class='ignore'>}</span>&nbsp; <br>
<span class='envir'>\end</span><span class='envir'>{gather}</span><br>
<br>
<span class='word'>Starting</span> <span class='word'>from</span> <span class='word'>the</span>&nbsp; <span class='word'>value</span> <span class='mathgroup'>$</span> <span class='math'>i</span> <span class='mathgroup'>$</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>searches</span> <span class='word'>for</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\tilde</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <span class='mathgroup'>$</span> <span class='word'>the</span> <span class='word'>value</span> <span class='word'>nearest</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>condition</span> <span class='mathgroup'>$</span><span class='math'>1</span> <span class='mathcmd'>\ge</span> <span class='math'>h</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>\iota</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='math'>)</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>generalizedPerturbationCondition</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>then</span> <span class='word'>finds</span> <span class='word'>a</span> <span class='word'>starting</span> <span class='word'>value</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>index</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>indexFromTheta</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>and</span> <span class='word'>returns</span> <span class='word'>the</span> <span class='word'>closest</span> <span class='word'>value</span> <span class='word'>which</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>the</span> <span class='word'>condition</span> <span class='mathgroup'>$</span><span class='math'>1</span> <span class='mathcmd'>\ge</span> <span class='math'>h</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>\iota</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='math'>)</span><span class='mathgroup'>$</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>generalizedPerturbationCondition</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>:</span><br>
<br>
<span class='word'>The</span> <span class='word'>region</span> <span class='mathgroup'>$</span><span class='math'>\iota</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>i</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>appropriate</span> <span class='word'>values</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>extremaBounds</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>extrema</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>ExtremaFunctions</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>are</span> <span class='word'>evaluated</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>function</span> <span class='word'>which</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>index</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>generalizedPerturbation</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>intercept</span> <span class='word'>position</span> <span class='mathgroup'>$</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>with</span> <span class='word'>algorithm</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>thetaX</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<span class='comment'>%\begin{gather*}</span><br>
<span class='comment'>%\begin{aligned}</span><br>
<span class='comment'>% \iota(i,n)&nbsp; &amp;= \left\lfloor 7\ \meanIndx-\sqrt{i^2 - 2 i \; \meanIndx + 49\ \meanIndx^2 }\right\rfloor &amp;</span><br>
<span class='comment'>%&nbsp; \extremaTheta{a} {l} = &amp; \arctan\left(\frac{l \sqrt{3} }{2^n - l}\right) &amp;</span><br>
<span class='comment'>%&nbsp; \extremaTheta{b} {l} = &amp; \arctan\left(\frac{l \; 2^{2-n}}{\sqrt{3}}&nbsp; &nbsp; &nbsp;  \right)</span><br>
<span class='comment'>%\end{aligned} \\</span><br>
<span class='comment'>%\begin{aligned}</span><br>
<span class='comment'>% \minimaTheta{a}&nbsp; &amp;= \extremaTheta{a}{i+\iota} &amp;</span><br>
<span class='comment'>% \maximaTheta{b} &amp;= \extremaTheta{b}{i-\iota-1} &amp; </span><br>
<span class='comment'>% \minimaTheta{b}&nbsp; &amp;= \extremaTheta{b}{i-\iota}&nbsp; &amp;</span><br>
<span class='comment'>% \maximaTheta{a} &amp;= \extremaTheta{a}{i+\iota+1}&nbsp; &amp;</span><br>
<span class='comment'>%&nbsp; \text{when} \quad </span><br>
<span class='comment'>%i + \iota &amp;\in \{2 \mathbb{N}&nbsp; &nbsp;  \} \\</span><br>
<span class='comment'>% \maximaTheta{a}&nbsp; &amp;= \extremaTheta{a}{i+\iota} &amp; </span><br>
<span class='comment'>% \minimaTheta{b}&nbsp; &amp;= \extremaTheta{b} {i-\iota-1} &amp;</span><br>
<span class='comment'>% \maximaTheta{b} &amp;= \extremaTheta{b}{i-\iota}&nbsp; &amp;</span><br>
<span class='comment'>% \minimaTheta{a}&nbsp; &amp;= \extremaTheta{a}{i+\iota+1}&nbsp; &amp; </span><br>
<span class='comment'>%\text{when} \quad </span><br>
<span class='comment'>%i + \iota &amp;\in \{2 \mathbb{N}&nbsp; + 1 \} </span><br>
<span class='comment'>%\end{aligned}\\</span><br>
<span class='comment'>%\thetaX{i} = \left\{\frac{</span><br>
<span class='comment'>%\beta \minimaTheta{b} (\minimaTheta{a}&nbsp; -\maximaTheta{a} )+\alpha&nbsp; \minimaTheta{a} (\maximaTheta{b}-\minimaTheta{b})&nbsp; }{</span><br>
<span class='comment'>%\beta&nbsp; (\minimaTheta{a} -\maximaTheta{a})+\alpha&nbsp; (\maximaTheta{b}-\minimaTheta{b})</span><br>
<span class='comment'>%},\frac{</span><br>
<span class='comment'>%\alpha&nbsp; \beta&nbsp; (\minimaTheta{a}-\minimaTheta{b})&nbsp; }{</span><br>
<span class='comment'>%\beta&nbsp; (\minimaTheta{a}-\maximaTheta{a})+\alpha&nbsp; (\maximaTheta{b}-\minimaTheta{b})</span><br>
<span class='comment'>%}\right\}</span><br>
<span class='comment'>%\end{gather*}</span><br>
<br>
 <span class='envir'>\begin</span><span class='envir'>{algorithm}</span><span class='option'>[h]</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\Function</span> <span class='ignore'>{</span> <span class='exclmath'>$</span><span class='mathcmd'>\overset</span><span class='ignore'>{</span><span class='mathcmd'>\times</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\phi</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclmath'>$</span> <span class='math'>i</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='math'>,</span> <span class='math'>n</span> <span class='exclmath'>$</span><span class='ignore'>}</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>i</span><span class='exclmath'>$</span> <span class='ignore'>integer</span> <span class='ignore'>index</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>intercept</span> <span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span> <span class='exclmath'>$</span><span class='mathcmd'>\meanIndx</span> <span class='mathcmd'>\gets</span>  <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='exclmath'>$</span>&nbsp; <span class='ignore'>;</span> <span class='exclcmd'>\quad</span>  <span class='exclmath'>$</span><span class='math'>\iota</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>n</span><span class='math'>)</span>&nbsp; <span class='mathcmd'>\gets</span>  <span class='mathcmd'>\left</span><span class='mathcmd'>\lfloor</span> <span class='math'>7</span><span class='mathcmd'>\ </span><span class='mathcmd'>\meanIndx</span><span class='math'>-</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>^</span><span class='math'>2</span> <span class='math'>-</span> <span class='math'>2</span> <span class='math'>i</span> <span class='mathcmd'>\meanIndx</span> <span class='math'>+</span> <span class='math'>49</span><span class='mathcmd'>\ </span><span class='mathcmd'>\meanIndx</span><span class='math'>^</span><span class='math'>2</span> <span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='mathcmd'>\rfloor</span> <span class='exclmath'>$</span>&nbsp; <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>n</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>source</span> <span class='ignore'>bit</span> <span class='ignore'>depth</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\State</span> <span class='exclmath'>$</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>2-n</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; &nbsp; &nbsp;  <span class='mathcmd'>\right</span><span class='math'>)</span><span class='exclmath'>$</span> <span class='ignore'>;</span> <span class='exclcmd'>\quad</span> <br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclmath'>$</span><span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\arctan</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='math'>-</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='exclcmd'>\If</span><span class='ignore'>{</span><span class='exclmath'>$</span> <span class='math'>i</span> <span class='math'>+</span> <span class='math'>\iota </span><span class='mathcmd'>\bmod</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>0</span><span class='exclmath'>$</span><span class='ignore'>}</span>&nbsp; <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>i</span> <span class='math'>+</span> <span class='math'>\iota</span><span class='exclmath'>$</span> <span class='ignore'>is</span> <span class='ignore'>even</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span>   <span class='exclmath'>$</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='exclmath'>$</span> <span class='ignore'>;</span><span class='exclcmd'>\quad</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\State</span>   <span class='exclmath'>$</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-\iota-1</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='ignore'>;</span><span class='exclcmd'>\quad</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-\iota</span><span class='ignore'>}</span>&nbsp; <span class='exclmath'>$</span><br>
&nbsp; &nbsp; &nbsp; &nbsp;  <span class='exclcmd'>\Else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='ignore'>;</span><span class='exclcmd'>\quad</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>+</span><span class='math'>\iota</span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span>&nbsp; <span class='exclmath'>$</span> <span class='exclcmd'>\;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>i-\iota</span><span class='ignore'>}</span>&nbsp; <span class='exclmath'>$</span> <span class='ignore'>;</span><span class='exclcmd'>\quad</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='mathcmd'>\extremaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>i-\iota-1</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='exclcmd'>\;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp; <span class='exclcmd'>\EndIf</span><br>
&nbsp;&nbsp;&nbsp; <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\left</span><span class='math'>\{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha </span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span>&nbsp; <span class='math'>-</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>)</span><span class='math'>+</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta&nbsp;  </span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>(</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='ignore'>}</span><span class='ignore'>{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha&nbsp; </span><span class='math'>(</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span> <span class='math'>-</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>)</span><span class='math'>+</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta&nbsp;  </span><span class='math'>(</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>}</span><span class='math'>,</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp;  <span class='math'>(</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>)</span>&nbsp; <span class='ignore'>}</span><span class='ignore'>{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha&nbsp; </span><span class='math'>(</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>a</span><span class='ignore'>}</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta&nbsp;  </span><span class='math'>(</span><span class='mathcmd'>\maximaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>-</span><span class='mathcmd'>\minimaTheta</span><span class='ignore'>{</span><span class='math'>b</span><span class='ignore'>}</span><span class='math'>)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='exclmath'>$</span> <span class='exclcmd'>\;</span><br>
&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\State</span> <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>Return</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>}</span><span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='ignore'>\{</span><span class='ignore'>angle</span><span class='ignore'>,</span>&nbsp; <span class='ignore'>maximum</span> <span class='ignore'>perturbation</span><span class='ignore'>\}</span> <span class='ignore'>}</span><br>
<span class='exclcmd'>\EndFunction</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\caption</span><span class='ignore'>{</span><span class='ignore'>A</span> <span class='ignore'>function</span> <span class='ignore'>which</span> <span class='ignore'>returns</span> <span class='ignore'>the</span> <span class='ignore'>angular</span> <span class='ignore'>position</span> <span class='ignore'>of</span> <span class='ignore'>compromise</span> <span class='ignore'>between</span> <span class='ignore'>the</span> <span class='ignore'>perturbations</span> <span class='ignore'>to</span> <span class='ignore'>the</span> <span class='ignore'>channels</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>thetaX</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{algorithm}</span><br>
<span class='comment'>%the angular position of the intercept and the maximum perturbation at that value</span><br>
<br>
<span class='word'>To</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>angular</span> <span class='word'>value</span> <span class='word'>closest</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>produces</span> <span class='word'>a</span> <span class='word'>perturbation</span> <span class='word'>less</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='mathgroup'>$</span><span class='math'>\tau</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>algorithm</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>newTheta</span><span class='ignore'>}</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>closest</span> <span class='word'>value</span> <span class='word'>which</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>positive</span> <span class='word'>and</span> <span class='word'>negative</span> <span class='word'>directions</span> <span class='word'>and</span> <span class='word'>returns</span> <span class='word'>the</span> <span class='word'>nearest</span> <span class='word'>one</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>requested</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>Algorithm</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>newTheta</span><span class='ignore'>}</span> <span class='word'>is</span> <span class='word'>guaranteed</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>a</span> <span class='word'>value</span> <span class='word'>which</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>tolerance</span> <span class='word'>in</span> <span class='word'>each</span> <span class='word'>direction</span> <span class='word'>within</span> <span class='word'>a</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>region</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>perturbation</span> <span class='word'>is</span> <span class='word'>zero</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>ends</span> <span class='word'>of</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>region</span><span class='ignore'>.</span><br>
 <br>
<span class='envir'>\begin</span><span class='envir'>{algorithm}</span><span class='option'>[H]</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;<span class='exclcmd'>\Require</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='exclmath'>$</span><span class='ignore'>,</span> <span class='exclmath'>$</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>maximum</span> <span class='ignore'>allowed</span> <span class='ignore'>perturbation</span> <span class='ignore'>to</span> <span class='ignore'>the</span> <span class='ignore'>channels</span><span class='ignore'>}</span><br>
&nbsp; <span class='exclcmd'>\State</span> <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Require</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>{</span> <span class='exclmath'>$</span><span class='math'>\theta</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>requested</span> <span class='ignore'>angle</span><span class='ignore'>;</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\Ensure</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='mathcmd'>\vartheta</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>suggested</span> <span class='ignore'>value</span> <span class='ignore'>for</span> <span class='exclmath'>$</span><span class='math'>\theta</span><span class='exclmath'>$</span> <span class='ignore'>and</span>&nbsp; <span class='exclmath'>$</span><span class='math'>h</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>predicted</span> <span class='ignore'>maximum</span> <span class='ignore'>perturbation</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\State</span>  <span class='exclenv'>\begin</span><span class='exclenv'>{tabular*}</span><span class='ignore'>{</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>c</span> <span class='ignore'>@</span><span class='ignore'>{</span><span class='ignore'>\extracolsep</span><span class='ignore'>{</span><span class='ignore'>\fill</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>lll</span><span class='ignore'>}</span><br>
 <span class='exclmath'>$</span><span class='math'>\delta\theta </span><span class='mathcmd'>\gets</span> <span class='math'>\theta </span><span class='mathcmd'>\bmod</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='exclmath'>$</span><span class='ignore'>;</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='math'>\Theta </span><span class='mathcmd'>\gets</span> <span class='math'>\theta </span><span class='math'>-</span> <span class='math'>\delta\theta</span><span class='exclmath'>$</span><span class='ignore'>;</span>&nbsp; <span class='ignore'>&amp;</span>&nbsp; <span class='exclmath'>$</span><span class='mathcmd'>\meanIndx</span> <span class='mathcmd'>\gets</span>  <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>;</span><br>
 <span class='exclenv'>\end</span><span class='exclenv'>{tabular*}</span><br>
&nbsp; <span class='exclcmd'>\State</span>  <span class='exclenv'>\begin</span><span class='exclenv'>{tabular*}</span><span class='ignore'>{</span><span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>c</span> <span class='ignore'>@</span><span class='ignore'>{</span><span class='ignore'>\extracolsep</span><span class='ignore'>{</span><span class='ignore'>\fill</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='ignore'>ll</span><span class='ignore'>}</span><br>
&nbsp;<span class='exclmath'>$</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\meanIndx</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\delta \theta </span><span class='math'>)</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\delta \theta </span><span class='math'>)</span><span class='math'>+</span><span class='math'>7</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\tan</span> <span class='math'>(</span><span class='math'>\delta \theta </span><span class='math'>)</span><span class='math'>+</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='ignore'>;</span> <span class='ignore'>&amp;</span> <br>
&nbsp; <span class='exclmath'>$</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='math'>,</span> <span class='math'>n</span><span class='ignore'>}</span><span class='exclmath'>$</span><br>
&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{tabular*}</span><br>
 <span class='exclcmd'>\While</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span> <span class='math'>&gt;</span> <span class='math'>1</span><span class='exclmath'>$</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='math'>+</span><span class='math'>+</span><span class='exclmath'>$</span> <span class='exclcmd'>\;</span><br>
 <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='math'>,</span> <span class='math'>n</span><span class='ignore'>}</span><span class='exclmath'>$</span><br>
 <span class='exclcmd'>\EndWhile</span><br>
 <span class='exclcmd'>\While</span><span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span> <span class='math'>&gt;</span> <span class='math'>1</span><span class='exclmath'>$</span><span class='ignore'>}</span><br>
&nbsp; <span class='exclcmd'>\State</span>   <span class='exclmath'>$</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>-</span><span class='exclmath'>$</span> <span class='exclcmd'>\;</span><br>
&nbsp;<span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathcmd'>\gets</span> <span class='mathcmd'>\thetaX</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='math'>,</span> <span class='math'>n</span><span class='ignore'>}</span><span class='exclmath'>$</span><br>
 <span class='exclcmd'>\EndWhile</span><br>
&nbsp;<span class='exclcmd'>\If</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span> <span class='math'>-</span><span class='math'>\delta\theta </span><span class='math'>&lt;</span> <span class='math'>\delta\theta </span><span class='math'>-</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>}</span><br>
 <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>,</span> <span class='math'>h</span><span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>\Theta </span><span class='math'>+</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\oplus</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='exclmath'>$</span> <br>
 <span class='exclcmd'>\Else</span><br>
&nbsp;<span class='exclcmd'>\State</span> <span class='exclmath'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>,</span> <span class='math'>h</span><span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>\Theta </span><span class='math'>+</span> <span class='mathcmd'>\vartheta</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>h</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\circleddash</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='exclmath'>$</span><br>
&nbsp; <span class='exclcmd'>\EndIf</span><br>
 <span class='exclcmd'>\State</span> <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>Return</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='exclmath'>$</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\vartheta</span><span class='math'>,</span> <span class='math'>h</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='exclmath'>$</span> <span class='ignore'>}</span><br>
&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\caption</span><span class='ignore'>{</span><span class='ignore'>Suggest</span> <span class='ignore'>a</span> <span class='ignore'>new</span> <span class='ignore'>value</span> <span class='ignore'>for</span> <span class='exclmath'>$</span><span class='math'>\theta</span><span class='exclmath'>$</span><span class='ignore'>}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>newTheta</span><span class='ignore'>}</span><br>
 <span class='envir'>\end</span><span class='envir'>{algorithm}</span><br>
 <br>
 <span class='word'>This</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>construct</span> <span class='word'>an</span> <span class='word'>integer</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>sufficiently</span> <span class='word'>close</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>floating</span> <span class='word'>point</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>that</span> <span class='word'>it</span> <span class='word'>introduces</span> <span class='word'>an</span> <span class='word'>error</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>no</span> <span class='word'>greater</span> <span class='word'>than</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='mathgroup'>$</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>chromatic</span> <span class='word'>channels</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>only</span> <span class='word'>question</span> <span class='word'>left</span> <span class='word'>is</span> <span class='word'>how</span> <span class='word'>onerous</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>restriction</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>choice</span> <span class='word'>of</span> <span class='word'>angle</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>useless</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>suggested</span> <span class='word'>angle</span> <span class='word'>is</span> <span class='word'>very</span> <span class='word'>different</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>requested</span> <span class='word'>angle</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>investigate</span> <span class='word'>this</span> <span class='word'>lets</span> <span class='word'>look</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>special</span> <span class='word'>case</span> <span class='word'>where</span> <span class='word'>no</span> <span class='word'>error</span> <span class='word'>is</span> <span class='word'>allowed</span><span class='ignore'>.</span><br>
 <span class='word'>The</span> <span class='word'>criteria</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha </span><span class='math'>=</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta </span><span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='mathcmd'>\textonehalf</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>gives</span> <span class='word'>an</span> <span class='word'>integer</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>which</span> <span class='word'>produces</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>effect</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>floating</span> <span class='word'>point</span> <span class='word'>rotation</span> <span class='word'>matrix</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>also</span> <span class='word'>selects</span> <span class='word'>from</span> <span class='word'>either</span> <span class='word'>the</span> <span class='word'>odd</span> <span class='word'>values</span> <span class='word'>or</span> <span class='word'>the</span> <span class='word'>even</span> <span class='word'>values</span> <span class='word'>of</span> <span class='word'>i</span><span class='ignore'>,</span> <span class='word'>because</span> <span class='word'>if</span> <span class='mathgroup'>$</span><span class='math'>h</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>\iota</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='mathcmd'>\textonehalf</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>true</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='mathgroup'>$</span><span class='math'>h</span><span class='math'>(</span><span class='math'>i</span><span class='math'>+</span><span class='math'>1</span><span class='math'>,</span><span class='math'>n</span><span class='math'>,</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\alpha</span><span class='math'>,</span> <span class='mathcmd'>\tau</span><span class='math'>_</span><span class='math'>\beta</span><span class='math'>)</span><span class='math'>&lt;</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='mathcmd'>\textonehalf</span><span class='ignore'>}</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>is</span> <span class='word'>false</span> <span class='word'>and</span> <span class='word'>vice</span> <span class='word'>versa</span><span class='ignore'>.</span> <span class='word'>There</span> <span class='word'>are</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-2</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>intersection</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n-3</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>satisfy</span> <span class='word'>the</span> <span class='word'>criteria</span> <span class='mathgroup'>$</span><span class='math'>\tau </span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>in</span> <span class='word'>each</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>region</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>For</span> <span class='word'>a</span> <span class='word'>24</span> <span class='word'>bit</span> <span class='word'>color</span> <span class='word'>image</span> <span class='mathgroup'>$</span><span class='math'>n</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>8</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='mathgroup'>$</span><span class='mathcmd'>\intR</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span> <span class='math'>-</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>8-2</span><span class='ignore'>}</span> <span class='mathcmd'>\cdots</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>8-2</span><span class='ignore'>}</span> <span class='math'>\}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>gives</span> <span class='mathgroup'>$</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>8-3</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>values</span> <span class='word'>in</span> <span class='word'>each</span> <span class='mathgroup'>$</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\pi</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>6</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>region</span><span class='ignore'>,</span> <span class='word'>producing</span> <span class='word'>a</span> <span class='word'>maximum</span> <span class='word'>perturbation</span> <span class='word'>of</span> <span class='word'>less</span> <span class='word'>than</span> <span class='cmd'>\textonehalf</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>total</span><span class='ignore'>,</span> <span class='word'>there</span> <span class='word'>are</span> <span class='mathgroup'>$</span><span class='math'>12</span> <span class='math'>(</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>8-3</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>=</span> <span class='math'>372</span><span class='mathgroup'>$</span> <span class='word'>possible</span> <span class='word'>values</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>produces</span> <span class='word'>a</span> <span class='word'>maximum</span> <span class='word'>perturbation</span> <span class='word'>of</span> <span class='word'>less</span> <span class='word'>than</span> <span class='cmd'>\textonehalf</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>would</span> <span class='word'>allow</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>expressed</span> <span class='word'>in</span> <span class='word'>8-bit</span> <span class='word'>numbers</span> <span class='word'>without</span> <span class='word'>error</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>transformation</span> <span class='word'>matrix</span> <span class='word'>expressed</span> <span class='word'>in</span> <span class='word'>6-bit</span> <span class='word'>signed</span> <span class='word'>integers</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>statistics</span> <span class='word'>performed</span> <span class='word'>to</span> <span class='word'>determine</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>demanding</span> <span class='word'>enough</span> <span class='word'>to</span> <span class='word'>justify</span> <span class='word'>rejecting</span> <span class='word'>a</span> <span class='word'>suggested</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>within</span> <span class='word'>1</span><span class='cmd'>\textdegree</span>  <span class='word'>of</span> <span class='word'>the</span> <span class='word'>requested</span> <span class='word'>value</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>is</span><span class='ignore'>,</span> <span class='word'>however</span><span class='ignore'>,</span> <span class='word'>important</span> <span class='word'>to</span> <span class='word'>know</span> <span class='word'>the</span> <span class='word'>value</span> <span class='word'>actually</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>algorithm</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>why</span> <span class='word'>the</span> <span class='word'>mechanism</span> <span class='word'>for</span> <span class='word'>adjusting</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>separate</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>color-space</span> <span class='word'>algorithm</span> <span class='word'>and</span> <span class='word'>is</span> <span class='word'>under</span> <span class='word'>the</span> <span class='word'>control</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>programmer</span><span class='ignore'>.</span><br>
<br>
<br>
<br>
<span class='cmd'>\chapter</span><span class='ignore'>{</span><span class='hword'>Preservation</span> <span class='hword'>of</span> <span class='hword'>Color</span> <span class='hword'>Information</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>app</span><span class='ignore'>:</span><span class='ignore'>PreservationOfColorInformation</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>goal</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>preserve</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>captured</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>which</span> <span class='word'>relates</span> <span class='word'>to</span> <span class='word'>skin</span> <span class='word'>whilst</span> <span class='word'>discarding</span> <span class='word'>as</span> <span class='word'>much</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>irrelevant</span> <span class='word'>information</span> <span class='word'>as</span> <span class='word'>possible</span><span class='ignore'>.</span> <span class='word'>Given</span> <span class='word'>that</span> <span class='word'>edges</span> <span class='word'>and</span> <span class='word'>features</span> <span class='word'>often</span> <span class='word'>present</span> <span class='word'>as</span> <span class='word'>shadows</span> <span class='word'>and</span> <span class='word'>highlights</span><span class='ignore'>,</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>captured</span> <span class='word'>in</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>luminosity</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>regarded</span> <span class='word'>as</span> <span class='word'>relevant</span> <span class='word'>information</span><span class='ignore'>,</span> <span class='word'>at</span> <span class='word'>least</span> <span class='word'>as</span> <span class='word'>far</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>manipulation</span> <span class='word'>of</span> <span class='word'>individual</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>is</span> <span class='word'>concerned</span><span class='ignore'>.</span> <span class='word'>Considering</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>importance</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>directly</span> <span class='word'>determined</span> <span class='word'>by</span> <span class='word'>a</span> <span class='word'>Gaussian</span> <span class='word'>distribution</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Knowing</span> <span class='word'>the</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>values</span> <span class='word'>produced</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>scale</span> <span class='word'>the</span> <span class='word'>transformation</span> <span class='word'>to</span> <span class='word'>fit</span> <span class='word'>into</span> <span class='word'>the</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>data</span> <span class='word'>type</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>RGB</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>machine</span> <span class='word'>data</span> <span class='word'>type</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>amount</span> <span class='word'>of</span> <span class='word'>information</span> <span class='word'>contained</span> <span class='word'>in</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>those</span> <span class='word'>channels</span> <span class='word'>is</span> <span class='word'>equal</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>values</span> <span class='word'>accessible</span> <span class='word'>in</span> <span class='word'>that</span> <span class='word'>data</span> <span class='word'>type</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>example</span><span class='ignore'>:</span> <span class='word'>for</span> <span class='word'>8-bit</span><span class='ignore'>,</span> <span class='word'>unsigned</span> <span class='word'>integers</span><span class='ignore'>,</span> <span class='word'>there</span> <span class='word'>are</span> <span class='word'>256</span> <span class='word'>possible</span> <span class='word'>values</span><span class='ignore'>.</span> <span class='word'>After</span> <span class='word'>a</span> <span class='word'>rotation</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>are</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>amount</span> <span class='word'>of</span> <span class='word'>information</span> <span class='word'>which</span> <span class='word'>lies</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>axes</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>simply</span> <span class='word'>by</span> <span class='word'>multiplying</span> <span class='word'>the</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>length</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>axes</span> <span class='word'>found</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>unit</span> <span class='word'>cube</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>preserve</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>captured</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>would</span> <span class='word'>therefore</span> <span class='word'>have</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>larger</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>to</span> <span class='word'>store</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>values</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>are</span><span class='ignore'>,</span> <span class='word'>however</span><span class='ignore'>,</span> <span class='word'>only</span> <span class='word'>interested</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>small</span> <span class='word'>region</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>question</span> <span class='word'>is</span><span class='ignore'>,</span> <span class='word'>then</span><span class='ignore'>,</span> <span class='word'>how</span> <span class='word'>to</span> <span class='word'>preserve</span> <span class='word'>the</span> <span class='word'>relevant</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>way</span> <span class='word'>consistent</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>significance</span> <span class='word'>indicated</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>aforementioned</span> <span class='word'>Gaussian</span> <span class='word'>distribution</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='word'>None</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>axes</span> <span class='word'>have</span> <span class='word'>lengths</span> <span class='word'>less</span> <span class='word'>than</span> <span class='word'>1</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>unit</span> <span class='word'>RGB</span> <span class='word'>cube</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>this</span> <span class='word'>reason</span> <span class='word'>we've</span> <span class='word'>written</span> <span class='word'>re-distribution</span> <span class='word'>functions</span> <span class='word'>which</span> <span class='word'>perform</span> <span class='word'>any</span> <span class='word'>necessary</span> <span class='word'>type</span> <span class='word'>conversion</span> <span class='word'>whilst</span> <span class='word'>preserving</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>controlled</span> <span class='word'>way</span><span class='ignore'>;</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>keep</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>where</span> <span class='word'>it's</span> <span class='word'>needed</span> <span class='word'>and</span> <span class='word'>discard</span> <span class='word'>it</span> <span class='word'>where</span> <span class='word'>it's</span> <span class='word'>irrelevant</span><span class='ignore'>.</span> <span class='word'>So</span> <span class='word'>although</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>strictly</span> <span class='word'>beyond</span> <span class='word'>the</span> <span class='word'>normal</span> <span class='word'>meaning</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>conversion</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>addressing</span> <span class='word'>a</span> <span class='word'>connected</span> <span class='word'>issue</span> <span class='word'>and</span> <span class='word'>belongs</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>conversion</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>optimization</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>also</span> <span class='word'>the</span> <span class='word'>most</span> <span class='word'>efficient</span> <span class='word'>place</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>in</span> <span class='word'>which</span> <span class='word'>to</span> <span class='word'>perform</span> <span class='word'>this</span> <span class='word'>adjustment</span><span class='ignore'>,</span> <span class='word'>allowing</span> <span class='word'>us</span> <span class='word'>to</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>sake</span> <span class='word'>of</span> <span class='word'>example</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>discard</span> <span class='word'>the</span> <span class='word'>details</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>colors</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>duck's</span> <span class='word'>feathers</span> <span class='word'>whilst</span> <span class='word'>keeping</span> <span class='word'>the</span> <span class='word'>hues</span> <span class='word'>and</span> <span class='word'>tones</span> <span class='word'>of</span> <span class='word'>human</span> <span class='word'>skin</span><span class='ignore'>.</span><br>
<br>
<span class='word'>We</span> <span class='word'>can</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>function</span> <span class='word'>to</span> <span class='word'>redistribute</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>contained</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>longer</span> <span class='word'>axis</span> <span class='word'>onto</span> <span class='word'>the</span> <span class='word'>shorter</span> <span class='word'>axis</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>expressed</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>discrete</span> <span class='word'>representation</span> <span class='word'>of</span> <span class='word'>that</span> <span class='word'>axis</span> <span class='word'>necessitated</span> <span class='word'>by</span> <span class='word'>internal</span> <span class='word'>integer</span> <span class='word'>data</span> <span class='word'>types</span><span class='ignore'>.</span> <span class='word'>There</span> <span class='word'>are</span> <span class='word'>three</span> <span class='word'>ways</span> <span class='word'>in</span> <span class='word'>which</span> <span class='word'>to</span> <span class='word'>implement</span> <span class='word'>the</span> <span class='word'>re-distribution</span> <span class='word'>functions</span><span class='ignore'>:</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Partition</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>Partition</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>most</span> <span class='word'>straightforward</span> <span class='word'>re-distribution</span> <span class='word'>method</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>simply</span> <span class='word'>preserve</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>1-to-1</span> <span class='word'>fashion</span> <span class='word'>within</span> <span class='word'>a</span> <span class='word'>region</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>region</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>defined</span> <span class='word'>in</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>Gaussian</span> <span class='word'>by</span> <span class='word'>specifying</span> <span class='word'>a</span> <span class='word'>significance</span> <span class='word'>level</span> <span class='word'>in</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>variance</span> <span class='word'>or</span> <span class='word'>the</span> <span class='word'>standard</span> <span class='word'>deviation</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Linear</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>Linear</span><span class='ignore'>}</span><br>
<br>
<span class='word'>A</span> <span class='word'>slightly</span> <span class='word'>more</span> <span class='word'>sophisticated</span> <span class='word'>method</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>linear</span> <span class='word'>re-distribution</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='word'>linear</span> <span class='word'>distribution</span> <span class='word'>is</span> <span class='word'>equivalent</span> <span class='word'>to</span> <span class='word'>partitioning</span> <span class='word'>given</span> <span class='word'>a</span> <span class='word'>unit</span> <span class='word'>gradient</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>linear</span> <span class='word'>re-distribution</span> <span class='word'>function</span> <span class='word'>allows</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>possibility</span> <span class='word'>of</span> <span class='word'>data</span> <span class='word'>compression</span><span class='ignore'>.</span> <span class='word'>So</span> <span class='word'>then</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>of</span> <span class='word'>interest</span> <span class='word'>contains</span> <span class='word'>more</span> <span class='word'>information</span> <span class='word'>than</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>expressed</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>data</span> <span class='word'>type</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>linear</span> <span class='word'>distribution</span> <span class='word'>function</span> <span class='word'>allows</span> <span class='word'>an</span> <span class='word'>even</span> <span class='word'>compression</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>from</span> <span class='word'>source</span> <span class='word'>to</span> <span class='word'>destination</span><span class='ignore'>.</span> <span class='ignore'>~</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Lee2002</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>ERF</span> <span class='ignore'>(</span><span class='hword'>Gaussian</span> <span class='hword'>Error</span> <span class='hword'>Function</span><span class='ignore'>)</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ERF</span><span class='ignore'>}</span><br>
<br>
<span class='word'>The</span> <span class='word'>integral</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>cumulative</span> <span class='word'>Gaussian</span> <span class='ignore'>(</span><span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>Error</span> <span class='word'>Function</span><span class='ignore'>)</span> <span class='word'>allows</span> <span class='word'>the</span> <span class='word'>re-distribution</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>way</span> <span class='word'>which</span> <span class='word'>selectively</span> <span class='word'>preserves</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>about</span> <span class='word'>a</span> <span class='word'>point</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='ignore'>(</span><span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>Gaussian</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>progressively</span> <span class='word'>discard</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>as</span> <span class='word'>it</span> <span class='word'>falls</span> <span class='word'>into</span> <span class='word'>the</span> <span class='word'>tails</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>Gaussian</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>provides</span> <span class='word'>a</span> <span class='word'>non-linear</span> <span class='word'>distribution</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>Gaussian</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>as</span> <span class='word'>describing</span> <span class='word'>our</span> <span class='word'>interest</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>contained</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>axis</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>it's</span> <span class='word'>logical</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>the</span> <span class='word'>error</span> <span class='word'>function</span> <span class='word'>to</span> <span class='word'>redistribute</span> <span class='word'>the</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>disadvantage</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>simply</span> <span class='word'>the</span> <span class='word'>computational</span> <span class='word'>effort</span> <span class='word'>involved</span> <span class='word'>in</span> <span class='word'>generating</span> <span class='word'>the</span> <span class='word'>error</span> <span class='word'>function</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>error</span> <span class='word'>function</span> <span class='word'>distribution</span> <span class='word'>is</span> <span class='word'>mathematically</span> <span class='word'>correct</span><span class='ignore'>,</span> <span class='word'>being</span> <span class='word'>directly</span> <span class='word'>related</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>Gaussian</span> <span class='word'>fit</span><span class='ignore'>.</span> <span class='word'>Computationally</span><span class='ignore'>,</span> <span class='word'>there</span> <span class='word'>are</span> <span class='word'>two</span> <span class='word'>considerations</span><span class='ignore'>:</span> <span class='word'>the</span> <span class='word'>numerical</span> <span class='word'>representation</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>performance</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>discrete</span> <span class='word'>representation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>numerics</span> <span class='word'>means</span> <span class='word'>that</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>significant</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>possible</span> <span class='word'>distributions</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>distributing</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>error</span> <span class='word'>function</span> <span class='word'>has</span> <span class='word'>little</span> <span class='word'>to</span> <span class='word'>no</span> <span class='word'>advantage</span> <span class='ignore'>(</span><span class='word'>or</span> <span class='word'>indeed</span> <span class='word'>difference</span><span class='ignore'>)</span> <span class='word'>from</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>linear</span> <span class='word'>distribution</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Considering</span> <span class='word'>the</span> <span class='word'>preservation</span> <span class='word'>of</span> <span class='word'>information</span> <span class='word'>captured</span><span class='ignore'>,</span> <span class='word'>mappings</span> <span class='word'>with</span> <span class='word'>a</span> <span class='word'>gradient</span> <span class='word'>greater</span> <span class='word'>than</span> <span class='word'>1</span> <span class='word'>are</span> <span class='word'>undesirable</span> <span class='word'>because</span> <span class='word'>they</span> <span class='word'>preserve</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>whilst</span> <span class='word'>being</span> <span class='word'>informatically</span> <span class='word'>wasteful</span> <span class='word'>in</span> <span class='word'>that</span> <span class='word'>there</span> <span class='word'>are</span> <span class='word'>functionally</span> <span class='word'>inaccessible</span> <span class='word'>discrete</span> <span class='word'>values</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>range</span><span class='ignore'>.</span> <span class='word'>Our</span> <span class='word'>stated</span> <span class='word'>aim</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>preserve</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>pertaining</span> <span class='word'>to</span> <span class='word'>human</span> <span class='word'>skin</span><span class='ignore'>;</span> <span class='word'>unevenly</span> <span class='word'>distributing</span> <span class='word'>this</span> <span class='word'>information</span> <span class='word'>across</span> <span class='word'>a</span> <span class='word'>discrete</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>only</span> <span class='word'>wasteful</span> <span class='word'>in</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>memory</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>also</span> <span class='word'>of</span> <span class='word'>processing</span> <span class='word'>resources</span> <span class='word'>because</span> <span class='word'>subsequent</span> <span class='word'>processing</span> <span class='word'>routines</span> <span class='word'>will</span> <span class='word'>treat</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>as</span> <span class='word'>if</span> <span class='word'>it</span> <span class='word'>has</span> <span class='word'>a</span> <span class='word'>higher</span> <span class='word'>fidelity</span> <span class='word'>than</span> <span class='word'>it</span> <span class='word'>actually</span> <span class='word'>does</span><span class='ignore'>.</span><br>
<br>
<span class='word'>To</span> <span class='word'>construct</span> <span class='word'>a</span> <span class='word'>distribution</span> <span class='word'>function</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>first</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>describe</span> <span class='word'>the</span> <span class='word'>relationship</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>error</span> <span class='word'>function</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>Gaussian</span> <span class='word'>fit</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>produce</span> <span class='word'>a</span> <span class='word'>function</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>appropriate</span> <span class='word'>range</span> <span class='word'>and</span> <span class='word'>domain</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>a</span> <span class='word'>Gaussian</span> <span class='word'>fit</span> <span class='word'>with</span> <span class='word'>an</span> <span class='word'>amplitude</span> <span class='word'>A</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>mean</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\mu</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>standard</span> <span class='word'>deviation</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='math'>\mu</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>x</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>lie</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>source</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='mathcmd'>\xRange</span><span class='mathgroup'>$</span> <span class='word'>from</span> <span class='mathgroup'>$</span><span class='mathcmd'>\xMin</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='mathcmd'>\xMax</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>cumulative</span> <span class='word'>distribution</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>integrating</span> <span class='word'>from</span> <span class='mathgroup'>$</span><span class='mathcmd'>\xMin</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>point</span> <span class='mathgroup'>$</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>x</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>ErfDefinition</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>ErfDefinition</span><span class='ignore'>}</span><br>
&nbsp;<span class='mathcmd'>\int</span> <span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\xMin</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>x</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>A</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>e</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>t-\mu </span><span class='math'>)</span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\sigma </span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\pi </span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='math'>dt</span> <span class='math'>=</span> <br>
&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>A</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>x</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\xMin</span><span class='math'>-</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>The</span> <span class='word'>Gaussian</span> <span class='word'>distribution</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>cumulative</span> <span class='word'>distribution</span> <span class='word'>are</span> <span class='word'>shown</span> <span class='word'>in</span> <span class='word'>Figure</span><span class='ignore'>~</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ErrorFunctionGraph</span><span class='ignore'>}</span> <span class='word'>for</span> <span class='word'>some</span> <span class='word'>values</span> <span class='word'>chosen</span> <span class='word'>for</span> <span class='word'>illustrative</span> <span class='word'>purposes</span><span class='ignore'>.</span> <span class='word'>All</span> <span class='word'>that</span> <span class='word'>is</span> <span class='word'>required</span> <span class='word'>now</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>fix</span> <span class='word'>the</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='mathcmd'>\yMin</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='mathcmd'>\yMax</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>domain</span> <span class='mathgroup'>$</span><span class='mathcmd'>\xMin</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='mathcmd'>\xMax</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span> <span class='comment'>%hi-res</span><br>
&nbsp;<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Error</span> <span class='oword'>function</span><span class='ignore'>.</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ErrorFunctionGraph</span><span class='ignore'>}</span><br>
&nbsp; <span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>errorFunction.jpg</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>First</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>determine</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>value</span> <span class='word'>taken</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>domain</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>simply</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>evaluating</span> <span class='word'>the</span> <span class='word'>function</span> <span class='word'>at</span> <span class='mathgroup'>$</span><span class='mathcmd'>\xMax</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>noted</span> <span class='word'>that</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>Gaussian</span> <span class='word'>distribution</span> <span class='word'>is</span> <span class='word'>well</span> <span class='word'>contained</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>domain</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>value</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>equal</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>amplitude</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>the</span> <span class='word'>sake</span> <span class='word'>of</span> <span class='word'>simplicity</span><span class='ignore'>,</span> <span class='word'>we'll</span> <span class='word'>ignore</span> <span class='word'>the</span> <span class='word'>amplitude</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>fitted</span> <span class='word'>Gaussian</span> <span class='word'>found</span> <span class='word'>previously</span> <span class='word'>as</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>relevant</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>design</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>re-distribution</span> <span class='word'>function</span><span class='ignore'>.</span> <span class='word'>So</span><span class='ignore'>,</span> <span class='word'>to</span> <span class='word'>fix</span> <span class='word'>the</span> <span class='word'>range</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>function</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>first</span> <span class='word'>scale</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='math'>:</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>by</span> <span class='word'>simply</span> <span class='word'>dividing</span> <span class='word'>through</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>value</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>re-scale</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='mathcmd'>\yRange</span> <span class='math'>=</span> <span class='mathcmd'>\yMax</span> <span class='math'>-</span> <span class='mathcmd'>\yMin</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>shift</span> <span class='word'>by</span> <span class='mathgroup'>$</span><span class='mathcmd'>\yMin</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>disFunction</span><span class='ignore'>}</span><br>
&nbsp;<span class='math'>dis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>(</span><span class='mathcmd'>\yRange</span><span class='math'>)</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>x-\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\xMin</span><span class='math'>-</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\xMax</span><span class='math'>-</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\xMin</span><span class='math'>-</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>+</span><span class='mathcmd'>\yMin</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Efficiently</span> <span class='hword'>Implementing</span> <span class='hword'>the</span> <span class='hword'>Distribution</span> <span class='hword'>Function</span><span class='ignore'>}</span><br>
<span class='word'>Mathematically</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>ERF</span> <span class='word'>distribution</span> <span class='word'>function</span><span class='ignore'>~</span><span class='ignore'>(</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>disFunction</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='word'>achieves</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>stated</span> <span class='word'>objectives</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>device</span> <span class='word'>we</span> <span class='word'>are</span> <span class='word'>dealing</span> <span class='word'>with</span> <span class='word'>discrete</span> <span class='word'>numerics</span> <span class='word'>and</span> <span class='word'>limited</span> <span class='word'>processing</span> <span class='word'>power</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>further</span> <span class='word'>analysis</span> <span class='word'>is</span> <span class='word'>required</span><span class='ignore'>.</span> <span class='word'>Where</span> <span class='word'>we're</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>discrete</span> <span class='word'>domain</span> <span class='word'>and</span> <span class='word'>range</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>is</span> <span class='word'>usefully</span> <span class='word'>divided</span> <span class='word'>into</span> <span class='word'>three</span> <span class='word'>characteristic</span> <span class='word'>behaviours</span><span class='ignore'>:</span>&nbsp; <span class='word'>where</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>constant</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='word'>it</span> <span class='word'>preserves</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>where</span> <span class='word'>it</span> <span class='word'>selectively</span> <span class='word'>preserves</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>Looking</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>distribution</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>divides</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>domain</span> <span class='word'>into</span> <span class='word'>five</span> <span class='word'>regions</span><span class='ignore'>:</span> <span class='word'>two</span> <span class='word'>where</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>effectively</span> <span class='word'>constant</span><span class='ignore'>,</span> <span class='word'>two</span> <span class='word'>where</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>selective</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>one</span> <span class='word'>region</span> <span class='word'>around</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>where</span> <span class='word'>it</span> <span class='word'>preserves</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>design</span> <span class='word'>an</span> <span class='word'>efficient</span> <span class='word'>algorithm</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>useful</span> <span class='word'>to</span> <span class='word'>identify</span> <span class='word'>the</span> <span class='word'>boundaries</span> <span class='word'>of</span> <span class='word'>these</span> <span class='word'>five</span> <span class='word'>regions</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>Region</span> <span class='hword'>Which</span> <span class='hword'>Discards</span> <span class='hword'>All</span> <span class='hword'>Information</span><span class='ignore'>}</span><br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.7\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>EffectivlyConstantRange</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>region</span> <span class='oword'>which</span> <span class='oword'>discards</span> <span class='oword'>all</span> <span class='oword'>information</span> <span class='oword'>beyond</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='oword'>is</span> <span class='oword'>shown</span> <span class='oword'>above</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>shaded</span> <span class='oword'>grid</span> <span class='oword'>squares</span> <span class='oword'>show</span> <span class='oword'>the</span> <span class='oword'>value</span> <span class='oword'>actually</span> <span class='oword'>taken</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>discrete</span> <span class='oword'>distribution</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>EffectivlyConstantRange</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<br>
<span class='word'>First</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>identify</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>is</span> <span class='word'>effectively</span> <span class='word'>constant</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>solving</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>equation</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>and</span> <span class='word'>domain</span> <span class='mathgroup'>$</span><span class='math'>0</span> <span class='mathcmd'>\le</span> <span class='math'>x</span> <span class='mathcmd'>\le</span> <span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>generalized</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>specific</span> <span class='word'>discrete</span> <span class='word'>numerics</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>0to1</span><span class='ignore'>}</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>+</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>x-\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu -1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>=</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\yRange</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\yRange</span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>\}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<br>
<span class='word'>The</span> <span class='word'>solution</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>domain</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='math'>:</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>as</span><span class='ignore'>:</span><br>
<br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>LowHigh</span><span class='ignore'>}</span><br>
 <span class='math'>x</span> <span class='math'>=</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma&nbsp; </span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>1</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>(</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span><span class='math'>)</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu -1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>+</span><span class='math'>\mu
</span><span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<br>
<span class='word'>The</span> <span class='word'>boundaries</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>regions</span> <span class='mathgroup'>$</span><span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span> <span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span> <span class='math'>x</span> <span class='math'>&gt;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>x</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='mathcmd'>\tMin</span> <span class='mathcmd'>\cdots</span> <span class='mathcmd'>\tMax</span> <span class='math'>\}</span><span class='mathgroup'>$</span> <span class='word'>or</span> <span class='mathgroup'>$</span><span class='math'>x</span><span class='math'>&lt;</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>1</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>and</span> <span class='mathgroup'>$</span> <span class='math'>x</span> <span class='math'>&gt;</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>x</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>0</span> <span class='mathcmd'>\cdots</span> <span class='math'>1</span> <span class='math'>\}</span><span class='mathgroup'>$</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>written</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>helpful</span> <span class='word'>constants</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distribution</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>DistributionConstants</span><span class='ignore'>}</span><br>
<span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>-</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu -1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span><br>
 <span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>+</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span><br>
&nbsp; <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\yRange</span><span class='ignore'>}</span> <span class='math'>&amp;</span><br>
&nbsp; <span class='math'>\kappa </span><span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\yRange</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\tRange</span><span class='ignore'>}</span> <br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>DiscardedRegionBounds</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
<span class='exclcmd'>\discard</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>\sigma </span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>1</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>(</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>+</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span> <span class='mathcmd'>\;</span> <span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>-</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>+</span><span class='math'>\mu&nbsp; </span><span class='math'>&amp;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
<span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>\sigma </span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>1</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>(</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span><span class='math'>-</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>-</span> <span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dL</span><span class='ignore'>}</span> <span class='mathcmd'>\;</span> <span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>+</span> <span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>+</span><span class='math'>\mu </span><span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\tMin</span> <span class='math'>+</span> <span class='mathcmd'>\tRange</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>1</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <br>
<span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\tMin</span> <span class='math'>+</span> <span class='mathcmd'>\tRange</span> <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='mathcmd'>\discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>)</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>Region</span> <span class='hword'>Which</span> <span class='hword'>Keeps</span> <span class='hword'>All</span> <span class='hword'>Information</span><span class='ignore'>}</span><br>
<span class='word'>To</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>where</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>domain</span> <span class='word'>is</span> <span class='word'>preserved</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>differentiate</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>and</span> <span class='word'>solve</span> <span class='word'>for</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>gradient</span> <span class='word'>is</span> <span class='word'>equal</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>range</span> <span class='word'>over</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>range</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>corresponds</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>at</span> <span class='word'>which</span> <span class='word'>a</span> <span class='word'>unit</span> <span class='word'>change</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>produces</span> <span class='word'>a</span> <span class='word'>unit</span> <span class='word'>change</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>range</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>Boundaries</span><span class='ignore'>}</span><br>
<span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='math'>e</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>x-\mu </span><span class='math'>)</span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\sigma </span><span class='math'>^</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\sigma&nbsp; </span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu -1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>=</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\yRange</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\tRange</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>Rearranging</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>x</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>find</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>PreservedRegion</span><span class='ignore'>}</span><br>
 <span class='math'>x</span><span class='math'>=</span><span class='math'>\mu </span><span class='mathcmd'>\pm</span> <span class='math'>\sigma&nbsp; </span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>-</span><span class='math'>2</span> <span class='mathcmd'>\log</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\sigma&nbsp; </span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu -1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>+</span><span class='math'>2</span> <span class='mathcmd'>\log</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\tRange</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\yRange</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>+</span><span class='mathcmd'>\log</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<br>
<span class='word'>The</span> <span class='word'>boundaries</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>region</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Keep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\Keep</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>x</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='mathcmd'>\tMin</span> <span class='mathcmd'>\cdots</span> <span class='mathcmd'>\tMax</span> <span class='math'>\}</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\keep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\keep</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='math'>x</span> <span class='mathcmd'>\in</span> <span class='math'>\{</span><span class='math'>0</span> <span class='mathcmd'>\cdots</span> <span class='math'>1</span> <span class='math'>\}</span><span class='mathgroup'>$</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>written</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>helpful</span> <span class='word'>constants</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distribution</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>DistributionConstants2</span><span class='ignore'>}</span><br>
<span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>-</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu -1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span><br>
 <span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>+</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span><br>
&nbsp; <span class='math'>\kappa </span><span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\yRange</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\tRange</span><span class='ignore'>}</span> <br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>PreservedRegionConsts</span><span class='ignore'>}</span><br>
&nbsp;<span class='math'>w</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span>&nbsp; <span class='math'>=</span>&nbsp; <span class='math'>\sigma&nbsp; </span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span> <span class='mathcmd'>\log</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>-</span><span class='math'>2</span> <span class='mathcmd'>\log</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\kappa \sigma&nbsp; </span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>+</span><span class='math'>-</span><span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>-</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>The</span> <span class='word'>equations</span> <span class='word'>are</span> <span class='word'>found</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>unit</span> <span class='word'>source</span> <span class='word'>domain</span> <span class='mathgroup'>$</span><span class='math'>0</span><span class='math'>:</span><span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>simple</span> <span class='word'>matter</span> <span class='word'>to</span> <span class='word'>scale</span> <span class='word'>and</span> <span class='word'>shift</span> <span class='word'>these</span> <span class='word'>values</span> <span class='word'>to</span> <span class='word'>give</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>more</span> <span class='word'>general</span> <span class='word'>source</span> <span class='word'>domain</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>PreservedRegionGen</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
<span class='exclcmd'>\keep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='math'>\mu </span><span class='math'>-</span> <span class='math'>w</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>&amp;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='mathcmd'>\keep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='math'>\mu </span><span class='math'>+</span> <span class='math'>w</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\Keep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\tMin</span> <span class='math'>+</span> <span class='mathcmd'>\tRange</span><span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>\mu </span><span class='math'>-</span> <span class='math'>w</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\Keep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\tMin</span> <span class='math'>+</span> <span class='mathcmd'>\tRange</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\mu </span><span class='math'>+</span> <span class='math'>w</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.7\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>ExtensionToLinearRegion</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>region</span> <span class='oword'>which</span> <span class='oword'>preserves</span> <span class='oword'>all</span> <span class='oword'>information</span> <span class='oword'>extends</span> <span class='oword'>beyond</span> <span class='oword'>the</span> <span class='oword'>analytic</span> <span class='oword'>region</span> <span class='oword'>due</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>rounding</span> <span class='oword'>involved</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>discretization</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>shaded</span> <span class='oword'>grid</span> <span class='oword'>squares</span> <span class='oword'>show</span> <span class='oword'>the</span> <span class='oword'>value</span> <span class='oword'>actually</span> <span class='oword'>taken</span> <span class='oword'>by</span> <span class='oword'>the</span> <span class='oword'>discrete</span> <span class='oword'>distribution</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>cord</span> <span class='oword'>is</span> <span class='oword'>the</span> <span class='oword'>tangent</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>distribution</span> <span class='oword'>curve</span> <span class='oword'>shifted</span> <span class='oword'>to</span> <span class='oword'>the</span> <span class='oword'>next</span> <span class='oword'>discrete</span> <span class='oword'>unit</span> <span class='oword'>below</span> <span class='oword'>the</span> <span class='oword'>curve</span> <span class='oword'>at</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Keep</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='oword'>The</span> <span class='oword'>point</span> <span class='oword'>of</span> <span class='oword'>intersection</span> <span class='oword'>is</span> <span class='oword'>the</span> <span class='oword'>extended</span> <span class='oword'>boundary</span> <span class='oword'>at</span> <span class='oword'>which</span> <span class='oword'>the</span> <span class='oword'>distribution</span> <span class='oword'>begins</span> <span class='oword'>to</span> <span class='oword'>discard</span> <span class='oword'>information</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ExtensionToLinearRegion</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>One</span> <span class='word'>refinement</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>made</span> <span class='word'>to</span> <span class='word'>these</span> <span class='word'>values</span> <span class='word'>by</span> <span class='word'>recognizing</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>discrete</span> <span class='word'>distribution</span> <span class='word'>extends</span> <span class='word'>the</span> <span class='word'>effectively</span> <span class='word'>linear</span> <span class='word'>region</span> <span class='word'>past</span> <span class='word'>the</span> <span class='word'>analytic</span> <span class='word'>solution</span> <span class='word'>by</span> <span class='word'>rounding</span> <span class='word'>the</span> <span class='word'>values</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ExtensionToLinearRegion</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>shaded</span> <span class='word'>squares</span> <span class='word'>are</span> <span class='word'>the</span> <span class='word'>rounded</span> <span class='word'>values</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>extended</span> <span class='word'>region</span> <span class='word'>boundary</span> <span class='mathgroup'>$</span><span class='mathcmd'>\eKeep</span><span class='mathgroup'>$</span> <span class='word'>was</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>numerically</span> <span class='word'>solving</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='mathcmd'>\left</span><span class='mathcmd'>\lfloor</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>2</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='mathcmd'>\rfloor</span><span class='math'>+</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>x</span><span class='math'>-</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>2</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>=</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>In</span> <span class='word'>the</span> <span class='word'>C</span><span class='ignore'>+</span><span class='ignore'>+</span> <span class='word'>code</span><span class='ignore'>,</span> <span class='word'>whilst</span> <span class='word'>numerical</span> <span class='word'>routines</span> <span class='word'>were</span> <span class='word'>used</span>&nbsp; <span class='word'>MatLab</span> <span class='word'>and</span> <span class='word'>Mathematica</span> <span class='word'>to</span> <span class='word'>perform</span> <span class='word'>the</span> <span class='word'>analysis</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>extended</span> <span class='word'>region</span> <span class='word'>boundary</span> <span class='word'>point</span> <span class='word'>was</span> <span class='word'>found</span> <span class='word'>by</span> <span class='ignore'>'</span><span class='word'>walking</span><span class='ignore'>'</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>analytic</span> <span class='word'>point</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Keep</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>until</span> <span class='word'>divergence</span> <span class='word'>from</span> <span class='word'>linear</span> <span class='word'>behaviour</span> <span class='word'>became</span> <span class='word'>apparent</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>regarded</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>simpler</span> <span class='word'>solution</span><span class='ignore'>,</span> <span class='word'>not</span> <span class='word'>requiring</span> <span class='word'>the</span> <span class='word'>use</span> <span class='word'>of</span> <span class='word'>numerical</span> <span class='word'>library</span> <span class='word'>routines</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>proved</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>a</span> <span class='word'>quick</span> <span class='word'>and</span> <span class='word'>elegant</span> <span class='word'>solution</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>C</span><span class='ignore'>+</span><span class='ignore'>+</span> <span class='word'>implementation</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>extended</span> <span class='word'>boundaries</span> <span class='mathgroup'>$</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span> <span class='word'>are</span> <span class='word'>then</span> <span class='word'>defined</span> <span class='word'>by</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>theExtendedBoundaries</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
<span class='exclcmd'>\left</span><span class='mathcmd'>\lceil</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>1</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='mathcmd'>\rceil</span><span class='math'>-</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>=</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span> <span class='math'>_</span><span class='math'>1</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span> <span class='mathcmd'>\eKeep</span> <span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span><br>
<span class='mathcmd'>\left</span><span class='mathcmd'>\lfloor</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>2</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='mathcmd'>\rfloor</span><span class='math'>-</span><span class='mathcmd'>\Keep</span> <span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>=</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span> <span class='math'>_</span><span class='math'>2</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span> <span class='mathcmd'>\eKeep</span> <span class='math'>_</span><span class='math'>2</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>Compression</span> <span class='hword'>Ratio</span><span class='ignore'>}</span><br>
<br>
<span class='word'>There</span> <span class='word'>is</span> <span class='word'>one</span> <span class='word'>final</span> <span class='word'>value</span> <span class='word'>of</span> <span class='word'>interest</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>development</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>gradient</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>mean</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>reason</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>of</span> <span class='word'>interest</span> <span class='word'>is</span> <span class='word'>because</span> <span class='word'>we're</span> <span class='word'>trying</span> <span class='word'>to</span> <span class='word'>compress</span> <span class='word'>the</span> <span class='word'>relevant</span> <span class='word'>data</span> <span class='word'>as</span> <span class='word'>much</span> <span class='word'>as</span> <span class='word'>possible</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>region</span> <span class='word'>is</span> <span class='word'>small</span> <span class='ignore'>(</span><span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>machine</span> <span class='word'>type</span> <span class='word'>is</span> <span class='word'>smaller</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>type</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>gradient</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>assess</span> <span class='word'>the</span> <span class='word'>fidelity</span> <span class='word'>required</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>type</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>it</span> <span class='word'>weren't</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>fact</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>result</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>rotation</span> <span class='word'>transformation</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>there</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>little</span> <span class='word'>purpose</span> <span class='word'>in</span> <span class='word'>assessing</span> <span class='word'>this</span> <span class='word'>value</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>entirely</span> <span class='word'>possible</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>lengthening</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axes</span> <span class='word'>resulting</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>is</span> <span class='word'>insignificant</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>desired</span> <span class='word'>destination</span> <span class='word'>type</span><span class='ignore'>;</span> <span class='word'>there's</span> <span class='word'>no</span> <span class='word'>point</span> <span class='word'>preserving</span> <span class='word'>information</span> <span class='word'>during</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>then</span> <span class='word'>discarded</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>re-distribution</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>gradient</span> <span class='word'>is</span> <span class='word'>given</span> <span class='word'>by</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>gradient</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
<span class='exclcmd'>\Delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='math'>\kappa&nbsp; \delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span> <span class='math'>\sigma </span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>\pi </span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>+</span><span class='math'>-</span><span class='math'>\Sigma</span><span class='math'>^</span><span class='math'>-</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>The</span> <span class='word'>compression</span> <span class='word'>ratio</span> <span class='word'>is</span> <span class='word'>at</span> <span class='word'>most</span> <span class='word'>one-to-one</span><span class='ignore'>,</span> <span class='word'>therefore</span> <span class='mathgroup'>$</span><span class='math'>\kappa </span><span class='math'>&lt;</span><span class='math'>=</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>gradient</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>unit</span> <span class='word'>space</span> <span class='word'>must</span> <span class='word'>always</span> <span class='word'>be</span> <span class='word'>greater</span> <span class='word'>than</span> <span class='word'>one</span> <span class='mathgroup'>$</span><span class='math'>1</span> <span class='mathcmd'>\le</span> <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>so</span> <span class='mathgroup'>$</span> <span class='math'>\kappa </span><span class='mathcmd'>\le</span> <span class='math'>\Delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\le</span> <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>required</span> <span class='word'>fidelity</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>domain</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>using</span> <span class='mathgroup'>$</span> <span class='math'>\Delta</span><span class='mathgroup'>$</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>sense</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>correspondence</span> <span class='word'>between</span> <span class='word'>one</span> <span class='word'>information</span> <span class='word'>step</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>must</span> <span class='word'>produce</span> <span class='word'>a</span> <span class='word'>step</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\Delta</span><span class='mathgroup'>$</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>type</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>evaluating</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>gradient</span> <span class='mathgroup'>$</span><span class='math'>\Delta</span><span class='mathgroup'>$</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>sure</span> <span class='word'>that</span>&nbsp; <span class='mathgroup'>$</span><span class='mathcmd'>\Keep</span><span class='mathgroup'>$</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>x</span> <span class='word'>axis</span> <span class='word'>where</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>preserved</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>exists</span> <span class='word'>if</span> <span class='mathgroup'>$</span><span class='math'>\Delta </span><span class='math'>&gt;</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>or</span> <span class='word'>tells</span> <span class='word'>us</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>x</span> <span class='word'>axis</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>shortened</span> <span class='word'>if</span>&nbsp; <span class='mathgroup'>$</span><span class='math'>\Delta </span><span class='math'>&lt;</span> <span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='mathgroup'>$</span><span class='math'>\Delta</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>an</span> <span class='word'>appropriate</span> <span class='word'>working</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>and</span> <span class='word'>to</span> <span class='word'>define</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>scaling</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>matrix</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='word'>We</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>consider</span> <span class='word'>the</span> <span class='word'>requested</span> <span class='word'>compression</span> <span class='word'>of</span> <span class='word'>information</span> <span class='word'>alongside</span> <span class='word'>the</span> <span class='word'>spread</span> <span class='word'>of</span> <span class='word'>information</span> <span class='word'>caused</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>rotation</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>desired</span> <span class='word'>focus</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>specific</span> <span class='word'>region</span> <span class='word'>of</span> <span class='word'>interest</span> <span class='word'>dictated</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>statistics</span><span class='ignore'>.</span> <span class='word'>Each</span> <span class='word'>axis</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>represented</span> <span class='word'>by</span> <span class='word'>a</span> <span class='word'>discrete</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>numbers</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>size</span> <span class='word'>of</span> <span class='word'>these</span> <span class='word'>sets</span> <span class='word'>dictates</span> <span class='word'>the</span> <span class='word'>discretization</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axis</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>ratios</span> <span class='word'>between</span> <span class='word'>them</span> <span class='word'>indicates</span> <span class='word'>the</span> <span class='word'>spread</span> <span class='word'>or</span> <span class='word'>compression</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>they</span> <span class='word'>contain</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>RGB</span> <span class='word'>axes</span> <span class='word'>are</span> <span class='word'>each</span> <span class='word'>discretized</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>extent</span><span class='ignore'>,</span> <span class='word'>each</span> <span class='word'>containing</span> <span class='mathgroup'>$</span><span class='mathcmd'>\srcRange</span><span class='mathgroup'>$</span> <span class='word'>values</span><span class='ignore'>.</span> <span class='word'>After</span> <span class='word'>the</span> <span class='word'>application</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>un-normalized</span> <span class='word'>rotational</span> <span class='word'>transformation</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>axes</span> <span class='word'>contain</span> <span class='word'>differing</span> <span class='word'>numbers</span> <span class='word'>of</span> <span class='word'>values</span> <span class='word'>given</span> <span class='word'>by</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>=</span><span class='mathcmd'>\srcRange</span> <span class='mathcmd'>\;</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>3</span><span class='ignore'>}</span> <span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>=</span> <span class='mathcmd'>\srcRange</span> <span class='mathcmd'>\;</span> <span class='math'>L</span><span class='math'>_</span><span class='math'>2</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='mathgroup'>$</span>&nbsp; <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>=</span> <span class='mathcmd'>\srcRange</span> <span class='mathcmd'>\;</span> <span class='math'>L</span><span class='math'>_</span><span class='math'>3</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>axis</span> <span class='word'>lengths</span> <span class='word'>preserve</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>contained</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>color</span> <span class='word'>space</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>so</span> <span class='word'>are</span> <span class='word'>the</span> <span class='word'>maximum</span> <span class='word'>length</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>should</span> <span class='word'>take</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>minumum</span> <span class='word'>length</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='word'>may</span> <span class='word'>take</span> <span class='word'>is</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>lost</span> <span class='word'>evenly</span> <span class='word'>throuought</span> <span class='word'>the</span> <span class='word'>axis</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>corresponds</span> <span class='word'>to</span> <span class='word'>an</span> <span class='word'>axis</span> <span class='word'>length</span> <span class='word'>equal</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>axis</span> <span class='word'>length</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span> <span class='math'>=</span> <span class='mathcmd'>\dstRange</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>We</span> <span class='word'>can</span> <span class='word'>now</span> <span class='word'>write</span> <span class='word'>an</span> <span class='word'>algorithm</span> <span class='word'>which</span> <span class='word'>determines</span> <span class='word'>the</span> <span class='word'>necessary</span> <span class='word'>scaling</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>axes</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>whether</span> <span class='word'>truncation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>extreme</span> <span class='word'>values</span> <span class='word'>is</span> <span class='word'>significant</span><span class='ignore'>.</span><br>
<span class='word'>As</span> <span class='word'>this</span> <span class='word'>will</span> <span class='word'>alter</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='mathgroup'>$</span> <span class='word'>we</span> <span class='word'>fix</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>\kappa</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>\Delta</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>those</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>working</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span> <span class='math'>=</span>&nbsp; <span class='mathcmd'>\inS</span><span class='option'>[\theta]</span><span class='mathcmd'>\srcRange</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>which</span> <span class='word'>preserves</span> <span class='word'>all</span> <span class='word'>information</span><span class='ignore'>.</span> <span class='word'>With</span> <span class='word'>this</span> <span class='word'>value</span> <span class='word'>the</span> <span class='word'>constants</span> <span class='word'>are</span><br>
<span class='envir'>\begin</span><span class='envir'>{align}</span><br>
<span class='math'>K</span> <span class='math'>&amp;</span> <span class='math'>=</span>&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\dstRange</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\srcRange</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span><br>
<span class='math'>\kappa</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>K</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span><span class='ignore'>}</span>&nbsp; <span class='math'>&amp;</span> <br>
<span class='math'>\Delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>K</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span>&nbsp; <br>
<span class='envir'>\end</span><span class='envir'>{align}</span><br>
<span class='word'>The</span> <span class='word'>length</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>axis</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='mathgroup'>$</span> <span class='word'>after</span> <span class='word'>rescaling</span> <span class='word'>should</span> <span class='word'>be</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>CombinedRotationRange</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
 <span class='exclcmd'>\tRange</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>,</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\min</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>K</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span><span class='ignore'>}</span>&nbsp;  <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>,</span> <span class='math'>1</span> <span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='mathcmd'>\inS</span><span class='option'>[\theta]</span><span class='mathcmd'>\srcRange</span>  <span class='mathcmd'>\\</span><br>
&nbsp;<span class='math'>&amp;</span> <span class='math'>=</span>&nbsp; <span class='mathcmd'>\min</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>K</span> <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>.</span> <span class='math'>,</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>.</span>&nbsp; <span class='mathcmd'>\inS</span><span class='option'>[\theta]</span><span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp; <span class='mathcmd'>\srcRange</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>The</span> <span class='word'>scaling</span> <span class='mathgroup'>$</span><span class='mathcmd'>\srcRange</span><span class='mathgroup'>$</span> <span class='word'>comes</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>pixel</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>remaining</span> <span class='word'>terms</span> <span class='word'>translates</span> <span class='word'>simply</span> <span class='word'>into</span> <span class='word'>a</span> <span class='word'>rotation</span> <span class='word'>matrix</span> <span class='word'>scaling</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
<span class='mathcmd'>\R</span><span class='option'>[\theta]</span>   <span class='math'>=</span>&nbsp; <span class='mathcmd'>\min</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>K</span> <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='mathcmd'>\right</span><span class='math'>.</span> <span class='math'>,</span>&nbsp; <span class='mathcmd'>\left</span><span class='math'>.</span>&nbsp; <span class='mathcmd'>\inS</span><span class='option'>[\theta]</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\Scale</span><span class='option'>[\theta]</span> <span class='mathcmd'>\otimes</span> <span class='mathcmd'>\fRO</span> <span class='mathcmd'>\left</span><span class='math'>[</span>&nbsp;  <span class='mathcmd'>\qRe</span><span class='option'>[ \theta, n ]</span> <span class='mathcmd'>\right</span><span class='math'>]</span>&nbsp;  <span class='mathcmd'>\\</span><br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<br>
<span class='word'>This</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>requirements</span> <span class='word'>placed</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>gradient</span> <span class='mathgroup'>$</span><span class='math'>\Delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span><span class='math'>&gt;</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>because</span><span class='ignore'>:</span> <span class='word'>if</span> <span class='word'>we</span> <span class='word'>substitute</span> <span class='word'>for</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='mathgroup'>$</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>definition</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>gradient</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>gradient</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>newGradient</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
<span class='exclcmd'>\Delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='comment'>% &amp;= \frac{\dstRange}{\tRange}&nbsp; \delta(\mu,\sigma)&nbsp; &amp; \delta(\mu,\sigma)&nbsp; &amp;= \frac{ \sqrt{2} }{ \sigma \sqrt{\pi }&nbsp; \left(\Sigma^+-\Sigma^-\right)} \\</span><br>
<span class='comment'>% &amp;= \frac{\dstRange}{\min\left\{ \frac{K}{\mathbf{L}(\theta)}&nbsp;  \delta(\mu,\sigma) , 1 \right\}&nbsp; \inS[\theta]\srcRange }&nbsp; \delta(\mu,\sigma) \\</span><br>
<span class='comment'>%&amp;= \frac{1}{\min\left\{ \frac{K}{\mathbf{L}(\theta)}&nbsp;  \delta(\mu,\sigma) , 1 \right\} }&nbsp; \frac{K}{\mathbf{L}(\theta)}&nbsp;  \delta(\mu,\sigma) \\</span><br>
<span class='comment'>%&amp;= \begin{cases}</span><br>
<span class='comment'>%1 &amp; \frac{K}{\mathbf{L}(\theta)}&nbsp;  \delta(\mu,\sigma) &lt; 1 \\</span><br>
<span class='comment'>% \frac{K}{\mathbf{L}(\theta)}&nbsp;  \delta(\mu,\sigma)&nbsp; &amp; \frac{K}{\mathbf{L}(\theta)}&nbsp;  \delta(\mu,\sigma) &gt; 1 \\</span><br>
<span class='comment'>%\end{cases} \\</span><br>
<span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\max</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>K</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span><span class='ignore'>}</span>&nbsp;  <span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='math'>,</span> <span class='math'>1</span> <span class='mathcmd'>\right</span><span class='math'>\}</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<span class='word'>And</span> <span class='word'>the</span> <span class='word'>compression</span> <span class='word'>ratio</span> <span class='mathgroup'>$</span><span class='math'>\kappa</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>also</span> <span class='word'>explicitly</span> <span class='word'>restricted</span> <span class='word'>to</span> <span class='word'>being</span> <span class='word'>at</span> <span class='word'>most</span> <span class='word'>one</span> <span class='word'>and</span> <span class='word'>now</span> <span class='word'>is</span> <span class='word'>no</span> <span class='word'>longer</span> <span class='word'>defined</span> <span class='word'>in</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tRange</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><span class='mathcmd'>\label</span><span class='ignore'>{</span><span class='math'>eq</span><span class='math'>:</span><span class='math'>newCompressionRatio</span><span class='ignore'>}</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
<span class='comment'>%\kappa(\theta)&nbsp; &amp;=&nbsp; \frac{\dstRange}{\tRange} \\</span><br>
<span class='comment'>% &amp;= \frac{\dstRange}{\min\left\{ \frac{K}{\mathbf{L}(\theta)}&nbsp;  \delta(\mu,\sigma) , 1 \right\}&nbsp; \inS[\theta]\srcRange }&nbsp;  \\</span><br>
<span class='comment'>%&amp;= \frac{1}{\min\left\{ \frac{K}{\mathbf{L}(\theta)}&nbsp;  \delta(\mu,\sigma) , 1 \right\} }&nbsp; \frac{K}{\mathbf{L}(\theta)}&nbsp; &nbsp; \\</span><br>
<span class='comment'>%&amp;= \begin{cases}</span><br>
<span class='comment'>%\frac{1}{\delta(\mu,\sigma)}&nbsp;  &amp; \frac{K}{\mathbf{L}(\theta)}&nbsp;  \delta(\mu,\sigma) &lt; 1 \\</span><br>
<span class='comment'>% \frac{K}{\mathbf{L}(\theta)}&nbsp;  &amp; \frac{K}{\mathbf{L}(\theta)}&nbsp;  \delta(\mu,\sigma) &gt; 1 \\</span><br>
<span class='comment'>%\end{cases} \\</span><br>
<span class='comment'>%&amp;= \max\left\{ \frac{\mathbf{L}(\theta)}{K \delta(\mu,\sigma) }&nbsp;  , 1 \right\} \frac{K}{\mathbf{L}(\theta)}&nbsp; \\</span><br>
<span class='exclcmd'>\kappa</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\max</span><span class='mathcmd'>\left</span><span class='math'>\{</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>\delta</span><span class='math'>(</span><span class='math'>\mu</span><span class='math'>,</span><span class='math'>\sigma</span><span class='math'>)</span> <span class='ignore'>}</span>&nbsp;  <span class='math'>,</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>K</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>L</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>\theta</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\right</span><span class='math'>\}</span>&nbsp;  <br>
<span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<br>
<br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{equation}</span><br>
<span class='comment'>%\R[\theta]&nbsp; = </span><br>
<span class='comment'>%\begin{cases}</span><br>
<span class='comment'>%&nbsp; \inS[\theta]\otimes \Scale[\theta] \otimes \fRO \left[&nbsp; \qRe[ \theta, n ] \right]&nbsp; &nbsp; &amp; \Delta(\mu,\sigma) = 1 \\</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; K&nbsp; \Scale[\theta] \otimes \fRO \left[&nbsp; \qRe[ \theta, n ] \right]&nbsp; &nbsp; &amp; \Delta(\mu,\sigma)&nbsp; = \kappa \\</span><br>
<span class='comment'>%&nbsp; &nbsp; &nbsp; &nbsp; K&nbsp; \delta(\mu,\sigma)&nbsp; \Scale[\theta] \otimes \fRO \left[ \qRe[ \theta, n ] \right]&nbsp; &nbsp; &amp;&nbsp; \kappa &lt; \Delta(\mu,\sigma) &lt; 1 \\</span><br>
<span class='comment'>%\end{cases}</span><br>
<span class='comment'>%\end{equation}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{equation}\label{eq:RescaleAxis}</span><br>
<span class='comment'>%\R[\theta]&nbsp; = \min\left\{\Delta(\mu,\sigma), 1 \right\}&nbsp; \inS[\theta]\otimes \nS[\theta] \otimes \rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; </span><br>
<span class='comment'>%\end{equation}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{equation}</span><br>
<span class='comment'>%\R[\theta]&nbsp; = </span><br>
<span class='comment'>%\begin{cases}</span><br>
<span class='comment'>%&nbsp;  \rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp;  &amp; \Delta(\mu,\sigma) = 1 \\</span><br>
<span class='comment'>% \kappa \otimes&nbsp; \inS[\theta] \otimes \nS[\theta] \otimes \rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp;  &amp; \Delta(\mu,\sigma)&nbsp; = \kappa \\</span><br>
<span class='comment'>% \Delta(\mu,\sigma)&nbsp; \inS[\theta] \otimes \nS[\theta] \otimes \rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; &nbsp; &amp;&nbsp; \kappa &lt; \Delta(\mu,\sigma) &lt; 1 \\</span><br>
<span class='comment'>%\end{cases}</span><br>
<span class='comment'>%\end{equation}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%There are several simplifications which can be applied here. Firstly remembering that :</span><br>
<span class='comment'>%\begin{align}</span><br>
<span class='comment'>%\srcRange &amp;= 2^n &amp;</span><br>
<span class='comment'>%\nS[\theta] \otimes \;&nbsp; \inS[\theta] &amp; = 1 \\</span><br>
<span class='comment'>%\nS[\theta] \otimes \rS \otimes \fSe (\theta) &amp; = </span><br>
<span class='comment'>%\begin{pmatrix}</span><br>
<span class='comment'>% \frac{1}{3}&nbsp; \\</span><br>
<span class='comment'>% \frac{1}{2}\\</span><br>
<span class='comment'>% \frac{1}{2} \\</span><br>
<span class='comment'>%\end{pmatrix} &amp;</span><br>
<span class='comment'>%\qS[ n ] &amp; = </span><br>
<span class='comment'>%\begin{pmatrix}</span><br>
<span class='comment'>% 1&nbsp; \\</span><br>
<span class='comment'>% 2^{2-n } \\</span><br>
<span class='comment'>% 2^{2-n }&nbsp; \\</span><br>
<span class='comment'>%\end{pmatrix} \\</span><br>
<span class='comment'>%\rS \otimes \fSe (\theta) &amp; = </span><br>
<span class='comment'>%\begin{pmatrix}</span><br>
<span class='comment'>% \frac{1}{3}&nbsp; \\</span><br>
<span class='comment'>% \frac{1}{2}\\</span><br>
<span class='comment'>% \frac{1}{2} \\</span><br>
<span class='comment'>%\end{pmatrix}&nbsp; \otimes \;&nbsp; \inS[\theta]&amp;</span><br>
<span class='comment'>%\srcRange \; \qS[ n ] &amp; = </span><br>
<span class='comment'>%\begin{pmatrix}</span><br>
<span class='comment'>% 2^n&nbsp; \\</span><br>
<span class='comment'>% 4 \\</span><br>
<span class='comment'>% 4&nbsp; \\</span><br>
<span class='comment'>%\end{pmatrix} </span><br>
<span class='comment'>%\end{align}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{equation}</span><br>
<span class='comment'>%\R[\theta]&nbsp; = </span><br>
<span class='comment'>%\begin{cases}</span><br>
<span class='comment'>%\rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; &amp; \Delta(\mu,\sigma) = 1 \\</span><br>
<span class='comment'>%\nS[\theta] \otimes \rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; &amp; \Delta(\mu,\sigma)&nbsp; = \kappa \\</span><br>
<span class='comment'>%\kappa(\theta) \otimes \rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; &amp;&nbsp; \kappa &lt; \Delta(\mu,\sigma) &lt; 1 \\</span><br>
<span class='comment'>%\end{cases}</span><br>
<span class='comment'>%\end{equation}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{align}\label{eq:RescaleAxis}</span><br>
<span class='comment'>%\R[\theta] % &amp; =&nbsp; \min\left\{ \Delta(\mu,\sigma) , 1\right\} \otimes \srcRange \otimes \;&nbsp; \inS[\theta]\otimes \nS[\theta] \otimes \rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; \\</span><br>
<span class='comment'>%&amp; = \min\left\{ \Delta(\mu,\sigma) , 1\right\}&nbsp; \otimes \rS \otimes \fSe (\theta) \otimes</span><br>
<span class='comment'>%\begin{pmatrix}</span><br>
<span class='comment'>%2^n&nbsp; \\</span><br>
<span class='comment'>% 4 \\</span><br>
<span class='comment'>%4&nbsp; \\</span><br>
<span class='comment'>%\end{pmatrix}\otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; \\</span><br>
<span class='comment'>%&amp; = \min\left\{ \Delta(\mu,\sigma) , 1\right\}&nbsp; \otimes \;&nbsp; \inS[\theta]\begin{pmatrix}</span><br>
<span class='comment'>% \frac{1}{3}&nbsp; \\</span><br>
<span class='comment'>% \frac{1}{2}\\</span><br>
<span class='comment'>% \frac{1}{2} \\</span><br>
<span class='comment'>%\end{pmatrix} \otimes</span><br>
<span class='comment'>%\begin{pmatrix}</span><br>
<span class='comment'>%2^n&nbsp; \\</span><br>
<span class='comment'>% 4 \\</span><br>
<span class='comment'>%4&nbsp; \\</span><br>
<span class='comment'>%\end{pmatrix}\otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; \\</span><br>
<span class='comment'>%&amp; = \min\left\{ \Delta(\mu,\sigma) , 1\right\}&nbsp; \otimes \;&nbsp; \inS[\theta]\otimes \begin{pmatrix}</span><br>
<span class='comment'>% \frac{2^n}{3}&nbsp; \\</span><br>
<span class='comment'>% 2\\</span><br>
<span class='comment'>% 2 \\</span><br>
<span class='comment'>%\end{pmatrix} \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; \\</span><br>
<span class='comment'>%\end{align}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%We can now re-formulate the transformation matrix in three different ways: pure rotation without rescaling, </span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{equation}</span><br>
<span class='comment'>%\R[\theta]&nbsp; = </span><br>
<span class='comment'>%\begin{cases}</span><br>
<span class='comment'>%\rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; &amp; \Delta(\mu,\sigma) \ge 1\\</span><br>
<span class='comment'>%\nS[\theta] \otimes \rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; &amp; \begin{array}{c} \delta(\mu,\sigma) = 1 \\</span><br>
<span class='comment'>%&nbsp; \Delta(\mu,\sigma)&nbsp; = \kappa</span><br>
<span class='comment'>% \end{array} \\</span><br>
<span class='comment'>%\kappa[\theta] \otimes \rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; \right]&nbsp; &amp;&nbsp; \kappa &lt; \Delta(\mu,\sigma) &lt; 1 \\</span><br>
<span class='comment'>%\end{cases}</span><br>
<span class='comment'>%\end{equation}</span><br>
<span class='comment'>%\begin{align*}</span><br>
<span class='comment'>%\nR[\theta] &amp; = \nRa[\theta]+\dnR[\theta] \\</span><br>
<span class='comment'>%&amp; = \nS[\theta] \otimes \rS \otimes \fSe (\theta) \otimes\qS[ n ] \otimes \fSs[\theta]&nbsp; \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; + \dqRe[ \theta, n ]&nbsp; \right]&nbsp; \\</span><br>
<span class='comment'>%&amp; = </span><br>
<span class='comment'>%\begin{pmatrix}</span><br>
<span class='comment'>% \frac{1}{3}&nbsp; \\</span><br>
<span class='comment'>% \frac{1}{2}\\</span><br>
<span class='comment'>% \frac{1}{2} \\</span><br>
<span class='comment'>%\end{pmatrix}</span><br>
<span class='comment'>% \otimes</span><br>
<span class='comment'>%\begin{pmatrix}</span><br>
<span class='comment'>% 1&nbsp; \\</span><br>
<span class='comment'>% 2^{2-n } \\</span><br>
<span class='comment'>% 2^{2-n }&nbsp; \\</span><br>
<span class='comment'>%\end{pmatrix}</span><br>
<span class='comment'>%\otimes&nbsp; \fSs(\theta) \otimes \fRO \left[ \qRe[ \theta, n ]&nbsp; + \dqRe[ \theta, n ]&nbsp; \right]&nbsp;  \\</span><br>
<span class='comment'>%\end{align*}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{equation}\label{eq:Rotation}</span><br>
<span class='comment'>% \R_{xyz}(\theta) =</span><br>
<span class='comment'>% \begin{pmatrix}</span><br>
<span class='comment'>%&nbsp; \frac{1}{\sqrt{3}} &amp; \frac{1}{\sqrt{3}} &amp; \frac{1}{\sqrt{3}} \\</span><br>
<span class='comment'>%&nbsp; -\sqrt{\frac{2}{3}} \sine{\theta +\Pii{6} } &amp; \sqrt{\frac{2}{3}} \cos (\theta ) &amp; -\sqrt{\frac{2}{3}} \sine{\Pii{6}-\theta } \\</span><br>
<span class='comment'>%&nbsp; -\sqrt{\frac{2}{3}} \cos \left(\theta +\Pii{6}\right) &amp; -\sqrt{\frac{2}{3}} \sin (\theta ) &amp; \sqrt{\frac{2}{3}} \cos \left(\Pii{6}-\theta \right) \\</span><br>
<span class='comment'>% \end{pmatrix} \quad \text{for} \quad&nbsp; </span><br>
<span class='comment'>% \begin{array}{c} \Delta(\mu,\sigma) \ge 1 </span><br>
<span class='comment'>% \end{array}</span><br>
<span class='comment'>%\end{equation}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%maximum scaling --- which scales to the destination range</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{equation}\label{eq:NormRxyz2}</span><br>
<span class='comment'>% \overline{\R}_{xyz}(\theta) =</span><br>
<span class='comment'>%\kappa</span><br>
<span class='comment'>%\bigotimes</span><br>
<span class='comment'>%\R_{xyz}(\theta) \quad where \quad</span><br>
<span class='comment'>%\begin{array}{c}</span><br>
<span class='comment'>%\kappa = \frac{\dstRange }{\srcRange \mathbf{L}(\theta)}</span><br>
<span class='comment'>%\end{array} \quad \text{for} \quad&nbsp; &nbsp; </span><br>
<span class='comment'>% \begin{array}{c} \delta(\mu,\sigma) = 1 \\</span><br>
<span class='comment'>%&nbsp; \Delta(\mu,\sigma)&nbsp; = \kappa</span><br>
<span class='comment'>% \end{array}</span><br>
<span class='comment'>%\end{equation}</span><br>
<span class='comment'>%</span><br>
<span class='comment'>% and scaled --- which shortens the axis as much as possible without losing statistically relevant data. </span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{equation}\label{eq:CompressedRotation}</span><br>
<span class='comment'>% \widetilde{\R}_{xyz}(\theta,\mathbf{\mu},\mathbf{\sigma}) =</span><br>
<span class='comment'>%\Delta(\mu,\sigma)</span><br>
<span class='comment'>%\bigotimes</span><br>
<span class='comment'>%\R_{xyz}(\theta) \quad \text{for} \quad&nbsp; \kappa &lt; \Delta(\mu,\sigma) &lt; 1</span><br>
<span class='comment'>%\end{equation}</span><br>
<span class='comment'>%because $\Delta$ is always greater or equal to $\kappa$ these special cases can be combined into a general scaling for each axis</span><br>
<span class='comment'>%</span><br>
<span class='comment'>%\begin{equation}\label{eq:CombinedRotation}</span><br>
<span class='comment'>% \widehat{\R}_{xyz}(\theta,\mu,\sigma) =</span><br>
<span class='comment'>%\left(</span><br>
<span class='comment'>%\begin{array}{c}</span><br>
<span class='comment'>%\min\left\{\Delta(\mu_1,\sigma_1), 1 \right\} \\</span><br>
<span class='comment'>%\min\left\{\Delta(\mu_2,\sigma_2), 1 \right\}&nbsp; \\</span><br>
<span class='comment'>%\min\left\{\Delta(\mu_3,\sigma_3), 1 \right\}&nbsp; \\</span><br>
<span class='comment'>%\end{array}</span><br>
<span class='comment'>%\right)</span><br>
<span class='comment'>%\bigotimes</span><br>
<span class='comment'>%\R_{xyz}(\theta) \quad where \quad</span><br>
<span class='comment'>%\begin{array}{c}</span><br>
<span class='comment'>%\kappa = \frac{\dstRange }{\srcRange \mathbf{L}(\theta)} \\</span><br>
<span class='comment'>%\Delta(\mu,\sigma) = \kappa \delta(\mu,\sigma)</span><br>
<span class='comment'>%\end{array}</span><br>
<span class='comment'>%\end{equation}</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>A</span> <span class='hword'>Piecewise</span> <span class='hword'>Approximation</span> <span class='hword'>to</span> <span class='hword'>the</span> <span class='hword'>ERF</span> <span class='hword'>Distribution</span><span class='ignore'>}</span><br>
<span class='word'>We</span> <span class='word'>now</span> <span class='word'>have</span> <span class='word'>equations</span> <span class='word'>which</span> <span class='word'>give</span> <span class='word'>us</span> <span class='word'>the</span> <span class='word'>four</span> <span class='word'>points</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>domain</span> <span class='word'>which</span> <span class='word'>mark</span> <span class='word'>the</span> <span class='word'>boundaries</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>five</span> <span class='word'>characteristic</span> <span class='word'>regions</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>can</span> <span class='word'>now</span> <span class='word'>use</span> <span class='word'>them</span> <span class='word'>to</span> <span class='word'>define</span> <span class='word'>a</span> <span class='word'>piecewise</span> <span class='word'>function</span> <span class='word'>which</span> <span class='word'>uses</span> <span class='word'>the</span> <span class='word'>computationally</span> <span class='word'>problematic</span> <span class='word'>error</span> <span class='word'>function</span> <span class='word'>based</span> <span class='word'>distribution</span> <span class='word'>as</span> <span class='word'>little</span> <span class='word'>as</span> <span class='word'>possible</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='math'>pDis</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='math'>=</span> <span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
<span class='mathcmd'>\dstMin</span> <span class='math'>&amp;</span> <span class='math'>x</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\\</span><br>
<span class='math'>x</span> <span class='math'>-</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>+</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\le</span> <span class='math'>x</span> <span class='mathcmd'>\le</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span>&nbsp; <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>-</span> <span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='math'>)</span> <span class='math'>+</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>1</span><span class='math'>)</span> <span class='math'>&amp;</span> <span class='math'>x</span> <span class='mathcmd'>\ge</span> <span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\\</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation}</span><br>
<br>
<span class='word'>All</span> <span class='word'>three</span> <span class='word'>distribution</span> <span class='word'>techniques</span> <span class='word'>described</span> <span class='word'>earlier</span> <span class='ignore'>(</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>Partition</span><span class='ignore'>}</span> <span class='ignore'>,</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>Linear</span><span class='ignore'>}</span> <span class='ignore'>,</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ERF</span><span class='ignore'>}</span> <span class='ignore'>)</span> <span class='word'>are</span> <span class='word'>special</span> <span class='word'>cases</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>distribution</span><span class='ignore'>.</span> <span class='word'>When</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>has</span> <span class='word'>a</span> <span class='word'>very</span> <span class='word'>large</span> <span class='word'>variance</span> <span class='word'>the</span> <span class='word'>piecewise</span> <span class='word'>distribution</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>simplified</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>linear</span> <span class='word'>distribution</span> <span class='word'>Fig</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>useLinear</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>When</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>has</span> <span class='word'>a</span> <span class='word'>very</span> <span class='word'>small</span> <span class='word'>variance</span> <span class='word'>a</span> <span class='word'>partitioning</span> <span class='word'>is</span> <span class='word'>more</span> <span class='word'>appropriate</span> <span class='word'>Fig</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>usePartitioning</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>most</span> <span class='word'>interesting</span> <span class='word'>distributions</span><span class='ignore'>,</span> <span class='word'>however</span><span class='ignore'>,</span> <span class='word'>are</span> <span class='word'>the</span> <span class='word'>ones</span> <span class='word'>which</span> <span class='word'>require</span> <span class='word'>the</span> <span class='word'>use</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>piecewise</span> <span class='word'>distribution</span> <span class='word'>Fig</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>usePiecewiseERF</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>useLinear</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Here</span> <span class='oword'>the</span> <span class='oword'>code</span> <span class='oword'>will</span> <span class='oword'>decide</span> <span class='oword'>to</span> <span class='oword'>use</span> <span class='oword'>a</span> <span class='oword'>linear</span> <span class='oword'>re-distribution</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>useLinear</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>usePartitioning</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>With</span> <span class='oword'>these</span> <span class='oword'>values</span> <span class='oword'>the</span> <span class='oword'>code</span> <span class='oword'>will</span> <span class='oword'>likely</span> <span class='oword'>decide</span> <span class='oword'>to</span> <span class='oword'>use</span> <span class='oword'>partitioning</span> <span class='oword'>if</span> <span class='oword'>the</span> <span class='oword'>tolerance</span> <span class='mathgroup'>$</span><span class='mathcmd'>\tau</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>partitioning</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='oword'>is</span> <span class='oword'>greater</span> <span class='oword'>than</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Discard</span><span class='math'>_</span><span class='math'>2</span><span class='math'>-</span><span class='mathcmd'>\eKeep</span><span class='math'>_</span><span class='math'>2</span><span class='mathgroup'>$</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>usePartitioning</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=1\linewidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter2</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>usePiecewiseERF</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>With</span> <span class='oword'>these</span> <span class='oword'>values</span> <span class='oword'>the</span> <span class='oword'>code</span> <span class='oword'>will</span> <span class='oword'>decide</span> <span class='oword'>to</span> <span class='oword'>use</span> <span class='oword'>a</span> <span class='oword'>piecewise</span> <span class='oword'>ERF</span> <span class='oword'>based</span> <span class='oword'>distribution</span><span class='ignore'>.</span> <span class='ignore'>(</span><span class='oword'>Labeled</span> <span class='ignore'>"</span><span class='oword'>Compact</span> <span class='oword'>Distribution</span><span class='ignore'>"</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>figure</span><span class='ignore'>.</span><span class='ignore'>)</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>usePiecewiseERF</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Chapter2/AppendixChapter2.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 4759</li>
<li>Words in headers: 49</li>
<li>Words outside text (captions, etc.): 284</li>
<li>Number of headers: 13</li>
<li>Number of floats/tables/figures: 9</li>
<li>Number of math inlines: 240</li>
<li>Number of math displayed: 65</li>
<li>Subcounts:</li>
<span class='subcount'>
<li class='fielddesc'>&nbsp; text+headers+captions (#headers/#floats/#inlines/#displayed)</li>
  <li>0+4+0 (1/0/0/0) Chapter: An Integer Rotation Matrix}\label{app:AnIntegerRotationMatrix</li>
  <li>742+2+117 (1/1/19/5) Section: Rotation Matrix}\label{sec:RotationMatrix</li>
  <li>432+3+11 (1/2/21/13) Section: Factoring the Rotation</li>
  <li>1523+3+17 (1/0/136/27) Section: Quantizing the Rotation</li>
  <li>422+4+0 (1/0/0/0) Chapter: Preservation of Color Information}\label{app:PreservationOfColorInformation</li>
  <li>43+1+0 (1/0/0/0) Section: Partition}\label{sec:Partition</li>
  <li>71+1+0 (1/0/0/0) Section: Linear}\label{sec:Linear</li>
  <li>464+4+2 (1/1/17/2) Section: ERF (Gaussian Error Function)}\label{sec:ERF</li>
  <li>115+5+0 (1/0/0/0) Section: Efficiently Implementing the Distribution Function</li>
  <li>66+6+23 (1/1/9/4) Subsection: The Region Which Discards All Information</li>
  <li>232+6+67 (1/1/11/7) Subsection: The Region Which Keeps All Information</li>
  <li>541+3+0 (1/0/25/6) Subsection: The Compression Ratio</li>
  <li>108+7+47 (1/3/2/1) Subsection: A Piecewise Approximation to the ERF Distribution</li>
</span>
</ul>
</div>
<h2>File: ./Chapter3/AppendixChapter3.tex</h2>
<div class='parse'><p>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Chapter3/AppendixChapter3.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 0</li>
<li>Words in headers: 0</li>
<li>Words outside text (captions, etc.): 0</li>
<li>Number of headers: 0</li>
<li>Number of floats/tables/figures: 0</li>
<li>Number of math inlines: 0</li>
<li>Number of math displayed: 0</li>
</ul>
</div>
<h2>File: ./Chapter4/AppendixChapter4.tex</h2>
<div class='parse'><p>
<br>
<span class='cmd'>\chapter</span><span class='ignore'>{</span><span class='hword'>Colorspace</span> <span class='hword'>Methods</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Implementing</span> <span class='hword'>the</span> <span class='hword'>Color</span> <span class='hword'>Space</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ImplementingTheColorSpace</span><span class='ignore'>}</span><br>
<br>
<span class='word'>Here</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>will</span> <span class='word'>outline</span> <span class='word'>the</span> <span class='word'>practical</span> <span class='word'>implementation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>algorithm</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>mobile</span> <span class='word'>device</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>first</span> <span class='word'>and</span> <span class='word'>most</span> <span class='word'>pressing</span> <span class='word'>consideration</span> <span class='word'>is</span> <span class='word'>limited</span> <span class='word'>processing</span> <span class='word'>power</span><span class='ignore'>;</span> <span class='word'>while</span> <span class='word'>our</span> <span class='word'>mathematical</span> <span class='word'>approach</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>design</span> <span class='word'>is</span> <span class='word'>significantly</span> <span class='word'>faster</span> <span class='word'>and</span> <span class='word'>more</span> <span class='word'>efficient</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>more</span> <span class='word'>typical</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>algorithms</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>as</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>discussed</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>chapter</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>minimizing</span> <span class='word'>the</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>clock</span> <span class='word'>cycles</span> <span class='word'>spent</span> <span class='word'>on</span> <span class='word'>continuous</span> <span class='word'>processes</span> <span class='word'>is</span> <span class='word'>necessary</span> <span class='word'>in</span> <span class='word'>order</span> <span class='word'>to</span> <span class='word'>ensure</span> <span class='word'>efficient</span> <span class='word'>operation</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>of</span> <span class='word'>redistribution</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>integer</span> <span class='word'>matrix</span> <span class='word'>transform</span> <span class='word'>is</span> <span class='word'>performed</span> <span class='word'>first</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>puts</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>quantized</span> <span class='word'>working</span> <span class='word'>type</span> <span class='mathgroup'>$</span><span class='math'>qRsRange</span><span class='mathgroup'>$</span> <span class='word'>described</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>pixel</span> <span class='word'>classification</span> <span class='word'>is</span> <span class='word'>performed</span> <span class='word'>before</span> <span class='word'>any</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>redistributed</span> <span class='word'>as</span> <span class='word'>illustrated</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PartitioningRegions</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>pixel</span> <span class='word'>classification</span> <span class='word'>is</span> <span class='word'>performed</span> <span class='word'>before</span> <span class='word'>the</span> <span class='word'>redistribution</span> <span class='word'>because</span> <span class='word'>it</span> <span class='word'>excludes</span> <span class='word'>processing</span> <span class='word'>pixels</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>of</span> <span class='word'>no</span> <span class='word'>interest</span> <span class='word'>based</span> <span class='word'>on</span> <span class='word'>both</span> <span class='word'>chromatic</span> <span class='word'>channels</span><span class='ignore'>,</span> <span class='word'>whereas</span> <span class='word'>for</span> <span class='word'>redistribution</span> <span class='word'>one</span> <span class='word'>channel</span> <span class='word'>may</span> <span class='word'>clearly</span> <span class='word'>lie</span> <span class='word'>outside</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>discard</span> <span class='word'>region</span> <span class='mathgroup'>$</span><span class='mathcmd'>\lambda</span><span class='mathgroup'>$</span> <span class='word'>while</span> <span class='word'>the</span> <span class='word'>other</span> <span class='word'>could</span> <span class='word'>be</span> <span class='word'>kept</span> <span class='word'>or</span> <span class='word'>redistributed</span><span class='ignore'>.</span> <span class='word'>With</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>classifier</span><span class='ignore'>,</span> <span class='word'>if</span> <span class='word'>one</span> <span class='word'>channel</span> <span class='word'>lies</span> <span class='word'>outside</span> <span class='word'>the</span> <span class='word'>discard</span> <span class='word'>region</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>other</span> <span class='word'>is</span> <span class='word'>also</span> <span class='word'>of</span> <span class='word'>no</span> <span class='word'>interest</span> <span class='word'>since</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>is</span> <span class='word'>outside</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>partitioning</span> <span class='word'>region</span><span class='ignore'>,</span> <span class='word'>thereby</span> <span class='word'>avoiding</span> <span class='word'>unnecessary</span> <span class='word'>processing</span> <span class='word'>time</span> <span class='word'>spent</span> <span class='word'>on</span> <span class='word'>redistribution</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>classification</span> <span class='word'>is</span> <span class='word'>straightforward</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>limits</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>channel</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>it</span> <span class='word'>isn't</span> <span class='word'>sophisticated</span> <span class='word'>like</span> <span class='word'>an</span> <span class='word'>elliptical</span> <span class='word'>partitioning</span> <span class='word'>or</span> <span class='word'>a</span> <span class='word'>probabilistic</span> <span class='word'>Gaussian-based</span> <span class='word'>thresholding</span><span class='ignore'>;</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>simply</span> <span class='word'>a</span> <span class='word'>quick</span> <span class='word'>way</span> <span class='word'>of</span> <span class='word'>excluding</span> <span class='word'>the</span> <span class='word'>majority</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>aren't</span> <span class='word'>of</span> <span class='word'>interest</span><span class='ignore'>.</span><br>
<br>
<span class='word'>Once</span> <span class='word'>the</span> <span class='word'>pixels</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>classified</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>redistribution</span> <span class='word'>is</span> <span class='word'>performed</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>which</span> <span class='word'>requires</span> <span class='word'>further</span> <span class='word'>processing</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>or</span> <span class='word'>we</span> <span class='word'>assign</span> <span class='word'>a</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>from</span> <span class='word'>a</span> <span class='word'>small</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>possibilities</span> <span class='word'>and</span> <span class='word'>skip</span> <span class='word'>onto</span> <span class='word'>the</span> <span class='word'>next</span> <span class='word'>pixel</span> <span class='word'>value</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>redistribution</span> <span class='word'>function</span> <span class='word'>is</span> <span class='word'>applied</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>working</span> <span class='word'>type</span> <span class='mathgroup'>$</span><span class='math'>tRange</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>while</span> <span class='word'>the</span> <span class='word'>comparison</span> <span class='word'>and</span> <span class='word'>classification</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>in</span> <span class='mathgroup'>$</span><span class='math'>qRsRange</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>in</span> <span class='mathgroup'>$</span><span class='math'>tRange</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>compressed</span> <span class='word'>to</span> <span class='word'>avoid</span> <span class='word'>wasting</span> <span class='word'>space</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>consequence</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>it</span> <span class='word'>does</span> <span class='word'>not</span> <span class='word'>occupy</span> <span class='word'>the</span> <span class='word'>full</span> <span class='word'>data</span> <span class='word'>type</span><span class='ignore'>.</span> <span class='mathgroup'>$</span><span class='math'>qRsRange</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>other</span> <span class='word'>hand</span><span class='ignore'>,</span> <span class='word'>being</span> <span class='word'>the</span> <span class='word'>natural</span> <span class='word'>range</span> <span class='word'>multiplied</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>quantization</span> <span class='word'>matrix</span> <span class='word'>qR</span><span class='ignore'>,</span> <span class='word'>does</span> <span class='word'>occupy</span> <span class='word'>the</span> <span class='word'>full</span> <span class='word'>data</span> <span class='word'>type</span><span class='ignore'>.</span> <span class='word'>Since</span> <span class='word'>the</span> <span class='word'>operation</span> <span class='word'>is</span> <span class='word'>simply</span> <span class='word'>a</span> <span class='word'>comparison</span> <span class='word'>between</span> <span class='word'>numbers</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>of</span> <span class='word'>no</span> <span class='word'>advantage</span> <span class='word'>to</span> <span class='word'>compress</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>so</span> <span class='word'>tightly</span><span class='ignore'>.</span> <span class='word'>Additionally</span><span class='ignore'>,</span> <span class='word'>since</span> <span class='mathgroup'>$</span><span class='math'>qRsRange</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>signed</span> <span class='word'>range</span><span class='ignore'>,</span> <span class='word'>one</span> <span class='word'>could</span> <span class='word'>look</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>bit</span> <span class='word'>indicating</span> <span class='word'>the</span> <span class='word'>sign</span> <span class='word'>and</span> <span class='word'>immediately</span> <span class='word'>tell</span> <span class='word'>whether</span> <span class='word'>or</span> <span class='word'>not</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>value</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>discarded</span><span class='ignore'>.</span> <span class='word'>Once</span> <span class='word'>scaled</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='math'>tRange</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>redistribution</span> <span class='word'>function</span> <span class='word'>is</span> <span class='word'>applied</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>which</span> <span class='word'>has</span> <span class='word'>a</span> <span class='word'>source</span> <span class='word'>range</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>tRange</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='math'>dRange</span><span class='mathgroup'>$</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>type</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>as</span> <span class='word'>outlined</span> <span class='word'>in</span> <span class='word'>Appendix</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>app</span><span class='ignore'>:</span><span class='ignore'>PreservationOfColorInformation</span><span class='ignore'>}</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span><span class='ignore'>.</span><br>
<br>
<span class='word'>It</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>noted</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>extended</span> <span class='word'>keep</span> <span class='word'>region</span> <span class='mathgroup'>$</span><span class='math'>\omega p</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>discard</span> <span class='word'>region</span> <span class='mathgroup'>$</span><span class='mathcmd'>\lambda</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>especially</span> <span class='word'>large</span><span class='ignore'>;</span> <span class='word'>for</span> <span class='word'>even</span> <span class='word'>a</span> <span class='mathgroup'>$</span><span class='math'>5\sigma</span><span class='mathgroup'>$</span> <span class='word'>result</span><span class='ignore'>,</span> <span class='word'>it's</span> <span class='word'>only</span> <span class='word'>tens</span> <span class='word'>of</span> <span class='word'>values</span> <span class='word'>wide</span><span class='ignore'>.</span> <span class='word'>As</span> <span class='word'>such</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>lookup</span> <span class='word'>table</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>redistribution</span> <span class='word'>in</span> <span class='word'>our</span> <span class='word'>actual</span> <span class='word'>implementation</span><span class='ignore'>,</span> <span class='word'>thus</span> <span class='word'>further</span> <span class='word'>reducing</span> <span class='word'>the</span> <span class='word'>processing</span> <span class='word'>overhead</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>C</span><span class='ignore'>+</span><span class='ignore'>+</span> <span class='word'>implementation</span> <span class='word'>has</span> <span class='word'>a</span> <span class='word'>lookup</span> <span class='word'>table</span> <span class='word'>threshold</span> <span class='word'>set</span> <span class='word'>to</span> <span class='word'>64</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>quarter</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>range</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>the</span> <span class='word'>redistribution</span> <span class='word'>region</span> <span class='word'>is</span> <span class='word'>larger</span> <span class='word'>than</span> <span class='word'>that</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>error</span> <span class='word'>function</span> <span class='word'>approximation</span> <span class='word'>from</span> <span class='word'>Chapter</span> <span class='word'>2</span> <span class='word'>is</span> <span class='word'>used</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>mainly</span> <span class='word'>for</span> <span class='word'>future-proofing</span> <span class='word'>the</span> <span class='word'>implementation</span><span class='ignore'>;</span> <span class='word'>given</span> <span class='word'>the</span> <span class='word'>limited</span> <span class='word'>size</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>region</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>fully</span> <span class='word'>expect</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>lookup</span> <span class='word'>table</span> <span class='word'>for</span> <span class='word'>all</span> <span class='word'>practical</span> <span class='word'>cases</span><span class='ignore'>.</span><br>
<br>
<span class='word'>As</span> <span class='word'>another</span> <span class='word'>future</span> <span class='word'>concession</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>facility</span> <span class='word'>to</span> <span class='word'>add</span> <span class='word'>pixel-based</span> <span class='word'>functions</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>transform</span><span class='ignore'>,</span> <span class='word'>such</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>probability</span> <span class='word'>function</span> <span class='word'>mentioned</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>end</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>previous</span> <span class='word'>chapter</span><span class='ignore'>,</span> <span class='word'>is</span> <span class='word'>allowed</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>transform</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>threaded</span> <span class='word'>process</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>there</span> <span class='word'>is</span> <span class='word'>no</span> <span class='word'>way</span> <span class='word'>of</span> <span class='word'>knowing</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>last</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>that</span> <span class='word'>was</span> <span class='word'>processed</span> <span class='word'>by</span> <span class='word'>any</span> <span class='word'>given</span> <span class='word'>thread</span> <span class='word'>was</span> <span class='word'>an</span> <span class='word'>adjacent</span> <span class='word'>pixel</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>parallelization</span> <span class='word'>is</span> <span class='word'>handled</span> <span class='word'>by</span> <span class='word'>OpenCV's</span> <span class='word'>universal</span> <span class='word'>threading</span> <span class='word'>library</span> <span class='word'>implementations</span><span class='ignore'>.</span> <span class='word'>Pixel-based</span> <span class='word'>functions</span><span class='ignore'>,</span> <span class='word'>however</span><span class='ignore'>,</span> <span class='word'>are</span> <span class='word'>per-pixel</span> <span class='word'>processes</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>they</span> <span class='word'>come</span> <span class='word'>out</span> <span class='word'>as</span> <span class='word'>separate</span> <span class='word'>resulting</span> <span class='word'>channels</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>they</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>added</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>transform</span> <span class='word'>without</span> <span class='word'>causing</span> <span class='word'>any</span> <span class='word'>conflicts</span><span class='ignore'>.</span><br>
<br>
<br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>White-Out</span> <span class='hword'>Black-Out</span> <span class='hword'>Algorithm</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>WhiteOutBlackOutAlgorithm</span><span class='ignore'>}</span><br>
<span class='word'>We</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>at</span> <span class='word'>which</span> <span class='word'>a</span> <span class='word'>chromatic</span> <span class='word'>value</span> <span class='word'>begins</span> <span class='word'>to</span> <span class='word'>suffer</span> <span class='word'>from</span> <span class='word'>white-out</span> <span class='word'>and</span> <span class='word'>black-out</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>corresponding</span> <span class='word'>RGB</span> <span class='word'>value</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>point</span> <span class='word'>and</span> <span class='word'>illuminating</span> <span class='word'>and</span> <span class='word'>deluminating</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>by</span> <span class='word'>shifting</span> <span class='word'>the</span> <span class='word'>channel</span> <span class='word'>values</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>amount</span><span class='ignore'>,</span> <span class='word'>noting</span> <span class='word'>when</span> <span class='word'>each</span> <span class='word'>channel</span> <span class='word'>value</span> <span class='word'>becomes</span> <span class='word'>fully</span> <span class='word'>saturated</span> <span class='word'>or</span> <span class='word'>desaturated</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>unit</span> <span class='word'>space</span> <span class='word'>so</span> <span class='word'>the</span> <span class='word'>results</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>scaled</span> <span class='word'>to</span> <span class='word'>any</span> <span class='word'>working</span> <span class='word'>range</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>for</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>theoretical</span> <span class='word'>values</span> <span class='word'>is</span> <span class='word'>given</span> <span class='word'>in</span> <span class='word'>Algorithm</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>TheWhiteoutBlackoutAlgorithm</span><span class='ignore'>}</span> <span class='word'>below</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{algorithm}</span><span class='option'>[H]</span><br>
 <span class='exclenv'>\begin</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;<span class='exclcmd'>\Require</span><span class='ignore'>{</span> <span class='exclmath'>$</span><span class='math'>Ca</span><span class='exclmath'>$</span><span class='ignore'>,</span> <span class='exclmath'>$</span><span class='math'>Cb</span><span class='exclmath'>$</span> <span class='ignore'>The</span> <span class='ignore'>chromatic</span> <span class='ignore'>values</span><span class='ignore'>}</span><br>
&nbsp; <span class='exclcmd'>\State</span> <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Require</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>{</span> <span class='exclmath'>$</span><span class='math'>iLCaCb</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>transform</span> <span class='ignore'>to</span> <span class='ignore'>LCaCb</span> <span class='ignore'>from</span> <span class='ignore'>RGB</span><span class='ignore'>;</span> <span class='ignore'>}</span><br>
&nbsp; <span class='exclcmd'>\State</span> <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Require</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>{</span>&nbsp; <span class='exclmath'>$</span><span class='math'>LCaCb</span><span class='exclmath'>$</span> <span class='ignore'>the</span> <span class='ignore'>transform</span> <span class='ignore'>to</span> <span class='ignore'>RGB</span> <span class='ignore'>from</span> <span class='ignore'>LCaCb</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\Ensure</span><span class='ignore'>{</span>&nbsp; <span class='ignore'>The</span> <span class='ignore'>luminosity</span> <span class='ignore'>at</span> <span class='ignore'>which</span> <span class='ignore'>black</span> <span class='ignore'>out</span> <span class='exclmath'>$</span><span class='math'>L</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>BO</span><span class='ignore'>}</span><span class='exclmath'>$</span>&nbsp; <span class='ignore'>and</span> <span class='ignore'>white</span> <span class='ignore'>out</span> <span class='exclmath'>$</span><span class='math'>L</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>WO</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>occur</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
 <span class='exclcmd'>\State</span> <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Ensu</span><span class='ignore'>}</span> <span class='ignore'>{</span> <span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span><br>
 <span class='exclmath'>$</span><span class='math'>Ca</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>min</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\le</span> <span class='math'>Ca</span> <span class='mathcmd'>\le</span> <span class='math'>Ca</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>max</span><span class='ignore'>}</span><span class='exclmath'>$</span>&nbsp;  <span class='exclcmd'>\\</span> <br>
 <span class='exclmath'>$</span><span class='math'>Cb</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>min</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\le</span> <span class='math'>Cb</span> <span class='mathcmd'>\le</span> <span class='math'>Cb</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>max</span><span class='ignore'>}</span><span class='exclmath'>$</span>&nbsp; <br>
 <span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><span class='exclcmd'>\parbox</span><span class='ignore'>{</span><span class='ignore'>0.65</span> <span class='exclcmd'>\textwidth</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>The</span> <span class='ignore'>chromatic</span> <span class='ignore'>range</span> <span class='ignore'>which</span> <span class='ignore'>could</span> <span class='ignore'>be</span> <span class='ignore'>suffering</span> <span class='ignore'>from</span> <span class='ignore'>white-out</span> <span class='ignore'>or</span> <span class='ignore'>black-out</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
 <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>iLCaCb</span><span class='math'>(</span><span class='math'>0.5</span><span class='math'>,</span> <span class='math'>Ca</span><span class='math'>,</span><span class='math'>Cb</span><span class='math'>)</span><span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Put</span> <span class='ignore'>the</span> <span class='ignore'>point</span> <span class='ignore'>in</span> <span class='ignore'>RGB</span> <span class='ignore'>space</span> <span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>O</span> <span class='mathcmd'>\gets</span> <span class='math'>Order</span><span class='math'>(</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>,</span> <span class='mathcmd'>\#</span><span class='math'>1</span><span class='math'>&gt;</span> <span class='mathcmd'>\#</span><span class='math'>2</span><span class='math'>)</span><span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>The</span> <span class='ignore'>order</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>RGB</span> <span class='ignore'>channels</span> <span class='ignore'>from</span> <span class='ignore'>largest</span> <span class='ignore'>to</span> <span class='ignore'>smallest</span><span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>\Delta WO</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\gets</span> <span class='math'>1</span> <span class='math'>-</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Iluminate</span> <span class='ignore'>to</span> <span class='ignore'>make</span> <span class='ignore'>the</span> <span class='ignore'>largest</span> <span class='ignore'>channel</span> <span class='ignore'>value</span> <span class='ignore'>saturated</span><span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>WO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>1</span> <span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>The</span> <span class='ignore'>point</span> <span class='ignore'>where</span> <span class='ignore'>a</span> <span class='ignore'>channel</span> <span class='ignore'>is</span> <span class='ignore'>saturated</span> <span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>WO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span>  <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span> <span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>+</span> <span class='math'>\Delta WO</span><span class='math'>_</span><span class='math'>1</span> <span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>WO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>3</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span>  <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span> <span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>3</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>+</span> <span class='math'>\Delta WO</span><span class='math'>_</span><span class='math'>1</span> <span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>\Delta WO</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\gets</span> <span class='math'>1</span> <span class='math'>-</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Iluminate</span> <span class='ignore'>to</span> <span class='ignore'>make</span> <span class='ignore'>the</span> <span class='ignore'>second</span> <span class='ignore'>largest</span> <span class='ignore'>channel</span> <span class='ignore'>value</span> <span class='ignore'>saturated</span><span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>WO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>1</span> <span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>The</span> <span class='ignore'>point</span> <span class='ignore'>where</span> <span class='ignore'>two</span> <span class='ignore'>channels</span> <span class='ignore'>are</span> <span class='ignore'>saturated</span> <span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>WO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>1</span> <span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>WO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>3</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span>  <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span> <span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>3</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>+</span> <span class='math'>\Delta WO</span><span class='math'>_</span><span class='math'>2</span> <span class='exclmath'>$</span> <br>
&nbsp; &nbsp;  <br>
&nbsp; &nbsp;  <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>\Delta BO</span><span class='math'>_</span><span class='math'>1</span> <span class='mathcmd'>\gets</span>  <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>3</span><span class='math'>)</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Deluminate</span> <span class='ignore'>by</span> <span class='ignore'>the</span> <span class='ignore'>smallest</span> <span class='ignore'>channel</span> <span class='ignore'>value</span><span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span><span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>BO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span>  <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span> <span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>-</span> <span class='math'>\Delta BO</span><span class='math'>_</span><span class='math'>1</span>&nbsp; <span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>The</span> <span class='ignore'>point</span> <span class='ignore'>where</span> <span class='ignore'>a</span> <span class='ignore'>channel</span> <span class='ignore'>is</span> <span class='ignore'>desaturated</span> <span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span> <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>BO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span>  <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span> <span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>-</span> <span class='math'>\Delta BO</span><span class='math'>_</span><span class='math'>1</span> <span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span> <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>BO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>3</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span>  <span class='math'>0</span> <span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>\Delta BO</span><span class='math'>_</span><span class='math'>2</span> <span class='mathcmd'>\gets</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span> <span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>Deluminate</span> <span class='ignore'>by</span> <span class='ignore'>the</span> <span class='ignore'>second</span> <span class='ignore'>smallest</span> <span class='ignore'>channel</span> <span class='ignore'>value</span><span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>BO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span> <span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span> <span class='math'>-</span> <span class='math'>\Delta BO</span><span class='math'>_</span><span class='math'>2</span> <span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>The</span> <span class='ignore'>point</span> <span class='ignore'>where</span> <span class='ignore'>two</span> <span class='ignore'>channels</span> <span class='ignore'>are</span> <span class='ignore'>desaturated</span> <span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>BO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>0</span> <span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclcmd'>\phantom</span><span class='ignore'>{</span><span class='ignore'>Set</span><span class='ignore'>}</span> <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>RGB</span><span class='math'>,</span> <span class='math'>BO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>O</span><span class='math'>(</span><span class='math'>3</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>0</span> <span class='exclmath'>$</span> <br>
&nbsp; &nbsp;  <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>i</span><span class='math'>)</span><span class='ignore'>}</span><span class='mathcmd'>\gets</span> <span class='math'>LCaCb</span><span class='math'>(</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>i</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>)</span> <span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>The</span> <span class='ignore'>white-out</span> <span class='ignore'>points</span> <span class='ignore'>in</span> <span class='ignore'>LCaCb</span> <span class='ignore'>color</span> <span class='ignore'>space</span><span class='ignore'>}</span><br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>i</span><span class='math'>)</span><span class='ignore'>}</span><span class='mathcmd'>\gets</span> <span class='math'>LCaCb</span><span class='math'>(</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>i</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>)</span> <span class='exclmath'>$</span> <span class='exclcmd'>\Comment</span><span class='ignore'>{</span><span class='ignore'>The</span> <span class='ignore'>black-out</span> <span class='ignore'>points</span> <span class='ignore'>in</span> <span class='ignore'>LCaCb</span> <span class='ignore'>color</span> <span class='ignore'>space</span><span class='ignore'>}</span><br>
&nbsp;  <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>L</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>WO</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>1</span><span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>L</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>BO</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>1</span><span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>Ca</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>min</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='math'>Min</span><span class='math'>(</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>)</span><span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>Ca</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>max</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>Max</span><span class='math'>(</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>)</span><span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>Cb</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>min</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\gets</span> <span class='math'>Min</span><span class='math'>(</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>3</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>3</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>3</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>)</span><span class='exclmath'>$</span> <br>
&nbsp;  <span class='exclcmd'>\State</span>  <span class='exclmath'>$</span><span class='math'>Cb</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>max</span><span class='ignore'>}</span> <span class='mathcmd'>\gets</span> <span class='math'>Max</span><span class='math'>(</span><span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>3</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>WO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>3</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>1</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>3</span><span class='math'>,</span> <span class='math'>pnt</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>(</span><span class='math'>BO</span><span class='math'>,</span> <span class='math'>2</span><span class='math'>)</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>3</span> <span class='math'>)</span><span class='exclmath'>$</span> <br>
&nbsp; &nbsp;  <br>
&nbsp; <span class='exclcmd'>\State</span> <span class='exclcmd'>\textbf</span><span class='ignore'>{</span><span class='ignore'>Return</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='exclmath'>$</span><span class='math'>L</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>WO</span><span class='ignore'>}</span> <span class='math'>,</span> <span class='math'>L</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>BO</span><span class='ignore'>}</span> <span class='math'>,</span> <span class='math'>Ca</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>min</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>Ca</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>max</span><span class='ignore'>}</span> <span class='math'>,</span> <span class='math'>Cb</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>min</span><span class='ignore'>}</span><span class='math'>,</span> <span class='math'>Cb</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>max</span><span class='ignore'>}</span><span class='exclmath'>$</span> <span class='ignore'>}</span><br>
 <br>
&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{algorithmic}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\caption</span><span class='ignore'>{</span><span class='ignore'>The</span> <span class='ignore'>White-Out</span> <span class='ignore'>Black-Out</span> <span class='ignore'>Algorithm</span><span class='ignore'>}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>algo</span><span class='ignore'>:</span><span class='ignore'>TheWhiteoutBlackoutAlgorithm</span><span class='ignore'>}</span><br>
 <span class='envir'>\end</span><span class='envir'>{algorithm}</span><br>
 <br>
 <span class='word'>The</span> <span class='word'>theoretical</span> <span class='word'>values</span> <span class='word'>are</span> <span class='word'>adjusted</span> <span class='word'>by</span> <span class='word'>10</span><span class='ignore'>\%</span> <span class='word'>to</span> <span class='word'>account</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>auto</span> <span class='word'>brightness</span> <span class='word'>and</span> <span class='word'>contrast</span> <span class='word'>adjustment</span> <span class='word'>performed</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>phone</span> <span class='word'>as</span> <span class='word'>described</span> <span class='word'>in</span> <span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>WhiteoutAndBlackout</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>only</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>adjust</span> <span class='word'>the</span> <span class='word'>bounds</span> <span class='word'>away</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>axis</span><span class='ignore'>.</span> <span class='word'>One</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>bounds</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>axis</span> <span class='mathgroup'>$</span><span class='math'>Ca</span><span class='math'>=</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>or</span>&nbsp; <span class='mathgroup'>$</span><span class='math'>Cb</span><span class='math'>=</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>white</span> <span class='word'>or</span> <span class='word'>black</span> <span class='word'>point</span><span class='ignore'>.</span> <span class='word'>Whether</span> <span class='word'>the</span> <span class='word'>bound</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>upper</span> <span class='word'>or</span> <span class='word'>lower</span> <span class='word'>limit</span> <span class='word'>depends</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>starting</span> <span class='word'>point</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>define</span> <span class='word'>a</span> <span class='word'>function</span> <span class='word'>which</span> <span class='word'>performs</span> <span class='word'>the</span> <span class='word'>adjustment</span> <span class='word'>appropriately</span><span class='ignore'>.</span><br>
 <br>
 <span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
 <span class='math'>slack</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='math'>=</span> <span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
 <span class='math'>(</span><span class='math'>1-a</span><span class='math'>)</span> <span class='math'>x</span>&nbsp; &nbsp;  <span class='math'>&amp;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='math'>(</span><span class='math'>1</span><span class='math'>+</span><span class='math'>a</span><span class='math'>)</span> <span class='math'>x</span>&nbsp; &nbsp;  <span class='math'>&amp;</span> <span class='math'>x</span> <span class='math'>&gt;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
 <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>&amp;</span> <span class='math'>x</span> <span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <br>
 <span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='math'>a</span> <span class='math'>=</span> <span class='math'>0.1</span><br>
&nbsp;  <span class='envir'>\end</span><span class='envir'>{equation}</span><br>
 <span class='word'>We</span> <span class='word'>can</span> <span class='word'>now</span> <span class='word'>write</span> <span class='word'>the</span> <span class='word'>condition</span> <span class='word'>for</span> <span class='word'>whether</span> <span class='word'>a</span> <span class='word'>value</span> <span class='word'>could</span> <span class='word'>have</span> <span class='word'>suffered</span> <span class='word'>from</span> <span class='word'>white-out</span> <span class='word'>or</span> <span class='word'>black-out</span><span class='ignore'>.</span> <br>
&nbsp; <span class='envir'>\begin</span><span class='envir'>{multline}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>InWoBoRegion</span><span class='ignore'>}</span><br>
 <span class='ignore'>(</span><span class='ignore'>(</span> <span class='word'>0</span> <span class='cmd'>\le</span> <span class='word'>L</span> <span class='cmd'>\le</span>  <span class='word'>slack</span><span class='ignore'>(</span><span class='word'>L</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='word'>BO</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='ignore'>)</span> <span class='cmd'>\vee</span> <span class='ignore'>(</span> <span class='word'>slack</span><span class='ignore'>(</span><span class='word'>L</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='word'>WO</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='cmd'>\le</span> <span class='word'>L</span> <span class='cmd'>\le</span> <span class='word'>1</span><span class='ignore'>)</span> <span class='ignore'>)</span> <span class='cmd'>\wedge</span>  <span class='cmd'>\\</span><br>
 <span class='word'>slack</span><span class='ignore'>(</span><span class='word'>Ca</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='word'>min</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='cmd'>\le</span> <span class='word'>Ca</span> <span class='cmd'>\le</span>  <span class='word'>slack</span><span class='ignore'>(</span><span class='word'>Ca</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='word'>max</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='cmd'>\wedge</span>  <span class='cmd'>\\</span><br>
 <span class='word'>slack</span><span class='ignore'>(</span><span class='word'>Cb</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='word'>min</span><span class='ignore'>}</span><span class='ignore'>)</span> <span class='cmd'>\le</span> <span class='word'>Cb</span> <span class='cmd'>\le</span>  <span class='word'>slack</span><span class='ignore'>(</span><span class='word'>Cb</span><span class='ignore'>_</span><span class='ignore'>{</span><span class='word'>max</span><span class='ignore'>}</span><span class='ignore'>)</span><br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{multline}</span><br>
&nbsp; <br>
&nbsp; <span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>Region</span> <span class='hword'>Classification</span> <span class='hword'>and</span> <span class='hword'>Partitioning</span> <span class='hword'>Function</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>TheRegionClassificationAndPartitioningFunction</span><span class='ignore'>}</span><br>
&nbsp;<span class='word'>It</span> <span class='word'>is</span> <span class='word'>desirable</span> <span class='word'>to</span> <span class='word'>classify</span> <span class='word'>a</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>after</span> <span class='word'>rotation</span> <span class='word'>but</span> <span class='word'>before</span> <span class='word'>redistribution</span> <span class='word'>in-order</span> <span class='word'>to</span> <span class='word'>avoid</span> <span class='word'>unnecessary</span> <span class='word'>work</span> <span class='word'>on</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>of</span> <span class='word'>interest</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>done</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>degree</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>necessary</span> <span class='word'>to</span> <span class='word'>assume</span> <span class='word'>reasonably</span> <span class='word'>uniform</span> <span class='word'>lighting</span> <span class='word'>conditions</span> <span class='word'>or</span> <span class='word'>by</span> <span class='word'>using</span> <span class='word'>boundaries</span> <span class='word'>set</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>WOBO</span> <span class='word'>algorithm</span> <span class='word'>described</span> <span class='word'>in</span> <span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>WhiteOutBlackOutAlgorithm</span><span class='ignore'>}</span> <span class='word'>above</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>are</span> <span class='word'>classified</span> <span class='word'>by</span> <span class='word'>chromatic</span> <span class='word'>value</span> <span class='word'>as</span> <span class='word'>either</span> <span class='word'>inside</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>region</span> <span class='word'>or</span> <span class='word'>outside</span> <span class='word'>in</span> <span class='word'>each</span> <span class='word'>chromatic</span> <span class='word'>axes</span><span class='ignore'>,</span> <span class='word'>dividing</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>plane</span> <span class='word'>into</span> <span class='word'>nine</span> <span class='word'>regions</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>illustrated</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PartitioningRegions</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='word'>rudimentary</span> <span class='word'>partitioning</span> <span class='word'>is</span> <span class='word'>performed</span> <span class='word'>by</span> <span class='word'>assigning</span> <span class='word'>8</span> <span class='word'>constant</span> <span class='word'>chromatic</span> <span class='word'>vectors</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>values</span> <span class='word'>outside</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>region</span> <span class='word'>around</span> <span class='word'>the</span> <span class='word'>mean</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>chromatic</span> <span class='word'>channel</span> <span class='word'>values</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>evaluated</span> <span class='word'>further</span> <span class='word'>for</span> <span class='word'>values</span> <span class='word'>outside</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>region</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>luminosity</span> <span class='word'>is</span> <span class='word'>always</span> <span class='word'>evaluated</span><span class='ignore'>,</span> <span class='word'>because</span> <span class='word'>all</span> <span class='word'>that</span> <span class='word'>is</span> <span class='word'>required</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>scaling</span> <span class='word'>from</span> <span class='mathgroup'>$</span><span class='math'>qRsRange</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='math'>dRange</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>and</span> <span class='word'>the</span> <span class='word'>luminosity</span> <span class='word'>is</span> <span class='word'>needed</span> <span class='word'>to</span> <span class='word'>choose</span> <span class='word'>appropriate</span> <span class='word'>bounds</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>WOBO</span> <span class='word'>algorithm</span><span class='ignore'>.</span><br>
&nbsp; <br>
&nbsp; <span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.80\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>PartitioningRegion.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>Regions</span> <span class='oword'>in</span> <span class='oword'>the</span> <span class='oword'>chromatic</span> <span class='oword'>space</span><span class='ignore'>.</span> <span class='oword'>A</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\sim</span> <span class='mathgroup'>$</span> <span class='oword'>indicates</span> <span class='oword'>values</span> <span class='oword'>which</span> <span class='oword'>will</span> <span class='oword'>undergo</span> <span class='oword'>redistribution</span><span class='ignore'>.</span> <span class='oword'>Regions</span> <span class='oword'>outside</span> <span class='oword'>the</span> <span class='oword'>target</span> <span class='oword'>area</span> <span class='oword'>are</span> <span class='oword'>allocated</span> <span class='oword'>extreme</span> <span class='oword'>values</span> <span class='oword'>at</span> <span class='oword'>the</span> <span class='oword'>edge</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>color</span> <span class='oword'>space</span><span class='ignore'>}</span>  <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>PartitioningRegions</span><span class='ignore'>}</span><br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{figure}</span><br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Floating</span> <span class='hword'>the</span> <span class='hword'>Mean</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FloatingTheMean</span><span class='ignore'>}</span><br>
&nbsp;<span class='word'>Different</span> <span class='word'>lighting</span> <span class='word'>conditions</span> <span class='word'>can</span> <span class='word'>affect</span> <span class='word'>the</span> <span class='word'>detected</span> <span class='word'>pixel</span> <span class='word'>color</span><span class='ignore'>.</span> <span class='word'>Not</span> <span class='word'>accounting</span> <span class='word'>for</span> <span class='word'>strongly-colored</span> <span class='word'>light</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>affect</span> <span class='word'>of</span> <span class='word'>different</span> <span class='word'>lighting</span> <span class='word'>conditions</span> <span class='word'>is</span> <span class='word'>to</span> <span class='word'>increase</span> <span class='word'>or</span> <span class='word'>decrease</span> <span class='word'>the</span> <span class='word'>saturation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>color</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>distribution</span> <span class='word'>is</span> <span class='word'>relatively</span> <span class='word'>unaffected</span> <span class='word'>in</span> <span class='word'>orientation</span> <span class='word'>or</span> <span class='word'>variance</span><span class='ignore'>,</span> <span class='word'>meaning</span> <span class='word'>that</span> <span class='word'>lighting</span> <span class='word'>conditions</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>accounted</span> <span class='word'>for</span> <span class='word'>by</span> <span class='word'>adjusting</span> <span class='word'>the</span> <span class='word'>mean</span><span class='ignore'>.</span> <br>
&nbsp; <span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\newMean</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\widetilde</span><span class='ignore'>{</span><span class='ignore'>\mu</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
&nbsp;<span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>adjusts</span> <span class='word'>to</span> <span class='word'>ambient</span> <span class='word'>lighting</span> <span class='word'>by</span> <span class='word'>first</span> <span class='word'>taking</span> <span class='word'>a</span> <span class='word'>reference</span> <span class='word'>image</span> <span class='word'>centered</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>patch</span> <span class='word'>of</span> <span class='word'>skin</span> <span class='word'>and</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>LCaCb</span> <span class='word'>color</span> <span class='word'>space</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>new</span> <span class='word'>mean</span> <span class='mathgroup'>$</span><span class='mathcmd'>\newMean</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>then</span> <span class='word'>used</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>current</span> <span class='word'>instance</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>is</span> <span class='word'>adventitious</span> <span class='word'>to</span> <span class='word'>keep</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>adjustable</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>routine</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>implemented</span> <span class='word'>by</span> <span class='word'>introducing</span> <span class='word'>an</span> <span class='word'>adjustment</span> <span class='word'>parameter</span> <span class='mathgroup'>$</span><span class='math'>\delta\mu</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>routine</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='mathgroup'>$</span><span class='mathcmd'>\newMean</span> <span class='math'>=</span> <span class='math'>\mu </span><span class='math'>+</span> <span class='math'>\delta\mu</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>assumes</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>adjustment</span> <span class='word'>is</span> <span class='word'>small</span> <span class='word'>enough</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>function</span> <span class='word'>retains</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>shape</span> <span class='word'>aside</span> <span class='word'>from</span> <span class='word'>a</span> <span class='word'>translation</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>axis</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>allows</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>parameters</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>adjusted</span> <span class='word'>by</span> <span class='word'>simply</span> <span class='word'>shifting</span> <span class='word'>them</span> <span class='word'>by</span> <span class='mathgroup'>$</span><span class='math'>\delta\mu</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
&nbsp; <br>
&nbsp; <span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
&nbsp;<span class='exclenv'>\begin</span><span class='exclenv'>{aligned}</span><br>
&nbsp; <span class='exclcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\lambda</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\lambda</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>+</span> <span class='math'>\delta\mu </span><span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='mathcmd'>\lambda</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\lambda</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>+</span> <span class='math'>\delta\mu </span><span class='mathcmd'>\\</span><br>
&nbsp; <span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\omega</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\omega</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>+</span> <span class='math'>\delta\mu </span><span class='math'>&amp;</span>&nbsp; <span class='mathcmd'>\widetilde</span><span class='ignore'>{</span><span class='math'>\omega</span><span class='ignore'>}</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>=</span> <span class='mathcmd'>\omega</span><span class='math'>_</span><span class='math'>2</span> <span class='math'>+</span> <span class='math'>\delta\mu 
&nbsp; </span><span class='exclenv'>\end</span><span class='exclenv'>{aligned}</span><span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Where</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\lambda</span><span class='math'>_</span><span class='math'>1</span> <span class='math'>&lt;</span> <span class='math'>\delta\mu </span><span class='math'>&lt;</span> <span class='math'>1</span> <span class='math'>-</span> <span class='mathcmd'>\lambda</span><span class='math'>_</span><span class='math'>2</span><br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{equation}</span><br>
&nbsp; <br>
&nbsp; <span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Loosened</span> <span class='hword'>Deviation</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>LoosenedDeviation</span><span class='ignore'>}</span><br>
&nbsp;<br>
 <span class='cmd'>\afterpage</span><span class='ignore'>{</span> <span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.85\textwidth,height = \textheight]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>RelaxingSigma.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>A</span> <span class='oword'>selection</span> <span class='oword'>of</span> <span class='oword'>images</span> <span class='oword'>classified</span> <span class='oword'>using</span> <span class='oword'>the</span> <span class='oword'>quaternary</span> <span class='oword'>method</span> <span class='oword'>outlined</span> <span class='oword'>in</span> <span class='oword'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>QuaternaryPixelClassification</span><span class='ignore'>}</span><span class='ignore'>,</span> <span class='oword'>with</span> <span class='oword'>various</span> <span class='oword'>values</span> <span class='oword'>of</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='oword'>It</span> <span class='oword'>can</span> <span class='oword'>be</span> <span class='oword'>seen</span> <span class='oword'>that</span> <span class='mathgroup'>$</span><span class='math'>1\sigma</span><span class='mathgroup'>$</span> <span class='oword'>correctly</span> <span class='oword'>classifies</span> <span class='oword'>the</span> <span class='oword'>majority</span> <span class='oword'>of</span> <span class='oword'>pixels</span><span class='ignore'>,</span> <span class='oword'>however</span> <span class='oword'>it</span> <span class='oword'>classifies</span> <span class='oword'>some</span> <span class='oword'>on-digit</span> <span class='oword'>pixels</span> <span class='oword'>as</span> <span class='ignore'>"</span><span class='oword'>probably</span> <span class='oword'>not</span> <span class='oword'>skin</span><span class='ignore'>"</span><span class='ignore'>,</span> <span class='oword'>and</span> <span class='oword'>even</span> <span class='ignore'>"</span><span class='oword'>not</span> <span class='oword'>skin</span><span class='ignore'>"</span><span class='ignore'>.</span> <span class='mathgroup'>$</span><span class='math'>3\sigma</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='oword'>meanwhile</span><span class='ignore'>,</span> <span class='oword'>includes</span> <span class='oword'>large</span> <span class='oword'>portions</span> <span class='oword'>of</span> <span class='oword'>shadow</span> <span class='oword'>as</span> <span class='ignore'>"</span><span class='oword'>probably</span> <span class='oword'>skin</span><span class='ignore'>"</span><span class='ignore'>.</span> <span class='oword'>A</span> <span class='oword'>compromise</span> <span class='oword'>of</span> <span class='mathgroup'>$</span><span class='math'>2\sigma</span><span class='mathgroup'>$</span><span class='ignore'>-</span><span class='mathgroup'>$</span><span class='math'>2.5\sigma</span><span class='mathgroup'>$</span> <span class='oword'>is</span> <span class='oword'>therefore</span> <span class='oword'>suggested</span><span class='ignore'>.</span><span class='ignore'>}</span> <span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>RelaxedSigma</span><span class='ignore'>}</span><br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{figure}</span><br>
&nbsp; <span class='cmd'>\clearpage</span><br>
&nbsp;<span class='ignore'>}</span><br>
&nbsp; <br>
&nbsp; <span class='word'>The</span> <span class='word'>standard</span> <span class='word'>deviation</span> <span class='word'>found</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>3</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>very</span> <span class='word'>tight</span> <span class='word'>fit</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>chromatic</span> <span class='word'>values</span> <span class='word'>taken</span> <span class='word'>under</span> <span class='word'>controlled</span> <span class='word'>lighting</span> <span class='word'>conditions</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>our</span> <span class='word'>practical</span> <span class='word'>implementation</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>tight</span> <span class='word'>fit</span> <span class='word'>needs</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>relaxed</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>empirically</span> <span class='word'>by</span> <span class='word'>trying</span> <span class='word'>out</span> <span class='word'>multipliers</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>standard</span> <span class='word'>deviation</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>sets</span><span class='ignore'>.</span> <span class='word'>What</span> <span class='word'>is</span> <span class='word'>desired</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>multiplier</span> <span class='word'>which</span> <span class='word'>relaxes</span> <span class='word'>the</span> <span class='word'>redistribution</span> <span class='word'>such</span> <span class='word'>that</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>on</span> <span class='word'>a</span> <span class='word'>given</span> <span class='word'>digit</span> <span class='word'>are</span> <span class='word'>classified</span> <span class='word'>as</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>all</span> <span class='word'>the</span> <span class='word'>background</span> <span class='word'>is</span> <span class='word'>classified</span> <span class='word'>as</span> <span class='word'>not</span> <span class='word'>skin</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>empirically</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>quaternary</span> <span class='word'>classification</span> <span class='word'>presented</span> <span class='word'>in</span> <span class='word'>Section</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>QuaternaryPixelClassification</span><span class='ignore'>}</span> <span class='word'>below</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>accounts</span> <span class='word'>for</span> <span class='word'>white-out</span> <span class='word'>and</span> <span class='word'>black-out</span> <span class='word'>and</span> <span class='word'>classifies</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>as</span> <span class='ignore'>"</span><span class='word'>definitely</span> <span class='word'>skin</span><span class='ignore'>"</span><span class='ignore'>,</span> <span class='ignore'>"</span><span class='word'>probably</span> <span class='word'>skin</span><span class='ignore'>"</span><span class='ignore'>,</span> <span class='ignore'>"</span><span class='word'>probably</span> <span class='word'>not</span> <span class='word'>skin</span><span class='ignore'>"</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='ignore'>"</span><span class='word'>not</span> <span class='word'>skin</span><span class='ignore'>"</span><span class='ignore'>.</span><br>
&nbsp; <br>
&nbsp; <span class='word'>Using</span> <span class='word'>a</span> <span class='word'>value</span> <span class='word'>of</span> <span class='word'>2.3</span> <span class='word'>times</span> <span class='word'>the</span> <span class='word'>original</span> <span class='mathgroup'>$</span><span class='math'>\sigma</span><span class='mathgroup'>$</span> <span class='word'>correctly</span> <span class='word'>classifies</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span><span class='ignore'>;</span> <span class='word'>this</span> <span class='word'>was</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>observing</span> <span class='word'>tables</span> <span class='word'>of</span> <span class='word'>images</span> <span class='word'>similar</span> <span class='word'>to</span> <span class='word'>those</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>RelaxedSigma</span><span class='ignore'>}</span><span class='ignore'>.</span> <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='hword'>Color</span> <span class='hword'>Space</span> <span class='hword'>Algorithm</span> <span class='hword'>as</span> <span class='hword'>Implemented</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ColorSpaceAlgorithmAsImplemented</span><span class='ignore'>}</span><br>
&nbsp;<span class='word'>Here</span> <span class='word'>we</span> <span class='word'>present</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>algorithm</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>way</span> <span class='word'>which</span> <span class='word'>most</span> <span class='word'>closely</span> <span class='word'>resembles</span> <span class='word'>the</span> <span class='word'>C</span><span class='ignore'>+</span><span class='ignore'>+</span> <span class='word'>code</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>construction</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>object</span> <span class='word'>is</span> <span class='word'>described</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>end</span> <span class='word'>of</span> <span class='word'>Chapter</span> <span class='word'>2</span><span class='ignore'>;</span> <span class='word'>here</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>operation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>described</span><span class='ignore'>.</span><br>
&nbsp; <br>
&nbsp; <span class='word'>First</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>determine</span> <span class='word'>the</span> <span class='word'>form</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>function</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>working</span> <span class='word'>type</span> <span class='mathgroup'>$</span><span class='math'>tRange</span><span class='mathgroup'>$</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>source</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='math'>srcRange</span><span class='math'>=</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span><span class='mathgroup'>$</span>&nbsp; <span class='word'>and</span> <span class='word'>destination</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='math'>dstRange</span><span class='math'>=</span><span class='math'>2</span><span class='math'>^</span><span class='math'>m</span><span class='mathgroup'>$</span> <span class='word'>expressed</span> <span class='word'>in</span> <span class='word'>terms</span> <span class='word'>of</span> <span class='word'>their</span> <span class='word'>bit</span> <span class='word'>depths</span><span class='ignore'>.</span><br>
&nbsp; <br>
&nbsp; <span class='envir'>\begin</span><span class='envir'>{gather*}</span><br>
&nbsp;<span class='envir'>\begin</span><span class='envir'>{aligned}</span><br>
&nbsp;<span class='ignore'>K</span> <span class='ignore'>&amp;</span> <span class='ignore'>=</span>&nbsp; <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>m-n</span><span class='ignore'>}</span>&nbsp; <span class='exclcmd'>\quad</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\quad</span>  <br>
&nbsp;<span class='exclcmd'>\tRange</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='ignore'>\mu</span><span class='ignore'>,</span><span class='ignore'>\sigma</span><span class='ignore'>)</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>=</span>&nbsp; <span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span> <span class='exclcmd'>\;</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>n</span> <span class='exclcmd'>\quad</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\quad</span><br>
&nbsp;<span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>=</span> <span class='exclcmd'>\min</span><span class='exclcmd'>\left</span><span class='ignore'>\{</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>m-n</span><span class='ignore'>}</span><span class='ignore'>\delta</span><span class='ignore'>(</span><span class='ignore'>\mu</span><span class='ignore'>,</span><span class='ignore'>\sigma</span><span class='ignore'>)</span> <span class='exclcmd'>\right</span><span class='ignore'>.</span> <span class='ignore'>,</span>&nbsp; <span class='exclcmd'>\left</span><span class='ignore'>.</span> <span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>L</span><span class='ignore'>}</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>)</span> <span class='exclcmd'>\right</span><span class='ignore'>\}</span> <br>
&nbsp;  <span class='envir'>\end</span><span class='envir'>{aligned}</span><span class='cmd'>\\</span><br>
&nbsp; <span class='envir'>\begin</span><span class='envir'>{aligned}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\tMin</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='ignore'>\mu</span><span class='ignore'>,</span><span class='ignore'>\sigma</span><span class='ignore'>)</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>=</span><br>
&nbsp;  <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp;&nbsp;&nbsp;<span class='ignore'>0</span> <span class='exclcmd'>\\</span><br>
&nbsp;&nbsp;<span class='ignore'>-</span><span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>2</span> <span class='exclcmd'>\;</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-1</span><span class='ignore'>}</span>&nbsp; <span class='exclcmd'>\\</span>  <br>
&nbsp;&nbsp;<span class='ignore'>-</span><span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>3</span> <span class='exclcmd'>\;</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-1</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span>  <br>
&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='exclcmd'>\quad</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\quad</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\tMax</span><span class='ignore'>(</span><span class='ignore'>\theta</span><span class='ignore'>,</span><span class='ignore'>\mu</span><span class='ignore'>,</span><span class='ignore'>\sigma</span><span class='ignore'>)</span>&nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>=</span><br>
&nbsp;  <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>1</span> <span class='exclcmd'>\;</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>n</span>&nbsp; <span class='exclcmd'>\\</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>2</span> <span class='exclcmd'>\;</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-1</span><span class='ignore'>}</span>&nbsp; <span class='exclcmd'>\\</span>  <br>
&nbsp;&nbsp;<span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>3</span> <span class='exclcmd'>\;</span> <span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>n-1</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span>  <br>
&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='exclcmd'>\quad</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\quad</span><br>
&nbsp;&nbsp; <span class='exclcmd'>\Scale</span> <span class='ignore'>&amp;</span><span class='ignore'>=</span><br>
&nbsp; &nbsp; &nbsp; <span class='exclcmd'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span> <span class='exclcmd'>\otimes</span><br>
&nbsp;&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{pmatrix}</span><br>
&nbsp;&nbsp;&nbsp; <span class='exclcmd'>\frac</span><span class='ignore'>{</span><span class='ignore'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>3</span><span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;<span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>1-n</span> <span class='ignore'>}</span> <span class='exclcmd'>\\</span><br>
&nbsp;&nbsp;&nbsp;<span class='ignore'>2</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>1-n</span> <span class='ignore'>}</span>&nbsp; <span class='exclcmd'>\\</span><br>
&nbsp;&nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{pmatrix}</span><span class='exclcmd'>\\</span><br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{aligned}</span><br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{gather*}</span><br>
&nbsp; <br>
&nbsp; <span class='word'>Substituting</span> <span class='word'>into</span> <span class='word'>the</span> <span class='word'>distribution</span> <span class='word'>function</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>disFunction</span><span class='ignore'>}</span> <span class='word'>gives</span> <span class='word'>us</span><br>
&nbsp; <br>
&nbsp; <span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
<span class='mathcmd'>\textbf</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='math'>=</span>&nbsp; <span class='math'>-</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='math'>^</span><span class='math'>n</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\mu </span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>+</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>1-2</span> <span class='math'>n</span><span class='ignore'>}</span> <span class='math'>x-\mu </span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\mu -1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='math'>-</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>erf</span><span class='ignore'>}</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>2</span> <span class='math'>\mu </span><span class='math'>+</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>\sigma </span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\textbf</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span><br>
<span class='exclenv'>\begin</span><span class='exclenv'>{array}</span><span class='ignore'>{</span><span class='math'>rl</span><span class='ignore'>}</span><br>
<span class='math'>qMin</span> <span class='math'>&lt;</span> <span class='math'>&amp;</span> <span class='math'>x</span>&nbsp; <span class='math'>&lt;</span> <span class='math'>qMax</span> <span class='mathcmd'>\\</span><br>
<span class='math'>0</span> <span class='math'>&lt;</span> <span class='math'>&amp;</span><span class='math'>\mu </span><span class='math'>&lt;</span><span class='math'>1</span><span class='mathcmd'>\\</span><br>
<span class='math'>0</span> <span class='math'>&lt;</span> <span class='math'>&amp;</span><span class='math'>\sigma </span><span class='math'>&lt;</span><span class='math'>1</span><br>
<span class='exclenv'>\end</span><span class='exclenv'>{array}</span><br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{equation}</span><br>
&nbsp; <br>
&nbsp; <span class='word'>This</span> <span class='word'>form</span> <span class='word'>takes</span> <span class='word'>the</span> <span class='word'>result</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>directly</span><span class='ignore'>,</span> <span class='word'>however</span> <span class='word'>we</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>add</span> <span class='word'>the</span> <span class='word'>flexibility</span> <span class='word'>to</span> <span class='word'>adjust</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>and</span> <span class='word'>use</span> <span class='word'>a</span> <span class='word'>lookup</span> <span class='word'>table</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>values</span><span class='ignore'>.</span> <span class='word'>It</span> <span class='word'>is</span> <span class='word'>desirable</span> <span class='word'>to</span> <span class='word'>keep</span> <span class='word'>the</span> <span class='word'>lookup</span> <span class='word'>table</span> <span class='word'>as</span> <span class='word'>short</span> <span class='word'>as</span> <span class='word'>possible</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>maximum</span> <span class='word'>compression</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>without</span> <span class='word'>losing</span> <span class='word'>relevant</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>given</span> <span class='word'>by</span> <span class='word'>compressing</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='math'>tRange</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>values</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>lookup</span> <span class='word'>table</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>reduced</span> <span class='word'>by</span> <span class='word'>scaling</span> <span class='mathgroup'>$</span><span class='math'>x</span><span class='mathgroup'>$</span> <span class='word'>by</span> <span class='word'>a</span> <span class='word'>range</span> <span class='mathgroup'>$</span><span class='math'>qtRange</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>chosen</span> <span class='word'>to</span> <span class='word'>balance</span> <span class='word'>lookup</span> <span class='word'>table</span> <span class='word'>size</span> <span class='word'>and</span> <span class='word'>computational</span> <span class='word'>scaling</span> <span class='word'>efficiency</span><span class='ignore'>.</span>&nbsp; <span class='word'>Noting</span> <span class='word'>that</span> <span class='mathgroup'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span> <span class='math'>&lt;</span><span class='math'>2</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='mathgroup'>$</span><span class='math'>qRsRange</span><span class='mathgroup'>$</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>chosen</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>equal</span> <span class='word'>to</span> <span class='mathgroup'>$</span><span class='math'>tRange</span><span class='mathgroup'>$</span> <span class='word'>as</span> <span class='word'>if</span> <span class='mathgroup'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>l</span><span class='ignore'>}</span> <span class='math'>=</span><span class='math'>2</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>means</span> <span class='word'>that</span> <span class='mathgroup'>$</span><span class='math'>qtRange</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>power</span> <span class='word'>of</span> <span class='word'>two</span><span class='ignore'>,</span> <span class='word'>allowing</span> <span class='word'>the</span> <span class='word'>scaling</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>performed</span> <span class='word'>by</span> <span class='word'>bit</span> <span class='word'>shifting</span> <span class='word'>the</span> <span class='word'>value</span> <span class='word'>of</span> <span class='mathgroup'>$</span><span class='math'>x</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>qt</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>x</span> <span class='mathcmd'>\ll</span> <span class='math'>n-2</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>function</span> <span class='word'>is</span> <span class='word'>applied</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>preserved</span> <span class='word'>at</span> <span class='word'>best</span> <span class='word'>2-to-1</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>the</span> <span class='word'>information</span> <span class='word'>density</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>reduced</span> <span class='word'>by</span> <span class='word'>half</span> <span class='mathgroup'>$</span><span class='math'>x</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>qt</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='math'>x</span> <span class='mathcmd'>\ll</span> <span class='math'>n-1</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>Adjusting</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>changes</span> <span class='word'>the</span> <span class='word'>bounds</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>region</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>redistributed</span> <span class='word'>such</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>form</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>function</span> <span class='word'>does</span> <span class='word'>not</span> <span class='word'>change</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>this</span> <span class='word'>reason</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>also</span> <span class='word'>define</span> <span class='mathgroup'>$</span><span class='math'>x</span><span class='mathgroup'>$</span> <span class='word'>relative</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>bounds</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>allows</span> <span class='word'>the</span> <span class='word'>same</span> <span class='word'>lookup</span> <span class='word'>table</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>regardless</span> <span class='word'>of</span> <span class='word'>any</span> <span class='word'>adjustment</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>mean</span><span class='ignore'>.</span><br>
&nbsp; <br>
&nbsp; &nbsp; <span class='envir'>\begin</span><span class='envir'>{equation}</span><br>
&nbsp;<span class='mathcmd'>\textbf</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span> <span class='math'>=</span>&nbsp; <span class='exclenv'>\begin</span><span class='exclenv'>{cases}</span><br>
&nbsp;&nbsp;<span class='mathcmd'>\textbf</span><span class='ignore'>{</span><span class='math'>disLU</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>(</span><span class='math'>x</span><span class='math'>-</span><span class='mathcmd'>\Lambda</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='math'>)</span> <span class='math'>qtRange</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\Lambda</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\Omega</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>pq1</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\textbf</span><span class='ignore'>{</span><span class='math'>disLU</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>(</span><span class='math'>x</span><span class='math'>-</span><span class='mathcmd'>\Omega</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>pq2</span><span class='ignore'>}</span><span class='math'>)</span> <span class='math'>qtRange</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\Omega</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>pq2</span><span class='ignore'>}</span> <span class='math'>&lt;</span> <span class='math'>x</span> <span class='math'>&lt;</span> <span class='mathcmd'>\Lambda</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>q2</span><span class='ignore'>}</span> <span class='mathcmd'>\\</span><br>
&nbsp;<span class='mathcmd'>\textbf</span><span class='ignore'>{</span><span class='math'>dis</span><span class='ignore'>}</span><span class='math'>(</span><span class='math'>x</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>Otherwise</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{cases}</span><span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>where</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <br>
&nbsp;&nbsp;<span class='math'>qtRange</span> <span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='exclenv'>\begin</span><span class='exclenv'>{smallmatrix}</span><br>
&nbsp;&nbsp;<span class='mathcmd'>\cdots</span> <span class='mathcmd'>\\</span> <span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>1-n</span><span class='ignore'>}</span><span class='mathcmd'>\\</span><span class='math'>2</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>1-n</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='exclenv'>\end</span><span class='exclenv'>{smallmatrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span><br>
&nbsp; &nbsp; <span class='envir'>\end</span><span class='envir'>{equation}</span><br>
&nbsp; <br>
&nbsp; <span class='word'>Aside</span> <span class='word'>from</span> <span class='word'>these</span> <span class='word'>refinements</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>presented</span> <span class='word'>in</span> <span class='word'>Chapter</span> <span class='word'>2</span> <span class='word'>is</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>perform</span> <span class='word'>the</span> <span class='word'>rotation</span> <span class='word'>and</span> <span class='word'>redistribution</span> <span class='word'>as</span> <span class='word'>described</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>proceeds</span> <span class='word'>as</span> <span class='word'>follows</span><span class='ignore'>:</span><br>
&nbsp; <br>
&nbsp; <span class='envir'>\begin</span><span class='envir'>{itemize}</span><br>
&nbsp;<span class='cmd'>\item</span> <span class='word'>Interactively</span> <span class='word'>find</span> <span class='word'>an</span> <span class='word'>adjustment</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>mean</span>&nbsp; <span class='mathgroup'>$</span><span class='math'>\delta\mu</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
&nbsp; <span class='cmd'>\item</span> <span class='word'>Set</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>distribution</span> <span class='word'>parameters</span><span class='ignore'>.</span><br>
&nbsp; <span class='cmd'>\item</span> <span class='word'>Rotate</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>with</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='mathcmd'>\qR</span><span class='mathgroup'>$</span> <span class='word'>matrix</span><span class='ignore'>:</span> <span class='mathgroup'>$</span> <span class='math'>pxl</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>q</span><span class='ignore'>}</span> <span class='math'>=</span> <span class='mathcmd'>\qR</span> <span class='mathcmd'>\cdot</span> <span class='math'>pxl</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>RGB</span><span class='ignore'>}</span><span class='mathgroup'>$</span> <span class='word'>then</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>-</span> <span class='math'>qRsRange</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span> <span class='math'>&lt;</span> <span class='math'>pxl</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>q</span><span class='ignore'>}</span> <span class='math'>&lt;</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span> <span class='math'>qRsRange</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='math'>2</span><span class='ignore'>}</span><span class='mathgroup'>$</span><br>
&nbsp; <span class='cmd'>\item</span> <span class='word'>Partition</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>values</span> <span class='word'>to</span> <span class='word'>avoid</span> <span class='word'>unnecessary</span> <span class='word'>processing</span> <span class='word'>of</span> <span class='word'>irrelevant</span> <span class='word'>information</span><span class='ignore'>.</span><br>
&nbsp; <span class='cmd'>\item</span> <span class='word'>Apply</span> <span class='word'>any</span> <span class='word'>user</span> <span class='word'>supplied</span> <span class='word'>per-pixel</span> <span class='word'>functions</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>value</span> <span class='word'>and</span> <span class='word'>add</span> <span class='word'>as</span> <span class='word'>extra</span> <span class='word'>channels</span><span class='ignore'>.</span><br>
&nbsp; <span class='cmd'>\item</span> <span class='word'>Redistribute</span> <span class='word'>the</span> <span class='word'>rotated</span> <span class='word'>values</span> <span class='word'>into</span> <span class='word'>the</span> <span class='word'>destination</span> <span class='word'>type</span><span class='ignore'>.</span><br>
&nbsp; <span class='cmd'>\item</span> <span class='word'>Apply</span> <span class='word'>and</span> <span class='word'>user</span> <span class='word'>supplied</span> <span class='word'>per-pixel</span> <span class='word'>functions</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>redistributed</span> <span class='word'>values</span><span class='ignore'>.</span><br>
&nbsp; <span class='envir'>\end</span><span class='envir'>{itemize}</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Pattern</span> <span class='hword'>Recognition</span> <span class='hword'>Routines</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>PatternRecognitionRoutines</span><span class='ignore'>}</span><br>
<span class='word'>In</span> <span class='word'>this</span> <span class='word'>section</span><span class='ignore'>,</span> <span class='word'>pattern</span> <span class='word'>recognition</span> <span class='word'>routines</span> <span class='word'>which</span> <span class='word'>use</span> <span class='word'>the</span> <span class='word'>new</span> <span class='word'>color</span> <span class='word'>space</span> <span class='word'>are</span> <span class='word'>presented</span> <span class='word'>and</span> <span class='word'>discussed</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\subsection</span><span class='ignore'>{</span><span class='hword'>Quaternary</span> <span class='hword'>Pixel</span> <span class='hword'>Classification</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>QuaternaryPixelClassification</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\WoBoBool</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\underset</span><span class='ignore'>{</span><span class='ignore'>\scalebox</span><span class='ignore'>{</span><span class='ignore'>0.5</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>WoBo</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\mathbb</span><span class='ignore'>{</span><span class='ignore'>L</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\ColorSquareBool</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\underset</span><span class='ignore'>{</span> <span class='ignore'>\scalebox</span><span class='ignore'>{</span><span class='ignore'>0.5</span><span class='ignore'>}</span><span class='ignore'>[</span><span class='ignore'>0.5</span><span class='ignore'>]</span><span class='ignore'>{</span><span class='ignore'>square</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span> <span class='ignore'>\mathbb</span><span class='ignore'>{</span><span class='ignore'>C</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\ColorEllipseBool</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\underset</span><span class='ignore'>{</span> <span class='ignore'>\scalebox</span><span class='ignore'>{</span><span class='ignore'>0.5</span><span class='ignore'>}</span><span class='ignore'>[</span><span class='ignore'>0.5</span><span class='ignore'>]</span><span class='ignore'>{</span><span class='ignore'>ellipse</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>{</span> <span class='ignore'>\mathbb</span><span class='ignore'>{</span><span class='ignore'>C</span><span class='ignore'>}</span> <span class='ignore'>}</span> <span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>ClassifiedSkin.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='oword'>Quaternary</span> <span class='oword'>Pixel</span> <span class='oword'>Classification</span> <span class='oword'>presented</span> <span class='oword'>alongside</span> <span class='oword'>the</span> <span class='oword'>probability</span> <span class='oword'>scored</span> <span class='oword'>image</span> <span class='oword'>for</span> <span class='oword'>comparison</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>2BitImage</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>We</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>classify</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>as</span> <span class='word'>either</span> <span class='word'>skin</span> <span class='word'>or</span> <span class='word'>not</span> <span class='word'>skin</span> <span class='word'>whist</span> <span class='word'>taking</span> <span class='word'>account</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>reliability</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>detected</span> <span class='word'>color</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>whiteout</span> <span class='word'>and</span> <span class='word'>blackout</span> <span class='word'>effects</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>by</span> <span class='word'>applying</span> <span class='word'>equation</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>eq</span><span class='ignore'>:</span><span class='ignore'>InWoBoRegion</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='word'>setting</span> <span class='word'>a</span> <span class='word'>boolean</span> <span class='word'>flag</span> <span class='mathgroup'>$</span><span class='mathcmd'>\WoBoBool</span><span class='mathgroup'>$</span> <span class='word'>accordingly</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>square</span> <span class='word'>partitioning</span> <span class='word'>performed</span> <span class='word'>earlier</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>also</span> <span class='word'>sets</span> <span class='word'>a</span> <span class='word'>boolean</span> <span class='word'>flag</span> <span class='mathgroup'>$</span><span class='mathcmd'>\ColorSquareBool</span><span class='mathgroup'>$</span> <span class='word'>to</span> <span class='word'>1</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>is</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>range</span> <span class='word'>and</span> <span class='word'>to</span> <span class='word'>0</span> <span class='word'>otherwise</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>combined</span> <span class='word'>to</span> <span class='word'>produce</span> <span class='word'>a</span> <span class='word'>2-bit</span> <span class='word'>image</span> <span class='word'>which</span> <span class='word'>indicates</span> <span class='word'>both</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>value</span> <span class='word'>is</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>chromatic</span> <span class='word'>range</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>reliability</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>classification</span><span class='ignore'>.</span><br>
<span class='comment'>% </span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{center}</span><br>
<span class='envir'>\begin</span><span class='envir'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\hline</span><br>
<span class='ignore'>Correct</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class='ignore'>&amp;</span> <span class='ignore'>Unreliable</span>&nbsp; &nbsp; &nbsp; <span class='ignore'>&amp;</span> <span class='exclcmd'>\multicolumn</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Image</span> <span class='ignore'>Bit</span><span class='ignore'>}</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\multicolumn</span><span class='ignore'>{</span><span class='ignore'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>|</span><span class='ignore'>c</span><span class='ignore'>|</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='exclcmd'>\multirow</span><span class='ignore'>{</span><span class='ignore'>2</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>*</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>Comment</span><span class='ignore'>}</span><span class='ignore'>}</span>  <span class='exclcmd'>\\</span> <span class='exclcmd'>\cline</span><span class='ignore'>{</span><span class='ignore'>1-4</span><span class='ignore'>}</span><br>
<span class='ignore'>Color</span> <span class='exclmath'>$</span><span class='mathcmd'>\ColorSquareBool</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\WoBoBool</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='exclmath'>$</span><span class='mathcmd'>\ColorSquareBool</span><span class='exclmath'>$</span> <span class='ignore'>&amp;</span> <span class='ignore'>XOR</span><span class='ignore'>(</span><span class='exclmath'>$</span><span class='mathcmd'>\ColorSquareBool</span><span class='exclmath'>$</span><span class='ignore'>,</span> <span class='exclmath'>$</span><span class='mathcmd'>\WoBoBool</span><span class='exclmath'>$</span><span class='ignore'>)</span> <span class='ignore'>&amp;</span> <span class='exclcmd'>\\</span><span class='exclcmd'>\hline</span><br>
<span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span>&nbsp; <span class='ignore'>Definitely</span> <span class='ignore'>not</span> <span class='ignore'>the</span> <span class='ignore'>target</span> <span class='exclcmd'>\\</span><span class='exclcmd'>\hline</span> <span class='comment'>% &amp; Wrong Color &amp;&nbsp; &nbsp; Reliable Luminosity </span><br>
<span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; <span class='ignore'>&amp;</span> <span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span> <span class='ignore'>Possibly</span> <span class='ignore'>the</span> <span class='ignore'>target</span> <span class='ignore'>but</span> <span class='exclcmd'>\\</span> <span class='ignore'>shifted</span> <span class='ignore'>out</span> <span class='ignore'>of</span> <span class='ignore'>the</span> <span class='ignore'>target</span> <span class='exclcmd'>\\</span> <span class='ignore'>chromatic</span> <span class='ignore'>region</span> <span class='ignore'>by</span> <span class='ignore'>WOBO</span><span class='ignore'>.</span> <span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><span class='exclcmd'>\\</span><span class='exclcmd'>\hline</span> <span class='comment'>% &amp; Wrong Color &amp; Unreliable Luminosity</span><br>
<span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span>&nbsp; <span class='ignore'>&amp;</span> <span class='exclenv'>\begin</span><span class='exclenv'>{tabular}</span><span class='ignore'>{</span><span class='ignore'>l</span><span class='ignore'>}</span> <span class='ignore'>Probably</span> <span class='ignore'>the</span> <span class='ignore'>target</span> <span class='ignore'>but</span> <span class='ignore'>possibly</span> <span class='exclcmd'>\\</span> <span class='ignore'>shifted</span> <span class='ignore'>into</span> <span class='ignore'>the</span> <span class='ignore'>target</span> <span class='ignore'>chromatic</span> <span class='exclcmd'>\\</span> <span class='ignore'>region</span> <span class='ignore'>by</span> <span class='ignore'>WOBO</span> <span class='exclenv'>\end</span><span class='exclenv'>{tabular}</span><span class='exclcmd'>\\</span><span class='exclcmd'>\hline</span> <span class='comment'>% &amp;&nbsp;  Right Color &amp;&nbsp; &nbsp; Reliable Luminosity</span><br>
<span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>0</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span> <span class='ignore'>&amp;</span> <span class='ignore'>1</span>&nbsp; <span class='ignore'>&amp;</span> <span class='ignore'>Definitely</span> <span class='ignore'>the</span> <span class='ignore'>target</span> <span class='exclcmd'>\\</span><span class='exclcmd'>\hline</span> <span class='comment'>% &amp;&nbsp;  Right Color &amp; Unreliable Luminosity</span><br>
<span class='envir'>\end</span><span class='envir'>{tabular}</span><br>
<span class='envir'>\end</span><span class='envir'>{center}</span><br>
<br>
<br>
<span class='word'>This</span> <span class='word'>produces</span> <span class='word'>a</span> <span class='word'>2-bit</span> <span class='word'>image</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>2BitImage</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>this</span> <span class='word'>purpose</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>2-bit</span> <span class='word'>data</span> <span class='word'>type</span> <span class='word'>was</span> <span class='word'>added</span> <span class='word'>to</span> <span class='word'>OpenCV</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>question</span> <span class='word'>then</span> <span class='word'>is</span> <span class='word'>how</span> <span class='word'>to</span> <span class='word'>use</span> <span class='word'>it</span><span class='ignore'>.</span> <span class='word'>Essentially</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>four</span> <span class='word'>different</span> <span class='word'>states</span><span class='ignore'>:</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>neither</span> <span class='word'>the</span> <span class='word'>right</span> <span class='word'>color</span> <span class='word'>nor</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>right</span> <span class='word'>region</span><span class='ignore'>;</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>possibly</span> <span class='word'>the</span> <span class='word'>right</span> <span class='word'>color</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>because</span> <span class='word'>they're</span> <span class='word'>outside</span> <span class='word'>the</span> <span class='word'>valid</span> <span class='word'>region</span><span class='ignore'>,</span> <span class='word'>they've</span> <span class='word'>potentially</span> <span class='word'>suffered</span> <span class='word'>from</span> <span class='word'>white-out</span> <span class='word'>and</span> <span class='word'>black-out</span><span class='ignore'>;</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>right</span> <span class='word'>region</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>the</span> <span class='word'>wrong</span> <span class='word'>color</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>we</span> <span class='word'>are</span> <span class='word'>certain</span> <span class='word'>that</span> <span class='word'>they</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>skin</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='word'>finally</span><span class='ignore'>,</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>valid</span> <span class='word'>region</span> <span class='word'>and</span> <span class='word'>are</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>right</span> <span class='word'>color</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>subsections</span> <span class='word'>we</span> <span class='word'>will</span> <span class='word'>present</span> <span class='word'>some</span> <span class='word'>useful</span> <span class='word'>methods</span> <span class='word'>which</span> <span class='word'>take</span> <span class='word'>advantage</span> <span class='word'>of</span> <span class='word'>this</span> <span class='word'>quaternary</span> <span class='word'>classified</span> <span class='word'>image</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='cmd'>\chapter</span><span class='ignore'>{</span><span class='hword'>Shape</span> <span class='hword'>Fitting</span> <span class='hword'>Methods</span><span class='ignore'>}</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='ignore'>`</span><span class='hword'>Hurdle</span><span class='ignore'>'</span> <span class='hword'>Method</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>HurdleMethod</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>Hurdle</span> <span class='word'>method</span> <span class='word'>is</span> <span class='word'>an</span> <span class='word'>algorithm</span> <span class='word'>for</span> <span class='word'>finding</span> <span class='word'>a</span> <span class='word'>path</span> <span class='word'>inside</span> <span class='word'>an</span> <span class='word'>object</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>quaternary</span> <span class='word'>classified</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>Hurdle</span> <span class='word'>method</span> <span class='word'>follows</span> <span class='word'>straight</span> <span class='word'>line</span> <span class='word'>paths</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>object</span><span class='ignore'>.</span> <span class='word'>As</span> <span class='word'>written</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>is</span> <span class='word'>flexible</span> <span class='word'>enough</span> <span class='word'>to</span> <span class='word'>follow</span> <span class='word'>any</span> <span class='word'>straight</span> <span class='word'>line</span><span class='ignore'>,</span> <span class='word'>however</span> <span class='word'>the</span> <span class='word'>current</span> <span class='word'>implementation</span> <span class='word'>takes</span> <span class='word'>a</span> <span class='word'>direction</span> <span class='word'>vector</span> <span class='word'>and</span> <span class='word'>evaluates</span> <span class='word'>at</span> <span class='word'>multiples</span> <span class='word'>of</span> <span class='word'>that</span> <span class='word'>direction</span> <span class='word'>vector</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>means</span> <span class='word'>that</span> <span class='word'>non-horizontal</span> <span class='word'>and</span> <span class='word'>non-vertical</span> <span class='word'>lines</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>guaranteed</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>continuous</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>are</span> <span class='word'>not</span> <span class='word'>found</span> <span class='word'>using</span> <span class='word'>Bresenham's</span> <span class='word'>line</span> <span class='word'>algorithm</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>has</span> <span class='word'>two</span> <span class='word'>thresholds</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>a</span> <span class='word'>high</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>low</span> <span class='word'>threshold</span><span class='ignore'>.</span> <span class='word'>Whilst</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>remain</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>high</span> <span class='word'>threshold</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>end</span> <span class='word'>point</span> <span class='word'>variable</span> <span class='word'>is</span> <span class='word'>updated</span><span class='ignore'>;</span> <span class='word'>when</span> <span class='word'>the</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>are</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>lower</span> <span class='word'>threshold</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>continues</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>path</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>without</span> <span class='word'>updating</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>end</span> <span class='word'>point</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>allows</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>to</span> <span class='word'>pass</span> <span class='word'>through</span> <span class='word'>artifacts</span> <span class='ignore'>(</span><span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>pixel</span> <span class='word'>values</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>inside</span> <span class='word'>the</span> <span class='word'>object</span> <span class='word'>but</span> <span class='word'>which</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>misclassified</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>does</span> <span class='word'>not</span> <span class='word'>allow</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>to</span> <span class='word'>extend</span> <span class='word'>outside</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>object</span> <span class='word'>into</span> <span class='word'>regions</span> <span class='word'>which</span> <span class='word'>are</span><span class='ignore'>,</span> <span class='word'>for</span> <span class='word'>instance</span><span class='ignore'>,</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>shadow</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>object</span><span class='ignore'>.</span><br>
 <br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='ignore'>`</span><span class='hword'>Filament</span> <span class='hword'>Fill</span><span class='ignore'>'</span> <span class='hword'>Method</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>FilamentFill</span><span class='ignore'>}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>FillamentFill.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>The</span> <span class='ignore'>'</span><span class='oword'>Filament</span> <span class='oword'>Fill</span><span class='ignore'>'</span> <span class='oword'>Method</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>FillamentFill</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='word'>The</span> <span class='word'>Filament</span> <span class='word'>Fill</span> <span class='word'>method</span> <span class='word'>takes</span> <span class='word'>a</span> <span class='word'>path</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>given</span> <span class='word'>as</span> <span class='word'>a</span> <span class='word'>sequence</span> <span class='word'>of</span> <span class='word'>points</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>within</span> <span class='word'>an</span> <span class='word'>object</span> <span class='word'>and</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>object</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>Hurdle</span> <span class='word'>method</span> <span class='word'>running</span> <span class='word'>away</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>path</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>object</span><span class='ignore'>.</span> <span class='word'>Assuming</span> <span class='word'>a</span> <span class='word'>horizontally-oriented</span> <span class='word'>object</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>path's</span> <span class='word'>extent</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>horizontal</span> <span class='word'>direction</span> <span class='word'>is</span> <span class='word'>divided</span> <span class='word'>equally</span> <span class='word'>into</span> <span class='word'>points</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>these</span> <span class='word'>points</span> <span class='word'>are</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>start</span> <span class='word'>the</span> <span class='word'>Hurdle</span> <span class='word'>method</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>vertical</span> <span class='word'>directions</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>vice</span> <span class='word'>versa</span> <span class='word'>for</span> <span class='word'>vertical-oriented</span> <span class='word'>objects</span><span class='ignore'>.</span><br>
<br>
<br>
<br>
<span class='word'>For</span> <span class='word'>the</span> <span class='word'>purposes</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>shape</span> <span class='word'>detection</span> <span class='word'>algorithms</span><span class='ignore'>,</span> <span class='word'>there</span> <span class='word'>are</span> <span class='word'>metrics</span> <span class='word'>that</span> <span class='word'>are</span> <span class='word'>applied</span> <span class='word'>which</span> <span class='word'>suffer</span> <span class='word'>from</span> <span class='word'>noise</span> <span class='word'>and</span> <span class='word'>anomalies</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>noise</span> <span class='word'>is</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>natural</span> <span class='word'>variability</span> <span class='word'>of</span> <span class='word'>human</span> <span class='word'>digits</span> <span class='word'>from</span> <span class='word'>regular</span> <span class='word'>geometric</span> <span class='word'>forms</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>anomalies</span> <span class='word'>are</span> <span class='word'>due</span> <span class='word'>to</span> <span class='word'>misdetections</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>edges</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>digit</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>assume</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>anomalous</span> <span class='word'>results</span> <span class='word'>are</span> <span class='word'>extreme</span> <span class='word'>values</span><span class='ignore'>,</span> <span class='word'>however</span> <span class='word'>we</span> <span class='word'>acknowledge</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>most</span> <span class='word'>common</span> <span class='ignore'>(</span><span class='word'>mode</span><span class='ignore'>)</span> <span class='word'>or</span> <span class='word'>middle</span> <span class='ignore'>(</span><span class='word'>median</span><span class='ignore'>)</span> <span class='word'>values</span> <span class='word'>may</span> <span class='word'>not</span> <span class='word'>be</span> <span class='word'>representative</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>best</span> <span class='word'>geometric</span> <span class='word'>approximation</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>shape</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>Mean-Median</span> <span class='word'>method</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>similar</span> <span class='word'>to</span> <span class='word'>the</span> <span class='ignore'>"</span><span class='word'>k-Nearest</span> <span class='word'>Neighbors</span><span class='ignore'>"</span> <span class='word'>algorithm</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>solves</span> <span class='word'>this</span> <span class='word'>problem</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>a</span> <span class='word'>confidence</span> <span class='word'>interval</span> <span class='word'>around</span> <span class='word'>the</span> <span class='word'>median</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>mean</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>within</span> <span class='word'>this</span> <span class='word'>interval</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>method</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>useful</span> <span class='word'>adaptation</span> <span class='word'>of</span> <span class='word'>methods</span> <span class='word'>like</span> <span class='word'>the</span> <span class='word'>k-Nearest</span> <span class='word'>Neighbors</span> <span class='word'>in</span> <span class='word'>that</span> <span class='word'>it</span> <span class='word'>solves</span> <span class='word'>the</span> <span class='word'>outlier</span> <span class='word'>problem</span> <span class='word'>for</span> <span class='word'>this</span> <span class='word'>particular</span> <span class='word'>application</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='ignore'>`</span><span class='hword'>Kink</span> <span class='hword'>Fit</span><span class='ignore'>'</span> <span class='hword'>Method</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>KinkFitMethod</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>Kink</span> <span class='word'>Fit</span> <span class='word'>algorithm</span> <span class='word'>takes</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>2D</span> <span class='word'>points</span><span class='ignore'>,</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>component</span> <span class='word'>is</span> <span class='word'>taken</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>the</span> <span class='word'>independent</span> <span class='word'>variable</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>component</span> <span class='word'>is</span> <span class='word'>taken</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>the</span> <span class='word'>dependent</span> <span class='word'>variable</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>assumption</span> <span class='word'>excludes</span> <span class='word'>the</span> <span class='word'>possibility</span> <span class='word'>of</span> <span class='word'>truly</span> <span class='word'>vertical</span> <span class='word'>lines</span> <span class='word'>being</span> <span class='word'>presented</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>algorithm</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>Kink</span> <span class='word'>Fit</span> <span class='word'>algorithm</span> <span class='word'>fits</span> <span class='word'>a</span> <span class='word'>function</span> <span class='word'>which</span> <span class='word'>consists</span> <span class='word'>of</span> <span class='word'>two</span> <span class='word'>straight-line</span> <span class='word'>segments</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>points</span><span class='ignore'>.</span> <span class='word'>Unfortunately</span><span class='ignore'>,</span> <span class='word'>currently</span> <span class='word'>the</span> <span class='word'>only</span> <span class='word'>piecewise</span> <span class='word'>linear</span> <span class='word'>fitting</span> <span class='word'>function</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>proprietary</span> <span class='word'>MARS</span> <span class='word'>algorithm</span> <span class='word'>which</span><span class='ignore'>,</span> <span class='word'>aside</span> <span class='word'>from</span> <span class='word'>being</span> <span class='word'>commercial</span><span class='ignore'>,</span> <span class='word'>is</span> <span class='word'>overkill</span> <span class='word'>for</span> <span class='word'>this</span> <span class='word'>particular</span> <span class='word'>problem</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>has</span> <span class='word'>a</span> <span class='word'>small</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>well-aligned</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>The</span> <span class='word'>Kink</span> <span class='word'>Fit</span> <span class='word'>algorithm</span> <span class='word'>relies</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>fact</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>know</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>are</span> <span class='word'>in</span> <span class='word'>order</span><span class='ignore'>;</span> <span class='word'>it</span> <span class='word'>chooses</span> <span class='word'>a</span> <span class='word'>point</span> <span class='word'>and</span> <span class='word'>divides</span> <span class='word'>the</span> <span class='word'>set</span> <span class='word'>in</span> <span class='word'>two</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>performs</span> <span class='word'>a</span> <span class='word'>standard</span><span class='ignore'>,</span> <span class='word'>least</span> <span class='word'>squares</span> <span class='word'>linear</span> <span class='word'>fit</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>sets</span><span class='ignore'>.</span> <span class='word'>Both</span> <span class='word'>sets</span> <span class='word'>include</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>at</span> <span class='word'>which</span> <span class='word'>the</span> <span class='word'>set</span> <span class='word'>is</span> <span class='word'>divided</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>The</span> <span class='word'>fit</span> <span class='word'>is</span> <span class='word'>also</span> <span class='word'>assumed</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>continuous</span><span class='ignore'>,</span> <span class='word'>except</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>derivative</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>as</span> <span class='word'>described</span> <span class='word'>above</span> <span class='word'>may</span> <span class='word'>produce</span> <span class='word'>two</span> <span class='word'>lines</span> <span class='word'>which</span> <span class='word'>do</span> <span class='word'>not</span> <span class='word'>intersect</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>second-to-last</span> <span class='word'>data</span> <span class='word'>point</span> <span class='word'>used</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>line</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>data</span> <span class='word'>point</span> <span class='word'>used</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>line</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>needs</span> <span class='word'>to</span> <span class='word'>ensure</span> <span class='word'>that</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>case</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>achieved</span> <span class='word'>by</span> <span class='word'>shifting</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>half</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>set</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>end</span> <span class='word'>point</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>linear</span> <span class='word'>fit</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>half</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>set</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>point</span> <span class='word'>at</span> <span class='word'>which</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>linear</span> <span class='word'>fits</span> <span class='word'>intersect</span> <span class='word'>is</span> <span class='word'>found</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>if</span> <span class='word'>that</span> <span class='word'>point</span> <span class='word'>is</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>second-to-last</span> <span class='word'>point</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>set</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>second</span> <span class='word'>point</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>second</span> <span class='word'>set</span> <span class='ignore'>(</span><span class='word'>i.e</span><span class='ignore'>.</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>either</span> <span class='word'>side</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>of</span> <span class='word'>division</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>fit</span> <span class='word'>is</span> <span class='word'>considered</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>acceptable</span><span class='ignore'>.</span> <span class='word'>If</span> <span class='word'>the</span> <span class='word'>fit</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>acceptable</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>indicates</span> <span class='word'>that</span> <span class='word'>there's</span> <span class='word'>a</span> <span class='word'>discontinuity</span> <span class='word'>in</span> <span class='word'>position</span> <span class='word'>rather</span> <span class='word'>than</span> <span class='word'>simply</span> <span class='word'>being</span> <span class='word'>a</span> <span class='word'>discontinuity</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>derivative</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>handled</span> <span class='word'>by</span> <span class='word'>choosing</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>fit</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>set</span> <span class='word'>closest</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>intersection</span> <span class='word'>within</span> <span class='word'>the</span> <span class='word'>bounds</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>either</span> <span class='word'>side</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>of</span> <span class='word'>division</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>linear</span> <span class='word'>fit</span> <span class='word'>is</span> <span class='word'>then</span> <span class='word'>performed</span> <span class='word'>with</span> <span class='word'>only</span> <span class='word'>the</span> <span class='word'>gradient</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>free</span> <span class='word'>parameter</span><span class='ignore'>,</span> <span class='word'>guaranteeing</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>line</span> <span class='word'>will</span> <span class='word'>have</span> <span class='word'>passed</span> <span class='word'>through</span> <span class='word'>this</span> <span class='word'>limiting</span> <span class='word'>point</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>then</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>residuals</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>square</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>residuals</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>considered</span> <span class='word'>the</span> <span class='word'>score</span> <span class='word'>for</span> <span class='word'>dividing</span> <span class='word'>the</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>at</span> <span class='word'>that</span> <span class='word'>position</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>finds</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>which</span> <span class='word'>minimizes</span> <span class='word'>the</span> <span class='word'>score</span> <span class='word'>using</span> <span class='word'>a</span> <span class='word'>bisecting</span> <span class='word'>algorithm</span><span class='ignore'>;</span> <span class='word'>if</span> <span class='word'>a</span> <span class='word'>linear</span> <span class='word'>fit</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>data</span> <span class='word'>has</span> <span class='word'>a</span> <span class='word'>low</span> <span class='word'>score</span><span class='ignore'>,</span> <span class='word'>then</span> <span class='word'>the</span> <span class='word'>Kink</span> <span class='word'>Fit</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>considered</span> <span class='word'>unnecessary</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>is</span> <span class='word'>assumed</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>relaxed</span><span class='ignore'>,</span> <span class='word'>straight</span><span class='ignore'>,</span> <span class='word'>neutral</span> <span class='word'>pose</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>algorithm</span> <span class='word'>specifies</span> <span class='word'>a</span> <span class='word'>minimum</span> <span class='word'>number</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>included</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>set</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>this</span> <span class='word'>avoids</span> <span class='word'>the</span> <span class='word'>problem</span> <span class='word'>of</span> <span class='word'>dividing</span> <span class='word'>into</span> <span class='word'>sets</span> <span class='word'>which</span> <span class='word'>contain</span> <span class='word'>only</span> <span class='word'>one</span> <span class='word'>point</span><span class='ignore'>.</span><br>
<br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.92\textwidth]{Chapter4/Figs/KinkFit_A.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{KinkFitA}\label{fig:KinkFitA}</span><br>
<span class='comment'>%\end{figure}</span><br>
<br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.95\textwidth]{Chapter4/Figs/KinkFit_B.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{KinkFitB}\label{fig:KinkFitB}</span><br>
<span class='comment'>%\end{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.88\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>KinkFit</span><span class='ignore'>_</span><span class='ignore'>C.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Example</span> <span class='oword'>A</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>KinkFit</span> <span class='oword'>algorithm</span> <span class='oword'>in</span> <span class='oword'>action</span><span class='ignore'>,</span> <span class='oword'>showcasing</span> <span class='oword'>its</span> <span class='oword'>reliability</span> <span class='oword'>over</span> <span class='oword'>several</span> <span class='oword'>iterations</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>KinkFitC</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.85\textwidth]{Chapter4/Figs/KinkFit_D.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{KinkFitD}\label{fig:KinkFitD}</span><br>
<span class='comment'>%\end{figure}</span><br>
<br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.80\textwidth]{Chapter4/Figs/KinkFit_E.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{KinkFitE}\label{fig:KinkFitE}</span><br>
<span class='comment'>%\end{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>KinkFit</span><span class='ignore'>_</span><span class='ignore'>F.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Example</span> <span class='oword'>B</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>KinkFit</span> <span class='oword'>algorithm</span> <span class='oword'>in</span> <span class='oword'>action</span><span class='ignore'>,</span> <span class='oword'>showcasing</span> <span class='oword'>its</span> <span class='oword'>reliability</span> <span class='oword'>over</span> <span class='oword'>several</span> <span class='oword'>iterations</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>KinkFitF</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.95\textwidth]{Chapter4/Figs/KinkFit_G.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{KinkFitG}\label{fig:KinkFitG}</span><br>
<span class='comment'>%\end{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>KinkFit</span><span class='ignore'>_</span><span class='ignore'>H.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Example</span> <span class='oword'>C</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>KinkFit</span> <span class='oword'>algorithm</span> <span class='oword'>in</span> <span class='oword'>action</span><span class='ignore'>,</span> <span class='oword'>showcasing</span> <span class='oword'>its</span> <span class='oword'>reliability</span> <span class='oword'>over</span> <span class='oword'>several</span> <span class='oword'>iterations</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>KinkFitH</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.95\textwidth]{Chapter4/Figs/KinkFit_I.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{KinkFitI}\label{fig:KinkFitI}</span><br>
<span class='comment'>%\end{figure}</span><br>
<br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.95\textwidth]{Chapter4/Figs/KinkFit_J.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{KinkFitJ}\label{fig:KinkFitJ}</span><br>
<span class='comment'>%\end{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>KinkFit</span><span class='ignore'>_</span><span class='ignore'>K.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Example</span> <span class='oword'>D</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>KinkFit</span> <span class='oword'>algorithm</span> <span class='oword'>in</span> <span class='oword'>action</span><span class='ignore'>,</span> <span class='oword'>showcasing</span> <span class='oword'>its</span> <span class='oword'>reliability</span> <span class='oword'>over</span> <span class='oword'>several</span> <span class='oword'>iterations</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>KinkFitK</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp;  \includegraphics[width=0.95\textwidth]{Chapter4/Figs/ICWaS1.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{ICWaS1}\label{fig:ICWaS1}</span><br>
<span class='comment'>%\end{figure}</span><br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.95\textwidth]{Chapter4/Figs/ICWaS2.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{ICWaS2}\label{fig:ICWaS2}</span><br>
<span class='comment'>%\end{figure}</span><br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.95\textwidth]{Chapter4/Figs/ICWaS3.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{ICWaS3}\label{fig:ICWaS3}</span><br>
<span class='comment'>%\end{figure}</span><br>
<span class='comment'>%\begin{figure}[h!]</span><br>
<span class='comment'>%&nbsp; \centering</span><br>
<span class='comment'>%&nbsp; &nbsp; \includegraphics[width=0.95\textwidth]{Chapter4/Figs/ICWaS4.jpg}</span><br>
<span class='comment'>%&nbsp; &nbsp; \caption{ICWaS4}\label{fig:ICWaS4}</span><br>
<span class='comment'>%\end{figure}</span><br>
<br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='ignore'>`</span><span class='hword'>Elliptical</span> <span class='hword'>Fit</span><span class='ignore'>'</span> <span class='hword'>Method</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>EllipticalFitMethod</span><span class='ignore'>}</span><br>
<span class='word'>Fitting</span> <span class='word'>an</span> <span class='word'>ellipse</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>is</span> <span class='word'>surprisingly</span> <span class='word'>difficult</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>reason</span> <span class='word'>for</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>outlined</span> <span class='word'>below</span><span class='ignore'>.</span><br>
<br>
<span class='word'>To</span> <span class='word'>follow</span> <span class='word'>the</span> <span class='word'>standard</span> <span class='word'>linear</span> <span class='word'>algebra</span> <span class='word'>approach</span> <span class='word'>to</span> <span class='word'>least</span> <span class='word'>squares</span> <span class='word'>fitting</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>need</span> <span class='word'>to</span> <span class='word'>decide</span> <span class='word'>upon</span> <span class='word'>a</span> <span class='word'>functional</span> <span class='word'>form</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>fit</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>thereby</span> <span class='word'>a</span> <span class='word'>basis</span> <span class='word'>set</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>an</span> <span class='word'>ellipse</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>basis</span> <span class='word'>set</span> <span class='word'>is</span> <span class='mathgroup'>$</span><span class='math'>\chi</span><span class='math'>=</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='math'>x</span><span class='math'>^</span><span class='math'>2</span><span class='math'>,</span> <span class='math'>x</span> <span class='math'>y</span><span class='math'>,</span> <span class='math'>y</span><span class='math'>^</span><span class='math'>2</span><span class='math'>,</span> <span class='math'>x</span><span class='math'>,</span> <span class='math'>y</span><span class='math'>,</span> <span class='math'>1</span><span class='mathcmd'>\right</span><span class='math'>)</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>six</span> <span class='word'>free</span> <span class='word'>coefficients</span> <span class='mathgroup'>$</span> <span class='math'>A</span><span class='math'>^</span><span class='math'>T</span><span class='math'>=</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>A</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>xx</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>,</span><span class='math'>A</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>xy</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>,</span><span class='math'>A</span><span class='math'>_</span><span class='ignore'>{</span><span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>yy</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='math'>,</span><span class='math'>A</span><span class='math'>_</span><span class='math'>x</span><span class='math'>,</span><span class='math'>A</span><span class='math'>_</span><span class='math'>y</span><span class='math'>,</span><span class='math'>A</span><span class='math'>_</span><span class='math'>0</span><span class='mathcmd'>\right</span><span class='math'>\}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>to</span> <span class='word'>specify</span> <span class='word'>an</span> <span class='word'>ellipse</span><span class='ignore'>,</span> <span class='word'>all</span> <span class='word'>that</span> <span class='word'>is</span> <span class='word'>needed</span> <span class='word'>is</span> <span class='word'>five</span> <span class='word'>numbers</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>major</span> <span class='word'>and</span> <span class='word'>minor</span> <span class='word'>axes</span> <span class='word'>lengths</span> <span class='mathgroup'>$</span><span class='math'>(</span><span class='math'>a</span><span class='math'>,</span><span class='math'>b</span><span class='math'>)</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>position</span> <span class='mathgroup'>$</span><span class='math'>(</span><span class='math'>x</span><span class='math'>_</span><span class='math'>0</span><span class='math'>,</span><span class='math'>y</span><span class='math'>_</span><span class='math'>0</span><span class='math'>)</span><span class='mathgroup'>$</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>orientation</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>basis</span> <span class='word'>set</span> <span class='word'>includes</span> <span class='word'>lines</span><span class='ignore'>,</span> <span class='word'>quadratics</span><span class='ignore'>,</span> <span class='word'>parabolic</span> <span class='word'>and</span> <span class='word'>hyperbolic</span> <span class='word'>functions</span> <span class='word'>as</span> <span class='word'>well</span> <span class='word'>as</span> <span class='word'>elliptical</span> <span class='word'>functions</span> <span class='word'>as</span> <span class='word'>possible</span> <span class='word'>fits</span><span class='ignore'>.</span> <span class='word'>An</span> <span class='word'>additional</span> <span class='word'>difficulty</span> <span class='word'>arises</span> <span class='word'>when</span> <span class='word'>we</span> <span class='word'>try</span> <span class='word'>to</span> <span class='word'>construct</span> <span class='word'>a</span> <span class='word'>cost</span> <span class='word'>function</span> <span class='word'>for</span> <span class='word'>an</span> <span class='word'>ellipse</span><span class='ignore'>.</span> <span class='word'>Ideally</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>wish</span> <span class='word'>to</span> <span class='word'>minimize</span> <span class='word'>the</span> <span class='word'>perpendicular</span> <span class='word'>distances</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>ellipse</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>the</span> <span class='word'>calculation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>distance</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>point</span> <span class='word'>from</span> <span class='word'>an</span> <span class='word'>ellipse</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>straightforward</span><span class='ignore'>,</span> <span class='word'>requiring</span> <span class='word'>the</span> <span class='word'>roots</span> <span class='word'>of</span> <span class='word'>a</span> <span class='word'>fourth</span> <span class='word'>degree</span> <span class='word'>polynomial</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>found</span><span class='ignore'>.</span> <span class='word'>Due</span> <span class='word'>to</span> <span class='word'>these</span> <span class='word'>complexities</span><span class='ignore'>,</span> <span class='word'>several</span> <span class='word'>different</span> <span class='word'>methods</span> <span class='word'>have</span> <span class='word'>been</span> <span class='word'>proposed</span> <span class='word'>by</span> <span class='word'>different</span> <span class='word'>authors</span><span class='ignore'>,</span> <span class='word'>but</span> <span class='word'>we</span> <span class='word'>will</span> <span class='word'>be</span> <span class='word'>focusing</span> <span class='word'>on</span> <span class='word'>two</span> <span class='word'>methods</span><span class='ignore'>:</span> <span class='word'>The</span> <span class='word'>Approximate</span> <span class='word'>Mean</span> <span class='word'>Square</span> <span class='ignore'>(</span><span class='word'>AMS</span><span class='ignore'>)</span>&nbsp; <span class='word'>proposed</span> <span class='word'>by</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Taubin1991</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>Direct</span> <span class='word'>least</span> <span class='word'>square</span> <span class='ignore'>(</span><span class='word'>Direct</span><span class='ignore'>)</span> <span class='word'>method</span> <span class='word'>by</span> <span class='ignore'>(</span><span class='cmd'>\cite</span><span class='ignore'>{</span><span class='ignore'>Fitzgibbon1999</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='word'>For</span> <span class='word'>the</span> <span class='word'>fingertip</span> <span class='word'>problem</span><span class='ignore'>,</span> <span class='word'>there</span> <span class='word'>is</span> <span class='word'>also</span> <span class='word'>the</span> <span class='word'>added</span> <span class='word'>difficulty</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>are</span> <span class='word'>confined</span> <span class='word'>to</span> <span class='word'>one</span> <span class='word'>side</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>ellipse</span> <span class='word'>so</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>chosen</span> <span class='word'>methods</span> <span class='word'>which</span> <span class='word'>cope</span> <span class='word'>well</span> <span class='word'>with</span> <span class='word'>partially</span> <span class='word'>occluded</span> <span class='word'>ellipses</span><span class='ignore'>.</span> <span class='word'>Both</span> <span class='word'>methods</span> <span class='word'>begin</span> <span class='word'>by</span> <span class='word'>forming</span> <span class='word'>the</span> <span class='word'>design</span> <span class='word'>matrix</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>applying</span> <span class='word'>an</span> <span class='word'>additional</span> <span class='word'>constraint</span> <span class='word'>which</span> <span class='word'>restricts</span> <span class='word'>the</span> <span class='word'>fit</span> <span class='word'>to</span> <span class='word'>a</span> <span class='word'>family</span> <span class='word'>of</span> <span class='word'>curves</span><span class='ignore'>.</span> <span class='word'>Both</span> <span class='word'>methods</span> <span class='word'>are</span> <span class='word'>formulated</span> <span class='word'>as</span> <span class='word'>generalized</span> <span class='word'>eigenvalue</span> <span class='word'>problems</span><span class='ignore'>,</span> <span class='word'>avoiding</span> <span class='word'>the</span> <span class='word'>need</span> <span class='word'>for</span> <span class='word'>iterative</span> <span class='word'>methods</span><span class='ignore'>.</span><br>
<br>
<span class='word'>The</span> <span class='word'>AMS</span> <span class='word'>method</span> <span class='word'>restricts</span> <span class='word'>the</span> <span class='word'>fit</span> <span class='word'>to</span> <span class='word'>parabolic</span><span class='ignore'>,</span> <span class='word'>hyperbolic</span> <span class='word'>and</span> <span class='word'>elliptical</span> <span class='word'>curves</span> <span class='word'>by</span> <span class='word'>imposing</span> <span class='word'>the</span> <span class='word'>condition</span> <span class='word'>that</span> <span class='mathgroup'>$</span> <span class='math'>A</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>(</span> <span class='math'>D</span><span class='math'>_</span><span class='math'>x</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span><span class='math'>_</span><span class='math'>x</span>&nbsp; <span class='math'>+</span>&nbsp;  <span class='math'>D</span><span class='math'>_</span><span class='math'>y</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span><span class='math'>_</span><span class='math'>y</span><span class='math'>)</span> <span class='math'>A</span> <span class='math'>=</span> <span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>matrices</span> <span class='mathgroup'>$</span><span class='math'>Dx</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='math'>Dy</span><span class='mathgroup'>$</span> <span class='word'>are</span> <span class='word'>the</span> <span class='word'>partial</span> <span class='word'>derivatives</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>design</span> <span class='word'>matrix</span> <span class='mathgroup'>$</span><span class='math'>D</span><span class='mathgroup'>$</span> <span class='word'>with</span> <span class='word'>respect</span> <span class='word'>to</span> <span class='word'>x</span> <span class='word'>and</span> <span class='word'>y</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>matrices</span> <span class='word'>are</span> <span class='word'>formed</span> <span class='word'>row</span> <span class='word'>by</span> <span class='word'>row</span> <span class='word'>applying</span> <span class='word'>the</span> <span class='word'>following</span> <span class='word'>to</span> <span class='word'>each</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>set</span><span class='ignore'>:</span><br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='math'>D</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>:</span><span class='math'>)</span><span class='math'>&amp;</span><span class='math'>=</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>x</span><span class='math'>_</span><span class='math'>i</span><span class='math'>^</span><span class='math'>2</span><span class='math'>,</span> <span class='math'>x</span><span class='math'>_</span><span class='math'>i</span> <span class='math'>y</span><span class='math'>_</span><span class='math'>i</span><span class='math'>,</span> <span class='math'>y</span><span class='math'>_</span><span class='math'>i</span><span class='math'>^</span><span class='math'>2</span><span class='math'>,</span> <span class='math'>x</span><span class='math'>_</span><span class='math'>i</span><span class='math'>,</span> <span class='math'>y</span><span class='math'>_</span><span class='math'>i</span><span class='math'>,</span> <span class='math'>1</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='math'>&amp;</span><br>
<span class='math'>D</span><span class='math'>_</span><span class='math'>x</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>:</span><span class='math'>)</span><span class='math'>&amp;</span><span class='math'>=</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>2</span> <span class='math'>x</span><span class='math'>_</span><span class='math'>i</span><span class='math'>,</span><span class='math'>y</span><span class='math'>_</span><span class='math'>i</span><span class='math'>,</span><span class='math'>0</span><span class='math'>,</span><span class='math'>1</span><span class='math'>,</span><span class='math'>0</span><span class='math'>,</span><span class='math'>0</span><span class='mathcmd'>\right</span><span class='math'>\}</span> <span class='math'>&amp;</span><br>
<span class='math'>D</span><span class='math'>_</span><span class='math'>y</span><span class='math'>(</span><span class='math'>i</span><span class='math'>,</span><span class='math'>:</span><span class='math'>)</span><span class='math'>&amp;</span><span class='math'>=</span><span class='mathcmd'>\left</span><span class='math'>\{</span><span class='math'>0</span><span class='math'>,</span><span class='math'>x</span><span class='math'>_</span><span class='math'>i</span><span class='math'>,</span><span class='math'>2</span> <span class='math'>y</span><span class='math'>_</span><span class='math'>i</span><span class='math'>,</span><span class='math'>0</span><span class='math'>,</span><span class='math'>1</span><span class='math'>,</span><span class='math'>0</span><span class='mathcmd'>\right</span><span class='math'>\}</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<span class='word'>The</span> <span class='word'>AMS</span> <span class='word'>method</span> <span class='word'>minimizes</span> <span class='word'>the</span> <span class='word'>cost</span> <span class='word'>function</span><br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
<span class='math'>\epsilon </span><span class='math'>^</span><span class='math'>2</span><span class='math'>=</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span> <span class='math'>A</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span> <span class='math'>A</span> <span class='ignore'>}</span><span class='ignore'>{</span> <span class='math'>A</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>(</span><span class='math'>D</span><span class='math'>_</span><span class='math'>x</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span><span class='math'>_</span><span class='math'>x</span> <span class='math'>+</span>&nbsp; <span class='math'>D</span><span class='math'>_</span><span class='math'>y</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span><span class='math'>_</span><span class='math'>y</span><span class='math'>)</span> <span class='math'>A</span><span class='math'>^</span><span class='math'>T</span> <span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>minimum</span> <span class='word'>cost</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>solving</span> <span class='word'>the</span> <span class='word'>generalized</span> <span class='word'>eigenvalue</span> <span class='word'>problem</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
 <span class='math'>D</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span> <span class='math'>A</span> <span class='math'>=</span> <span class='mathcmd'>\lambda</span>  <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>D</span><span class='math'>_</span><span class='math'>x</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span><span class='math'>_</span><span class='math'>x</span> <span class='math'>+</span>&nbsp; <span class='math'>D</span><span class='math'>_</span><span class='math'>y</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span><span class='math'>_</span><span class='math'>y</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>A</span> <br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>Direct</span> <span class='word'>method</span> <span class='word'>confines</span> <span class='word'>the</span> <span class='word'>fit</span> <span class='word'>to</span> <span class='word'>ellipses</span> <span class='word'>by</span> <span class='word'>ensuring</span> <span class='word'>that</span> <span class='mathgroup'>$</span><span class='math'>4</span> <span class='math'>A</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>xx</span><span class='ignore'>}</span> <span class='math'>A</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>yy</span><span class='ignore'>}</span><span class='math'>-</span> <span class='math'>A</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>xy</span><span class='ignore'>}</span><span class='math'>^</span><span class='math'>2</span> <span class='math'>&gt;</span> <span class='math'>0</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>condition</span> <span class='word'>imposed</span> <span class='word'>is</span> <span class='word'>that</span> <span class='mathgroup'>$</span><span class='math'>4</span> <span class='math'>A</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>xx</span><span class='ignore'>}</span> <span class='math'>A</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>yy</span><span class='ignore'>}</span><span class='math'>-</span> <span class='math'>A</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>xy</span><span class='ignore'>}</span><span class='math'>^</span><span class='math'>2</span><span class='math'>=</span><span class='math'>1</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>satisfies</span> <span class='word'>the</span> <span class='word'>inequality</span> <span class='word'>and</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>coefficients</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>arbitrarily</span> <span class='word'>scaled</span> <span class='word'>is</span> <span class='word'>not</span> <span class='word'>overly</span> <span class='word'>restrictive</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
<span class='math'>\epsilon </span><span class='math'>^</span><span class='math'>2</span><span class='math'>=</span> <span class='math'>A</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span> <span class='math'>A</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>with</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='math'>A</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>C</span> <span class='math'>A</span> <span class='math'>=</span><span class='math'>1</span> <span class='mathcmd'>\quad</span> <span class='mathcmd'>\text</span><span class='ignore'>{</span><span class='math'>and</span><span class='ignore'>}</span> <span class='mathcmd'>\quad</span> <span class='math'>C</span><span class='math'>=</span><span class='mathcmd'>\left</span><span class='math'>(</span><span class='exclenv'>\begin</span><span class='exclenv'>{matrix}</span><br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>2</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span>&nbsp; <span class='math'>0</span>&nbsp; <span class='mathcmd'>\\</span> <br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>-</span><span class='math'>1</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span>&nbsp; <span class='math'>0</span> <span class='mathcmd'>\\</span> <br>
 <span class='math'>2</span> <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span>&nbsp; <span class='math'>0</span> <span class='mathcmd'>\\</span> <br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span>&nbsp; <span class='math'>0</span> <span class='mathcmd'>\\</span> <br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span>&nbsp; <span class='math'>0</span> <span class='mathcmd'>\\</span> <br>
 <span class='math'>0</span> <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span> <span class='math'>0</span>&nbsp; <span class='math'>&amp;</span>&nbsp; <span class='math'>0</span> <br>
<span class='exclenv'>\end</span><span class='exclenv'>{matrix}</span><span class='mathcmd'>\right</span><span class='math'>)</span><br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>minimum</span> <span class='word'>cost</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>solving</span> <span class='word'>the</span> <span class='word'>generalized</span> <span class='word'>eigenvalue</span> <span class='word'>problem</span><span class='ignore'>.</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
 <span class='math'>D</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span> <span class='math'>A</span> <span class='math'>=</span> <span class='mathcmd'>\lambda</span>  <span class='mathcmd'>\left</span><span class='math'>(</span> <span class='math'>C</span><span class='mathcmd'>\right</span><span class='math'>)</span> <span class='math'>A</span> <br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<br>
<span class='word'>The</span> <span class='word'>system</span> <span class='word'>produces</span> <span class='word'>only</span> <span class='word'>one</span> <span class='word'>positive</span> <span class='word'>eigenvalue</span> <span class='mathgroup'>$</span> <span class='mathcmd'>\lambda</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>chosen</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>solution</span> <span class='word'>with</span> <span class='word'>its</span> <span class='word'>eigenvector</span> <span class='mathgroup'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>u</span><span class='ignore'>}</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>These</span> <span class='word'>are</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>coefficients</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[p]</span><br>
<span class='exclcmd'>\centering</span><br>
<span class='exclcmd'>\subfloat</span><span class='option'>[Comparison of the AMS and Direct ellipse fit methods for a complete ellipse]</span><span class='option'>[AMS and Direct methods both perform well with a set of points evenly distributed arround the ellipse. ]</span><span class='ignore'>{</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.98\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>EllipticalFitTestFull.jpg</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>EllipseFitTestFull</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\qquad</span><br>
<span class='exclcmd'>\subfloat</span><span class='option'>[The AMS method sometimes produces a hyperbolic fit.]</span><span class='option'>[The AMS method sometimes produces a hyperbolic fit whilst the direct method always produces an ellipse]</span><span class='ignore'>{</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.47\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>EllipticalFitTest</span><span class='ignore'>_</span><span class='ignore'>Hyperbolic.jpg</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>EllipseFitTestHalfHyperbolic</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\quad</span><br>
<span class='exclcmd'>\subfloat</span><span class='option'>[Comparison of the AMS and Direct ellipse fit methods for a half ellipse.]</span><span class='option'>[The AMS method better fits the extreme edge points in the data set resulting in the AMS method producing larger ellipses than the Direct method. The true ellipse is most often between the&nbsp; two.]</span><span class='ignore'>{</span><br>
<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.47\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>EllipticalFitTest</span><span class='ignore'>_</span><span class='ignore'>DTA.jpg</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>EllipseFitTestHalf</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Comparison</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>AMS</span> <span class='oword'>and</span> <span class='oword'>Direct</span> <span class='oword'>ellipse</span> <span class='oword'>fit</span> <span class='oword'>methods</span><span class='ignore'>.</span><span class='ignore'>}</span><br>
<span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>EllipseFitTest</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{equation*}</span><br>
 <span class='math'>A</span> <span class='math'>=</span> <span class='mathcmd'>\sqrt</span><span class='ignore'>{</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>u</span><span class='ignore'>}</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>C</span> <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>u</span><span class='ignore'>}</span><span class='ignore'>}</span><span class='ignore'>}</span>&nbsp; <span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>u</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{equation*}</span><br>
<span class='word'>The</span> <span class='word'>scaling</span> <span class='word'>factor</span> <span class='word'>guarantees</span> <span class='word'>that</span>&nbsp; <span class='mathgroup'>$</span><span class='math'>A</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>C</span> <span class='math'>A</span> <span class='math'>=</span><span class='math'>1</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<br>
<span class='word'>These</span> <span class='word'>methods</span> <span class='word'>were</span> <span class='word'>implemented</span> <span class='word'>in</span> <span class='word'>Mathematica</span> <span class='word'>for</span> <span class='word'>evaluation</span> <span class='word'>and</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>OpenCV</span> <span class='word'>C</span><span class='ignore'>+</span><span class='ignore'>+</span> <span class='word'>code</span><span class='ignore'>.</span> <span class='word'>Testing</span> <span class='word'>routines</span> <span class='word'>generated</span> <span class='word'>sample</span> <span class='word'>data</span> <span class='word'>with</span> <span class='word'>variable</span> <span class='word'>ellipse</span> <span class='word'>occlusion</span> <span class='word'>and</span> <span class='word'>noise</span> <span class='word'>around</span> <span class='word'>a</span> <span class='word'>randomly</span> <span class='word'>generated</span> <span class='word'>ellipse</span> <span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>methods</span> <span class='word'>both</span> <span class='word'>produced</span> <span class='word'>good</span> <span class='word'>fits</span> <span class='word'>to</span> <span class='word'>complete</span> <span class='word'>ellipses</span> <span class='word'>Fig</span><span class='ignore'>.</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>EllipseFitTestFull</span><span class='ignore'>}</span> <span class='word'>and</span> <span class='word'>incomplete</span> <span class='word'>ellipses</span> <span class='word'>Fig</span><span class='ignore'>.</span><span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>EllipseFitTestHalf</span><span class='ignore'>}</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>AMS</span> <span class='word'>method</span> <span class='word'>was</span> <span class='word'>slightly</span> <span class='word'>better</span> <span class='word'>at</span> <span class='word'>fitting</span> <span class='word'>the</span> <span class='word'>extreme</span> <span class='word'>ends</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>ellipse</span><span class='ignore'>,</span> <span class='word'>generally</span> <span class='word'>producing</span> <span class='word'>a</span> <span class='word'>larger</span> <span class='word'>ellipse</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>Direct</span> <span class='word'>method</span><span class='ignore'>.</span> <span class='word'>Both</span> <span class='word'>methods</span> <span class='word'>accurately</span> <span class='word'>obtained</span> <span class='word'>the</span> <span class='word'>position</span> <span class='word'>and</span> <span class='word'>orientation</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>AMS</span> <span class='word'>method</span> <span class='word'>occasionally</span> <span class='word'>produced</span> <span class='word'>a</span> <span class='word'>hyperbolic</span> <span class='word'>fit</span> <span class='word'>for</span> <span class='word'>very</span> <span class='word'>flat</span> <span class='word'>ellipses</span> <span class='word'>Fig</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>EllipseFitTestHalfHyperbolic</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
<br>
<br>
<span class='word'>The</span> <span class='word'>largest</span> <span class='word'>computational</span> <span class='word'>effort</span> <span class='word'>in</span> <span class='word'>both</span> <span class='word'>methods</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>determination</span> <span class='word'>of</span> <span class='word'>the</span> <span class='mathgroup'>$</span><span class='math'>D</span><span class='math'>^</span><span class='math'>T</span> <span class='math'>D</span><span class='mathgroup'>$</span> <span class='word'>matrix</span><span class='ignore'>.</span> <span class='word'>Once</span> <span class='word'>found</span><span class='ignore'>,</span> <span class='word'>however</span><span class='ignore'>,</span> <span class='word'>both</span> <span class='word'>methods</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>at</span> <span class='word'>relatively</span> <span class='word'>little</span> <span class='word'>extra</span> <span class='word'>computational</span> <span class='word'>cost</span><span class='ignore'>.</span> <span class='word'>All</span> <span class='word'>Ellipses</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>considered</span> <span class='word'>as</span> <span class='word'>valid</span> <span class='word'>fits</span> <span class='word'>also</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>suggests</span> <span class='word'>a</span> <span class='word'>method</span> <span class='word'>which</span> <span class='word'>allows</span> <span class='word'>for</span> <span class='word'>extra</span> <span class='word'>information</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>refine</span> <span class='word'>the</span> <span class='word'>fit</span><span class='ignore'>.</span> <span class='word'>In</span> <span class='word'>the</span> <span class='word'>case</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>finger</span> <span class='word'>model</span> <span class='word'>this</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>orientation</span><span class='ignore'>,</span> <span class='word'>distal</span> <span class='word'>width</span> <span class='word'>and</span> <span class='word'>position</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>parallel</span> <span class='word'>line</span> <span class='word'>fit</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>ellipse</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>two</span> <span class='word'>fits</span> <span class='word'>which</span> <span class='word'>most</span> <span class='word'>closely</span> <span class='word'>matches</span> <span class='word'>the</span> <span class='word'>extra</span> <span class='word'>information</span> <span class='word'>is</span> <span class='word'>chosen</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>best</span> <span class='word'>fit</span><span class='ignore'>.</span><br>
<span class='cmd'>\clearpage</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='ignore'>`</span><span class='hword'>Isoscelian</span> <span class='hword'>Trapezian</span><span class='ignore'>'</span> <span class='hword'>Fit</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>TrapezianFit</span><span class='ignore'>}</span><br>
<br>
<span class='word'>Given</span> <span class='word'>three</span> <span class='word'>sets</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>corresponding</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>top</span><span class='ignore'>,</span> <span class='word'>middle</span> <span class='word'>and</span> <span class='word'>bottom</span> <span class='word'>of</span> <span class='word'>an</span> <span class='word'>isosceles</span> <span class='word'>trapezium</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>oriented</span> <span class='word'>so</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>parallel</span> <span class='word'>sides</span> <span class='word'>are</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>left</span> <span class='word'>and</span> <span class='word'>right</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>fit</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>found</span> <span class='word'>as</span> <span class='word'>follows</span><span class='ignore'>:</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{enumerate}</span><br>
<span class='cmd'>\item</span> <span class='word'>A</span> <span class='word'>straight</span> <span class='word'>line</span> <span class='word'>fit</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>midpoints</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>giving</span> <span class='word'>start</span> <span class='word'>and</span> <span class='word'>end</span> <span class='word'>points</span> <span class='word'>along</span> <span class='word'>with</span> <span class='word'>an</span> <span class='word'>orientation</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>The</span> <span class='word'>points</span> <span class='word'>are</span> <span class='word'>translated</span> <span class='word'>and</span> <span class='word'>rotated</span> <span class='word'>so</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>middle</span> <span class='word'>point</span> <span class='word'>is</span> <span class='word'>at</span> <span class='word'>the</span> <span class='word'>origin</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>last</span> <span class='word'>middle</span> <span class='word'>point</span> <span class='word'>is</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>x</span> <span class='word'>axis</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>The</span> <span class='word'>bottom</span> <span class='word'>points</span> <span class='word'>are</span> <span class='word'>reflected</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>x</span> <span class='word'>axis</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>A</span> <span class='word'>single</span> <span class='word'>straight</span> <span class='word'>line</span> <span class='word'>is</span> <span class='word'>fitted</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>top</span> <span class='word'>and</span> <span class='word'>reflected</span> <span class='word'>bottom</span> <span class='word'>points</span> <span class='word'>together</span><span class='ignore'>.</span><br>
<span class='cmd'>\item</span> <span class='word'>Four</span> <span class='word'>points</span> <span class='word'>describing</span> <span class='word'>the</span> <span class='word'>trapezium</span> <span class='word'>are</span> <span class='word'>found</span> <span class='word'>and</span> <span class='word'>returned</span> <span class='word'>along</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>orientation</span> <span class='word'>and</span> <span class='word'>position</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>original</span> <span class='word'>coordinates</span><span class='ignore'>.</span><br>
<span class='envir'>\end</span><span class='envir'>{enumerate}</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>The</span> <span class='ignore'>`</span><span class='hword'>Force</span> <span class='hword'>Analogue</span> <span class='hword'>Shape</span> <span class='hword'>Detection</span><span class='ignore'>'</span> <span class='hword'>Method</span> <span class='ignore'>(</span><span class='hword'>FASDM</span><span class='ignore'>)</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>ForceAnalogue</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\pos</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>P</span><span class='ignore'>}</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\F</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>F</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>i</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\Ft</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>F</span><span class='ignore'>}</span><span class='ignore'>^</span><span class='ignore'>\tau</span><span class='ignore'>_</span><span class='ignore'>i</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\dm</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>d</span><span class='ignore'>}</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>m</span><span class='ignore'>{</span><span class='ignore'>\scriptscriptstyle</span> <span class='ignore'>dl</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>i</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\di</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>d</span><span class='ignore'>}</span><span class='ignore'>^</span><span class='ignore'>{</span><span class='ignore'>i</span><span class='ignore'>{</span><span class='ignore'>\scriptscriptstyle</span> <span class='ignore'>mg</span><span class='ignore'>}</span> <span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>i</span><span class='ignore'>}</span><br>
<span class='cmd'>\newcommand</span><span class='ignore'>{</span><span class='ignore'>\Mt</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='ignore'>\mathbf</span><span class='ignore'>{</span><span class='ignore'>\tau</span><span class='ignore'>}</span><span class='ignore'>_</span><span class='ignore'>i</span><span class='ignore'>}</span><br>
<span class='word'>The</span> <span class='word'>FASDM</span> <span class='word'>is</span> <span class='word'>one</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>most</span> <span class='word'>straightforward</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>if</span> <span class='word'>not</span> <span class='word'>the</span> <span class='word'>most</span> <span class='word'>straightforward</span> <span class='ignore'>-</span><span class='ignore'>-</span><span class='ignore'>-</span> <span class='word'>shape</span> <span class='word'>alignment</span> <span class='word'>algorithms</span><span class='ignore'>.</span> <span class='word'>Given</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>points</span><span class='ignore'>,</span> <span class='word'>if</span> <span class='word'>we</span> <span class='word'>know</span> <span class='word'>a</span> <span class='word'>corresponding</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>the</span> <span class='word'>target</span> <span class='word'>shape</span> <span class='word'>model</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>can</span> <span class='word'>find</span> <span class='word'>translation</span> <span class='word'>vectors</span> <span class='word'>between</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>model</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dm</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>points</span>&nbsp; <span class='word'>on</span> <span class='word'>the</span> <span class='word'>image</span> <span class='mathgroup'>$</span><span class='mathcmd'>\di</span><span class='mathgroup'>$</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>FASDM</span> <span class='word'>makes</span> <span class='word'>the</span> <span class='word'>analogue</span> <span class='word'>between</span> <span class='word'>these</span> <span class='word'>vectors</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>force</span> <span class='word'>acting</span> <span class='word'>on</span> <span class='word'>that</span> <span class='word'>point</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>model</span> <span class='mathgroup'>$</span><span class='mathcmd'>\F</span><span class='math'>=</span><span class='mathcmd'>\di</span><span class='math'>-</span><span class='mathcmd'>\dm</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>position</span> <span class='word'>and</span> <span class='word'>orientation</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>shape</span> <span class='word'>is</span> <span class='word'>then</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>translating</span> <span class='word'>and</span> <span class='word'>rotating</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>such</span> <span class='word'>that</span> <span class='word'>the</span> <span class='ignore'>'</span><span class='word'>force</span><span class='ignore'>'</span> <span class='word'>acting</span> <span class='word'>upon</span> <span class='word'>it</span> <span class='word'>sums</span> <span class='word'>to</span> <span class='word'>zero</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>facilitate</span> <span class='word'>the</span> <span class='word'>calculation</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>is</span> <span class='word'>expressed</span> <span class='word'>in</span> <span class='word'>coordinates</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>origin</span> <span class='word'>corresponds</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>center</span> <span class='word'>of</span> <span class='word'>mass</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>.</span><br>
<br>
<span class='word'>It</span> <span class='word'>should</span> <span class='word'>be</span> <span class='word'>noted</span> <span class='word'>that</span> <span class='word'>other</span> <span class='word'>transformations</span> <span class='word'>can</span> <span class='word'>easily</span> <span class='word'>be</span> <span class='word'>included</span><span class='ignore'>,</span> <span class='word'>however</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>current</span> <span class='word'>purposes</span><span class='ignore'>,</span> <span class='word'>rotation</span> <span class='word'>and</span> <span class='word'>translation</span> <span class='word'>are</span> <span class='word'>all</span> <span class='word'>that</span> <span class='word'>is</span> <span class='word'>required</span><span class='ignore'>.</span><br>
<span class='word'>The</span> <span class='word'>translation</span> <span class='word'>vector</span> <span class='mathgroup'>$</span><span class='mathcmd'>\F</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>average</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>force</span> <span class='word'>acting</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>center</span> <span class='word'>of</span> <span class='word'>mass</span> <span class='mathgroup'>$</span><span class='mathcmd'>\pos</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>n</span><span class='ignore'>}</span> <span class='mathcmd'>\sum</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>=</span><span class='math'>1</span><span class='ignore'>}</span><span class='math'>^</span><span class='math'>n</span> <span class='mathcmd'>\F</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
<span class='word'>Translating</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>to</span> <span class='word'>this</span> <span class='word'>position</span> <span class='word'>allows</span> <span class='word'>the</span> <span class='word'>residual</span> <span class='word'>turning</span> <span class='word'>forces</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>found</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Ft</span> <span class='math'>=</span> <span class='mathcmd'>\F</span> <span class='math'>-</span> <span class='mathcmd'>\pos</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
<span class='word'>The</span> <span class='word'>moment</span> <span class='word'>about</span> <span class='word'>the</span> <span class='word'>center</span> <span class='word'>of</span> <span class='word'>mass</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Mt</span><span class='mathgroup'>$</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>simply</span> <span class='word'>by</span> <span class='word'>finding</span> <span class='word'>the</span> <span class='word'>magnitude</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>outer</span> <span class='word'>product</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>residual</span> <span class='word'>turning</span> <span class='word'>force</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Ft</span><span class='mathgroup'>$</span> <span class='word'>with</span> <span class='word'>the</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>model</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dm</span><span class='mathgroup'>$</span> <span class='word'>thus</span> <span class='mathgroup'>$</span><span class='mathcmd'>\Mt</span> <span class='math'>=</span> <span class='mathcmd'>\lVert</span> <span class='mathcmd'>\Ft</span> <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\dm</span> <span class='mathcmd'>\rVert</span><span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
<span class='word'>The</span> <span class='word'>rotation</span> <span class='word'>which</span> <span class='word'>would</span> <span class='word'>reduce</span> <span class='word'>the</span> <span class='word'>moment</span> <span class='word'>to</span> <span class='word'>zero</span> <span class='word'>is</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>the</span> <span class='word'>angle</span> <span class='word'>between</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dm</span><span class='mathgroup'>$</span> <span class='word'>and</span> <span class='mathgroup'>$</span><span class='mathcmd'>\dm</span><span class='math'>+</span><span class='mathcmd'>\Ft</span><span class='mathgroup'>$</span><span class='ignore'>.</span><br>
<span class='word'>The</span> <span class='word'>moment</span> <span class='word'>weighted</span> <span class='word'>average</span> <span class='word'>of</span> <span class='word'>these</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>angle</span> <span class='mathgroup'>$</span><span class='math'>\theta</span><span class='mathgroup'>$</span> <span class='word'>which</span> <span class='word'>will</span> <span class='word'>most</span> <span class='word'>reduce</span> <span class='word'>the</span> <span class='word'>total</span> <span class='word'>rotational</span> <span class='word'>moment</span> <span class='mathgroup'>$</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>\tau</span><span class='ignore'>}</span> <span class='mathgroup'>$</span><span class='ignore'>.</span> <br>
<br>
<span class='envir'>\begin</span><span class='envir'>{align*}</span><br>
<span class='math'>\theta </span><span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>\tau</span><span class='ignore'>}</span><span class='ignore'>}</span> <span class='mathcmd'>\sum</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>=</span><span class='math'>1</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n</span><span class='ignore'>}</span> <span class='mathcmd'>\Mt</span> <span class='mathcmd'>\theta</span><span class='math'>_</span><span class='math'>i</span> <span class='math'>&amp;</span><br>
<span class='mathcmd'>\theta</span><span class='math'>_</span><span class='math'>i</span> <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\arccos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\dm</span> <span class='mathcmd'>\cdot</span> <span class='math'>(</span><span class='mathcmd'>\dm</span><span class='math'>+</span><span class='mathcmd'>\Ft</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\lVert</span> <span class='mathcmd'>\dm</span> <span class='mathcmd'>\rVert</span> <span class='mathcmd'>\lVert</span> <span class='mathcmd'>\dm</span><span class='math'>+</span><span class='mathcmd'>\Ft</span> <span class='mathcmd'>\rVert</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span><br>
<span class='mathcmd'>\mathbf</span><span class='ignore'>{</span><span class='math'>\tau</span><span class='ignore'>}</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\sum</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>=</span><span class='math'>1</span><span class='ignore'>}</span><span class='math'>^</span><span class='ignore'>{</span><span class='math'>n</span><span class='ignore'>}</span> <span class='mathcmd'>\Mt</span> <span class='mathcmd'>\\</span><br>
<span class='mathcmd'>\pos</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='math'>1</span><span class='ignore'>}</span> <span class='ignore'>{</span><span class='math'>n</span><span class='ignore'>}</span> <span class='mathcmd'>\sum</span><span class='math'>_</span><span class='ignore'>{</span><span class='math'>i</span><span class='math'>=</span><span class='math'>1</span><span class='ignore'>}</span><span class='math'>^</span><span class='math'>n</span> <span class='mathcmd'>\F</span> <span class='math'>&amp;</span><br>
&nbsp; <span class='math'>&amp;</span><span class='math'>=</span>&nbsp; <span class='mathcmd'>\arccos</span> <span class='mathcmd'>\left</span><span class='math'>(</span><span class='mathcmd'>\frac</span><span class='ignore'>{</span><span class='mathcmd'>\dm</span> <span class='mathcmd'>\cdot</span> <span class='math'>(</span><span class='mathcmd'>\di</span> <span class='math'>-</span> <span class='mathcmd'>\pos</span><span class='math'>)</span><span class='ignore'>}</span><span class='ignore'>{</span><span class='mathcmd'>\lVert</span> <span class='mathcmd'>\dm</span> <span class='mathcmd'>\rVert</span> <span class='mathcmd'>\lVert</span> <span class='mathcmd'>\di</span> <span class='math'>-</span> <span class='mathcmd'>\pos</span> <span class='mathcmd'>\rVert</span><span class='ignore'>}</span><span class='mathcmd'>\right</span><span class='math'>)</span>&nbsp; <span class='math'>&amp;</span><br>
<span class='mathcmd'>\Mt</span> <span class='math'>&amp;</span><span class='math'>=</span> <span class='mathcmd'>\lVert</span> <span class='math'>(</span><span class='mathcmd'>\di</span> <span class='math'>-</span> <span class='mathcmd'>\pos</span><span class='math'>)</span> <span class='mathcmd'>\wedge</span> <span class='mathcmd'>\dm</span> <span class='mathcmd'>\rVert</span><br>
<span class='envir'>\end</span><span class='envir'>{align*}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Random</span><span class='ignore'>_</span><span class='ignore'>Polygon</span><span class='ignore'>_</span><span class='ignore'>Centroids.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Random</span> <span class='oword'>Polygon</span> <span class='oword'>Centroids</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>RandomPolygonCentroids</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>Exagerated</span><span class='ignore'>_</span><span class='ignore'>Model</span><span class='ignore'>_</span><span class='ignore'>Centroids</span><span class='ignore'>_</span><span class='ignore'>With</span><span class='ignore'>_</span><span class='ignore'>Pos</span><span class='ignore'>_</span><span class='ignore'>Orientation.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Position</span> <span class='oword'>and</span> <span class='oword'>Orientation</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ExaggeratedPositionAndOrientation</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<br>
 <span class='word'>Mathematically</span> <span class='word'>and</span> <span class='word'>algorithmically</span><span class='ignore'>,</span> <span class='word'>there</span> <span class='word'>are</span> <span class='word'>three</span> <span class='word'>points</span> <span class='word'>which</span> <span class='word'>may</span> <span class='word'>be</span> <span class='word'>considered</span> <span class='word'>the</span> <span class='word'>center</span> <span class='word'>of</span> <span class='word'>mass</span><span class='ignore'>:</span> <span class='word'>the</span> <span class='word'>centroid</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>area</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>where</span> <span class='word'>the</span> <span class='word'>center</span> <span class='word'>of</span> <span class='word'>mass</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>were</span> <span class='word'>a</span> <span class='word'>a</span> <span class='word'>flat</span><span class='ignore'>,</span> <span class='word'>uniform</span> <span class='word'>sheet</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>centroid</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>perimeter</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>,</span> <span class='word'>which</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>center</span> <span class='word'>of</span> <span class='word'>mass</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>were</span> <span class='word'>constructed</span> <span class='word'>using</span> <span class='word'>wire</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>perimeter</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>arithmetic</span> <span class='word'>average</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>interest</span> <span class='word'>defined</span> <span class='word'>on</span> <span class='word'>the</span> <span class='word'>perimeter</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>model</span><span class='ignore'>.</span> <span class='ignore'>(</span><span class='word'>See</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>RandomPolygonCentroids</span><span class='ignore'>}</span><span class='ignore'>.</span><span class='ignore'>)</span> <span class='word'>The</span> <span class='word'>choice</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>analogue</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>center</span> <span class='word'>of</span> <span class='word'>mass</span> <span class='word'>depends</span> <span class='word'>upon</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>used</span><span class='ignore'>.</span> <span class='word'>For</span> <span class='word'>a</span> <span class='word'>method</span> <span class='word'>which</span> <span class='word'>returns</span> <span class='word'>points</span> <span class='word'>radially</span> <span class='word'>distributed</span> <span class='word'>about</span> <span class='word'>a</span> <span class='word'>point</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>model</span> <span class='word'>would</span> <span class='word'>favor</span> <span class='word'>the</span> <span class='word'>area</span> <span class='word'>centroid</span><span class='ignore'>;</span> <span class='word'>a</span> <span class='word'>method</span> <span class='word'>which</span> <span class='word'>returned</span> <span class='word'>points</span> <span class='word'>relatively</span> <span class='word'>evenly</span> <span class='word'>distributed</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>perimeter</span> <span class='word'>would</span> <span class='word'>naturally</span> <span class='word'>favor</span> <span class='word'>the</span> <span class='word'>perimeter</span> <span class='word'>centroid</span> <span class='word'>method</span><span class='ignore'>;</span> <span class='word'>and</span> <span class='word'>a</span> <span class='word'>method</span> <span class='word'>which</span> <span class='word'>returned</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>interest</span> <span class='word'>would</span> <span class='word'>favor</span> <span class='word'>the</span> <span class='word'>point</span> <span class='word'>centroid</span> <span class='word'>method</span><span class='ignore'>.</span> <span class='ignore'>(</span><span class='word'>There's</span> <span class='word'>no</span> <span class='word'>guarantee</span> <span class='word'>the</span> <span class='word'>points</span> <span class='word'>of</span> <span class='word'>interest</span> <span class='word'>would</span> <span class='word'>be</span> <span class='word'>distributed</span> <span class='word'>in</span> <span class='word'>any</span> <span class='word'>relation</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>shape-based</span> <span class='word'>centroids</span><span class='ignore'>.</span><span class='ignore'>)</span> <span class='word'>An</span> <span class='word'>example</span> <span class='word'>fingertip</span> <span class='word'>model</span> <span class='word'>centroid</span> <span class='word'>and</span> <span class='word'>FASDM</span> <span class='word'>method</span> <span class='word'>can</span> <span class='word'>be</span> <span class='word'>seen</span> <span class='word'>in</span> <span class='word'>Figure</span> <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ExaggeratedPositionAndOrientation</span><span class='ignore'>}</span><span class='ignore'>.</span><br>
 <br>
 <span class='word'>The</span> <span class='word'>Filament</span> <span class='word'>Fill</span> <span class='word'>algorithm</span> <span class='word'>returns</span> <span class='word'>a</span> <span class='word'>set</span> <span class='word'>of</span> <span class='word'>points</span> <span class='word'>distributed</span> <span class='word'>linearly</span> <span class='word'>around</span> <span class='word'>the</span> <span class='word'>perimeter</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>appropriate</span> <span class='word'>FASDM</span> <span class='word'>method</span> <span class='word'>is</span> <span class='word'>therefore</span> <span class='word'>a</span> <span class='word'>point-based</span> <span class='word'>centroid</span> <span class='word'>found</span> <span class='word'>by</span> <span class='word'>generating</span> <span class='word'>points</span> <span class='word'>along</span> <span class='word'>the</span> <span class='word'>shape</span> <span class='word'>perimeter</span> <span class='word'>which</span> <span class='word'>are</span> <span class='word'>equally-spaced</span> <span class='word'>perpendicular</span> <span class='word'>projections</span> <span class='word'>from</span> <span class='word'>the</span> <span class='word'>shape</span> <span class='word'>axis</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\chapter</span><span class='ignore'>{</span><span class='hword'>iPhone</span> <span class='hword'>Camera</span> <span class='hword'>Setup</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>iPhoneCameraSetup</span><span class='ignore'>}</span><br>
<span class='word'>Quite</span> <span class='word'>later</span> <span class='word'>on</span> <span class='word'>in</span> <span class='word'>development</span><span class='ignore'>,</span> <span class='word'>an</span> <span class='word'>iOS</span> <span class='word'>update</span> <span class='word'>was</span> <span class='word'>released</span> <span class='word'>which</span> <span class='word'>allows</span> <span class='word'>in-code</span> <span class='word'>control</span> <span class='word'>of</span> <span class='word'>camera</span> <span class='word'>properties</span><span class='ignore'>,</span> <span class='word'>such</span> <span class='word'>as</span> <span class='word'>focus</span><span class='ignore'>,</span> <span class='word'>exposure</span> <span class='word'>and</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>color</span> <span class='word'>balance</span><span class='ignore'>.</span> <span class='word'>Because</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>does</span> <span class='word'>per-pixel</span> <span class='word'>comparisons</span> <span class='word'>and</span> <span class='word'>assumes</span> <span class='word'>that</span> <span class='word'>the</span> <span class='word'>color</span> <span class='word'>values</span> <span class='word'>remain</span> <span class='word'>constant</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>first</span> <span class='word'>thing</span> <span class='word'>this</span> <span class='word'>allows</span> <span class='word'>us</span> <span class='word'>to</span> <span class='word'>do</span> <span class='word'>is</span> <span class='word'>fix</span> <span class='word'>the</span> <span class='word'>exposure</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>white</span> <span class='word'>point</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>focus</span> <span class='word'>such</span> <span class='word'>that</span><span class='ignore'>,</span> <span class='word'>as</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>is</span> <span class='word'>tracking</span> <span class='word'>the</span> <span class='word'>digit</span> <span class='word'>and</span> <span class='word'>tracking</span> <span class='word'>the</span> <span class='word'>blood</span> <span class='word'>flow</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>algorithm</span> <span class='word'>isn't</span> <span class='word'>thrown</span> <span class='word'>off</span> <span class='word'>by</span> <span class='word'>the</span> <span class='word'>phone</span> <span class='word'>deciding</span> <span class='word'>to</span> <span class='word'>suddenly</span> <span class='word'>changing</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>properties</span><span class='ignore'>.</span> <br>
<br>
<span class='word'>Initially</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>simple</span> <span class='word'>routine</span> <span class='word'>was</span> <span class='word'>added</span> <span class='word'>which</span> <span class='word'>simply</span> <span class='word'>fixed</span> <span class='word'>these</span> <span class='word'>camera</span> <span class='word'>properties</span> <span class='word'>before</span> <span class='word'>starting</span> <span class='word'>the</span> <span class='word'>tracking</span><span class='ignore'>.</span> <span class='word'>However</span><span class='ignore'>,</span> <span class='word'>it</span> <span class='word'>was</span> <span class='word'>apparent</span> <span class='word'>that</span> <span class='word'>we</span> <span class='word'>could</span> <span class='word'>take</span> <span class='word'>advantage</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>control</span> <span class='word'>features</span> <span class='word'>to</span> <span class='word'>produce</span> <span class='word'>a</span> <span class='word'>better</span> <span class='word'>result</span><span class='ignore'>.</span> <span class='word'>First</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>needed</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>able</span> <span class='word'>to</span> <span class='word'>perform</span> <span class='word'>a</span> <span class='word'>metric</span> <span class='word'>for</span> <span class='word'>how</span> <span class='word'>good</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>settings</span> <span class='word'>are</span> <span class='word'>for</span> <span class='word'>tracking</span><span class='ignore'>.</span> <span class='word'>Initially</span><span class='ignore'>,</span> <span class='word'>this</span> <span class='word'>metric</span> <span class='word'>was</span> <span class='word'>taken</span> <span class='word'>using</span> <span class='word'>the</span> <span class='word'>whole</span> <span class='word'>image</span><span class='ignore'>.</span> <span class='word'>Taking</span> <span class='word'>the</span> <span class='word'>classified</span> <span class='word'>image</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>metric</span> <span class='word'>was</span> <span class='word'>formed</span> <span class='word'>by</span> <span class='word'>taking</span> <span class='word'>a</span> <span class='word'>weighted</span> <span class='word'>sum</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>classified</span> <span class='word'>image</span> <span class='word'>pixel</span> <span class='word'>values</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>metric</span> <span class='word'>scored</span> <span class='word'>values</span> <span class='word'>of</span> <span class='word'>0</span> <span class='word'>and</span> <span class='word'>3</span> <span class='word'>positively</span> <span class='word'>and</span> <span class='word'>values</span> <span class='word'>of</span> <span class='word'>1</span> <span class='word'>and</span> <span class='word'>2</span> <span class='word'>negatively</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>idea</span> <span class='word'>being</span> <span class='word'>to</span> <span class='word'>promote</span> <span class='word'>camera</span> <span class='word'>settings</span> <span class='word'>which</span> <span class='word'>result</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>classified</span> <span class='word'>image</span> <span class='word'>which</span> <span class='word'>rewards</span> <span class='word'>certainty</span><span class='ignore'>.</span><br>
<br>
<span class='word'>However</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>problem</span> <span class='word'>with</span> <span class='word'>this</span> <span class='word'>approach</span> <span class='word'>is</span> <span class='word'>that</span> <span class='word'>if</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>properties</span> <span class='word'>are</span> <span class='word'>set</span> <span class='word'>with</span><span class='ignore'>,</span> <span class='word'>say</span><span class='ignore'>,</span> <span class='word'>a</span> <span class='word'>very</span> <span class='word'>low</span> <span class='word'>exposure</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>image</span> <span class='word'>is</span> <span class='word'>almost</span> <span class='word'>entirely</span> <span class='word'>black</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>classified</span> <span class='word'>image</span> <span class='word'>is</span> <span class='word'>certain</span> <span class='word'>that</span> <span class='word'>there</span> <span class='word'>isn't</span> <span class='word'>a</span> <span class='word'>finger</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>picture</span><span class='ignore'>,</span> <span class='word'>regardless</span> <span class='word'>of</span> <span class='word'>the</span> <span class='word'>reality</span><span class='ignore'>,</span> <span class='word'>so</span> <span class='word'>this</span> <span class='word'>metric</span> <span class='word'>is</span> <span class='word'>scored</span> <span class='word'>highly</span><span class='ignore'>.</span> <span class='word'>To</span> <span class='word'>combat</span> <span class='word'>this</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>app</span> <span class='word'>allows</span> <span class='word'>two</span> <span class='word'>regions</span> <span class='word'>to</span> <span class='word'>be</span> <span class='word'>selected</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>frame</span><span class='ignore'>,</span> <span class='word'>one</span> <span class='word'>which</span> <span class='word'>definitely</span> <span class='word'>contains</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>one</span> <span class='word'>which</span> <span class='word'>definitely</span> <span class='word'>does</span> <span class='word'>not</span><span class='ignore'>.</span> <span class='word'>We</span> <span class='word'>then</span> <span class='word'>have</span> <span class='word'>two</span> <span class='word'>separate</span> <span class='word'>metrics</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>region</span><span class='ignore'>;</span> <span class='word'>values</span> <span class='word'>of</span> <span class='word'>2</span> <span class='word'>and</span> <span class='word'>3</span> <span class='word'>are</span> <span class='word'>scored</span> <span class='word'>highly</span><span class='ignore'>,</span> <span class='word'>while</span> <span class='word'>values</span> <span class='word'>of</span> <span class='word'>0</span> <span class='word'>and</span> <span class='word'>1</span> <span class='word'>are</span> <span class='word'>scored</span> <span class='word'>negatively</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>conversely</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>skinless</span> <span class='word'>region</span><span class='ignore'>.</span><br>
<br>
<span class='word'>After</span> <span class='word'>all</span> <span class='word'>this</span> <span class='word'>work</span><span class='ignore'>,</span> <span class='word'>we</span> <span class='word'>have</span> <span class='word'>three</span> <span class='word'>metrics</span><span class='ignore'>:</span> <span class='word'>one</span> <span class='word'>which</span> <span class='word'>rewards</span> <span class='word'>correctly</span> <span class='word'>identifying</span> <span class='word'>skin</span><span class='ignore'>,</span> <span class='word'>one</span> <span class='word'>which</span> <span class='word'>rewards</span> <span class='word'>correctly</span> <span class='word'>identifying</span> <span class='word'>background</span><span class='ignore'>,</span> <span class='word'>and</span> <span class='word'>one</span> <span class='word'>which</span> <span class='word'>rewards</span> <span class='word'>overall</span> <span class='word'>certainty</span><span class='ignore'>.</span> <span class='word'>The</span> <span class='word'>final</span> <span class='word'>metric</span> <span class='word'>which</span> <span class='word'>was</span> <span class='word'>returned</span> <span class='word'>in</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>calibration</span> <span class='word'>is</span> <span class='word'>the</span> <span class='word'>weighted</span> <span class='word'>sum</span> <span class='word'>of</span> <span class='word'>these</span> <span class='word'>three</span> <span class='word'>metrics</span><span class='ignore'>;</span> <span class='word'>the</span> <span class='word'>skin</span> <span class='word'>and</span> <span class='word'>the</span> <span class='word'>background</span> <span class='word'>identification</span> <span class='word'>metrics</span> <span class='word'>given</span> <span class='word'>a</span> <span class='word'>slightly</span> <span class='word'>higher</span> <span class='word'>weighting</span> <span class='word'>than</span> <span class='word'>the</span> <span class='word'>overall</span> <span class='word'>certainty</span><span class='ignore'>.</span><br>
<br>
<span class='cmd'>\clearpage</span><br>
<br>
<span class='cmd'>\section</span><span class='ignore'>{</span><span class='hword'>Setting</span> <span class='hword'>the</span> <span class='hword'>Exposure</span><span class='ignore'>}</span><span class='cmd'>\label</span><span class='ignore'>{</span><span class='ignore'>sec</span><span class='ignore'>:</span><span class='ignore'>SettingTheExposure</span><span class='ignore'>}</span><br>
<span class='envir'>\begin</span><span class='envir'>{figure}</span><span class='option'>[h!]</span><br>
&nbsp;<span class='exclcmd'>\centering</span><br>
&nbsp;&nbsp;<span class='exclcmd'>\includegraphics</span><span class='option'>[width=0.95\textwidth]</span><span class='ignore'>{</span><span class='ignore'>Chapter4</span><span class='ignore'>/</span><span class='ignore'>Figs</span><span class='ignore'>/</span><span class='ignore'>exposureGraphic1.jpg</span><span class='ignore'>}</span><br>
&nbsp; &nbsp; <span class='cmd'>\caption</span><span class='ignore'>{</span><span class='oword'>Optimization</span> <span class='oword'>of</span> <span class='oword'>the</span> <span class='oword'>exposure</span> <span class='oword'>for</span> <span class='oword'>the</span> <span class='oword'>iPhone</span> <span class='oword'>camera</span><span class='ignore'>.</span><span class='ignore'>}</span><span class='exclcmd'>\label</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ExposureGraphic1</span><span class='ignore'>}</span><br>
<span class='envir'>\end</span><span class='envir'>{figure}</span><br>
<span class='word'>To</span> <span class='word'>find</span> <span class='word'>the</span> <span class='word'>optimal</span> <span class='word'>exposure</span><span class='ignore'>,</span> <span class='word'>the</span> <span class='word'>code</span> <span class='word'>first</span> <span class='word'>picks</span> <span class='word'>a</span> <span class='word'>handful</span> <span class='word'>of</span> <span class='word'>values</span> <span class='word'>between</span> <span class='word'>a</span> <span class='word'>minimum</span> <span class='word'>and</span> <span class='word'>maximum</span> <span class='word'>exposure</span> <span class='word'>and</span> <span class='word'>evaluates</span> <span class='word'>the</span> <span class='word'>metric</span> <span class='word'>at</span> <span class='word'>these</span> <span class='word'>values</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>done</span> <span class='word'>by</span> <span class='word'>setting</span> <span class='word'>the</span> <span class='word'>exposure</span> <span class='word'>waiting</span> <span class='word'>in-code</span> <span class='word'>for</span> <span class='word'>a</span> <span class='word'>few</span> <span class='word'>microseconds</span> <span class='word'>for</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>to</span> <span class='word'>finish</span> <span class='word'>adjusting</span> <span class='word'>and</span> <span class='word'>then</span> <span class='word'>evaluating</span> <span class='word'>the</span> <span class='word'>metric</span><span class='ignore'>.</span> <span class='word'>This</span> <span class='word'>is</span> <span class='word'>necessary</span> <span class='word'>because</span> <span class='word'>the</span> <span class='word'>camera</span> <span class='word'>properties</span> <span class='word'>are</span> <span class='word'>set</span> <span class='word'>in</span> <span class='word'>a</span> <span class='word'>different</span> <span class='word'>thread</span> <span class='word'>to</span> <span class='word'>the</span> <span class='word'>tracking</span> <span class='word'>algorithm's</span> <span class='word'>thread</span><span class='ignore'>.</span> <span class='word'>A</span> <span class='word'>bisection</span> <span class='word'>algorithm</span> <span class='word'>is</span> <span class='word'>then</span> <span class='word'>used</span> <span class='word'>to</span> <span class='word'>refine</span> <span class='word'>the</span> <span class='word'>optimal</span> <span class='word'>exposure</span> <span class='ignore'>(</span><span class='word'>Figure</span>&nbsp; <span class='cmd'>\ref</span><span class='ignore'>{</span><span class='ignore'>fig</span><span class='ignore'>:</span><span class='ignore'>ExposureGraphic1</span><span class='ignore'>}</span><span class='ignore'>)</span><span class='ignore'>.</span><br>
<br>
<br>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Chapter4/AppendixChapter4.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 4329</li>
<li>Words in headers: 68</li>
<li>Words outside text (captions, etc.): 180</li>
<li>Number of headers: 18</li>
<li>Number of floats/tables/figures: 12</li>
<li>Number of math inlines: 78</li>
<li>Number of math displayed: 11</li>
<li>Subcounts:</li>
<span class='subcount'>
<li class='fielddesc'>&nbsp; text+headers+captions (#headers/#floats/#inlines/#displayed)</li>
  <li>0+2+0 (1/0/0/0) Chapter: Colorspace Methods</li>
  <li>623+4+0 (1/0/13/0) Section: Implementing the Color Space}\label{sec:ImplementingTheColorSpace</li>
  <li>205+4+0 (1/0/2/1) Subsection: The White-Out Black-Out Algorithm}\label{sec:WhiteOutBlackOutAlgorithm</li>
  <li>153+6+29 (1/1/3/0) Subsection: The Region Classification and Partitioning Function}\label{sec:TheRegionClassificationAndPartitioningFunction</li>
  <li>152+3+0 (1/0/4/1) Subsection: Floating the Mean}\label{sec:FloatingTheMean</li>
  <li>141+2+56 (1/1/7/0) Subsection: Loosened Deviation}\label{sec:LoosenedDeviation</li>
  <li>350+6+0 (1/0/18/2) Subsection: The Color Space Algorithm as Implemented}\label{sec:ColorSpaceAlgorithmAsImplemented</li>
  <li>16+3+0 (1/0/0/0) Section: Pattern Recognition Routines}\label{sec:PatternRecognitionRoutines</li>
  <li>216+3+12 (1/1/2/0) Subsection: Quaternary Pixel Classification}\label{sec:QuaternaryPixelClassification</li>
  <li>0+3+0 (1/0/0/0) Chapter: Shape Fitting Methods</li>
  <li>175+3+0 (1/0/0/0) Section: The `Hurdle' Method}\label{sec:HurdleMethod</li>
  <li>207+4+4 (1/1/0/0) Section: The `Filament Fill' Method}\label{sec:FilamentFill</li>
  <li>470+4+56 (1/4/0/0) Section: The `Kink Fit' Method}\label{sec:KinkFitMethod</li>
  <li>589+4+9 (1/1/15/6) Section: The `Elliptical Fit' Method}\label{sec:EllipticalFitMethod</li>
  <li>123+4+0 (1/0/0/0) Section: The `Isoscelian Trapezian' Fit}\label{sec:TrapezianFit</li>
  <li>460+7+6 (1/2/14/1) Section: The `Force Analogue Shape Detection' Method (FASDM)}\label{sec:ForceAnalogue</li>
  <li>369+3+0 (1/0/0/0) Chapter: iPhone Camera Setup}\label{sec:iPhoneCameraSetup</li>
  <li>80+3+8 (1/1/0/0) Section: Setting the Exposure}\label{sec:SettingTheExposure</li>
</span>
</ul>
</div>
<h2>File: ./Chapter5/AppendixChapter5.tex</h2>
<div class='parse'><p>
</p></div>
<div class='count'>
<ul class='count'>
<li class='header'>Included file: ./Chapter5/AppendixChapter5.tex</li>
<li>Encoding: ascii</li>
<li>Words in text: 0</li>
<li>Words in headers: 0</li>
<li>Words outside text (captions, etc.): 0</li>
<li>Number of headers: 0</li>
<li>Number of floats/tables/figures: 0</li>
<li>Number of math inlines: 0</li>
<li>Number of math displayed: 0</li>
</ul>
</div>
<h2>Sum of files: thesis.tex</h2>
<div class='sumcount'>
<ul class='count'>
<li class='header'>File(s) total: thesis.tex</li>
<li>Words in text: 24254</li>
<li>Words in headers: 350</li>
<li>Words outside text (captions, etc.): 1766</li>
<li>Number of headers: 98</li>
<li>Number of floats/tables/figures: 81</li>
<li>Number of math inlines: 531</li>
<li>Number of math displayed: 101</li>
<li>Files: 15</li>
<li>Subcounts:</li>
<span class='subcount'>
<li class='fielddesc'>&nbsp; text+headers+captions (#headers/#floats/#inlines/#displayed)</li>
  <li>1+8+0 (1/0/0/0) File: thesis.tex</li>
  <li>15+0+0 (0/0/0/0) Included file: ./Dedication/dedication.tex</li>
  <li>88+0+0 (0/0/0/0) Included file: ./Declaration/declaration.tex</li>
  <li>105+0+0 (0/0/0/0) Included file: ./Acknowledgement/acknowledgement.tex</li>
  <li>334+1+0 (1/0/0/0) Included file: ./Abstract/abstract.tex</li>
  <li>2269+17+162 (7/7/25/5) Included file: ./Chapter1/chapter1.tex</li>
  <li>1867+36+9 (7/0/88/14) Included file: ./Chapter2/chapter2.tex</li>
  <li>3248+49+525 (17/24/58/2) Included file: ./Chapter3/chapter3.tex</li>
  <li>4677+74+445 (20/24/30/4) Included file: ./Chapter4/chapter4.tex</li>
  <li>2562+48+161 (14/5/12/0) Included file: ./Chapter5/chapter5.tex</li>
  <li>4759+49+284 (13/9/240/65) Included file: ./Chapter2/AppendixChapter2.tex</li>
  <li>4329+68+180 (18/12/78/11) Included file: ./Chapter4/AppendixChapter4.tex</li>
</span>
</ul>
</div>
</div>

</body>

</html>
